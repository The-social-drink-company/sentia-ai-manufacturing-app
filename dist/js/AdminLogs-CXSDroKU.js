import{a as e,an as t,j as r,ad as s,bt as a,ai as d,F as i,Z as l,aC as n,E as c,B as o,C as x,af as m,b2 as g,W as h}from"./chunk-dQ8ZuPJ5.js";import{a as y,c as u,e as p}from"./index-D9poZ9V0.js";import"./chunk-CVC8ZTrn.js";import"./chunk-CZm8CRZW.js";import"./chunk-BYhzkSrP.js";import"./chunk-BmDXyJMe.js";import"./chunk-CULnPDSP.js";import"./chunk-BqFGoBxF.js";import"./chunk-Dozjk7Op.js";const b=({log:e,isOpen:t,onClose:s})=>t&&e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Log Details"}),r.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsxs("div",{className:"px-6 py-4 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Timestamp"}),r.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}).format(new Date(e.timestamp))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Level"}),r.jsx("span",{className:u("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",{"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"error"===e.level,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"warning"===e.level,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"success"===e.level,"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"info"===e.level}),children:e.level.toUpperCase()})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"User"}),r.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[e.user," (",e.userRole,")"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"IP Address"}),r.jsx("div",{className:"text-sm font-mono text-gray-900 dark:text-white",children:e.ipAddress})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),r.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:e.description})]}),e.details&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Additional Details"}),r.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-3",children:r.jsx("pre",{className:"text-xs text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:JSON.stringify(e.details,null,2)})})]})]}),r.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:r.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700",children:"Close"})})]})}):null,j=()=>{const{hasPermission:j}=y(),[k,w]=e.useState(""),[v,N]=e.useState("all"),[f,A]=e.useState("all"),[C,D]=e.useState({key:"timestamp",direction:"desc"}),[L,S]=e.useState(null),[I,U]=e.useState(!1),{data:M=[],isLoading:_}=t({queryKey:["admin","logs",k,v,f],queryFn:async()=>(await new Promise(e=>setTimeout(e,800)),[{id:1,timestamp:new Date(Date.now()-9e5),level:"info",category:"authentication",action:"User Login",user:"daniel.kenny@sentiaspirits.com",userRole:"Admin",description:"Successful admin login from Chrome browser",ipAddress:"192.168.1.45",location:"London, UK",details:{browser:"Chrome 119.0",device:"Desktop",sessionId:"sess_1a2b3c4d5e6f"}},{id:2,timestamp:new Date(Date.now()-192e4),level:"warning",category:"data_access",action:"Sensitive Data Access",user:"paul.roberts@sentiaspirits.com",userRole:"Admin",description:"Accessed API key management outside normal hours",ipAddress:"192.168.1.78",location:"Manchester, UK",details:{resource:"API Keys Management",keysViewed:4}},{id:3,timestamp:new Date(Date.now()-27e5),level:"error",category:"system",action:"Failed API Call",user:"system",userRole:"System",description:"Failed to sync with Railway deployment service",ipAddress:"10.0.0.1",location:"Internal",details:{endpoint:"/api/railway/sync",error:"Connection timeout after 30s"}},{id:4,timestamp:new Date(Date.now()-402e4),level:"success",category:"user_management",action:"Bulk User Update",user:"daniel.kenny@sentiaspirits.com",userRole:"Admin",description:"Performed bulk password reset for 5 users",ipAddress:"192.168.1.45",location:"London, UK",details:{operation:"bulk_password_reset",userCount:5}}]),refetchInterval:3e4}),P=M.filter(e=>{const t=""===k||e.action.toLowerCase().includes(k.toLowerCase())||e.description.toLowerCase().includes(k.toLowerCase())||e.user.toLowerCase().includes(k.toLowerCase()),r="all"===v||e.level===v,s="all"===f||e.category===f;return t&&r&&s}),R=[...P].sort((e,t)=>{let r=e[C.key],s=t[C.key];return"timestamp"===C.key&&(r=new Date(r),s=new Date(s)),r<s?"asc"===C.direction?-1:1:r>s?"asc"===C.direction?1:-1:0}),T=e=>{const t=new Date-new Date(e),r=Math.floor(t/6e4),s=Math.floor(t/36e5);return r<60?`${r}m ago`:s<24?`${s}h ago`:`${Math.floor(s/24)}d ago`};return j("admin.logs.view")?_?r.jsx("div",{className:"p-6 space-y-6",children:r.jsxs("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-6"}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[...Array(5)].map((e,t)=>r.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[r.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-2"}),r.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]},t))})]})}):r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"System Logs & Audit Trail"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Monitor system activity, security events, and compliance logs"})]}),r.jsx("div",{className:"flex items-center space-x-3",children:j("admin.logs.export")&&r.jsxs("button",{onClick:()=>{p("Logs exported",{component:"AdminLogs",count:P.length})},className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[r.jsx(a,{className:"w-4 h-4"}),r.jsx("span",{children:"Export"})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Events"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:M.length}),r.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:"Last 24 hours"})]}),r.jsx(d,{className:"w-8 h-8 text-blue-500"})]})}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Security Events"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:M.filter(e=>"security"===e.category||"warning"===e.level||"error"===e.level).length}),r.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:"Requires attention"})]}),r.jsx(i,{className:"w-8 h-8 text-red-500"})]})}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Admin Actions"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:M.filter(e=>"system"!==e.user).length}),r.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:"User activity"})]}),r.jsx(l,{className:"w-8 h-8 text-green-500"})]})}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"System Events"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:M.filter(e=>"system"===e.user).length}),r.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400 mt-1",children:"Automated"})]}),r.jsx(n,{className:"w-8 h-8 text-purple-500"})]})})]}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(c,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search logs...",value:k,onChange:e=>w(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]}),r.jsx("select",{value:v,onChange:e=>N(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[{id:"all",name:"All Levels"},{id:"info",name:"Info"},{id:"success",name:"Success"},{id:"warning",name:"Warning"},{id:"error",name:"Error"}].map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))}),r.jsx("select",{value:f,onChange:e=>A(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[{id:"all",name:"All Categories"},{id:"authentication",name:"Authentication"},{id:"user_management",name:"User Management"},{id:"api_management",name:"API Management"},{id:"data_access",name:"Data Access"},{id:"security",name:"Security"},{id:"system",name:"System"}].map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))})]})}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left",children:r.jsxs("button",{onClick:()=>{return e="timestamp",void D(t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"}));var e},className:"flex items-center space-x-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[r.jsx("span",{children:"Timestamp"}),"timestamp"===C.key&&("asc"===C.direction?r.jsx(o,{className:"w-3 h-3"}):r.jsx(x,{className:"w-3 h-3"}))]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Level"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Action"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"User"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Description"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[R.map(e=>{const t=(e=>{switch(e){case"error":case"warning":return i;case"success":return h;default:return g}})(e.level);return r.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:(s=e.timestamp,new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date(s)))}),r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:T(e.timestamp)})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("span",{className:u("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",{"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"error"===e.level,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"warning"===e.level,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"success"===e.level,"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"info"===e.level}),children:[r.jsx(t,{className:"w-3 h-3 mr-1"}),e.level]})}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.action}),r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:e.category.replace("_"," ")})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:e.user}),r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.userRole})]}),r.jsxs("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900 dark:text-white max-w-xs truncate",children:e.description}),r.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.ipAddress," • ",e.location]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsx("button",{onClick:()=>(e=>{S(e),U(!0)})(e),className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",title:"View Details",children:r.jsx(m,{className:"w-4 h-4"})})})]},e.id);var s}),0===R.length&&r.jsx("tr",{children:r.jsxs("td",{colSpan:"6",className:"px-6 py-12 text-center",children:[r.jsx(d,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No logs found"}),r.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:k?"Try adjusting your search or filters":"No system logs match your current filters"})]})})]})]})})}),r.jsx(b,{log:L,isOpen:I,onClose:()=>U(!1)})]}):r.jsxs("div",{className:"p-6 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx(s,{className:"w-8 h-8 text-red-600"})}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You don't have permission to view system logs."})]})};export{j as default};
