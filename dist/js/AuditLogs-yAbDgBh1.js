import{r as e,j as t,a6 as s,bq as a,ad as r,F as l,bn as i,ax as n,E as c,aZ as d,a7 as o}from"./chunk-6UcRpCBY.js";import{ah as x}from"./chunk-TAvxFron.js";import"./chunk-BSax3_JK.js";import"./chunk-CH-SdtzI.js";import"./chunk-C3SnPVx2.js";import"./chunk-BnxSvIiU.js";import"./chunk-B0LCvgW6.js";import"./chunk-CxHw_PPj.js";import"./chunk-Dozjk7Op.js";const m=()=>{const[m,u]=e.useState([]),[h,g]=e.useState([]),[p,y]=e.useState(!0),[j,f]=e.useState(""),[b,N]=e.useState("all"),[v,w]=e.useState("all"),[k,S]=e.useState("today"),C=[{id:"all",name:"All Categories",count:m.length},{id:"authentication",name:"Authentication",count:m.filter(e=>"authentication"===e.category).length},{id:"data_access",name:"Data Access",count:m.filter(e=>"data_access"===e.category).length},{id:"security",name:"Security",count:m.filter(e=>"security"===e.category).length},{id:"system",name:"System",count:m.filter(e=>"system"===e.category).length},{id:"configuration",name:"Configuration",count:m.filter(e=>"configuration"===e.category).length},{id:"user_management",name:"User Management",count:m.filter(e=>"user_management"===e.category).length}],A=[{id:"all",name:"All Levels",count:m.length},{id:"info",name:"Info",count:m.filter(e=>"info"===e.level).length},{id:"warning",name:"Warning",count:m.filter(e=>"warning"===e.level).length},{id:"error",name:"Error",count:m.filter(e=>"error"===e.level).length},{id:"success",name:"Success",count:m.filter(e=>"success"===e.level).length}];e.useEffect(()=>{(async()=>{try{y(!0);const e=await fetch("/api/admin/audit-logs");if(e.ok){const t=await e.json();u(t.logs||[])}else u([])}catch(e){u([])}finally{y(!1)}})()},[]),e.useEffect(()=>{let e=m.filter(e=>{const t=""===j||e.action.toLowerCase().includes(j.toLowerCase())||e.description.toLowerCase().includes(j.toLowerCase())||e.user.toLowerCase().includes(j.toLowerCase()),s="all"===b||e.level===b,a="all"===v||e.category===v;return t&&s&&a});g(e)},[m,j,b,v]);const L=e=>{switch(e){case"error":return"text-red-600 bg-red-100 border-red-200";case"warning":return"text-yellow-600 bg-yellow-100 border-yellow-200";case"success":return"text-green-600 bg-green-100 border-green-200";case"info":return"text-blue-600 bg-blue-100 border-blue-200";default:return"text-gray-600 bg-gray-100 border-gray-200"}},E=e=>{const t=new Date-e,s=Math.floor(t/6e4),a=Math.floor(t/36e5),r=Math.floor(t/864e5);return s<60?`${s}m ago`:a<24?`${a}h ago`:`${r}d ago`};return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[t.jsx(s,{className:"w-8 h-8 mr-3 text-blue-600"}),"Audit Logs"]}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Security and access monitoring for compliance and troubleshooting"})]}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(a,{className:"w-4 h-4 mr-2"}),"Export Logs"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Events"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.length}),t.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Last 24 hours"})]}),t.jsx(r,{className:"w-8 h-8 text-blue-500"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Security Events"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.filter(e=>"security"===e.category).length}),t.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Requires attention"})]}),t.jsx(l,{className:"w-8 h-8 text-red-500"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"User Actions"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.filter(e=>"system"!==e.user).length}),t.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Human activity"})]}),t.jsx(i,{className:"w-8 h-8 text-green-500"})]})}),t.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"System Events"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.filter(e=>"system"===e.user).length}),t.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Automated"})]}),t.jsx(n,{className:"w-8 h-8 text-purple-500"})]})})]}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search logs...",value:j,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),t.jsx("div",{children:t.jsx("select",{value:b,onChange:e=>N(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:A.map(e=>t.jsxs("option",{value:e.id,children:[e.name," (",e.count,")"]},e.id))})}),t.jsx("div",{children:t.jsx("select",{value:v,onChange:e=>w(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:C.map(e=>t.jsxs("option",{value:e.id,children:[e.name," (",e.count,")"]},e.id))})}),t.jsx("div",{children:t.jsxs("select",{value:k,onChange:e=>S(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"week",children:"This Week"}),t.jsx("option",{value:"month",children:"This Month"}),t.jsx("option",{value:"all",children:"All Time"})]})})]})}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP Address"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p?t.jsx("tr",{children:t.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mx-auto mb-4"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mx-auto"})]})})}):0===h.length?t.jsx("tr",{children:t.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"No logs match your current filters"})}):h.map((e,s)=>{const a=(e=>{switch(e){case"error":case"warning":return l;case"success":return o;default:return d}})(e.level);return t.jsxs(x.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"hover:bg-gray-50 cursor-pointer",children:[t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm text-gray-900",children:(r=e.timestamp,new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(r))}),t.jsx("div",{className:"text-xs text-gray-500",children:E(e.timestamp)})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${L(e.level)}`,children:[t.jsx(a,{className:"w-3 h-3 mr-1"}),e.level]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.action}),t.jsx("div",{className:"text-xs text-gray-500 capitalize",children:e.category.replace("_"," ")})]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm text-gray-900",children:e.user}),t.jsx("div",{className:"text-xs text-gray-500",children:e.userRole})]}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:e.description}),t.jsx("div",{className:"text-xs text-gray-500",children:e.location})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-600",children:e.ipAddress})]},e.id);var r})})]})})})]})};export{m as default};
