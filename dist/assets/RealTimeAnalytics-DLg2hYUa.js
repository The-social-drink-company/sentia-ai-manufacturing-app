import{r as x,C as c,R as m,j as e,H as F,J as O,b4 as b,x as I,w as j,y as E,o as g,b5 as p,I as z}from"./react-vendor-CbFVVgBZ.js";import{L as q,D as _,C as P,a as T,b as U,P as V,c as K,u as M,p as X,d as B,e as H,v as J}from"./charts-Dbk9-C0f.js";import"./vendor-BHPHB5s9.js";import"./utils-Pe79r9Ua.js";P.register(T,U,V,K,M,X,B,H,J);const Y=()=>{const[d,f]=x.useState("24h");x.useState(["revenue","orders","inventory"]);const[i,N]=x.useState(!0),{data:r,isLoading:v,refetch:w}=c({queryKey:["amazon-metrics",_timeRange],queryFn:async()=>{const a=await fetch(`/api/integrations/amazon?endpoint=metrics&range=${d}`);if(!a.ok)throw new Error("Failed to fetch Amazon data");return a.json()},refetchInterval:i?6e4:!1,retry:3}),{data:t,isLoading:k,refetch:S}=c({queryKey:["shopify-analytics",_timeRange],queryFn:async()=>{const a=await fetch(`/api/integrations/shopify?endpoint=analytics&period=${d==="24h"?"1":d==="7d"?"7":"30"}`);if(!a.ok)throw new Error("Failed to fetch Shopify data");return a.json()},refetchInterval:i?6e4:!1,retry:3}),{data:s,isLoading:R,refetch:L}=c({queryKey:["unleashed-summary",_timeRange],queryFn:async()=>{const a=await fetch("/api/integrations/unleashed?endpoint=summary");if(!a.ok)throw new Error("Failed to fetch Unleashed data");return a.json()},refetchInterval:i?6e4:!1,retry:3}),{data:o,isLoading:A,refetch:$}=c({queryKey:["xero-financial",_timeRange],queryFn:async()=>{const a=await fetch(`/api/integrations/xero?endpoint=financial-summary&period=${d==="24h"?"1":d==="7d"?"7":"30"}`);if(!a.ok)throw new Error("Failed to fetch Xero data");return a.json()},refetchInterval:i?6e4:!1,retry:3}),D=()=>{w(),S(),L(),$()},l=m.useMemo(()=>{if(!r?.data||!t?.data||!o?.data||!s?.data)return null;const a=(r.data.totalRevenue||0)+(t.data.summary?.totalSales||0),n=(r.data.totalOrders||0)+(t.data.summary?.totalOrders||0),C=n>0?a/n:0;return{totalRevenue:a,totalOrders:n,averageOrderValue:C,totalInventoryValue:s.data.totalValue||0,totalCustomers:t.data.summary?.totalCustomers||0,overdueAmount:o.data.invoices?.due||0,lastUpdated:new Date().toISOString()}},[r,t,o,s]),h=m.useMemo(()=>t?.data?.analytics?{labels:t.data.analytics.map(n=>new Date(n.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Daily Revenue",data:t.data.analytics.map(n=>n.total_sales||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0}]}:null,[t]),u=m.useMemo(()=>s?.data?{labels:["Available","Low Stock","Out of Stock"],datasets:[{data:[s.data.totalItems-s.data.lowStockItems-s.data.outOfStockItems,s.data.lowStockItems,s.data.outOfStockItems],backgroundColor:["#10B981","#F59E0B","#EF4444"],borderColor:["#059669","#D97706","#DC2626"],borderWidth:2}]}:null,[s]),y=v||k||R||A;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Real-Time Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Live data from Amazon, Shopify, Unleashed ERP, and Xero"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:d,onChange:a=>f(a.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"24h",children:"Last 24 Hours"}),e.jsx("option",{value:"7d",children:"Last 7 Days"}),e.jsx("option",{value:"30d",children:"Last 30 Days"})]}),e.jsxs("button",{onClick:()=>N(!i),className:`px-3 py-2 text-sm rounded-lg transition-colors ${i?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:[e.jsx(F,{className:"w-4 h-4 inline mr-1"}),"Auto Refresh"]}),e.jsxs("button",{onClick:D,disabled:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[e.jsx(O,{className:`w-4 h-4 inline mr-1 ${y?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Amazon SP-API"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${r?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:r?"Connected":"Disconnected"})]})]}),e.jsx(b,{className:"w-8 h-8 text-orange-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Shopify"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${t?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:t?"Connected":"Disconnected"})]})]}),e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"S"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Unleashed ERP"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${s?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:s?"Connected":"Disconnected"})]})]}),e.jsx(I,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Xero Accounting"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${o?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:o?"Connected":"Disconnected"})]})]}),e.jsx(j,{className:"w-8 h-8 text-green-500"})]})})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",l.totalRevenue.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(b,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:l.totalOrders.toLocaleString()})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(E,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Avg Order Value"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",l.averageOrderValue.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Overdue Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",l.overdueAmount.toLocaleString()]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Revenue Trend"}),e.jsxs("button",{className:"text-sm text-blue-600 hover:text-blue-700",children:[e.jsx(p,{className:"w-4 h-4 inline mr-1"}),"Export"]})]}),e.jsx("div",{className:"h-64",children:e.jsx(q,{data:h,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return"$"+a.toLocaleString()}}}}}})})]}),u&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Inventory Status"}),e.jsxs("button",{className:"text-sm text-blue-600 hover:text-blue-700",children:[e.jsx(p,{className:"w-4 h-4 inline mr-1"}),"Export"]})]}),e.jsx("div",{className:"h-64",children:e.jsx(_,{data:u,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Orders"}),e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700",children:"View All"})]})}),e.jsx("div",{className:"p-6",children:t?.data?.summary?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Shopify Orders"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Last ",d]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-gray-900 dark:text-white",children:t.data.summary.totalOrders}),e.jsxs("p",{className:"text-sm text-green-600",children:["$",t.data.summary.totalSales?.toLocaleString()]})]})]}),r?.data&&e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Amazon Orders"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Last ",d]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-gray-900 dark:text-white",children:r.data.totalOrders}),e.jsxs("p",{className:"text-sm text-green-600",children:["$",r.data.totalRevenue?.toLocaleString()]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-24 text-gray-500",children:"Loading order data..."})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"System Alerts"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[s?.data?.lowStockItems>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsx(g,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Low Stock Alert"}),e.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:[s.data.lowStockItems," items have low inventory levels"]})]})]}),l?.overdueAmount>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx(g,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Overdue Invoices"}),e.jsxs("p",{className:"text-xs text-red-700 dark:text-red-300",children:["$",l.overdueAmount.toLocaleString()," in overdue payments"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx(z,{className:"w-5 h-5 text-green-600 dark:text-green-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"All Systems Online"}),e.jsx("p",{className:"text-xs text-green-700 dark:text-green-300",children:"Data synchronization is running smoothly"})]})]})]})]})]})]})};export{Y as default};
