import{ab as e}from"./vendor-if_euMW7.js";import{C as n,d as h}from"./index-IkkkT-X8.js";import{b as o}from"./data-layer-BNrHGTjD.js";import"./radix-DXWB-ErX.js";import"./router-D3j4TwQA.js";const l="https://mcp-server-tkyu.onrender.com",d="/api";class u{constructor(){this.mcpServerUrl=l,this.apiBaseUrl=d}async fetchWithAuth(t,s={}){try{const a=await fetch(t,{...s,headers:{"Content-Type":"application/json",...s.headers}});if(!a.ok)throw new Error(`API Error: ${a.status} ${a.statusText}`);return await a.json()}catch(a){throw console.error("API Call Failed:",a),a}}async getMCPStatus(){return this.fetchWithAuth(`${this.mcpServerUrl}/health`)}async getAIInsights(t){return this.fetchWithAuth(`${this.mcpServerUrl}/api/ai/insights`,{method:"POST",body:JSON.stringify({query:t})})}async getDemandForecast(t){return this.fetchWithAuth(`${this.mcpServerUrl}/api/ai/forecast`,{method:"POST",body:JSON.stringify(t)})}async getInventoryOptimization(){return this.fetchWithAuth(`${this.mcpServerUrl}/api/ai/inventory-optimization`)}async getWorkingCapital(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/financial/working-capital`)}catch(t){return console.warn("[APIService] MCP working capital request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/financial/working-capital`)}}async getCashFlow(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/financial/cash-flow`)}catch(t){return console.warn("[APIService] MCP cash flow request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/financial/cash-flow`)}}async getFinancialMetrics(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/financial/metrics`)}catch(t){return console.warn("[APIService] MCP financial metrics request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/financial/metrics`)}}async getProductionMetrics(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/production/metrics`)}catch(t){return console.warn("[APIService] MCP production metrics request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/production/metrics`)}}async getInventoryData(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/inventory/current`)}catch(t){return console.warn("[APIService] MCP inventory request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/inventory/current`)}}async getQualityMetrics(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/quality/metrics`)}catch(t){return console.warn("[APIService] MCP quality metrics request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/quality/metrics`)}}async getDashboardSummary(){try{return await this.fetchWithAuth(`${this.mcpServerUrl}/api/dashboard/summary`)}catch(t){return console.warn("[APIService] MCP dashboard summary request failed, falling back to local API",t),this.fetchWithAuth(`${this.apiBaseUrl}/dashboard/summary`)}}async getXeroData(){return this.fetchWithAuth(`${this.apiBaseUrl}/integrations/xero/data`)}async getShopifyData(){return this.fetchWithAuth(`${this.apiBaseUrl}/integrations/shopify/data`)}async getAmazonData(){return this.fetchWithAuth(`${this.apiBaseUrl}/integrations/amazon/data`)}async runWhatIfScenario(t){return this.fetchWithAuth(`${this.mcpServerUrl}/api/ai/what-if`,{method:"POST",body:JSON.stringify(t)})}connectToLiveData(t,s){const a=new EventSource(`${this.mcpServerUrl}/api/sse/stream`);return a.onmessage=i=>{try{const c=JSON.parse(i.data);t(c)}catch(c){console.error("SSE Parse Error:",c)}},a.onerror=i=>{console.error("SSE Connection Error:",i),s&&s(i)},a}}const p=new u,S=()=>{const{data:r,isLoading:t}=o({queryKey:["quality"],queryFn:()=>p.getQualityMetrics(),refetchInterval:3e4});return t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quality Control"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(n,{children:e.jsxs(h,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Quality Score"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[(r==null?void 0:r.score)||"98.5","%"]})]})}),e.jsx(n,{children:e.jsxs(h,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Defect Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-red-600",children:[(r==null?void 0:r.defectRate)||"0.8","%"]})]})}),e.jsx(n,{children:e.jsxs(h,{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tests Passed"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[(r==null?void 0:r.testsPassed)||"2,341","/",(r==null?void 0:r.totalTests)||"2,350"]})]})})]})]})};export{S as default};
