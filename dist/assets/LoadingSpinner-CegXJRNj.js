import{r as o,j as e}from"./react-vendor-CbFVVgBZ.js";import{C as y,u as k,a as j}from"./clerk-3Oyg3_c8.js";import{ax as v,c as N}from"./vendor-BHPHB5s9.js";const h=o.createContext(null),f={isLoaded:!0,isSignedIn:!0,userId:"guest_user",sessionId:"guest_session",user:{id:"guest_user",firstName:"Guest",lastName:"User",fullName:"Guest User",emailAddresses:[{emailAddress:"guest@sentia.local"}],publicMetadata:{role:"viewer"}},signOut:()=>Promise.resolve(),getToken:()=>Promise.resolve(null),mode:"fallback"},w=()=>e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Initializing authentication..."})]})}),A=({error:t,onRetry:r})=>e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"max-w-md w-full p-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Authentication Issue"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"We're having trouble connecting to our authentication service."})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono",children:t})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:r,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Try Again"}),e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Return to Home"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"If this issue persists, please contact support or try refreshing the page."})})]})});function L({children:t}){const r=k(),s=j(),n={...r,user:s?.user||null,mode:"clerk"};return e.jsx(h.Provider,{value:n,children:t})}function z({children:t}){const[r,s]=o.useState("initializing"),[n,m]=o.useState(null),[x,d]=o.useState(0),a="{PROD_CLERK_PUBLISHABLE_KEY}",l=!!(a.startsWith("pk")&&a.length>20&&!a.includes("undefined")&&!a.includes("YOUR_KEY")&&!a.includes("your_key_here")),c=o.useCallback(()=>{m(null),s("initializing");const i=setTimeout(()=>{console.warn("Authentication timeout - switching to fallback mode"),s("fallback")},3e3);return l?(console.info("Valid Clerk key detected, initializing Clerk..."),console.info("Key info:",{keyStart:a?.substring(0,30)+"...",keyLength:a?.length,domain:"champion-bulldog-92.clerk.accounts.dev"}),clearTimeout(i),s("clerk")):(clearTimeout(i),console.warn("Invalid Clerk key - using fallback mode"),console.info("Clerk key status:",{hasKey:!0,keyStart:a?.substring(0,20),keyLength:a?.length}),s("fallback")),()=>clearTimeout(i)},[l,x]);o.useEffect(()=>{c()},[c]);const p=()=>{d(i=>i+1),c()};if(n&&r!=="fallback")return e.jsx(A,{error:n,onRetry:p});if(r==="initializing")return e.jsx(w,{});if(r==="clerk"&&l)try{return e.jsx(y,{publishableKey:a,fallbackRedirectUrl:"/dashboard",signInFallbackRedirectUrl:"/dashboard",signUpFallbackRedirectUrl:"/dashboard",appearance:{elements:{rootBox:"w-full",card:"shadow-none"}},children:e.jsx(L,{children:t})})}catch(i){console.error("Clerk initialization error:",i),s("fallback")}return e.jsx(h.Provider,{value:f,children:e.jsx("div",{"data-auth-mode":"fallback",className:"w-full h-full",children:t})})}function C(){const t=o.useContext(h);return t||f}function T(){const t=C(),r=t.user?.publicMetadata?.role||"viewer",s=S(r);return{role:r,permissions:s,hasPermission:n=>s.includes(n),isAdmin:r==="admin",isManager:r==="manager"||r==="admin",isAuthenticated:t.isSignedIn}}function S(t){const r={admin:["*"],manager:["read","write","update","delete","manage_team"],operator:["read","write","update"],viewer:["read"]};return r[t]||r.viewer}function u(...t){return v(N(t))}const g={sm:"size-4 border-[2px]",md:"size-6 border-[3px]",lg:"size-8 border-[3px]",xl:"size-10 border-[4px]"},E={sm:"text-xs",md:"text-sm",lg:"text-base",xl:"text-lg"},b={primary:"border-primary/40 border-t-primary",muted:"border-muted border-t-muted-foreground",inverted:"border-white/30 border-t-white"};function P({size:t="md",variant:r="primary",label:s,showLabel:n=!1,className:m,...x}){const d=g[t]?t:"md",a=b[r]?r:"primary",l=s??"Loading",c=r==="inverted"?"text-white":"text-muted-foreground";return e.jsxs("div",{role:"status","aria-live":"polite",className:u("inline-flex items-center gap-3",c,m),...x,children:[e.jsxs("span",{className:"relative inline-flex",children:[e.jsx("span",{"aria-hidden":"true",className:u("inline-flex animate-spin rounded-full border-solid border-current border-t-transparent",g[d],b[a])}),e.jsx("span",{"aria-hidden":"true",className:u("absolute inset-0 rounded-full border border-border/20",g[d])})]}),(n||s)&&e.jsx("span",{className:u("font-medium",E[d]),children:l}),e.jsx("span",{className:"sr-only",children:l})]})}export{z as B,P as L,T as a,u as c,C as u};
