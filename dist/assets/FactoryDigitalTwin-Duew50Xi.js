import{a6 as e,a7 as t,j as n}from"./index-DrxFeC9W.js";import{r,g as i,R as a,a as s}from"./vendor-CPcSq91-.js";import{r as o}from"./auth-BBXZ5c8F.js";import{j as l}from"./query-AvopVzDf.js";import{_ as c}from"./charts-C9jciwVj.js";import"./utils-BeLtu-UY.js";var u,h,d={exports:{}},p={};var f=(h||(h=1,d.exports=(u||(u=1,
/**
   * @license React
   * react-reconciler-constants.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */
p.ConcurrentRoot=1,p.ContinuousEventPriority=8,p.DefaultEventPriority=32,p.DiscreteEventPriority=2,p.IdleEventPriority=268435456,p.LegacyRoot=0,p.NoEventPriority=0),p)),d.exports);
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const m="180",g={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},v={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},y=0,_=1,x=2,b=100,S=101,M=102,w=200,T=201,E=202,A=203,C=204,R=205,P=206,I=207,D=208,N=209,L=210,U=211,O=212,F=213,k=214,z=0,B=1,V=2,H=3,j=4,G=5,W=6,X=7,q="attached",Y="detached",Z=300,J=301,$=302,K=303,Q=304,ee=306,te=1e3,ne=1001,re=1002,ie=1003,ae=1004,se=1005,oe=1006,le=1007,ce=1008,ue=1008,he=1009,de=1010,pe=1011,fe=1012,me=1013,ge=1014,ve=1015,ye=1016,_e=1017,xe=1018,be=1020,Se=35902,Me=35899,we=1021,Te=1022,Ee=1023,Ae=1026,Ce=1027,Re=1028,Pe=1029,Ie=1030,De=1031,Ne=1033,Le=33776,Ue=33777,Oe=33778,Fe=33779,ke=35840,ze=35841,Be=35842,Ve=35843,He=36196,je=37492,Ge=37496,We=37808,Xe=37809,qe=37810,Ye=37811,Ze=37812,Je=37813,$e=37814,Ke=37815,Qe=37816,et=37817,tt=37818,nt=37819,rt=37820,it=37821,at=36492,st=36494,ot=36495,lt=36283,ct=36284,ut=36285,ht=36286,dt=2300,pt=2301,ft=2302,mt=2400,gt=2401,vt=2402,yt=2500,_t=2501,xt="",bt="srgb",St="srgb-linear",Mt="linear",wt="srgb",Tt=7680,Et=512,At=513,Ct=514,Rt=515,Pt=516,It=517,Dt=518,Nt=519,Lt=35044,Ut="300 es",Ot=2e3,Ft=2001;let kt=class{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const r=n[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}};const zt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Bt=1234567;const Vt=Math.PI/180,Ht=180/Math.PI;function jt(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(zt[255&e]+zt[e>>8&255]+zt[e>>16&255]+zt[e>>24&255]+"-"+zt[255&t]+zt[t>>8&255]+"-"+zt[t>>16&15|64]+zt[t>>24&255]+"-"+zt[63&n|128]+zt[n>>8&255]+"-"+zt[n>>16&255]+zt[n>>24&255]+zt[255&r]+zt[r>>8&255]+zt[r>>16&255]+zt[r>>24&255]).toLowerCase()}function Gt(e,t,n){return Math.max(t,Math.min(n,e))}function Wt(e,t){return(e%t+t)%t}function Xt(e,t,n){return(1-n)*e+n*t}function qt(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Yt(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const Zt={DEG2RAD:Vt,RAD2DEG:Ht,generateUUID:jt,clamp:Gt,euclideanModulo:Wt,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Xt,damp:function(e,t,n,r){return Xt(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(Wt(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Bt=e);let t=Bt+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Vt},radToDeg:function(e){return e*Ht},isPowerOfTwo:function(e){return!(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const a=Math.cos,s=Math.sin,o=a(n/2),l=s(n/2),c=a((t+r)/2),u=s((t+r)/2),h=a((t-r)/2),d=s((t-r)/2),p=a((r-t)/2),f=s((r-t)/2);switch(i){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c)}},normalize:Yt,denormalize:qt};class Jt{constructor(e=0,t=0){Jt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Gt(this.x,e.x,t.x),this.y=Gt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Gt(this.x,e,t),this.y=Gt(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Gt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Gt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class $t{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,s){let o=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[a+0],d=i[a+1],p=i[a+2],f=i[a+3];if(0===s)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===s)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||o!==h||l!==d||c!==p){let e=1-s;const t=o*h+l*d+c*p+u*f,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),a=Math.atan2(i,t*n);e=Math.sin(e*a)/i,s=Math.sin(s*a)/i}const i=s*n;if(o=o*e+h*i,l=l*e+d*i,c=c*e+p*i,u=u*e+f*i,e===1-s){const e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,a){const s=n[r],o=n[r+1],l=n[r+2],c=n[r+3],u=i[a],h=i[a+1],d=i[a+2],p=i[a+3];return e[t]=s*p+c*u+o*d-l*h,e[t+1]=o*p+c*h+l*u-s*d,e[t+2]=l*p+c*d+s*h-o*u,e[t+3]=c*p-s*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=o(n/2),d=o(r/2),p=o(i/2);switch(a){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],s=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=n+s+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-o)*e,this._y=(i-l)*e,this._z=(a-r)*e}else if(n>s&&n>u){const e=2*Math.sqrt(1+n-s-u);this._w=(c-o)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+l)/e}else if(s>u){const e=2*Math.sqrt(1+s-n-u);this._w=(i-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+u-n-s);this._w=(a-r)/e,this._x=(i+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Gt(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,s=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+a*s+r*l-i*o,this._y=r*c+a*o+i*s-n*l,this._z=i*c+a*l+n*o-r*s,this._w=a*c-n*s-r*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let s=a*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const o=1-s*s;if(o<=Number.EPSILON){const e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,s),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=a*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Kt{constructor(e=0,t=0,n=0){Kt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(en.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(en.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,s=e.z,o=e.w,l=2*(a*r-s*n),c=2*(s*t-i*r),u=2*(i*n-a*t);return this.x=t+o*l+a*u-s*c,this.y=n+o*c+s*l-i*u,this.z=r+o*u+i*c-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Gt(this.x,e.x,t.x),this.y=Gt(this.y,e.y,t.y),this.z=Gt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Gt(this.x,e,t),this.y=Gt(this.y,e,t),this.z=Gt(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Gt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,s=t.y,o=t.z;return this.x=r*o-i*s,this.y=i*a-n*o,this.z=n*s-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Qt.copy(this).projectOnVector(e),this.sub(Qt)}reflect(e){return this.sub(Qt.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Gt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Qt=new Kt,en=new $t;class tn{constructor(e,t,n,r,i,a,s,o,l){tn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,s,o,l)}set(e,t,n,r,i,a,s,o,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=o,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],x=r[2],b=r[5],S=r[8];return i[0]=a*f+s*v+o*x,i[3]=a*m+s*y+o*b,i[6]=a*g+s*_+o*S,i[1]=l*f+c*v+u*x,i[4]=l*m+c*y+u*b,i[7]=l*g+c*_+u*S,i[2]=h*f+d*v+p*x,i[5]=h*m+d*y+p*b,i[8]=h*g+d*_+p*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8];return t*a*c-t*s*l-n*i*c+n*s*o+r*i*l-r*a*o}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=c*a-s*l,h=s*o-c*i,d=l*i-a*o,p=t*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(r*l-c*n)*f,e[2]=(s*n-r*a)*f,e[3]=h*f,e[4]=(c*t-r*o)*f,e[5]=(r*i-s*t)*f,e[6]=d*f,e[7]=(n*o-l*t)*f,e[8]=(a*t-n*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,s){const o=Math.cos(i),l=Math.sin(i);return this.set(n*o,n*l,-n*(o*a+l*s)+a+e,-r*l,r*o,-r*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(nn.makeScale(e,t)),this}rotate(e){return this.premultiply(nn.makeRotation(-e)),this}translate(e,t){return this.premultiply(nn.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const nn=new tn;function rn(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const an={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function sn(e,t){return new an[e](t)}function on(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function ln(){const e=on("canvas");return e.style.display="block",e}const cn={};function un(e){e in cn||(cn[e]=!0)}const hn=(new tn).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),dn=(new tn).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function pn(){const e={enabled:!0,workingColorSpace:St,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===wt&&(e.r=mn(e.r),e.g=mn(e.g),e.b=mn(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===wt&&(e.r=gn(e.r),e.g=gn(e.g),e.b=gn(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===xt?Mt:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return un("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return un("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[St]:{primaries:t,whitePoint:r,transfer:Mt,toXYZ:hn,fromXYZ:dn,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:bt},outputColorSpaceConfig:{drawingBufferColorSpace:bt}},[bt]:{primaries:t,whitePoint:r,transfer:wt,toXYZ:hn,fromXYZ:dn,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:bt}}}),e}const fn=pn();function mn(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function gn(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let vn;class yn{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{void 0===vn&&(vn=on("canvas")),vn.width=e.width,vn.height=e.height;const t=vn.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),n=vn}return n.toDataURL(t)}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=on("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*mn(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*mn(t[e]/255)):t[e]=mn(t[e]);return{data:t,width:e.width,height:e.height}}return e}}let _n=0;class xn{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_n++}),this.uuid=jt(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(bn(r[t].image)):e.push(bn(r[t]))}else e=bn(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function bn(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?yn.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:{}}let Sn=0;const Mn=new Kt;class wn extends kt{constructor(e=wn.DEFAULT_IMAGE,t=wn.DEFAULT_MAPPING,n=1001,r=1001,i=1006,a=1008,s=1023,o=1009,l=wn.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Sn++}),this.uuid=jt(),this.name="",this.source=new xn(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Mn).x}get height(){return this.source.getSize(Mn).y}get depth(){return this.source.getSize(Mn).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n)continue;const r=this[t];void 0!==r&&(r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n)}}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Z)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case te:e.x=e.x-Math.floor(e.x);break;case ne:e.x=e.x<0?0:1;break;case re:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case te:e.y=e.y-Math.floor(e.y);break;case ne:e.y=e.y<0?0:1;break;case re:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}wn.DEFAULT_IMAGE=null,wn.DEFAULT_MAPPING=Z,wn.DEFAULT_ANISOTROPY=1;class Tn{constructor(e=0,t=0,n=0,r=1){Tn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const a=.01,s=.1,o=e.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<a&&Math.abs(u-f)<a&&Math.abs(p-m)<a){if(Math.abs(c+h)<s&&Math.abs(u+f)<s&&Math.abs(p+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+f)/4,x=(p+m)/4;return e>o&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=_/n):o>v?o<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=y/r,i=x/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=_/i,r=x/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(u-f)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Gt(this.x,e.x,t.x),this.y=Gt(this.y,e.y,t.y),this.z=Gt(this.z,e.z,t.z),this.w=Gt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Gt(this.x,e,t),this.y=Gt(this.y,e,t),this.z=Gt(this.z,e,t),this.w=Gt(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Gt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class En extends kt{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:oe,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Tn(0,0,e,t),this.scissorTest=!1,this.viewport=new Tn(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new wn(r);this.textures=[];const a=n.count;for(let s=0;s<a;s++)this.textures[s]=i.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:oe,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(t)}}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new xn(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class An extends En{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Cn extends wn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ie,this.minFilter=ie,this.wrapR=ne,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Rn extends wn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=ie,this.minFilter=ie,this.wrapR=ne,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Pn{constructor(e=new Kt(1/0,1/0,1/0),t=new Kt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Dn.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Dn.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Dn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Dn):Dn.fromBufferAttribute(r,t),Dn.applyMatrix4(e.matrixWorld),this.expandByPoint(Dn);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Nn.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Nn.copy(n.boundingBox)),Nn.applyMatrix4(e.matrixWorld),this.union(Nn)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Dn),Dn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Bn),Vn.subVectors(this.max,Bn),Ln.subVectors(e.a,Bn),Un.subVectors(e.b,Bn),On.subVectors(e.c,Bn),Fn.subVectors(Un,Ln),kn.subVectors(On,Un),zn.subVectors(Ln,On);let t=[0,-Fn.z,Fn.y,0,-kn.z,kn.y,0,-zn.z,zn.y,Fn.z,0,-Fn.x,kn.z,0,-kn.x,zn.z,0,-zn.x,-Fn.y,Fn.x,0,-kn.y,kn.x,0,-zn.y,zn.x,0];return!!Gn(t,Ln,Un,On,Vn)&&(t=[1,0,0,0,1,0,0,0,1],!!Gn(t,Ln,Un,On,Vn)&&(Hn.crossVectors(Fn,kn),t=[Hn.x,Hn.y,Hn.z],Gn(t,Ln,Un,On,Vn)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Dn).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Dn).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(In[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),In[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),In[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),In[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),In[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),In[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),In[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),In[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(In)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const In=[new Kt,new Kt,new Kt,new Kt,new Kt,new Kt,new Kt,new Kt],Dn=new Kt,Nn=new Pn,Ln=new Kt,Un=new Kt,On=new Kt,Fn=new Kt,kn=new Kt,zn=new Kt,Bn=new Kt,Vn=new Kt,Hn=new Kt,jn=new Kt;function Gn(e,t,n,r,i){for(let a=0,s=e.length-3;a<=s;a+=3){jn.fromArray(e,a);const s=i.x*Math.abs(jn.x)+i.y*Math.abs(jn.y)+i.z*Math.abs(jn.z),o=t.dot(jn),l=n.dot(jn),c=r.dot(jn);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>s)return!1}return!0}const Wn=new Pn,Xn=new Kt,qn=new Kt;class Yn{constructor(e=new Kt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Wn.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Xn.subVectors(e,this.center);const t=Xn.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Xn,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(qn.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Xn.copy(e.center).add(qn)),this.expandByPoint(Xn.copy(e.center).sub(qn))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Zn=new Kt,Jn=new Kt,$n=new Kt,Kn=new Kt,Qn=new Kt,er=new Kt,tr=new Kt;class nr{constructor(e=new Kt,t=new Kt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Zn)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Zn.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Zn.copy(this.origin).addScaledVector(this.direction,t),Zn.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Jn.copy(e).add(t).multiplyScalar(.5),$n.copy(t).sub(e).normalize(),Kn.copy(this.origin).sub(Jn);const i=.5*e.distanceTo(t),a=-this.direction.dot($n),s=Kn.dot(this.direction),o=-Kn.dot($n),l=Kn.lengthSq(),c=Math.abs(1-a*a);let u,h,d,p;if(c>0)if(u=a*o-s,h=a*s-o,p=i*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+a*h+2*s)+h*(a*u+h+2*o)+l}else h=i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;else h=-i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;else h<=-p?(u=Math.max(0,-(-a*i+s)),h=u>0?-i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-o),i),d=h*(h+2*o)+l):(u=Math.max(0,-(a*i+s)),h=u>0?i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l);else h=a>0?-i:i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(Jn).addScaledVector($n,h),d}intersectSphere(e,t){Zn.subVectors(e.center,this.origin);const n=Zn.dot(this.direction),r=Zn.dot(Zn)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),s=n-a,o=n+a;return o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,s,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,a=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,a=(e.min.y-h.y)*c),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),u>=0?(s=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(s=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),n>o||s>r?null:((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,Zn)}intersectTriangle(e,t,n,r,i){Qn.subVectors(t,e),er.subVectors(n,e),tr.crossVectors(Qn,er);let a,s=this.direction.dot(tr);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}Kn.subVectors(this.origin,e);const o=a*this.direction.dot(er.crossVectors(Kn,er));if(o<0)return null;const l=a*this.direction.dot(Qn.cross(Kn));if(l<0)return null;if(o+l>s)return null;const c=-a*Kn.dot(tr);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class rr{constructor(e,t,n,r,i,a,s,o,l,c,u,h,d,p,f,m){rr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,s,o,l,c,u,h,d,p,f,m)}set(e,t,n,r,i,a,s,o,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new rr).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/ir.setFromMatrixColumn(e,0).length(),i=1/ir.setFromMatrixColumn(e,1).length(),a=1/ir.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),s=Math.sin(n),o=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=a*c,n=a*u,r=s*c,i=s*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-s*o,t[2]=i-e*l,t[6]=r+n*l,t[10]=a*o}else if("YXZ"===e.order){const e=o*c,n=o*u,r=l*c,i=l*u;t[0]=e+i*s,t[4]=r*s-n,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=a*o}else if("ZXY"===e.order){const e=o*c,n=o*u,r=l*c,i=l*u;t[0]=e-i*s,t[4]=-a*u,t[8]=r+n*s,t[1]=n+r*s,t[5]=a*c,t[9]=i-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){const e=a*c,n=a*u,r=s*c,i=s*u;t[0]=o*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=o*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=a*c,t[9]=-s*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=a*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=s*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(sr,e,or)}lookAt(e,t,n){const r=this.elements;return ur.subVectors(e,t),0===ur.lengthSq()&&(ur.z=1),ur.normalize(),lr.crossVectors(n,ur),0===lr.lengthSq()&&(1===Math.abs(n.z)?ur.x+=1e-4:ur.z+=1e-4,ur.normalize(),lr.crossVectors(n,ur)),lr.normalize(),cr.crossVectors(ur,lr),r[0]=lr.x,r[4]=cr.x,r[8]=ur.x,r[1]=lr.y,r[5]=cr.y,r[9]=ur.y,r[2]=lr.z,r[6]=cr.z,r[10]=ur.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],x=n[15],b=r[0],S=r[4],M=r[8],w=r[12],T=r[1],E=r[5],A=r[9],C=r[13],R=r[2],P=r[6],I=r[10],D=r[14],N=r[3],L=r[7],U=r[11],O=r[15];return i[0]=a*b+s*T+o*R+l*N,i[4]=a*S+s*E+o*P+l*L,i[8]=a*M+s*A+o*I+l*U,i[12]=a*w+s*C+o*D+l*O,i[1]=c*b+u*T+h*R+d*N,i[5]=c*S+u*E+h*P+d*L,i[9]=c*M+u*A+h*I+d*U,i[13]=c*w+u*C+h*D+d*O,i[2]=p*b+f*T+m*R+g*N,i[6]=p*S+f*E+m*P+g*L,i[10]=p*M+f*A+m*I+g*U,i[14]=p*w+f*C+m*D+g*O,i[3]=v*b+y*T+_*R+x*N,i[7]=v*S+y*E+_*P+x*L,i[11]=v*M+y*A+_*I+x*U,i[15]=v*w+y*C+_*D+x*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],s=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*o*u-r*l*u-i*s*h+n*l*h+r*s*d-n*o*d)+e[7]*(+t*o*d-t*l*h+i*a*h-r*a*d+r*l*c-i*o*c)+e[11]*(+t*l*u-t*s*d-i*a*u+n*a*d+i*s*c-n*l*c)+e[15]*(-r*s*c-t*o*u+t*s*h+r*a*u-n*a*h+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*h*l+f*o*d-s*m*d-u*o*g+s*h*g,y=p*h*l-c*m*l-p*o*d+a*m*d+c*o*g-a*h*g,_=c*f*l-p*u*l+p*s*d-a*f*d-c*s*g+a*u*g,x=p*u*o-c*f*o-p*s*h+a*f*h+c*s*m-a*u*m,b=t*v+n*y+r*_+i*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/b;return e[0]=v*S,e[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*g-n*h*g)*S,e[2]=(s*m*i-f*o*i+f*r*l-n*m*l-s*r*g+n*o*g)*S,e[3]=(u*o*i-s*h*i-u*r*l+n*h*l+s*r*d-n*o*d)*S,e[4]=y*S,e[5]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*g+t*h*g)*S,e[6]=(p*o*i-a*m*i-p*r*l+t*m*l+a*r*g-t*o*g)*S,e[7]=(a*h*i-c*o*i+c*r*l-t*h*l-a*r*d+t*o*d)*S,e[8]=_*S,e[9]=(p*u*i-c*f*i-p*n*d+t*f*d+c*n*g-t*u*g)*S,e[10]=(a*f*i-p*s*i+p*n*l-t*f*l-a*n*g+t*s*g)*S,e[11]=(c*s*i-a*u*i-c*n*l+t*u*l+a*n*d-t*s*d)*S,e[12]=x*S,e[13]=(c*f*r-p*u*r+p*n*h-t*f*h-c*n*m+t*u*m)*S,e[14]=(p*s*r-a*f*r-p*n*o+t*f*o+a*n*m-t*s*m)*S,e[15]=(a*u*r-c*s*r+c*n*o-t*u*o-a*n*h+t*s*h)*S,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,s=e.y,o=e.z,l=i*a,c=i*s;return this.set(l*a+n,l*s-r*o,l*o+r*s,0,l*s+r*o,c*s+n,c*o-r*a,0,l*o-r*s,c*o+r*a,i*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,s=t._z,o=t._w,l=i+i,c=a+a,u=s+s,h=i*l,d=i*c,p=i*u,f=a*c,m=a*u,g=s*u,v=o*l,y=o*c,_=o*u,x=n.x,b=n.y,S=n.z;return r[0]=(1-(f+g))*x,r[1]=(d+_)*x,r[2]=(p-y)*x,r[3]=0,r[4]=(d-_)*b,r[5]=(1-(h+g))*b,r[6]=(m+v)*b,r[7]=0,r[8]=(p+y)*S,r[9]=(m-v)*S,r[10]=(1-(h+f))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=ir.set(r[0],r[1],r[2]).length();const a=ir.set(r[4],r[5],r[6]).length(),s=ir.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],ar.copy(this);const o=1/i,l=1/a,c=1/s;return ar.elements[0]*=o,ar.elements[1]*=o,ar.elements[2]*=o,ar.elements[4]*=l,ar.elements[5]*=l,ar.elements[6]*=l,ar.elements[8]*=c,ar.elements[9]*=c,ar.elements[10]*=c,t.setFromRotationMatrix(ar),n.x=i,n.y=a,n.z=s,this}makePerspective(e,t,n,r,i,a,s=2e3,o=!1){const l=this.elements,c=2*i/(t-e),u=2*i/(n-r),h=(t+e)/(t-e),d=(n+r)/(n-r);let p,f;if(o)p=i/(a-i),f=a*i/(a-i);else if(s===Ot)p=-(a+i)/(a-i),f=-2*a*i/(a-i);else{if(s!==Ft)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);p=-a/(a-i),f=-a*i/(a-i)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,i,a,s=2e3,o=!1){const l=this.elements,c=2/(t-e),u=2/(n-r),h=-(t+e)/(t-e),d=-(n+r)/(n-r);let p,f;if(o)p=1/(a-i),f=a/(a-i);else if(s===Ot)p=-2/(a-i),f=-(a+i)/(a-i);else{if(s!==Ft)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);p=-1/(a-i),f=-i/(a-i)}return l[0]=c,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=u,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ir=new Kt,ar=new rr,sr=new Kt(0,0,0),or=new Kt(1,1,1),lr=new Kt,cr=new Kt,ur=new Kt,hr=new rr,dr=new $t;class pr{constructor(e=0,t=0,n=0,r=pr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],s=r[8],o=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Gt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Gt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Gt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-Gt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Gt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-Gt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return hr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(hr,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return dr.setFromEuler(this),this.setFromQuaternion(dr,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}pr.DEFAULT_ORDER="XYZ";class fr{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let mr=0;const gr=new Kt,vr=new $t,yr=new rr,_r=new Kt,xr=new Kt,br=new Kt,Sr=new $t,Mr=new Kt(1,0,0),wr=new Kt(0,1,0),Tr=new Kt(0,0,1),Er={type:"added"},Ar={type:"removed"},Cr={type:"childadded",child:null},Rr={type:"childremoved",child:null};class Pr extends kt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:mr++}),this.uuid=jt(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pr.DEFAULT_UP.clone();const e=new Kt,t=new pr,n=new $t,r=new Kt(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new rr},normalMatrix:{value:new tn}}),this.matrix=new rr,this.matrixWorld=new rr,this.matrixAutoUpdate=Pr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Pr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new fr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return vr.setFromAxisAngle(e,t),this.quaternion.multiply(vr),this}rotateOnWorldAxis(e,t){return vr.setFromAxisAngle(e,t),this.quaternion.premultiply(vr),this}rotateX(e){return this.rotateOnAxis(Mr,e)}rotateY(e){return this.rotateOnAxis(wr,e)}rotateZ(e){return this.rotateOnAxis(Tr,e)}translateOnAxis(e,t){return gr.copy(e).applyQuaternion(this.quaternion),this.position.add(gr.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Mr,e)}translateY(e){return this.translateOnAxis(wr,e)}translateZ(e){return this.translateOnAxis(Tr,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(yr.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?_r.copy(e):_r.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),xr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?yr.lookAt(xr,_r,this.up):yr.lookAt(_r,xr,this.up),this.quaternion.setFromRotationMatrix(yr),r&&(yr.extractRotation(r.matrixWorld),vr.setFromRotationMatrix(yr),this.quaternion.premultiply(vr.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this||e&&e.isObject3D&&(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Er),Cr.child=e,this.dispatchEvent(Cr),Cr.child=null),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ar),Rr.child=e,this.dispatchEvent(Rr),Rr.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),yr.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),yr.multiply(e.parent.matrixWorld)),e.applyMatrix4(yr),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Er),Cr.child=e,this.dispatchEvent(Cr),Cr.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xr,e,br),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xr,Sr,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(e=>({...e,boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(e=>({...e})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=a(e.geometries),r=a(e.materials),i=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),c=a(e.animations),u=a(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function a(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Pr.DEFAULT_UP=new Kt(0,1,0),Pr.DEFAULT_MATRIX_AUTO_UPDATE=!0,Pr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ir=new Kt,Dr=new Kt,Nr=new Kt,Lr=new Kt,Ur=new Kt,Or=new Kt,Fr=new Kt,kr=new Kt,zr=new Kt,Br=new Kt,Vr=new Tn,Hr=new Tn,jr=new Tn;class Gr{constructor(e=new Kt,t=new Kt,n=new Kt){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ir.subVectors(e,t),r.cross(Ir);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Ir.subVectors(r,t),Dr.subVectors(n,t),Nr.subVectors(e,t);const a=Ir.dot(Ir),s=Ir.dot(Dr),o=Ir.dot(Nr),l=Dr.dot(Dr),c=Dr.dot(Nr),u=a*l-s*s;if(0===u)return i.set(0,0,0),null;const h=1/u,d=(l*o-s*c)*h,p=(a*c-s*o)*h;return i.set(1-d-p,p,d)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,Lr)&&(Lr.x>=0&&Lr.y>=0&&Lr.x+Lr.y<=1)}static getInterpolation(e,t,n,r,i,a,s,o){return null===this.getBarycoord(e,t,n,r,Lr)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(i,Lr.x),o.addScaledVector(a,Lr.y),o.addScaledVector(s,Lr.z),o)}static getInterpolatedAttribute(e,t,n,r,i,a){return Vr.setScalar(0),Hr.setScalar(0),jr.setScalar(0),Vr.fromBufferAttribute(e,t),Hr.fromBufferAttribute(e,n),jr.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Vr,i.x),a.addScaledVector(Hr,i.y),a.addScaledVector(jr,i.z),a}static isFrontFacing(e,t,n,r){return Ir.subVectors(n,t),Dr.subVectors(e,t),Ir.cross(Dr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ir.subVectors(this.c,this.b),Dr.subVectors(this.a,this.b),.5*Ir.cross(Dr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return Gr.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Gr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,s;Ur.subVectors(r,n),Or.subVectors(i,n),kr.subVectors(e,n);const o=Ur.dot(kr),l=Or.dot(kr);if(o<=0&&l<=0)return t.copy(n);zr.subVectors(e,r);const c=Ur.dot(zr),u=Or.dot(zr);if(c>=0&&u<=c)return t.copy(r);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return a=o/(o-c),t.copy(n).addScaledVector(Ur,a);Br.subVectors(e,i);const d=Ur.dot(Br),p=Or.dot(Br);if(p>=0&&d<=p)return t.copy(i);const f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return s=l/(l-p),t.copy(n).addScaledVector(Or,s);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return Fr.subVectors(i,r),s=(u-c)/(u-c+(d-p)),t.copy(r).addScaledVector(Fr,s);const g=1/(m+f+h);return a=f*g,s=h*g,t.copy(n).addScaledVector(Ur,a).addScaledVector(Or,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Wr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xr={h:0,s:0,l:0},qr={h:0,s:0,l:0};function Yr(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Zr{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=bt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,fn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=fn.workingColorSpace){return this.r=e,this.g=t,this.b=n,fn.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=fn.workingColorSpace){if(e=Wt(e,1),t=Gt(t,0,1),n=Gt(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Yr(i,r,e+1/3),this.g=Yr(i,r,e),this.b=Yr(i,r,e-1/3)}return fn.colorSpaceToWorking(this,r),this}setStyle(e,t=bt){function n(e){void 0!==e&&parseFloat(e)}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let e;const i=r[1],a=r[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(e[4]),this.setRGB(Math.min(255,parseInt(e[1],10))/255,Math.min(255,parseInt(e[2],10))/255,Math.min(255,parseInt(e[3],10))/255,t);if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(e[4]),this.setRGB(Math.min(100,parseInt(e[1],10))/100,Math.min(100,parseInt(e[2],10))/100,Math.min(100,parseInt(e[3],10))/100,t);break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(e[4]),this.setHSL(parseFloat(e[1])/360,parseFloat(e[2])/100,parseFloat(e[3])/100,t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=r[1],n=e.length;if(3===n)return this.setRGB(parseInt(e.charAt(0),16)/15,parseInt(e.charAt(1),16)/15,parseInt(e.charAt(2),16)/15,t);if(6===n)return this.setHex(parseInt(e,16),t)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=bt){const n=Wr[e.toLowerCase()];return void 0!==n&&this.setHex(n,t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=mn(e.r),this.g=mn(e.g),this.b=mn(e.b),this}copyLinearToSRGB(e){return this.r=gn(e.r),this.g=gn(e.g),this.b=gn(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=bt){return fn.workingToColorSpace(Jr.copy(this),e),65536*Math.round(Gt(255*Jr.r,0,255))+256*Math.round(Gt(255*Jr.g,0,255))+Math.round(Gt(255*Jr.b,0,255))}getHexString(e=bt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=fn.workingColorSpace){fn.workingToColorSpace(Jr.copy(this),t);const n=Jr.r,r=Jr.g,i=Jr.b,a=Math.max(n,r,i),s=Math.min(n,r,i);let o,l;const c=(s+a)/2;if(s===a)o=0,l=0;else{const e=a-s;switch(l=c<=.5?e/(a+s):e/(2-a-s),a){case n:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-n)/e+2;break;case i:o=(n-r)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t=fn.workingColorSpace){return fn.workingToColorSpace(Jr.copy(this),t),e.r=Jr.r,e.g=Jr.g,e.b=Jr.b,e}getStyle(e=bt){fn.workingToColorSpace(Jr.copy(this),e);const t=Jr.r,n=Jr.g,r=Jr.b;return e!==bt?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(Xr),this.setHSL(Xr.h+e,Xr.s+t,Xr.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Xr),e.getHSL(qr);const n=Xt(Xr.h,qr.h,t),r=Xt(Xr.s,qr.s,t),i=Xt(Xr.l,qr.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Jr=new Zr;Zr.NAMES=Wr;let $r=0;class Kr extends kt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:$r++}),this.uuid=jt(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=C,this.blendDst=R,this.blendEquation=b,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Zr(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Tt,this.stencilZFail=Tt,this.stencilZPass=Tt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n)continue;const r=this[t];void 0!==r&&(r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==C&&(n.blendSrc=this.blendSrc),this.blendDst!==R&&(n.blendDst=this.blendDst),this.blendEquation!==b&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Tt&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Tt&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Tt&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Qr extends Kr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new pr,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const ei=ti();function ti(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const a=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;!(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,a[l]=e|t}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)s[l]=l<<23;s[31]=1199570944,s[32]=2147483648;for(let l=33;l<63;++l)s[l]=2147483648+(l-32<<23);s[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:a,exponentTable:s,offsetTable:o}}function ni(e){Math.abs(e),e=Gt(e,-65504,65504),ei.floatView[0]=e;const t=ei.uint32View[0],n=t>>23&511;return ei.baseTable[n]+((8388607&t)>>ei.shiftTable[n])}function ri(e){const t=e>>10;return ei.uint32View[0]=ei.mantissaTable[ei.offsetTable[t]+(1023&e)]+ei.exponentTable[t],ei.floatView[0]}class ii{static toHalfFloat(e){return ni(e)}static fromHalfFloat(e){return ri(e)}}const ai=new Kt,si=new Jt;let oi=0;class li{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:oi++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Lt,this.updateRanges=[],this.gpuType=ve,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix3(e),this.setXY(t,si.x,si.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)ai.fromBufferAttribute(this,t),ai.applyMatrix3(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ai.fromBufferAttribute(this,t),ai.applyMatrix4(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ai.fromBufferAttribute(this,t),ai.applyNormalMatrix(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ai.fromBufferAttribute(this,t),ai.transformDirection(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=qt(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Yt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=qt(t,this.array)),t}setX(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=qt(t,this.array)),t}setY(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=qt(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=qt(t,this.array)),t}setW(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array),r=Yt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array),r=Yt(r,this.array),i=Yt(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Lt&&(e.usage=this.usage),e}}class ci extends li{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class ui extends li{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class hi extends li{constructor(e,t,n){super(new Float32Array(e),t,n)}}let di=0;const pi=new rr,fi=new Pr,mi=new Kt,gi=new Pn,vi=new Pn,yi=new Kt;class _i extends kt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:di++}),this.uuid=jt(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(rn(e)?ui:ci)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new tn).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return pi.makeRotationFromQuaternion(e),this.applyMatrix4(pi),this}rotateX(e){return pi.makeRotationX(e),this.applyMatrix4(pi),this}rotateY(e){return pi.makeRotationY(e),this.applyMatrix4(pi),this}rotateZ(e){return pi.makeRotationZ(e),this.applyMatrix4(pi),this}translate(e,t,n){return pi.makeTranslation(e,t,n),this.applyMatrix4(pi),this}scale(e,t,n){return pi.makeScale(e,t,n),this.applyMatrix4(pi),this}lookAt(e){return fi.lookAt(e),fi.updateMatrix(),this.applyMatrix4(fi.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(mi).negate(),this.translate(mi.x,mi.y,mi.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new hi(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length,t.count,t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Pn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)this.boundingBox.set(new Kt(-1/0,-1/0,-1/0),new Kt(1/0,1/0,1/0));else{if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];gi.setFromBufferAttribute(n),this.morphTargetsRelative?(yi.addVectors(this.boundingBox.min,gi.min),this.boundingBox.expandByPoint(yi),yi.addVectors(this.boundingBox.max,gi.max),this.boundingBox.expandByPoint(yi)):(this.boundingBox.expandByPoint(gi.min),this.boundingBox.expandByPoint(gi.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Yn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)this.boundingSphere.set(new Kt,1/0);else if(e){const n=this.boundingSphere.center;if(gi.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];vi.setFromBufferAttribute(n),this.morphTargetsRelative?(yi.addVectors(gi.min,vi.min),gi.expandByPoint(yi),yi.addVectors(gi.max,vi.max),gi.expandByPoint(yi)):(gi.expandByPoint(vi.min),gi.expandByPoint(vi.max))}gi.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)yi.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(yi));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],s=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)yi.fromBufferAttribute(a,t),s&&(mi.fromBufferAttribute(e,t),yi.add(mi)),r=Math.max(r,n.distanceToSquared(yi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return;const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new li(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),s=[],o=[];for(let M=0;M<n.count;M++)s[M]=new Kt,o[M]=new Kt;const l=new Kt,c=new Kt,u=new Kt,h=new Jt,d=new Jt,p=new Jt,f=new Kt,m=new Kt;function g(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,r),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),p.fromBufferAttribute(i,r),c.sub(l),u.sub(l),d.sub(h),p.sub(h);const a=1/(d.x*p.y-p.x*d.y);isFinite(a)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(u,-d.y).multiplyScalar(a),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(a),s[e].add(f),s[t].add(f),s[r].add(f),o[e].add(m),o[t].add(m),o[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let M=0,w=v.length;M<w;++M){const t=v[M],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)g(e.getX(r+0),e.getX(r+1),e.getX(r+2))}const y=new Kt,_=new Kt,x=new Kt,b=new Kt;function S(e){x.fromBufferAttribute(r,e),b.copy(x);const t=s[e];y.copy(t),y.sub(x.multiplyScalar(x.dot(t))).normalize(),_.crossVectors(b,t);const n=_.dot(o[e])<0?-1:1;a.setXYZW(e,y.x,y.y,y.z,n)}for(let M=0,w=v.length;M<w;++M){const t=v[M],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)S(e.getX(r+0)),S(e.getX(r+1)),S(e.getX(r+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new li(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Kt,i=new Kt,a=new Kt,s=new Kt,o=new Kt,l=new Kt,c=new Kt,u=new Kt;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,f),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,d),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),s.add(c),o.add(c),l.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)yi.fromBufferAttribute(e,t),yi.normalize(),e.setXYZ(t,yi.x,yi.y,yi.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let s=0,o=0;for(let l=0,c=t.length;l<c;l++){s=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)a[o++]=n[s++]}return new li(a,r,i)}if(null===this.index)return this;const t=new _i,n=this.index.array,r=this.attributes;for(const s in r){const i=e(r[s],n);t.setAttribute(s,i)}const i=this.morphAttributes;for(const s in i){const r=[],a=i[s];for(let t=0,i=a.length;t<i;t++){const i=e(a[t],n);r.push(i)}t.morphAttributes[s]=r}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let s=0,o=a.length;s<o;s++){const e=a[s];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const r={};let i=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[o]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere=s.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,c=a.length;l<c;l++){const e=a[l];this.addGroup(e.start,e.count,e.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const xi=new rr,bi=new nr,Si=new Yn,Mi=new Kt,wi=new Kt,Ti=new Kt,Ei=new Kt,Ai=new Kt,Ci=new Kt,Ri=new Kt,Pi=new Kt;class Ii extends Pr{constructor(e=new _i,t=new Qr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(i&&s){Ci.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=s[n],o=i[n];0!==r&&(Ai.fromBufferAttribute(o,e),a?Ci.addScaledVector(Ai,r):Ci.addScaledVector(Ai.sub(t),r))}t.add(Ci)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Si.copy(n.boundingSphere),Si.applyMatrix4(i),bi.copy(e.ray).recast(e.near),!1===Si.containsPoint(bi.origin)){if(null===bi.intersectSphere(Si,Mi))return;if(bi.origin.distanceToSquared(Mi)>(e.far-e.near)**2)return}xi.copy(i).invert(),bi.copy(e.ray).applyMatrix4(xi),null!==n.boundingBox&&!1===bi.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,bi)}}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,s=i.index,o=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==s)if(Array.isArray(a))for(let p=0,f=h.length;p<f;p++){const i=h[p],o=a[i.materialIndex];for(let a=Math.max(i.start,d.start),h=Math.min(s.count,Math.min(i.start+i.count,d.start+d.count));a<h;a+=3){r=Di(this,o,e,n,l,c,u,s.getX(a),s.getX(a+1),s.getX(a+2)),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),o=Math.min(s.count,d.start+d.count);i<o;i+=3){r=Di(this,a,e,n,l,c,u,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==o)if(Array.isArray(a))for(let p=0,f=h.length;p<f;p++){const i=h[p],s=a[i.materialIndex];for(let a=Math.max(i.start,d.start),h=Math.min(o.count,Math.min(i.start+i.count,d.start+d.count));a<h;a+=3){r=Di(this,s,e,n,l,c,u,a,a+1,a+2),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),s=Math.min(o.count,d.start+d.count);i<s;i+=3){r=Di(this,a,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function Di(e,t,n,r,i,a,s,o,l,c){e.getVertexPosition(o,wi),e.getVertexPosition(l,Ti),e.getVertexPosition(c,Ei);const u=function(e,t,n,r,i,a,s,o){let l;if(l=1===t.side?r.intersectTriangle(s,a,i,!0,o):r.intersectTriangle(i,a,s,0===t.side,o),null===l)return null;Pi.copy(o),Pi.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(Pi);return c<n.near||c>n.far?null:{distance:c,point:Pi.clone(),object:e}}(e,t,n,r,wi,Ti,Ei,Ri);if(u){const e=new Kt;Gr.getBarycoord(Ri,wi,Ti,Ei,e),i&&(u.uv=Gr.getInterpolatedAttribute(i,o,l,c,e,new Jt)),a&&(u.uv1=Gr.getInterpolatedAttribute(a,o,l,c,e,new Jt)),s&&(u.normal=Gr.getInterpolatedAttribute(s,o,l,c,e,new Kt),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const t={a:o,b:l,c:c,normal:new Kt,materialIndex:0};Gr.getNormal(wi,Ti,Ei,t.normal),u.face=t,u.barycoord=e}return u}class Ni extends _i{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const s=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const o=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,r,i,a,p,f,m,g,v){const y=a/m,_=p/g,x=a/2,b=p/2,S=f/2,M=m+1,w=g+1;let T=0,E=0;const A=new Kt;for(let s=0;s<w;s++){const a=s*_-b;for(let o=0;o<M;o++){const h=o*y-x;A[e]=h*r,A[t]=a*i,A[n]=S,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(o/m),u.push(1-s/g),T+=1}}for(let s=0;s<g;s++)for(let e=0;e<m;e++){const t=h+e+M*s,n=h+e+M*(s+1),r=h+(e+1)+M*(s+1),i=h+(e+1)+M*s;o.push(t,n,i),o.push(n,r,i),E+=6}s.addGroup(d,E,v),d+=E,h+=T}p("z","y","x",-1,-1,n,t,e,a,i,0),p("z","y","x",1,-1,n,t,-e,a,i,1),p("x","z","y",1,1,e,n,t,r,a,2),p("x","z","y",1,-1,e,n,-t,r,a,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(o),this.setAttribute("position",new hi(l,3)),this.setAttribute("normal",new hi(c,3)),this.setAttribute("uv",new hi(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ni(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Li(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?t[n][r]=null:t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Ui(e){const t={};for(let n=0;n<e.length;n++){const r=Li(e[n]);for(const e in r)t[e]=r[e]}return t}function Oi(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:fn.workingColorSpace}const Fi={clone:Li,merge:Ui};class ki extends Kr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Li(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class zi extends Pr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rr,this.projectionMatrix=new rr,this.projectionMatrixInverse=new rr,this.coordinateSystem=Ot,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Bi=new Kt,Vi=new Jt,Hi=new Jt;let ji=class extends zi{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Ht*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Vt*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Ht*Math.atan(Math.tan(.5*Vt*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Bi.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Bi.x,Bi.y).multiplyScalar(-e/Bi.z),Bi.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Bi.x,Bi.y).multiplyScalar(-e/Bi.z)}getViewSize(e,t){return this.getViewBounds(e,Vi,Hi),t.subVectors(Hi,Vi)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Vt*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/s,r*=a.width/e,n*=a.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Gi=-90;class Wi extends Pr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ji(Gi,1,e,t);r.layers=this.layers,this.add(r);const i=new ji(Gi,1,e,t);i.layers=this.layers,this.add(i);const a=new ji(Gi,1,e,t);a.layers=this.layers,this.add(a);const s=new ji(Gi,1,e,t);s.layers=this.layers,this.add(s);const o=new ji(Gi,1,e,t);o.layers=this.layers,this.add(o);const l=new ji(Gi,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,s,o]=t;for(const l of t)this.remove(l);if(e===Ot)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==Ft)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,s,o,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,o),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class Xi extends wn{constructor(e=[],t=301,n,r,i,a,s,o,l,c){super(e,t,n,r,i,a,s,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class qi extends An{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Xi(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new Ni(5,5,5),i=new ki({name:"CubemapFromEquirect",uniforms:Li(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=t;const a=new Ii(r,i),s=t.minFilter;t.minFilter===ce&&(t.minFilter=oe);return new Wi(1,10,this).update(e,a),t.minFilter=s,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}class Yi extends Pr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Zi={type:"move"};class Ji{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Yi,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Yi,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Kt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Kt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Yi,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Kt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Kt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(const a of e.hand.values()){const e=t.getJointPose(a,n),r=this._getHandJoint(l,a);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),o=.02,c=.005;l.inputState.pinching&&s>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Zi)))}return null!==s&&(s.visible=null!==r),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Yi;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class $i{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Zr(e),this.density=t}clone(){return new $i(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Ki{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Zr(e),this.near=t,this.far=n}clone(){return new Ki(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Qi extends Pr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new pr,this.environmentIntensity=1,this.environmentRotation=new pr,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class ea{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Lt,this.updateRanges=[],this.version=0,this.uuid=jt()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jt()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jt()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ta=new Kt;class na{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.applyMatrix4(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.applyNormalMatrix(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ta.fromBufferAttribute(this,t),ta.transformDirection(e),this.setXYZ(t,ta.x,ta.y,ta.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=qt(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Yt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Yt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Yt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Yt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Yt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=qt(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=qt(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=qt(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=qt(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array),r=Yt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array),r=Yt(r,this.array),i=Yt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new li(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new na(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class ra extends Kr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Zr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ia;const aa=new Kt,sa=new Kt,oa=new Kt,la=new Jt,ca=new Jt,ua=new rr,ha=new Kt,da=new Kt,pa=new Kt,fa=new Jt,ma=new Jt,ga=new Jt;class va extends Pr{constructor(e=new ra){if(super(),this.isSprite=!0,this.type="Sprite",void 0===ia){ia=new _i;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new ea(e,5);ia.setIndex([0,1,2,0,2,3]),ia.setAttribute("position",new na(t,3,0,!1)),ia.setAttribute("uv",new na(t,2,3,!1))}this.geometry=ia,this.material=e,this.center=new Jt(.5,.5),this.count=1}raycast(e,t){e.camera,sa.setFromMatrixScale(this.matrixWorld),ua.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),oa.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&sa.multiplyScalar(-oa.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const a=this.center;ya(ha.set(-.5,-.5,0),oa,a,sa,r,i),ya(da.set(.5,-.5,0),oa,a,sa,r,i),ya(pa.set(.5,.5,0),oa,a,sa,r,i),fa.set(0,0),ma.set(1,0),ga.set(1,1);let s=e.ray.intersectTriangle(ha,da,pa,!1,aa);if(null===s&&(ya(da.set(-.5,.5,0),oa,a,sa,r,i),ma.set(0,1),s=e.ray.intersectTriangle(ha,pa,da,!1,aa),null===s))return;const o=e.ray.origin.distanceTo(aa);o<e.near||o>e.far||t.push({distance:o,point:aa.clone(),uv:Gr.getInterpolation(aa,ha,da,pa,fa,ma,ga,new Jt),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function ya(e,t,n,r,i,a){la.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(ca.x=a*la.x-i*la.y,ca.y=i*la.x+a*la.y):ca.copy(la),e.copy(t),e.x+=ca.x,e.y+=ca.y,e.applyMatrix4(ua)}const _a=new Kt,xa=new Kt;class ba extends Pr{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let i;for(i=0;i<r.length&&!(t<r[i].distance);i++);return r.splice(i,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){_a.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(_a);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){_a.setFromMatrixPosition(e.matrixWorld),xa.setFromMatrixPosition(this.matrixWorld);const n=_a.distanceTo(xa)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),!(n>=e))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const e=n[r];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const Sa=new Kt,Ma=new Tn,wa=new Tn,Ta=new Kt,Ea=new rr,Aa=new Kt,Ca=new Yn,Ra=new rr,Pa=new nr;class Ia extends Ii{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=q,this.bindMatrix=new rr,this.bindMatrixInverse=new rr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Pn),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Aa),this.boundingBox.expandByPoint(Aa)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Yn),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Aa),this.boundingSphere.expandByPoint(Aa)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),Ca.copy(this.boundingSphere),Ca.applyMatrix4(r),!1!==e.ray.intersectsSphere(Ca)&&(Ra.copy(r).invert(),Pa.copy(e.ray).applyMatrix4(Ra),null!==this.boundingBox&&!1===Pa.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,Pa)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Tn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===q?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Y&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;Ma.fromBufferAttribute(r.attributes.skinIndex,e),wa.fromBufferAttribute(r.attributes.skinWeight,e),Sa.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const e=wa.getComponent(i);if(0!==e){const r=Ma.getComponent(i);Ea.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(Ta.copy(Sa).applyMatrix4(Ea),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Da extends Pr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Na extends wn{constructor(e=null,t=1,n=1,r,i,a,s,o,l=1003,c=1003,u,h){super(null,a,s,o,l,c,r,i,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const La=new rr,Ua=new rr;class Oa{constructor(e=[],t=[]){this.uuid=jt(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new rr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new rr;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const r=e[i]?e[i].matrixWorld:Ua;La.multiplyMatrices(r,t[i]),La.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new Oa(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Na(t,e,e,Ee,ve);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let r=t[e.bones[n]];void 0===r&&(r=new Da),this.bones.push(r),this.boneInverses.push((new rr).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class Fa extends li{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ka=new rr,za=new rr,Ba=[],Va=new Pn,Ha=new rr,ja=new Ii,Ga=new Yn;class Wa extends Ii{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Fa(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Ha)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Pn),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ka),Va.copy(e.boundingBox).applyMatrix4(ka),this.boundingBox.union(Va)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Yn),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ka),Ga.copy(e.boundingSphere).applyMatrix4(ka),this.boundingSphere.union(Ga)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,i=e*(n.length+1)+1;for(let a=0;a<n.length;a++)n[a]=r[i+a]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(ja.geometry=this.geometry,ja.material=this.material,void 0!==ja.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Ga.copy(this.boundingSphere),Ga.applyMatrix4(n),!1!==e.ray.intersectsSphere(Ga)))for(let i=0;i<r;i++){this.getMatrixAt(i,ka),za.multiplyMatrices(n,ka),ja.matrixWorld=za,ja.raycast(e,Ba);for(let e=0,n=Ba.length;e<n;e++){const n=Ba[e];n.instanceId=i,n.object=this,t.push(n)}Ba.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Fa(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new Na(new Float32Array(r*this.count),r,this.count,Re,ve));const i=this.morphTexture.source.data.data;let a=0;for(let l=0;l<n.length;l++)a+=n[l];const s=this.geometry.morphTargetsRelative?1:1-a,o=r*e;i[o]=s,i.set(n,o+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Xa=new Kt,qa=new Kt,Ya=new tn;class Za{constructor(e=new Kt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Xa.subVectors(n,t).cross(qa.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Xa),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ya.getNormalMatrix(e),r=this.coplanarPoint(Xa).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ja=new Yn,$a=new Jt(.5,.5),Ka=new Kt;class Qa{constructor(e=new Za,t=new Za,n=new Za,r=new Za,i=new Za,a=new Za){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=2e3,n=!1){const r=this.planes,i=e.elements,a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],p=i[8],f=i[9],m=i[10],g=i[11],v=i[12],y=i[13],_=i[14],x=i[15];if(r[0].setComponents(l-a,d-c,g-p,x-v).normalize(),r[1].setComponents(l+a,d+c,g+p,x+v).normalize(),r[2].setComponents(l+s,d+u,g+f,x+y).normalize(),r[3].setComponents(l-s,d-u,g-f,x-y).normalize(),n)r[4].setComponents(o,h,m,_).normalize(),r[5].setComponents(l-o,d-h,g-m,x-_).normalize();else if(r[4].setComponents(l-o,d-h,g-m,x-_).normalize(),t===Ot)r[5].setComponents(l+o,d+h,g+m,x+_).normalize();else{if(t!==Ft)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(o,h,m,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Ja.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Ja.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ja)}intersectsSprite(e){Ja.center.set(0,0,0);const t=$a.distanceTo(e.center);return Ja.radius=.7071067811865476+t,Ja.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ja)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Ka.x=r.normal.x>0?e.max.x:e.min.x,Ka.y=r.normal.y>0?e.max.y:e.min.y,Ka.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Ka)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const es=new rr,ts=new Qa;class ns{constructor(){this.coordinateSystem=Ot}intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(es.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ts.setFromProjectionMatrix(es,r.coordinateSystem,r.reversedDepth),ts.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(es.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ts.setFromProjectionMatrix(es,r.coordinateSystem,r.reversedDepth),ts.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(es.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ts.setFromProjectionMatrix(es,r.coordinateSystem,r.reversedDepth),ts.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(es.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ts.setFromProjectionMatrix(es,r.coordinateSystem,r.reversedDepth),ts.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(es.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ts.setFromProjectionMatrix(es,r.coordinateSystem,r.reversedDepth),ts.containsPoint(e))return!0}return!1}clone(){return new ns}}function rs(e,t){return e-t}function is(e,t){return e.z-t.z}function as(e,t){return t.z-e.z}class ss{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const i=this.pool,a=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const s=i[this.index];a.push(s),this.index++,s.start=e,s.count=t,s.z=n,s.index=r}reset(){this.list.length=0,this.index=0}}const os=new rr,ls=new Zr(1,1,1),cs=new Qa,us=new ns,hs=new Pn,ds=new Yn,ps=new Kt,fs=new Kt,ms=new Kt,gs=new ss,vs=new Ii,ys=[];function _s(e,t,n=0){const r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const i=e.count;for(let a=0;a<i;a++)for(let i=0;i<r;i++)t.setComponent(a+n,i,e.getComponent(a,i))}else t.array.set(e.array,n*r);t.needsUpdate=!0}function xs(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)t[r]=e[r]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class bs extends Ii{constructor(e,t,n=2*t,r){super(new _i,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Na(t,e,e,Ee,ve);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Na(t,e,e,Pe,ge);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Na(t,e,e,Ee,ve);n.colorSpace=fn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(!1===this._geometryInitialized){for(const r in e.attributes){const i=e.getAttribute(r),{array:a,itemSize:s,normalized:o}=i,l=new a.constructor(n*s),c=new li(l,s,o);t.setAttribute(r,c)}if(null!==e.getIndex()){const e=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new li(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),i=t.getAttribute(n);if(r.itemSize!==i.itemSize||r.normalized!==i.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Pn);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,os),this.getBoundingBoxAt(r,hs).applyMatrix4(os),e.union(hs)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Yn);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,os),this.getBoundingSphereAt(r,ds).applyMatrix4(os),e.union(ds)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const t={visible:!0,active:!0,geometryIndex:e};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(rs),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));const r=this._matricesTexture;os.identity().toArray(r.image.data,16*n),r.needsUpdate=!0;const i=this._colorsTexture;return i&&(ls.toArray(i.image.data,4*n),i.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},i=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=-1===t?e.getAttribute("position").count:t;const a=e.getIndex();if(null!==a&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=-1===n?a.count:n),-1!==r.indexStart&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let s;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(rs),s=this._availableGeometryIds.shift(),i[s]=r):(s=this._geometryCount,this._geometryCount++,i.push(r)),this.setGeometryAt(s,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,s}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=null!==n.getIndex(),i=n.getIndex(),a=t.getIndex(),s=this._geometryInfo[e];if(r&&a.count>s.reservedIndexCount||t.attributes.position.count>s.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const o=s.vertexStart,l=s.reservedVertexCount;s.vertexCount=t.getAttribute("position").count;for(const c in n.attributes){const e=t.getAttribute(c),r=n.getAttribute(c);_s(e,r,o);const i=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=o+t;for(let t=0;t<i;t++)r.setComponent(e,t,0)}r.needsUpdate=!0,r.addUpdateRange(o*i,l*i)}if(r){const e=s.indexStart,n=s.reservedIndexCount;s.indexCount=t.getIndex().count;for(let t=0;t<a.count;t++)i.setX(e+t,o+a.getX(t));for(let t=a.count,r=n;t<r;t++)i.setX(e+t,o);i.needsUpdate=!0,i.addUpdateRange(e,s.reservedIndexCount)}return s.start=r?s.indexStart:s.vertexStart,s.count=r?s.indexCount:s.vertexCount,s.boundingBox=null,null!==t.boundingBox&&(s.boundingBox=t.boundingBox.clone()),s.boundingSphere=null,null!==t.boundingSphere&&(s.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;const n=this._instanceInfo;for(let r=0,i=n.length;r<i;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((e,t)=>t).sort((e,t)=>n[e].vertexStart-n[t].vertexStart),i=this.geometry;for(let a=0,s=n.length;a<s;a++){const s=r[a],o=n[s];if(!1!==o.active){if(null!==i.index){if(o.indexStart!==t){const{indexStart:n,vertexStart:r,reservedIndexCount:a}=o,s=i.index,l=s.array,c=e-r;for(let e=n;e<n+a;e++)l[e]=l[e]+c;s.array.copyWithin(t,n,n+a),s.addUpdateRange(t,a),o.indexStart=t}t+=o.reservedIndexCount}if(o.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=o,r=i.attributes;for(const i in r){const a=r[i],{array:s,itemSize:o}=a;s.copyWithin(e*o,t*o,(t+n)*o),a.addUpdateRange(e*o,n*o)}o.vertexStart=e}e+=o.reservedVertexCount,o.start=i.index?o.indexStart:o.vertexStart,this._nextIndexStart=i.index?o.indexStart+o.reservedIndexCount:0,this._nextVertexStart=o.vertexStart+o.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingBox){const e=new Pn,t=n.index,i=n.attributes.position;for(let n=r.start,a=r.start+r.count;n<a;n++){let r=n;t&&(r=t.getX(r)),e.expandByPoint(ps.fromBufferAttribute(i,r))}r.boundingBox=e}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingSphere){const t=new Yn;this.getBoundingBoxAt(e,hs),hs.getCenter(t.center);const i=n.index,a=n.attributes.position;let s=0;for(let e=r.start,n=r.start+r.count;e<n;e++){let n=e;i&&(n=i.getX(n)),ps.fromBufferAttribute(a,n),s=Math.max(s,t.center.distanceToSquared(ps))}t.radius=Math.sqrt(s),r.boundingSphere=t}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,16*e),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(rs);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),i=new Int32Array(e);xs(this._multiDrawCounts,r),xs(this._multiDrawStarts,i),this._multiDrawCounts=r,this._multiDrawStarts=i,this._maxInstanceCount=e;const a=this._indirectTexture,s=this._matricesTexture,o=this._colorsTexture;a.dispose(),this._initIndirectTexture(),xs(a.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),xs(s.image.data,this._matricesTexture.image.data),o&&(o.dispose(),this._initColorsTexture(),xs(o.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(e=>e.active);if(Math.max(...n.map(e=>e.vertexStart+e.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index){if(Math.max(...n.map(e=>e.indexStart+e.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`)}const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new _i,this._initializeGeometry(r));const i=this.geometry;r.index&&xs(r.index.array,i.index.array);for(const a in r.attributes)xs(r.attributes[a].array,i.attributes[a].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,i=this.matrixWorld,a=this.geometry;vs.material=this.material,vs.geometry.index=a.index,vs.geometry.attributes=a.attributes,null===vs.geometry.boundingBox&&(vs.geometry.boundingBox=new Pn),null===vs.geometry.boundingSphere&&(vs.geometry.boundingSphere=new Yn);for(let s=0,o=n.length;s<o;s++){if(!n[s].visible||!n[s].active)continue;const a=n[s].geometryIndex,o=r[a];vs.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(s,vs.matrixWorld).premultiply(i),this.getBoundingBoxAt(a,vs.geometry.boundingBox),this.getBoundingSphereAt(a,vs.geometry.boundingSphere),vs.raycast(e,ys);for(let e=0,n=ys.length;e<n;e++){const n=ys[e];n.object=this,n.batchId=s,t.push(n)}ys.length=0}vs.material=null,vs.geometry.index=null,vs.geometry.attributes={},vs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(e=>({...e,boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(e=>({...e})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),s=null===a?1:a.array.BYTES_PER_ELEMENT,o=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,u=this._geometryInfo,h=this.perObjectFrustumCulled,d=this._indirectTexture,p=d.image.data,f=n.isArrayCamera?us:cs;h&&!n.isArrayCamera&&(os.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),cs.setFromProjectionMatrix(os,n.coordinateSystem,n.reversedDepth));let m=0;if(this.sortObjects){os.copy(this.matrixWorld).invert(),ps.setFromMatrixPosition(n.matrixWorld).applyMatrix4(os),fs.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(os);for(let r=0,i=o.length;r<i;r++)if(o[r].visible&&o[r].active){const e=o[r].geometryIndex;this.getMatrixAt(r,os),this.getBoundingSphereAt(e,ds).applyMatrix4(os);let t=!1;if(h&&(t=!f.intersectsSphere(ds,n)),!t){const t=u[e],n=ms.subVectors(ds.center,ps).dot(fs);gs.push(t.start,t.count,n,r)}}const e=gs.list,t=this.customSort;null===t?e.sort(i.transparent?as:is):t.call(this,e,n);for(let n=0,r=e.length;n<r;n++){const t=e[n];l[m]=t.start*s,c[m]=t.count,p[m]=t.index,m++}gs.reset()}else for(let g=0,v=o.length;g<v;g++)if(o[g].visible&&o[g].active){const e=o[g].geometryIndex;let t=!1;if(h&&(this.getMatrixAt(g,os),this.getBoundingSphereAt(e,ds).applyMatrix4(os),t=!f.intersectsSphere(ds,n)),!t){const t=u[e];l[m]=t.start*s,c[m]=t.count,p[m]=g,m++}}d.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,i,a){this.onBeforeRender(e,null,r,i,a)}}class Ss extends Kr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Zr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Ms=new Kt,ws=new Kt,Ts=new rr,Es=new nr,As=new Yn,Cs=new Kt,Rs=new Kt;class Ps extends Pr{constructor(e=new _i,t=new Ss){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)Ms.fromBufferAttribute(t,e-1),ws.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Ms.distanceTo(ws);e.setAttribute("lineDistance",new hi(n,1))}return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),As.copy(n.boundingSphere),As.applyMatrix4(r),As.radius+=i,!1===e.ray.intersectsSphere(As))return;Ts.copy(r).invert(),Es.copy(e.ray).applyMatrix4(Ts);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,a.start),r=Math.min(c.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=c.getX(i),r=c.getX(i+1),a=Is(this,e,Es,o,n,r,i);a&&t.push(a)}if(this.isLineLoop){const i=c.getX(r-1),a=c.getX(n),s=Is(this,e,Es,o,i,a,r-1);s&&t.push(s)}}else{const n=Math.max(0,a.start),r=Math.min(u.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=Is(this,e,Es,o,i,i+1,i);n&&t.push(n)}if(this.isLineLoop){const i=Is(this,e,Es,o,r-1,n,r-1);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Is(e,t,n,r,i,a,s){const o=e.geometry.attributes.position;Ms.fromBufferAttribute(o,i),ws.fromBufferAttribute(o,a);if(n.distanceSqToSegment(Ms,ws,Cs,Rs)>r)return;Cs.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(Cs);return l<t.near||l>t.far?void 0:{distance:l,point:Rs.clone().applyMatrix4(e.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:e}}const Ds=new Kt,Ns=new Kt;class Ls extends Ps{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)Ds.fromBufferAttribute(t,e),Ns.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Ds.distanceTo(Ns);e.setAttribute("lineDistance",new hi(n,1))}return this}}class Us extends Ps{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Os extends Kr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Zr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Fs=new rr,ks=new nr,zs=new Yn,Bs=new Kt;class Vs extends Pr{constructor(e=new _i,t=new Os){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),zs.copy(n.boundingSphere),zs.applyMatrix4(r),zs.radius+=i,!1===e.ray.intersectsSphere(zs))return;Fs.copy(r).invert(),ks.copy(e.ray).applyMatrix4(Fs);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);n<i;n++){const i=l.getX(n);Bs.fromBufferAttribute(c,i),Hs(Bs,i,o,r,e,t,this)}}else{for(let n=Math.max(0,a.start),i=Math.min(c.count,a.start+a.count);n<i;n++)Bs.fromBufferAttribute(c,n),Hs(Bs,n,o,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Hs(e,t,n,r,i,a,s){const o=ks.distanceSqToPoint(e);if(o<n){const n=new Kt;ks.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:s})}}class js extends wn{constructor(e,t,n,r,i=1006,a=1006,s,o,l){super(e,t,n,r,i,a,s,o,l),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const c=this;"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(function t(){c.needsUpdate=!0,c._requestVideoFrameCallbackId=e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),super.dispose()}}class Gs extends wn{constructor(e,t,n,r,i,a,s,o,l,c,u,h){super(null,a,s,o,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Ws extends wn{constructor(e,t,n=1014,r,i,a,s=1003,o=1003,l,c=1026,u=1){if(c!==Ae&&c!==Ce)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},r,i,a,s,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new xn(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class Xs extends wn{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class qs extends _i{constructor(e=1,t=1,n=4,r=8,i=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:i},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),i=Math.max(1,Math.floor(i));const a=[],s=[],o=[],l=[],c=t/2,u=Math.PI/2*e,h=t,d=2*u+h,p=2*n+i,f=r+1,m=new Kt,g=new Kt;for(let v=0;v<=p;v++){let y=0,_=0,x=0,b=0;if(v<=n){const t=v/n,r=t*Math.PI/2;_=-c-e*Math.cos(r),x=e*Math.sin(r),b=-e*Math.cos(r),y=t*u}else if(v<=n+i){const r=(v-n)/i;_=r*t-c,x=e,b=0,y=u+r*h}else{const t=(v-n-i)/n,r=t*Math.PI/2;_=c+e*Math.sin(r),x=e*Math.cos(r),b=e*Math.sin(r),y=u+h+t*u}const S=Math.max(0,Math.min(1,y/d));let M=0;0===v?M=.5/r:v===p&&(M=-.5/r);for(let e=0;e<=r;e++){const t=e/r,n=t*Math.PI*2,i=Math.sin(n),a=Math.cos(n);g.x=-x*a,g.y=_,g.z=x*i,s.push(g.x,g.y,g.z),m.set(-x*a,b,x*i),m.normalize(),o.push(m.x,m.y,m.z),l.push(t+M,S)}if(v>0){const e=(v-1)*f;for(let t=0;t<r;t++){const n=e+t,r=e+t+1,i=v*f+t,s=v*f+t+1;a.push(n,r,i),a.push(r,s,i)}}}this.setIndex(a),this.setAttribute("position",new hi(s,3)),this.setAttribute("normal",new hi(o,3)),this.setAttribute("uv",new hi(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qs(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Ys extends _i{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],s=[],o=[],l=new Kt,c=new Jt;a.push(0,0,0),s.push(0,0,1),o.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const i=n+u/t*r;l.x=e*Math.cos(i),l.y=e*Math.sin(i),a.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(a[h]/e+1)/2,c.y=(a[h+1]/e+1)/2,o.push(c.x,c.y)}for(let u=1;u<=t;u++)i.push(u,u+1,0);this.setIndex(i),this.setAttribute("position",new hi(a,3)),this.setAttribute("normal",new hi(s,3)),this.setAttribute("uv",new hi(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ys(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Zs extends _i{constructor(e=1,t=1,n=1,r=32,i=1,a=!1,s=0,o=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:s,thetaLength:o};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=n/2;let g=0;function v(n){const i=p,a=new Jt,f=new Kt;let v=0;const y=!0===n?e:t,_=!0===n?1:-1;for(let e=1;e<=r;e++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),p++;const x=p;for(let e=0;e<=r;e++){const t=e/r*o+s,n=Math.cos(t),i=Math.sin(t);f.x=y*i,f.y=m*_,f.z=y*n,u.push(f.x,f.y,f.z),h.push(0,_,0),a.x=.5*n+.5,a.y=.5*i*_+.5,d.push(a.x,a.y),p++}for(let e=0;e<r;e++){const t=i+e,r=x+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const a=new Kt,v=new Kt;let y=0;const _=(t-e)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,y=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*o+s,l=Math.sin(i),f=Math.cos(i);v.x=y*l,v.y=-g*n+m,v.z=y*f,u.push(v.x,v.y,v.z),a.set(l,_,f).normalize(),h.push(a.x,a.y,a.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let n=0;n<r;n++)for(let r=0;r<i;r++){const a=f[r][n],s=f[r+1][n],o=f[r+1][n+1],l=f[r][n+1];(e>0||0!==r)&&(c.push(a,s,l),y+=3),(t>0||r!==i-1)&&(c.push(s,o,l),y+=3)}l.addGroup(g,y,0),g+=y}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new hi(u,3)),this.setAttribute("normal",new hi(h,3)),this.setAttribute("uv",new hi(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zs(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Js extends Zs{constructor(e=1,t=1,n=32,r=1,i=!1,a=0,s=2*Math.PI){super(0,e,t,n,r,i,a,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:s}}static fromJSON(e){return new Js(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class $s extends _i{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],a=[];function s(e,t,n,r){const i=r+1,a=[];for(let s=0;s<=i;s++){a[s]=[];const r=e.clone().lerp(n,s/i),o=t.clone().lerp(n,s/i),l=i-s;for(let e=0;e<=l;e++)a[s][e]=0===e&&s===i?r:r.clone().lerp(o,e/l)}for(let s=0;s<i;s++)for(let e=0;e<2*(i-s)-1;e++){const t=Math.floor(e/2);e%2==0?(o(a[s][t+1]),o(a[s+1][t]),o(a[s][t])):(o(a[s][t+1]),o(a[s+1][t+1]),o(a[s+1][t]))}}function o(e){i.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){const n=new Kt,r=new Kt,i=new Kt;for(let a=0;a<t.length;a+=3)l(t[a+0],n),l(t[a+1],r),l(t[a+2],i),s(n,r,i,e)}(r),function(e){const t=new Kt;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new Kt;for(let t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];const n=u(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;a.push(n,1-r)}(function(){const e=new Kt,t=new Kt,n=new Kt,r=new Kt,s=new Jt,o=new Jt,l=new Jt;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),s.set(a[d+0],a[d+1]),o.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),r.copy(e).add(t).add(n).divideScalar(3);const p=u(r);c(s,d+0,e,p),c(o,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<a.length;e+=6){const t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),s=Math.min(t,n,r);i>.9&&s<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new hi(i,3)),this.setAttribute("normal",new hi(i.slice(),3)),this.setAttribute("uv",new hi(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $s(e.vertices,e.indices,e.radius,e.details)}}class Ks extends $s{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ks(e.radius,e.detail)}}const Qs=new Kt,eo=new Kt,to=new Kt,no=new Gr;class ro extends _i{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,r=Math.pow(10,n),i=Math.cos(Vt*t),a=e.getIndex(),s=e.getAttribute("position"),o=a?a.count:s.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<o;e+=3){a?(l[0]=a.getX(e),l[1]=a.getX(e+1),l[2]=a.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:o}=no;if(t.fromBufferAttribute(s,l[0]),n.fromBufferAttribute(s,l[1]),o.fromBufferAttribute(s,l[2]),no.getNormal(to),u[0]=`${Math.round(t.x*r)},${Math.round(t.y*r)},${Math.round(t.z*r)}`,u[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`,u[2]=`${Math.round(o.x*r)},${Math.round(o.y*r)},${Math.round(o.z*r)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=u[e],r=u[t],a=no[c[e]],s=no[c[t]],o=`${n}_${r}`,p=`${r}_${n}`;p in h&&h[p]?(to.dot(h[p].normal)<=i&&(d.push(a.x,a.y,a.z),d.push(s.x,s.y,s.z)),h[p]=null):o in h||(h[o]={index0:l[e],index1:l[t],normal:to.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:n}=h[e];Qs.fromBufferAttribute(s,t),eo.fromBufferAttribute(s,n),d.push(Qs.x,Qs.y,Qs.z),d.push(eo.x,eo.y,eo.z)}this.setAttribute("position",new hi(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class io{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const i=n.length;let a;a=t||e*n[i-1];let s,o=0,l=i-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),s=n[r]-a,s<0)o=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===a)return r/(i-1);const c=n[r];return(r+(a-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),s=this.getPoint(i),o=t||(a.isVector2?new Jt:new Kt);return o.copy(s).sub(a).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Kt,r=[],i=[],a=[],s=new Kt,o=new rr;for(let d=0;d<=e;d++){const t=d/e;r[d]=this.getTangentAt(t,new Kt)}i[0]=new Kt,a[0]=new Kt;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),a[0].crossVectors(r[0],i[0]);for(let d=1;d<=e;d++){if(i[d]=i[d-1].clone(),a[d]=a[d-1].clone(),s.crossVectors(r[d-1],r[d]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(Gt(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(o.makeRotationAxis(s,e))}a[d].crossVectors(r[d],i[d])}if(!0===t){let t=Math.acos(Gt(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(o.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class ao extends io{constructor(e=0,t=0,n=1,r=1,i=0,a=2*Math.PI,s=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=s,this.aRotation=o}getPoint(e,t=new Jt){const n=t,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);const s=this.aStartAngle+e*i;let o=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,r=l-this.aY;o=n*e-r*t+this.aX,l=n*t+r*e+this.aY}return n.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class so extends ao{constructor(e,t,n,r,i,a){super(e,t,n,n,r,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function oo(){let e=0,t=0,n=0,r=0;function i(i,a,s,o){e=i,t=s,n=-3*i+3*a-2*s-o,r=2*i-2*a+s+o}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,s,o){let l=(t-e)/a-(n-e)/(a+s)+(n-t)/s,c=(n-t)/s-(r-t)/(s+o)+(r-n)/o;l*=s,c*=s,i(t,n,l,c)},calc:function(i){const a=i*i;return e+t*i+n*a+r*(a*i)}}}const lo=new Kt,co=new oo,uo=new oo,ho=new oo;class po extends io{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Kt){const n=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let s,o,l=Math.floor(a),c=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?s=r[(l-1)%i]:(lo.subVectors(r[0],r[1]).add(r[0]),s=lo);const u=r[l%i],h=r[(l+1)%i];if(this.closed||l+2<i?o=r[(l+2)%i]:(lo.subVectors(r[i-1],r[i-2]).add(r[i-1]),o=lo),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(u),e),n=Math.pow(u.distanceToSquared(h),e),r=Math.pow(h.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),co.initNonuniformCatmullRom(s.x,u.x,h.x,o.x,t,n,r),uo.initNonuniformCatmullRom(s.y,u.y,h.y,o.y,t,n,r),ho.initNonuniformCatmullRom(s.z,u.z,h.z,o.z,t,n,r)}else"catmullrom"===this.curveType&&(co.initCatmullRom(s.x,u.x,h.x,o.x,this.tension),uo.initCatmullRom(s.y,u.y,h.y,o.y,this.tension),ho.initCatmullRom(s.z,u.z,h.z,o.z,this.tension));return n.set(co.calc(c),uo.calc(c),ho.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Kt).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function fo(e,t,n,r,i){const a=.5*(r-t),s=.5*(i-n),o=e*e;return(2*n-2*r+a+s)*(e*o)+(-3*n+3*r-2*a-s)*o+a*e+n}function mo(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function go(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}class vo extends io{constructor(e=new Jt,t=new Jt,n=new Jt,r=new Jt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Jt){const n=t,r=this.v0,i=this.v1,a=this.v2,s=this.v3;return n.set(go(e,r.x,i.x,a.x,s.x),go(e,r.y,i.y,a.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class yo extends io{constructor(e=new Kt,t=new Kt,n=new Kt,r=new Kt){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Kt){const n=t,r=this.v0,i=this.v1,a=this.v2,s=this.v3;return n.set(go(e,r.x,i.x,a.x,s.x),go(e,r.y,i.y,a.y,s.y),go(e,r.z,i.z,a.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class _o extends io{constructor(e=new Jt,t=new Jt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Jt){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Jt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xo extends io{constructor(e=new Kt,t=new Kt){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Kt){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Kt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bo extends io{constructor(e=new Jt,t=new Jt,n=new Jt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Jt){const n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(mo(e,r.x,i.x,a.x),mo(e,r.y,i.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class So extends io{constructor(e=new Kt,t=new Kt,n=new Kt){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Kt){const n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(mo(e,r.x,i.x,a.x),mo(e,r.y,i.y,a.y),mo(e,r.z,i.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Mo extends io{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Jt){const n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),s=i-a,o=r[0===a?a:a-1],l=r[a],c=r[a>r.length-2?r.length-1:a+1],u=r[a>r.length-3?r.length-1:a+2];return n.set(fo(s,o.x,l.x,c.x,u.x),fo(s,o.y,l.y,c.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Jt).fromArray(n))}return this}}var wo=Object.freeze({__proto__:null,ArcCurve:so,CatmullRomCurve3:po,CubicBezierCurve:vo,CubicBezierCurve3:yo,EllipseCurve:ao,LineCurve:_o,LineCurve3:xo,QuadraticBezierCurve:bo,QuadraticBezierCurve3:So,SplineCurve:Mo});class To extends io{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new wo[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const e=r[i]-n,a=this.curves[i],s=a.getLength(),o=0===s?0:1-e/s;return a.getPointAt(o,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const a=i[r],s=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,o=a.getPoints(s);for(let e=0;e<o.length;e++){const r=o[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new wo[n.type]).fromJSON(n))}return this}}class Eo extends To{constructor(e){super(),this.type="Path",this.currentPoint=new Jt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new _o(this.currentPoint.clone(),new Jt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new bo(this.currentPoint.clone(),new Jt(e,t),new Jt(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,a){const s=new vo(this.currentPoint.clone(),new Jt(e,t),new Jt(n,r),new Jt(i,a));return this.curves.push(s),this.currentPoint.set(i,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Mo(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,a){const s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,n,r,i,a),this}absarc(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}ellipse(e,t,n,r,i,a,s,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,a,s,o),this}absellipse(e,t,n,r,i,a,s,o){const l=new ao(e,t,n,r,i,a,s,o);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ao extends Eo{constructor(e){super(e),this.uuid=jt(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new Eo).fromJSON(n))}return this}}function Co(e,t,n=2){const r=t&&t.length,i=r?t[0]*n:e.length;let a=Ro(e,0,i,n,!0);const s=[];if(!a||a.next===a.prev)return s;let o,l,c;if(r&&(a=function(e,t,n,r){const i=[];for(let a=0,s=t.length;a<s;a++){const n=Ro(e,t[a]*r,a<s-1?t[a+1]*r:e.length,r,!1);n===n.next&&(n.steiner=!0),i.push(Bo(n))}i.sort(Oo);for(let a=0;a<i.length;a++)n=Fo(i[a],n);return n}(e,t,a,n)),e.length>80*n){o=1/0,l=1/0;let t=-1/0,r=-1/0;for(let a=n;a<i;a+=n){const n=e[a],i=e[a+1];n<o&&(o=n),i<l&&(l=i),n>t&&(t=n),i>r&&(r=i)}c=Math.max(t-o,r-l),c=0!==c?32767/c:0}return Io(a,s,n,o,l,c,0),s}function Ro(e,t,n,r,i){let a;if(i===function(e,t,n,r){let i=0;for(let a=t,s=n-r;a<n;a+=r)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}(e,t,n,r)>0)for(let s=t;s<n;s+=r)a=$o(s/r|0,e[s],e[s+1],a);else for(let s=n-r;s>=t;s-=r)a=$o(s/r|0,e[s],e[s+1],a);return a&&Wo(a,a.next)&&(Ko(a),a=a.next),a}function Po(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Wo(r,r.next)&&0!==Go(r.prev,r,r.next))r=r.next;else{if(Ko(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function Io(e,t,n,r,i,a,s){if(!e)return;!s&&a&&function(e,t,n,r){let i=e;do{0===i.z&&(i.z=zo(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n=1;do{let r,i=e;e=null;let a=null;for(t=0;i;){t++;let s=i,o=0;for(let e=0;e<n&&(o++,s=s.nextZ,s);e++);let l=n;for(;o>0||l>0&&s;)0!==o&&(0===l||!s||i.z<=s.z)?(r=i,i=i.nextZ,o--):(r=s,s=s.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=s}a.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,a);let o=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(a?No(e,r,i,a):Do(e))t.push(l.i,e.i,c.i),Ko(e),e=c.next,o=c.next;else if((e=c)===o){s?1===s?Io(e=Lo(Po(e),t),t,n,r,i,a,2):2===s&&Uo(e,t,n,r,i,a):Io(Po(e),t,n,r,i,a,1);break}}}function Do(e){const t=e.prev,n=e,r=e.next;if(Go(t,n,r)>=0)return!1;const i=t.x,a=n.x,s=r.x,o=t.y,l=n.y,c=r.y,u=Math.min(i,a,s),h=Math.min(o,l,c),d=Math.max(i,a,s),p=Math.max(o,l,c);let f=r.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Ho(i,o,a,l,s,c,f.x,f.y)&&Go(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function No(e,t,n,r){const i=e.prev,a=e,s=e.next;if(Go(i,a,s)>=0)return!1;const o=i.x,l=a.x,c=s.x,u=i.y,h=a.y,d=s.y,p=Math.min(o,l,c),f=Math.min(u,h,d),m=Math.max(o,l,c),g=Math.max(u,h,d),v=zo(p,f,t,n,r),y=zo(m,g,t,n,r);let _=e.prevZ,x=e.nextZ;for(;_&&_.z>=v&&x&&x.z<=y;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==s&&Ho(o,u,l,h,c,d,_.x,_.y)&&Go(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==s&&Ho(o,u,l,h,c,d,x.x,x.y)&&Go(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==s&&Ho(o,u,l,h,c,d,_.x,_.y)&&Go(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==s&&Ho(o,u,l,h,c,d,x.x,x.y)&&Go(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Lo(e,t){let n=e;do{const r=n.prev,i=n.next.next;!Wo(r,i)&&Xo(r,n,n.next,i)&&Zo(r,i)&&Zo(i,r)&&(t.push(r.i,n.i,i.i),Ko(n),Ko(n.next),n=e=i),n=n.next}while(n!==e);return Po(n)}function Uo(e,t,n,r,i,a){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&jo(s,e)){let o=Jo(s,e);return s=Po(s,s.next),o=Po(o,o.next),Io(s,t,n,r,i,a,0),void Io(o,t,n,r,i,a,0)}e=e.next}s=s.next}while(s!==e)}function Oo(e,t){let n=e.x-t.x;if(0===n&&(n=e.y-t.y,0===n)){n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return n}function Fo(e,t){const n=function(e,t){let n=t;const r=e.x,i=e.y;let a,s=-1/0;if(Wo(e,n))return n;do{if(Wo(e,n.next))return n.next;if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s&&(s=e,a=n.x<n.next.x?n:n.next,e===r))return a}n=n.next}while(n!==t);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;n=a;do{if(r>=n.x&&n.x>=l&&r!==n.x&&Vo(i<c?r:s,i,l,c,i<c?s:r,i,n.x,n.y)){const t=Math.abs(i-n.y)/(r-n.x);Zo(n,e)&&(t<u||t===u&&(n.x>a.x||n.x===a.x&&ko(a,n)))&&(a=n,u=t)}n=n.next}while(n!==o);return a}(e,t);if(!n)return t;const r=Jo(n,e);return Po(r,r.next),Po(n,n.next)}function ko(e,t){return Go(e.prev,e,t.prev)<0&&Go(t.next,e,e.next)<0}function zo(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Bo(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Vo(e,t,n,r,i,a,s,o){return(i-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(r-o)>=(n-s)*(t-o)&&(n-s)*(a-o)>=(i-s)*(r-o)}function Ho(e,t,n,r,i,a,s,o){return!(e===s&&t===o)&&Vo(e,t,n,r,i,a,s,o)}function jo(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Xo(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Zo(e,t)&&Zo(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Go(e.prev,e,t.prev)||Go(e,t.prev,t))||Wo(e,t)&&Go(e.prev,e,e.next)>0&&Go(t.prev,t,t.next)>0)}function Go(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Wo(e,t){return e.x===t.x&&e.y===t.y}function Xo(e,t,n,r){const i=Yo(Go(e,t,n)),a=Yo(Go(e,t,r)),s=Yo(Go(n,r,e)),o=Yo(Go(n,r,t));return i!==a&&s!==o||(!(0!==i||!qo(e,n,t))||(!(0!==a||!qo(e,r,t))||(!(0!==s||!qo(n,e,r))||!(0!==o||!qo(n,t,r)))))}function qo(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Yo(e){return e>0?1:e<0?-1:0}function Zo(e,t){return Go(e.prev,e,e.next)<0?Go(e,t,e.next)>=0&&Go(e,e.prev,t)>=0:Go(e,t,e.prev)<0||Go(e,e.next,t)<0}function Jo(e,t){const n=Qo(e.i,e.x,e.y),r=Qo(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function $o(e,t,n,r){const i=Qo(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ko(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Qo(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class el{static triangulate(e,t,n=2){return Co(e,t,n)}}class tl{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}static isClockWise(e){return tl.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];nl(e),rl(n,e);let a=e.length;t.forEach(nl);for(let o=0;o<t.length;o++)r.push(a),a+=t[o].length,rl(n,t[o]);const s=el.triangulate(n,r);for(let o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}}function nl(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function rl(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class il extends _i{constructor(e=new Ao([new Jt(.5,.5),new Jt(-.5,.5),new Jt(-.5,-.5),new Jt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let s=0,o=e.length;s<o;s++){a(e[s])}function a(e){const a=[],s=void 0!==t.curveSegments?t.curveSegments:12,o=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:al;let g,v,y,_,x,b=!1;f&&(g=f.getSpacedPoints(o),b=!0,c=!1,v=f.computeFrenetFrames(o,!1),y=new Kt,_=new Kt,x=new Kt),c||(p=0,u=0,h=0,d=0);const S=e.extractPoints(s);let M=S.shape;const w=S.holes;if(!tl.isClockWise(M)){M=M.reverse();for(let e=0,t=w.length;e<t;e++){const t=w[e];tl.isClockWise(t)&&(w[e]=t.reverse())}}function T(e){const t=1e-10*1e-10;let n=e[0];for(let r=1;r<=e.length;r++){const i=r%e.length,a=e[i],s=a.x-n.x,o=a.y-n.y,l=s*s+o*o,c=Math.max(Math.abs(a.x),Math.abs(a.y),Math.abs(n.x),Math.abs(n.y));l<=t*c*c?(e.splice(i,1),r--):n=a}}T(M),w.forEach(T);const E=w.length,A=M;for(let t=0;t<E;t++){const e=w[t];M=M.concat(e)}function C(e,t,n){return e.clone().addScaledVector(t,n)}const R=M.length;function P(e,t,n){let r,i,a;const s=e.x-t.x,o=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=s*s+o*o,h=s*c-o*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-o/h,f=t.y+s/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(s*c-o*l);r=p+s*m-e.x,i=f+o*m-e.y;const g=r*r+i*i;if(g<=2)return new Jt(r,i);a=Math.sqrt(g/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(c)&&(e=!0),e?(r=-o,i=s,a=Math.sqrt(u)):(r=s,i=o,a=Math.sqrt(u/2))}return new Jt(r/a,i/a)}const I=[];for(let t=0,n=A.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),I[t]=P(A[t],A[r],A[i]);const D=[];let N,L,U=I.concat();for(let t=0,n=E;t<n;t++){const e=w[t];N=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),N[t]=P(e[t],e[r],e[i]);D.push(N),U=U.concat(N)}if(0===p)L=tl.triangulateShape(A,w);else{const e=[],t=[];for(let n=0;n<p;n++){const r=n/p,i=u*Math.cos(r*Math.PI/2),a=h*Math.sin(r*Math.PI/2)+d;for(let t=0,n=A.length;t<n;t++){const n=C(A[t],I[t],a);z(n.x,n.y,-i),0===r&&e.push(n)}for(let e=0,n=E;e<n;e++){const n=w[e];N=D[e];const s=[];for(let e=0,t=n.length;e<t;e++){const t=C(n[e],N[e],a);z(t.x,t.y,-i),0===r&&s.push(t)}0===r&&t.push(s)}}L=tl.triangulateShape(e,t)}const O=L.length,F=h+d;for(let t=0;t<R;t++){const e=c?C(M[t],U[t],F):M[t];b?(_.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),x.copy(g[0]).add(_).add(y),z(x.x,x.y,x.z)):z(e.x,e.y,0)}for(let t=1;t<=o;t++)for(let e=0;e<R;e++){const n=c?C(M[e],U[e],F):M[e];b?(_.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),x.copy(g[t]).add(_).add(y),z(x.x,x.y,x.z)):z(n.x,n.y,l/o*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,i=A.length;t<i;t++){const e=C(A[t],I[t],r);z(e.x,e.y,l+n)}for(let t=0,i=w.length;t<i;t++){const e=w[t];N=D[t];for(let t=0,i=e.length;t<i;t++){const i=C(e[t],N[t],r);b?z(i.x,i.y+g[o-1].y,g[o-1].x+n):z(i.x,i.y,l+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=o+2*p;e<n;e++){const n=R*e,a=R*(e+1);V(t+r+n,t+i+n,t+i+a,t+r+a)}}}function z(e,t,n){a.push(e),a.push(t),a.push(n)}function B(e,t,i){H(e),H(t),H(i);const a=r.length/3,s=m.generateTopUV(n,r,a-3,a-2,a-1);j(s[0]),j(s[1]),j(s[2])}function V(e,t,i,a){H(e),H(t),H(a),H(t),H(i),H(a);const s=r.length/3,o=m.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);j(o[0]),j(o[1]),j(o[3]),j(o[1]),j(o[2]),j(o[3])}function H(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function j(e){i.push(e.x),i.push(e.y)}!function(){const e=r.length/3;if(c){let e=0,t=R*e;for(let n=0;n<O;n++){const e=L[n];B(e[2]+t,e[1]+t,e[0]+t)}e=o+2*p,t=R*e;for(let n=0;n<O;n++){const e=L[n];B(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<O;e++){const t=L[e];B(t[2],t[1],t[0])}for(let e=0;e<O;e++){const t=L[e];B(t[0]+R*o,t[1]+R*o,t[2]+R*o)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;k(A,t),t+=A.length;for(let n=0,r=w.length;n<r;n++){const e=w[n];k(e,t),t+=e.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new hi(r,3)),this.setAttribute("uv",new hi(i,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){const t=e[r];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,a=e.shapes.length;i<a;i++){const r=t[e.shapes[i]];n.push(r)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new wo[r.type]).fromJSON(r)),new il(n,e.options)}}const al={generateTopUV:function(e,t,n,r,i){const a=t[3*n],s=t[3*n+1],o=t[3*r],l=t[3*r+1],c=t[3*i],u=t[3*i+1];return[new Jt(a,s),new Jt(o,l),new Jt(c,u)]},generateSideWallUV:function(e,t,n,r,i,a){const s=t[3*n],o=t[3*n+1],l=t[3*n+2],c=t[3*r],u=t[3*r+1],h=t[3*r+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(o-u)<Math.abs(s-c)?[new Jt(s,1-l),new Jt(c,1-h),new Jt(d,1-f),new Jt(m,1-v)]:[new Jt(o,1-l),new Jt(u,1-h),new Jt(p,1-f),new Jt(g,1-v)]}};class sl extends $s{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sl(e.radius,e.detail)}}class ol extends _i{constructor(e=[new Jt(0,-.5),new Jt(.5,0),new Jt(0,.5)],t=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Gt(r,0,2*Math.PI);const i=[],a=[],s=[],o=[],l=[],c=1/t,u=new Kt,h=new Jt,d=new Kt,p=new Kt,f=new Kt;let m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){const i=n+v*c*r,d=Math.sin(i),p=Math.cos(i);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*p,a.push(u.x,u.y,u.z),h.x=v/t,h.y=n/(e.length-1),s.push(h.x,h.y);const r=o[3*n+0]*d,i=o[3*n+1],c=o[3*n+0]*p;l.push(r,i,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,r=n,a=n+e.length,s=n+e.length+1,o=n+1;i.push(r,a,o),i.push(s,o,a)}this.setIndex(i),this.setAttribute("position",new hi(a,3)),this.setAttribute("uv",new hi(s,2)),this.setAttribute("normal",new hi(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ol(e.points,e.segments,e.phiStart,e.phiLength)}}class ll extends $s{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ll(e.radius,e.detail)}}class cl extends _i{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,s=Math.floor(n),o=Math.floor(r),l=s+1,c=o+1,u=e/s,h=t/o,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){const e=g*h-a;for(let t=0;t<l;t++){const n=t*u-i;p.push(n,-e,0),f.push(0,0,1),m.push(t/s),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<s;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;d.push(t,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new hi(p,3)),this.setAttribute("normal",new hi(f,3)),this.setAttribute("uv",new hi(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cl(e.width,e.height,e.widthSegments,e.heightSegments)}}class ul extends _i{constructor(e=.5,t=1,n=32,r=1,i=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},n=Math.max(3,n);const s=[],o=[],l=[],c=[];let u=e;const h=(t-e)/(r=Math.max(1,r)),d=new Kt,p=new Jt;for(let f=0;f<=r;f++){for(let e=0;e<=n;e++){const r=i+e/n*a;d.x=u*Math.cos(r),d.y=u*Math.sin(r),o.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let f=0;f<r;f++){const e=f*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,a=r+n+1,o=r+n+2,l=r+1;s.push(i,a,l),s.push(a,o,l)}}this.setIndex(s),this.setAttribute("position",new hi(o,3)),this.setAttribute("normal",new hi(l,3)),this.setAttribute("uv",new hi(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ul(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class hl extends _i{constructor(e=new Ao([new Jt(0,.5),new Jt(-.5,-.5),new Jt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],a=[];let s=0,o=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(s,o,c),s+=o,o=0;function l(e){const s=r.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===tl.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===tl.isClockWise(e)&&(u[t]=e.reverse())}const h=tl.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),a.push(e.x,e.y)}for(let t=0,r=h.length;t<r;t++){const e=h[t],r=e[0]+s,i=e[1]+s,a=e[2]+s;n.push(r,i,a),o+=3}}this.setIndex(n),this.setAttribute("position",new hi(r,3)),this.setAttribute("normal",new hi(i,3)),this.setAttribute("uv",new hi(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}return new hl(n,e.curveSegments)}}class dl extends _i{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,a=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(a+s,Math.PI);let l=0;const c=[],u=new Kt,h=new Kt,d=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0===g&&0===a?y=.5/t:g===n&&o===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;u.x=-e*Math.cos(r+o*i)*Math.sin(a+v*s),u.y=e*Math.cos(a+v*s),u.z=e*Math.sin(r+o*i)*Math.sin(a+v*s),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],r=c[g][e],i=c[g+1][e],s=c[g+1][e+1];(0!==g||a>0)&&d.push(t,r,s),(g!==n-1||o<Math.PI)&&d.push(r,i,s)}this.setIndex(d),this.setAttribute("position",new hi(p,3)),this.setAttribute("normal",new hi(f,3)),this.setAttribute("uv",new hi(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class pl extends $s{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new pl(e.radius,e.detail)}}class fl extends _i{constructor(e=1,t=.4,n=12,r=48,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const a=[],s=[],o=[],l=[],c=new Kt,u=new Kt,h=new Kt;for(let d=0;d<=n;d++)for(let a=0;a<=r;a++){const p=a/r*i,f=d/n*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),s.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),o.push(h.x,h.y,h.z),l.push(a/r),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=r;e++){const t=(r+1)*d+e-1,n=(r+1)*(d-1)+e-1,i=(r+1)*(d-1)+e,s=(r+1)*d+e;a.push(t,n,s),a.push(n,i,s)}this.setIndex(a),this.setAttribute("position",new hi(s,3)),this.setAttribute("normal",new hi(o,3)),this.setAttribute("uv",new hi(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fl(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class ml extends _i{constructor(e=1,t=.4,n=64,r=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);const s=[],o=[],l=[],c=[],u=new Kt,h=new Kt,d=new Kt,p=new Kt,f=new Kt,m=new Kt,g=new Kt;for(let y=0;y<=n;++y){const s=y/n*i*Math.PI*2;v(s,i,a,e,d),v(s+.01,i,a,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,a=-t*Math.cos(i),s=t*Math.sin(i);u.x=d.x+(a*g.x+s*f.x),u.y=d.y+(a*g.y+s*f.y),u.z=d.z+(a*g.z+s*f.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/n),c.push(e/r)}}for(let y=1;y<=n;y++)for(let e=1;e<=r;e++){const t=(r+1)*(y-1)+(e-1),n=(r+1)*y+(e-1),i=(r+1)*y+e,a=(r+1)*(y-1)+e;s.push(t,n,a),s.push(n,i,a)}function v(e,t,n,r,i){const a=Math.cos(e),s=Math.sin(e),o=n/t*e,l=Math.cos(o);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*s*.5,i.z=r*Math.sin(o)*.5}this.setIndex(s),this.setAttribute("position",new hi(o,3)),this.setAttribute("normal",new hi(l,3)),this.setAttribute("uv",new hi(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ml(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class gl extends _i{constructor(e=new So(new Kt(-1,-1,0),new Kt(-1,1,0),new Kt(1,1,0)),t=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const s=new Kt,o=new Kt,l=new Jt;let c=new Kt;const u=[],h=[],d=[],p=[];function f(i){c=e.getPointAt(i/t,c);const l=a.normals[i],d=a.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);o.x=a*l.x+i*d.x,o.y=a*l.y+i*d.y,o.z=a*l.z+i*d.z,o.normalize(),h.push(o.x,o.y,o.z),s.x=c.x+n*o.x,s.y=c.y+n*o.y,s.z=c.z+n*o.z,u.push(s.x,s.y,s.z)}}!function(){for(let e=0;e<t;e++)f(e);f(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,s=(r+1)*(e-1)+t;p.push(n,i,s),p.push(i,a,s)}}()}(),this.setIndex(p),this.setAttribute("position",new hi(u,3)),this.setAttribute("normal",new hi(h,3)),this.setAttribute("uv",new hi(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new gl((new wo[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class vl extends _i{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new Kt,i=new Kt;if(null!==e.index){const a=e.attributes.position,s=e.index;let o=e.groups;0===o.length&&(o=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){const l=o[e],c=l.start;for(let e=c,o=c+l.count;e<o;e+=3)for(let l=0;l<3;l++){const o=s.getX(e+l),c=s.getX(e+(l+1)%3);r.fromBufferAttribute(a,o),i.fromBufferAttribute(a,c),!0===yl(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const a=e.attributes.position;for(let e=0,s=a.count/3;e<s;e++)for(let o=0;o<3;o++){const s=3*e+o,l=3*e+(o+1)%3;r.fromBufferAttribute(a,s),i.fromBufferAttribute(a,l),!0===yl(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new hi(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function yl(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var _l=Object.freeze({__proto__:null,BoxGeometry:Ni,CapsuleGeometry:qs,CircleGeometry:Ys,ConeGeometry:Js,CylinderGeometry:Zs,DodecahedronGeometry:Ks,EdgesGeometry:ro,ExtrudeGeometry:il,IcosahedronGeometry:sl,LatheGeometry:ol,OctahedronGeometry:ll,PlaneGeometry:cl,PolyhedronGeometry:$s,RingGeometry:ul,ShapeGeometry:hl,SphereGeometry:dl,TetrahedronGeometry:pl,TorusGeometry:fl,TorusKnotGeometry:ml,TubeGeometry:gl,WireframeGeometry:vl});class xl extends Kr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Zr(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class bl extends ki{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Sl extends Kr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Zr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new pr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ml extends Sl{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Jt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Zr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Zr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Zr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class wl extends Kr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Zr(16777215),this.specular=new Zr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new pr,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Tl extends Kr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Zr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class El extends Kr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Al extends Kr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new pr,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Cl extends Kr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Rl extends Kr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Pl extends Kr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Zr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Il extends Ss{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Dl(e,t){return e&&e.constructor!==t?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function Nl(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ll(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n}function Ul(e,t,n){const r=e.length,i=new e.constructor(r);for(let a=0,s=0;s!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)i[s++]=e[r+n]}return i}function Ol(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0===a)return;let s=a[r];if(void 0!==s)if(Array.isArray(s))do{s=a[r],void 0!==s&&(t.push(a.time),n.push(...s)),a=e[i++]}while(void 0!==a);else if(void 0!==s.toArray)do{s=a[r],void 0!==s&&(t.push(a.time),s.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{s=a[r],void 0!==s&&(t.push(a.time),n.push(s)),a=e[i++]}while(void 0!==a)}class Fl{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=i)){const s=t[1];e<s&&(n=2,i=s);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0;break n}break e}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class kl extends Fl{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:mt,endingEnd:mt}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,s=r[i],o=r[a];if(void 0===s)switch(this.getSettings_().endingStart){case gt:i=e,s=2*t-n;break;case vt:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===o)switch(this.getSettings_().endingEnd){case gt:a=e,o=2*n-t;break;case vt:a=1,o=n+r[1]-r[0];break;default:a=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-n),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let x=0;x!==s;++x)i[x]=g*a[c+x]+v*a[l+x]+y*a[o+x]+_*a[u+x];return i}}class zl extends Fl{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=(n-t)/(r-t),u=1-c;for(let h=0;h!==s;++h)i[h]=a[l+h]*u+a[o+h]*c;return i}}class Bl extends Fl{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Vl{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Dl(t,this.TimeBufferType),this.values=Dl(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Dl(e.times,Array),values:Dl(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Bl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new zl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new kl(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case dt:t=this.InterpolantFactoryMethodDiscrete;break;case pt:t=this.InterpolantFactoryMethodLinear;break;case ft:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return dt;case this.InterpolantFactoryMethodLinear:return pt;case this.InterpolantFactoryMethodSmooth:return ft}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*e,a*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(e=!1);let a=null;for(let s=0;s!==i;s++){const t=n[s];if("number"==typeof t&&isNaN(t)){e=!1;break}if(null!==a&&a>t){e=!1;break}a=t}if(void 0!==r&&Nl(r))for(let s=0,o=r.length;s!==o;++s){const t=r[s];if(isNaN(t)){e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===ft,i=e.length-1;let a=1;for(let s=1;s<i;++s){let i=!1;const o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,a=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[a+s]){i=!0;break}}}if(i){if(s!==a){e[a]=e[s];const r=s*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,s=0;s!==n;++s)t[r+s]=t[e+s];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Vl.prototype.ValueTypeName="",Vl.prototype.TimeBufferType=Float32Array,Vl.prototype.ValueBufferType=Float32Array,Vl.prototype.DefaultInterpolation=pt;class Hl extends Vl{constructor(e,t,n){super(e,t,n)}}Hl.prototype.ValueTypeName="bool",Hl.prototype.ValueBufferType=Array,Hl.prototype.DefaultInterpolation=dt,Hl.prototype.InterpolantFactoryMethodLinear=void 0,Hl.prototype.InterpolantFactoryMethodSmooth=void 0;class jl extends Vl{constructor(e,t,n,r){super(e,t,n,r)}}jl.prototype.ValueTypeName="color";class Gl extends Vl{constructor(e,t,n,r){super(e,t,n,r)}}Gl.prototype.ValueTypeName="number";class Wl extends Fl{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(n-t)/(r-t);let l=e*s;for(let c=l+s;l!==c;l+=4)$t.slerpFlat(i,0,a,l-s,a,l,o);return i}}class Xl extends Vl{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new Wl(this.times,this.values,this.getValueSize(),e)}}Xl.prototype.ValueTypeName="quaternion",Xl.prototype.InterpolantFactoryMethodSmooth=void 0;class ql extends Vl{constructor(e,t,n){super(e,t,n)}}ql.prototype.ValueTypeName="string",ql.prototype.ValueBufferType=Array,ql.prototype.DefaultInterpolation=dt,ql.prototype.InterpolantFactoryMethodLinear=void 0,ql.prototype.InterpolantFactoryMethodSmooth=void 0;class Yl extends Vl{constructor(e,t,n,r){super(e,t,n,r)}}Yl.prototype.ValueTypeName="vector";class Zl{constructor(e="",t=-1,n=[],r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=jt(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,s=n.length;a!==s;++a)t.push(Jl(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i.userData=JSON.parse(e.userData||"{}"),i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let i=0,a=n.length;i!==a;++i)t.push(Vl.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let s=0;s<i;s++){let e=[],o=[];e.push((s+i-1)%i,s,(s+1)%i),o.push(0,1,0);const l=Ll(e);e=Ul(e,1,l),o=Ul(o,1,l),r||0!==e[0]||(e.push(i),o.push(o[0])),a.push(new Gl(".morphTargetInfluences["+t[s].name+"]",e,o).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let s=0,o=e.length;s<o;s++){const t=e[s],n=t.name.match(i);if(n&&n.length>1){const e=n[1];let i=r[e];i||(r[e]=i=[]),i.push(t)}}const a=[];for(const s in r)a.push(this.CreateFromMorphTargetSequence(s,r[s],t,n));return a}static parseAnimation(e,t){if(!e)return null;const n=function(e,t,n,r,i){if(0!==n.length){const a=[],s=[];Ol(n,a,s,r),0!==a.length&&i.push(new e(t,a,s))}},r=[],i=e.name||"default",a=e.fps||30,s=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const i in t){const t=[],a=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),a.push(r.morphTarget===i?1:0)}r.push(new Gl(".morphTargetInfluence["+i+"]",t,a))}o=t.length*a}else{const i=".bones["+t[c].name+"]";n(Yl,i+".position",e,"pos",r),n(Xl,i+".quaternion",e,"rot",r),n(Yl,i+".scale",e,"scl",r)}}if(0===r.length)return null;return new this(i,o,r,s)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function Jl(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gl;case"vector":case"vector2":case"vector3":case"vector4":return Yl;case"color":return jl;case"quaternion":return Xl;case"bool":case"boolean":return Hl;case"string":return ql}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];Ol(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const $l={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Kl{constructor(e,t,n){const r=this;let i,a=!1,s=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.abortController=new AbortController,this.itemStart=function(e){o++,!1===a&&void 0!==r.onStart&&r.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,o),s===o&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}const Ql=new Kl;class ec{constructor(e){this.manager=void 0!==e?e:Ql,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}ec.DEFAULT_MATERIAL_NAME="__DEFAULT";const tc={};class nc extends Error{constructor(e,t){super(e),this.response=t}}class rc extends ec{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=$l.get(`file:${e}`);if(void 0!==i)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(void 0!==tc[e])return void tc[e].push({onLoad:t,onProgress:n,onError:r});tc[e]=[],tc[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),s=this.mimeType,o=this.responseType;fetch(a).then(t=>{if(200===t.status||0===t.status){if(t.status,"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=tc[e],r=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),a=i?parseInt(i):0,s=0!==a;let o=0;const l=new ReadableStream({start(e){!function t(){r.read().then(({done:r,value:i})=>{if(r)e.close();else{o+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:o,total:a});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(i),t()}},t=>{e.error(t)})}()}});return new Response(l)}throw new nc(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,s));case"json":return e.json();default:if(""===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{$l.add(`file:${e}`,t);const n=tc[e];delete tc[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}}).catch(t=>{const n=tc[e];if(void 0===n)throw this.manager.itemError(e),t;delete tc[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const ic=new WeakMap;class ac extends ec{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=$l.get(`image:${e}`);if(void 0!==a){if(!0===a.complete)i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0);else{let e=ic.get(a);void 0===e&&(e=[],ic.set(a,e)),e.push({onLoad:t,onError:r})}return a}const s=on("img");function o(){c(),t&&t(this);const n=ic.get(this)||[];for(let e=0;e<n.length;e++){const t=n[e];t.onLoad&&t.onLoad(this)}ic.delete(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),$l.remove(`image:${e}`);const n=ic.get(this)||[];for(let e=0;e<n.length;e++){const r=n[e];r.onError&&r.onError(t)}ic.delete(this),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),$l.add(`image:${e}`,s),i.manager.itemStart(e),s.src=e,s}}class sc extends ec{constructor(e){super(e)}load(e,t,n,r){const i=new Xi;i.colorSpace=bt;const a=new ac(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let s=0;function o(n){a.load(e[n],function(e){i.images[n]=e,s++,6===s&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let l=0;l<e.length;++l)o(l);return i}}class oc extends ec{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new Na,s=new rc(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,function(e){let n;try{n=i.parse(e)}catch(s){if(void 0===r)return;r(s)}void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:ne,a.wrapT=void 0!==n.wrapT?n.wrapT:ne,a.magFilter=void 0!==n.magFilter?n.magFilter:oe,a.minFilter=void 0!==n.minFilter?n.minFilter:oe,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(a.colorSpace=n.colorSpace),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=ce),1===n.mipmapCount&&(a.minFilter=oe),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n)},n,r),a}}class lc extends Pr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Zr(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class cc extends lc{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Pr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Zr(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const uc=new rr,hc=new Kt,dc=new Kt;class pc{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jt(512,512),this.mapType=he,this.map=null,this.mapPass=null,this.matrix=new rr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Qa,this._frameExtents=new Jt(1,1),this._viewportCount=1,this._viewports=[new Tn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;hc.setFromMatrixPosition(e.matrixWorld),t.position.copy(hc),dc.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(dc),t.updateMatrixWorld(),uc.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(uc,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(uc)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class fc extends pc{constructor(){super(new ji(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=2*Ht*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}let mc=class extends lc{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Pr.DEFAULT_UP),this.updateMatrix(),this.target=new Pr,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new fc}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const gc=new rr,vc=new Kt,yc=new Kt;class _c extends pc{constructor(){super(new ji(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Jt(4,2),this._viewportCount=6,this._viewports=[new Tn(2,1,1,1),new Tn(0,1,1,1),new Tn(3,1,1,1),new Tn(1,1,1,1),new Tn(3,0,1,1),new Tn(1,0,1,1)],this._cubeDirections=[new Kt(1,0,0),new Kt(-1,0,0),new Kt(0,0,1),new Kt(0,0,-1),new Kt(0,1,0),new Kt(0,-1,0)],this._cubeUps=[new Kt(0,1,0),new Kt(0,1,0),new Kt(0,1,0),new Kt(0,1,0),new Kt(0,0,1),new Kt(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),vc.setFromMatrixPosition(e.matrixWorld),n.position.copy(vc),yc.copy(n.position),yc.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(yc),n.updateMatrixWorld(),r.makeTranslation(-vc.x,-vc.y,-vc.z),gc.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gc,n.coordinateSystem,n.reversedDepth)}}class xc extends lc{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new _c}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class bc extends zi{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,s=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,s,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class Sc extends pc{constructor(){super(new bc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Mc extends lc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Pr.DEFAULT_UP),this.updateMatrix(),this.target=new Pr,this.shadow=new Sc}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class wc extends lc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Tc extends lc{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Ec{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Kt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class Ac extends lc{constructor(e=new Ec,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Cc extends ec{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,a=new rc(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r&&r(a),i.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(e){return t[e],t[e]}const r=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new Zr).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(r.dispersion=e.dispersion),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const i in e.uniforms){const t=e.uniforms[i];switch(r.uniforms[i]={},t.type){case"t":r.uniforms[i].value=n(t.value);break;case"c":r.uniforms[i].value=(new Zr).setHex(t.value);break;case"v2":r.uniforms[i].value=(new Jt).fromArray(t.value);break;case"v3":r.uniforms[i].value=(new Kt).fromArray(t.value);break;case"v4":r.uniforms[i].value=(new Tn).fromArray(t.value);break;case"m3":r.uniforms[i].value=(new tn).fromArray(t.value);break;case"m4":r.uniforms[i].value=(new rr).fromArray(t.value);break;default:r.uniforms[i].value=t.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const i in e.extensions)r.extensions[i]=e.extensions[i];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new Jt).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Jt).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Cc.createMaterialFromType(e)}static createMaterialFromType(e){return new{ShadowMaterial:xl,SpriteMaterial:ra,RawShaderMaterial:bl,ShaderMaterial:ki,PointsMaterial:Os,MeshPhysicalMaterial:Ml,MeshStandardMaterial:Sl,MeshPhongMaterial:wl,MeshToonMaterial:Tl,MeshNormalMaterial:El,MeshLambertMaterial:Al,MeshDepthMaterial:Cl,MeshDistanceMaterial:Rl,MeshBasicMaterial:Qr,MeshMatcapMaterial:Pl,LineDashedMaterial:Il,LineBasicMaterial:Ss,Material:Kr}[e]}}class Rc{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Pc extends _i{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Ic extends ec{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new rc(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r&&r(a),i.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers,i=r[t],a=new Uint32Array(i).buffer;return n[t]=a,a}(e,i.buffer),s=sn(i.type,a),o=new ea(s,i.stride);return o.uuid=i.uuid,t[r]=o,o}const i=e.isInstancedBufferGeometry?new Pc:new _i,a=e.data.index;if(void 0!==a){const e=sn(a.type,a.array);i.setIndex(new li(e,1))}const s=e.data.attributes;for(const u in s){const t=s[u];let n;if(t.isInterleavedBufferAttribute){const i=r(e.data,t.data);n=new na(i,t.itemSize,t.offset,t.normalized)}else{const e=sn(t.type,t.array);n=new(t.isInstancedBufferAttribute?Fa:li)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),i.setAttribute(u,n)}const o=e.data.morphAttributes;if(o)for(const u in o){const t=o[u],n=[];for(let i=0,a=t.length;i<a;i++){const a=t[i];let s;if(a.isInterleavedBufferAttribute){const t=r(e.data,a.data);s=new na(t,a.itemSize,a.offset,a.normalized)}else{const e=sn(a.type,a.array);s=new li(e,a.itemSize,a.normalized)}void 0!==a.name&&(s.name=a.name),n.push(s)}i.morphAttributes[u]=n}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const e=l[u];i.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;return void 0!==c&&(i.boundingSphere=(new Yn).fromJSON(c)),e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}const Dc={UVMapping:Z,CubeReflectionMapping:J,CubeRefractionMapping:$,EquirectangularReflectionMapping:K,EquirectangularRefractionMapping:Q,CubeUVReflectionMapping:ee},Nc={RepeatWrapping:te,ClampToEdgeWrapping:ne,MirroredRepeatWrapping:re},Lc={NearestFilter:ie,NearestMipmapNearestFilter:ae,NearestMipmapLinearFilter:se,LinearFilter:oe,LinearMipmapNearestFilter:le,LinearMipmapLinearFilter:ce},Uc=new WeakMap;let Oc;class Fc{static getContext(){return void 0===Oc&&(Oc=new(window.AudioContext||window.webkitAudioContext)),Oc}static setContext(e){Oc=e}}const kc=new rr,zc=new rr,Bc=new rr;class Vc extends ji{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class Hc{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const jc=new Kt,Gc=new $t,Wc=new Kt,Xc=new Kt,qc=new Kt;class Yc extends Pr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return;if(!1===this.hasPlaybackControl)return;this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1!==this.hasPlaybackControl&&this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),"buffer"!==e.sourceType||(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice()),this}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Zc=new Kt,Jc=new $t,$c=new Kt,Kc=new Kt;class Qc{constructor(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)n[i+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){s.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){$t.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;$t.multiplyQuaternionsFlat(e,a,e,t,e,n),$t.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]*a+e[n+s]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const i=t+a;e[i]=e[i]+e[n+a]*r}}}const eu="\\[\\]\\.:\\/",tu=new RegExp("["+eu+"]","g"),nu="[^"+eu+"]",ru="[^"+eu.replace("\\.","")+"]",iu=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",nu)+/(WCOD+)?/.source.replace("WCOD",ru)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",nu)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",nu)+"$"),au=["material","materials","bones","map"];class su{constructor(e,t,n){this.path=t,this.parsedPath=n||su.parseTrackName(t),this.node=su.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new su.Composite(e,t,n):new su(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(tu,"")}static parseTrackName(e){const t=iu.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==au.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=su.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return;if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return;if(!e.material.materials)return;e=e.material.materials;break;case"bones":if(!e.skeleton)return;e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return;if(!e.material.map)return;e=e.material.map;break;default:if(void 0===e[n])return;e=e[n]}if(void 0!==r){if(void 0===e[r])return;e=e[r]}}const a=e[r];if(void 0===a){t.nodeName;return}let s=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?s=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return;if(!e.geometry.morphAttributes)return;void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}su.Composite=class{constructor(e,t,n){const r=n||su.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},su.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},su.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},su.prototype.GetterByBindingType=[su.prototype._getValue_direct,su.prototype._getValue_array,su.prototype._getValue_arrayElement,su.prototype._getValue_toArray],su.prototype.SetterByBindingTypeAndVersioning=[[su.prototype._setValue_direct,su.prototype._setValue_direct_setNeedsUpdate,su.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[su.prototype._setValue_array,su.prototype._setValue_array_setNeedsUpdate,su.prototype._setValue_array_setMatrixWorldNeedsUpdate],[su.prototype._setValue_arrayElement,su.prototype._setValue_arrayElement_setNeedsUpdate,su.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[su.prototype._setValue_fromArray,su.prototype._setValue_fromArray_setNeedsUpdate,su.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class ou{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,s=new Array(a),o={endingStart:mt,endingEnd:mt};for(let l=0;l!==a;++l){const e=i[l].createInterpolant(null);s[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),!0===n){const n=this._clip.duration,r=e._clip.duration,i=r/n,a=n/r;e.warp(1,i,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const o=s.parameterPositions,l=s.sampleValues;return o[0]=i,o[1]=i+n,l[0]=e/a,l[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;r<0||0===n?t=0:(this._startTime=null,t=n*r)}t*=this._updateTimeScale(e);const a=this._updateTime(t),s=this._updateWeight(e);if(s>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===_t)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(a),t[n].accumulateAdditive(s);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(a),t[n].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=2202===n;if(0===e)return-1===i||!a||1&~i?r:t-r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&!(1&~i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=gt,r.endingEnd=gt):(r.endingStart=e?this.zeroSlopeAtStart?gt:mt:vt,r.endingEnd=t?this.zeroSlopeAtEnd?gt:mt:vt)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const s=a.parameterPositions,o=a.sampleValues;return s[0]=i,o[0]=t,s[1]=i+e,o[1]=n,this}}const lu=new Float32Array(1);class cu{constructor(e){this.value=e}clone(){return new cu(void 0===this.value.clone?this.value:this.value.clone())}}let uu=0;const hu=new rr;class du{constructor(e,t,n=0,r=1/0){this.ray=new nr(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new fr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera&&(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t)}setFromXRController(e){return hu.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(hu),this}intersectObject(e,t=!0,n=[]){return fu(e,this,n,t),n.sort(pu),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)fu(e[r],this,n,t);return n.sort(pu),n}}function pu(e,t){return e.distance-t.distance}function fu(e,t,n,r){let i=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(i=!1)}if(!0===i&&!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)fu(r[e],t,n,!0)}}function mu(){!1===this._document.hidden&&this.reset()}class gu{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Gt(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Gt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class vu{constructor(e,t,n,r){vu.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}const yu=new Jt;const _u=new Kt,xu=new Kt,bu=new Kt,Su=new Kt,Mu=new Kt,wu=new Kt,Tu=new Kt;const Eu=new Kt;const Au=new Kt,Cu=new rr,Ru=new rr;function Pu(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push(...Pu(e.children[n]));return t}const Iu=new Kt,Du=new Zr,Nu=new Zr;const Lu=new Kt,Uu=new Kt,Ou=new Kt;const Fu=new Kt,ku=new zi;function zu(e,t,n,r,i,a,s){Fu.set(i,a,s).unproject(r);const o=t[e];if(void 0!==o){const e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],Fu.x,Fu.y,Fu.z)}}const Bu=new Pn;const Vu=new Kt;let Hu,ju;function Gu(e,t,n,r){const i=function(e){switch(e){case he:case de:return{byteLength:1,components:1};case fe:case pe:case ye:return{byteLength:2,components:1};case _e:case xe:return{byteLength:2,components:4};case ge:case me:case ve:return{byteLength:4,components:1};case Se:case Me:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(r);switch(n){case we:return e*t;case Re:case Pe:return e*t/i.components*i.byteLength;case Ie:case De:return e*t*2/i.components*i.byteLength;case Te:return e*t*3/i.components*i.byteLength;case Ee:case Ne:return e*t*4/i.components*i.byteLength;case Le:case Ue:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case Oe:case Fe:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case ze:case Ve:return Math.max(e,16)*Math.max(t,8)/4;case ke:case Be:return Math.max(e,8)*Math.max(t,8)/2;case He:case je:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case Ge:case We:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Xe:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case qe:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case Ye:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case Ze:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case Je:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case $e:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case Ke:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case Qe:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case et:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case tt:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case nt:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case rt:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case it:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case at:case st:case ot:return Math.ceil(e/4)*Math.ceil(t/4)*16;case lt:case ct:return Math.ceil(e/4)*Math.ceil(t/4)*8;case ut:case ht:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
function Wu(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Xu(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,a=r.byteLength,s=e.createBuffer();let o;if(e.bindBuffer(n,s),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)o=e.FLOAT;else if("undefined"!=typeof Float16Array&&r instanceof Float16Array)o=e.HALF_FLOAT;else if(r instanceof Uint16Array)o=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)o=e.SHORT;else if(r instanceof Uint32Array)o=e.UNSIGNED_INT;else if(r instanceof Int32Array)o=e.INT;else if(r instanceof Int8Array)o=e.BYTE;else if(r instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);o=e.UNSIGNED_BYTE}return{buffer:s,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,a=n.updateRanges;if(e.bindBuffer(r,t),0===a.length)e.bufferSubData(r,0,i);else{a.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<a.length;e++){const n=a[t],r=a[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,a[t]=r)}a.length=t+1;for(let n=0,s=a.length;n<s;n++){const t=a[n];e.bufferSubData(r,t.start*i.BYTES_PER_ELEMENT,i,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:m}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=m));const qu={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Yu={common:{diffuse:{value:new Zr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new tn},alphaMap:{value:null},alphaMapTransform:{value:new tn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new tn}},envmap:{envMap:{value:null},envMapRotation:{value:new tn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new tn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new tn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new tn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new tn},normalScale:{value:new Jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new tn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new tn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new tn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new tn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Zr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Zr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new tn},alphaTest:{value:0},uvTransform:{value:new tn}},sprite:{diffuse:{value:new Zr(16777215)},opacity:{value:1},center:{value:new Jt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new tn},alphaMap:{value:null},alphaMapTransform:{value:new tn},alphaTest:{value:0}}},Zu={basic:{uniforms:Ui([Yu.common,Yu.specularmap,Yu.envmap,Yu.aomap,Yu.lightmap,Yu.fog]),vertexShader:qu.meshbasic_vert,fragmentShader:qu.meshbasic_frag},lambert:{uniforms:Ui([Yu.common,Yu.specularmap,Yu.envmap,Yu.aomap,Yu.lightmap,Yu.emissivemap,Yu.bumpmap,Yu.normalmap,Yu.displacementmap,Yu.fog,Yu.lights,{emissive:{value:new Zr(0)}}]),vertexShader:qu.meshlambert_vert,fragmentShader:qu.meshlambert_frag},phong:{uniforms:Ui([Yu.common,Yu.specularmap,Yu.envmap,Yu.aomap,Yu.lightmap,Yu.emissivemap,Yu.bumpmap,Yu.normalmap,Yu.displacementmap,Yu.fog,Yu.lights,{emissive:{value:new Zr(0)},specular:{value:new Zr(1118481)},shininess:{value:30}}]),vertexShader:qu.meshphong_vert,fragmentShader:qu.meshphong_frag},standard:{uniforms:Ui([Yu.common,Yu.envmap,Yu.aomap,Yu.lightmap,Yu.emissivemap,Yu.bumpmap,Yu.normalmap,Yu.displacementmap,Yu.roughnessmap,Yu.metalnessmap,Yu.fog,Yu.lights,{emissive:{value:new Zr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:qu.meshphysical_vert,fragmentShader:qu.meshphysical_frag},toon:{uniforms:Ui([Yu.common,Yu.aomap,Yu.lightmap,Yu.emissivemap,Yu.bumpmap,Yu.normalmap,Yu.displacementmap,Yu.gradientmap,Yu.fog,Yu.lights,{emissive:{value:new Zr(0)}}]),vertexShader:qu.meshtoon_vert,fragmentShader:qu.meshtoon_frag},matcap:{uniforms:Ui([Yu.common,Yu.bumpmap,Yu.normalmap,Yu.displacementmap,Yu.fog,{matcap:{value:null}}]),vertexShader:qu.meshmatcap_vert,fragmentShader:qu.meshmatcap_frag},points:{uniforms:Ui([Yu.points,Yu.fog]),vertexShader:qu.points_vert,fragmentShader:qu.points_frag},dashed:{uniforms:Ui([Yu.common,Yu.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:qu.linedashed_vert,fragmentShader:qu.linedashed_frag},depth:{uniforms:Ui([Yu.common,Yu.displacementmap]),vertexShader:qu.depth_vert,fragmentShader:qu.depth_frag},normal:{uniforms:Ui([Yu.common,Yu.bumpmap,Yu.normalmap,Yu.displacementmap,{opacity:{value:1}}]),vertexShader:qu.meshnormal_vert,fragmentShader:qu.meshnormal_frag},sprite:{uniforms:Ui([Yu.sprite,Yu.fog]),vertexShader:qu.sprite_vert,fragmentShader:qu.sprite_frag},background:{uniforms:{uvTransform:{value:new tn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:qu.background_vert,fragmentShader:qu.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new tn}},vertexShader:qu.backgroundCube_vert,fragmentShader:qu.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:qu.cube_vert,fragmentShader:qu.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:qu.equirect_vert,fragmentShader:qu.equirect_frag},distanceRGBA:{uniforms:Ui([Yu.common,Yu.displacementmap,{referencePosition:{value:new Kt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:qu.distanceRGBA_vert,fragmentShader:qu.distanceRGBA_frag},shadow:{uniforms:Ui([Yu.lights,Yu.fog,{color:{value:new Zr(0)},opacity:{value:1}}]),vertexShader:qu.shadow_vert,fragmentShader:qu.shadow_frag}};Zu.physical={uniforms:Ui([Zu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new tn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new tn},clearcoatNormalScale:{value:new Jt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new tn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new tn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new tn},sheen:{value:0},sheenColor:{value:new Zr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new tn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new tn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new tn},transmissionSamplerSize:{value:new Jt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new tn},attenuationDistance:{value:0},attenuationColor:{value:new Zr(0)},specularColor:{value:new Zr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new tn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new tn},anisotropyVector:{value:new Jt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new tn}}]),vertexShader:qu.meshphysical_vert,fragmentShader:qu.meshphysical_frag};const Ju={r:0,b:0,g:0},$u=new pr,Ku=new rr;function Qu(e,t,n,r,i,a,s){const o=new Zr(0);let l,c,u=!0===a?0:1,h=null,d=0,p=null;function f(e){let r=!0===e.isScene?e.background:null;if(r&&r.isTexture){r=(e.backgroundBlurriness>0?n:t).get(r)}return r}function m(t,n){t.getRGB(Ju,Oi(e)),r.buffers.color.setClear(Ju.r,Ju.g,Ju.b,n,s)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),u=t,m(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,m(o,u)},render:function(t){let n=!1;const i=f(t);null===i?m(o,u):i&&i.isColor&&(m(i,1),n=!0);const a=e.xr.getEnvironmentBlendMode();"additive"===a?r.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===a&&r.buffers.color.setClear(0,0,0,0,s),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=f(n);r&&(r.isCubeTexture||r.mapping===ee)?(void 0===c&&(c=new Ii(new Ni(1,1,1),new ki({name:"BackgroundCubeMaterial",uniforms:Li(Zu.backgroundCube.uniforms),vertexShader:Zu.backgroundCube.vertexShader,fragmentShader:Zu.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),$u.copy(n.backgroundRotation),$u.x*=-1,$u.y*=-1,$u.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&($u.y*=-1,$u.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(Ku.makeRotationFromEuler($u)),c.material.toneMapped=fn.getTransfer(r.colorSpace)!==wt,h===r&&d===r.version&&p===e.toneMapping||(c.material.needsUpdate=!0,h=r,d=r.version,p=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new Ii(new cl(2,2),new ki({name:"BackgroundMaterial",uniforms:Li(Zu.background.uniforms),vertexShader:Zu.background.vertexShader,fragmentShader:Zu.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=fn.getTransfer(r.colorSpace)!==wt,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),h===r&&d===r.version&&p===e.toneMapping||(l.material.needsUpdate=!0,h=r,d=r.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function eh(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=c(null);let a=i,s=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],i=[];for(let a=0;a<n;a++)t[a]=0,r[a]=0,i[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function u(){const e=a.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function h(e){d(e,0)}function d(t,n){const r=a.newAttributes,i=a.enabledAttributes,s=a.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),s[t]!==n&&(e.vertexAttribDivisor(t,n),s[t]=n)}function p(){const t=a.newAttributes,n=a.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function f(t,n,r,i,a,s,o){!0===o?e.vertexAttribIPointer(t,n,r,a,s):e.vertexAttribPointer(t,n,r,i,a,s)}function m(){g(),s=!0,a!==i&&(a=i,o(a.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,m,g){let v=!1;const y=function(t,n,i){const a=!0===i.wireframe;let s=r[t.id];void 0===s&&(s={},r[t.id]=s);let o=s[n.id];void 0===o&&(o={},s[n.id]=o);let l=o[a];void 0===l&&(l=c(e.createVertexArray()),o[a]=l);return l}(m,l,i);a!==y&&(a=y,o(a.object)),v=function(e,t,n,r){const i=a.attributes,s=t.attributes;let o=0;const l=n.getAttributes();for(const a in l){if(l[a].location>=0){const t=i[a];let n=s[a];if(void 0===n&&("instanceMatrix"===a&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===a&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return a.attributesNum!==o||a.index!==r}(n,m,l,g),v&&function(e,t,n,r){const i={},s=t.attributes;let o=0;const l=n.getAttributes();for(const a in l){if(l[a].location>=0){let t=s[a];void 0===t&&("instanceMatrix"===a&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===a&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[a]=n,o++}}a.attributes=i,a.attributesNum=o,a.index=r}(n,m,l,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(v||s)&&(s=!1,function(n,r,i,a){u();const s=a.attributes,o=i.getAttributes(),l=r.defaultAttributeValues;for(const c in o){const r=o[c];if(r.location>=0){let i=s[c];if(void 0===i&&("instanceMatrix"===c&&n.instanceMatrix&&(i=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(i=n.instanceColor)),void 0!==i){const s=i.normalized,o=i.itemSize,l=t.get(i);if(void 0===l)continue;const c=l.buffer,u=l.type,p=l.bytesPerElement,m=u===e.INT||u===e.UNSIGNED_INT||i.gpuType===me;if(i.isInterleavedBufferAttribute){const t=i.data,l=t.stride,g=i.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)d(r.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<r.locationSize;e++)h(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)f(r.location+e,o/r.locationSize,u,s,l*p,(g+o/r.locationSize*e)*p,m)}else{if(i.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)d(r.location+e,i.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let e=0;e<r.locationSize;e++)h(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)f(r.location+e,o/r.locationSize,u,s,o*p,o/r.locationSize*e*p,m)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(r.location,t);break;case 3:e.vertexAttrib3fv(r.location,t);break;case 4:e.vertexAttrib4fv(r.location,t);break;default:e.vertexAttrib1fv(r.location,t)}}}}p()}(n,i,l,m),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)l(i[e].object),delete i[e];delete n[e.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:p}}function th(e,t,n){let r;function i(t,i,a){0!==a&&(e.drawArraysInstanced(r,t,i,a),n.update(i,r,a))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,a);let s=0;for(let t=0;t<a;t++)s+=i[t];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,a,s,o){if(0===s)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],a[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,a,0,o,0,s);let t=0;for(let e=0;e<s;e++)t+=a[e]*o[e];n.update(t,r,1)}}}function nh(e,t,n,r){let i;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==n.precision?n.precision:"highp";const o=a(s);o!==s&&(s=o);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,textureFormatReadable:function(t){return t===Ee||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===ye&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==he&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==ve&&!i)},precision:s,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:h>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function rh(e){const t=this;let n=null,r=0,i=!1,a=!1;const s=new Za,o=new tn,l={value:null,needsUpdate:!1};function c(e,n,r,i){const a=null!==e?e.length:0;let c=null;if(0!==a){if(c=l.value,!0!==i||null===c){const t=r+4*a,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=r;n!==a;++n,l+=4)s.copy(e[n]).applyMatrix4(i,o),s.normal.toArray(c,l),c[l+3]=s.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(s,o,u){const h=s.clippingPlanes,d=s.clipIntersection,p=s.clipShadows,f=e.get(s);if(!i||null===h||0===h.length||a&&!p)a?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{const e=a?0:r,t=4*e;let i=f.clippingState||null;l.value=i,i=c(h,o,t,u);for(let r=0;r!==t;++r)i[r]=n[r];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function ih(e){let t=new WeakMap;function n(e,t){return t===K?e.mapping=J:t===Q&&(e.mapping=$),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping;if(a===K||a===Q){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const a=i.image;if(a&&a.height>0){const s=new qi(a.height);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}const ah=[.125,.215,.35,.446,.526,.582],sh=20,oh=new bc,lh=new Zr;let ch=null,uh=0,hh=0,dh=!1;const ph=(1+Math.sqrt(5))/2,fh=1/ph,mh=[new Kt(-ph,fh,0),new Kt(ph,fh,0),new Kt(-fh,0,ph),new Kt(fh,0,ph),new Kt(0,ph,-fh),new Kt(0,ph,fh),new Kt(-1,1,-1),new Kt(1,1,-1),new Kt(-1,1,1),new Kt(1,1,1)],gh=new Kt;class vh{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:s=gh}=i;ch=this._renderer.getRenderTarget(),uh=this._renderer.getActiveCubeFace(),hh=this._renderer.getActiveMipmapLevel(),dh=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,r,o,s),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=bh(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=xh(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ch,uh,hh),this._renderer.xr.enabled=dh,e.scissorTest=!1,_h(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===J||e.mapping===$?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ch=this._renderer.getRenderTarget(),uh=this._renderer.getActiveCubeFace(),hh=this._renderer.getActiveMipmapLevel(),dh=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:oe,minFilter:oe,generateMipmaps:!1,type:ye,format:Ee,colorSpace:St,depthBuffer:!1},r=yh(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=yh(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const a=e-4+1+ah.length;for(let s=0;s<a;s++){const a=Math.pow(2,i);n.push(a);let o=1/a;s>e-4?o=ah[s-e+4-1]:0===s&&(o=0),r.push(o);const l=1/(a-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*d),y=new Float32Array(m*p*d),_=new Float32Array(g*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,f*p*e),y.set(h,m*p*e);const i=[e,e,e,e,e,e];_.set(i,g*p*e)}const x=new _i;x.setAttribute("position",new li(v,f)),x.setAttribute("uv",new li(y,m)),x.setAttribute("faceIndex",new li(_,g)),t.push(x),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(sh),i=new Kt(0,1,0),a=new ki({name:"SphericalGaussianBlur",defines:{n:sh,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Sh(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return a}(r,e,t)}return r}_compileMaterial(e){const t=new Ii(this._lodPlanes[0],e);this._renderer.compile(t,oh)}_sceneToCubeUV(e,t,n,r,i){const a=new ji(90,1,t,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(lh),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(r),l.clearDepth(),l.setRenderTarget(null));const h=new Qr({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),d=new Ii(new Ni,h);let p=!1;const f=e.background;f?f.isColor&&(h.color.copy(f),e.background=null,p=!0):(h.color.copy(lh),p=!0);for(let m=0;m<6;m++){const t=m%3;0===t?(a.up.set(0,s[m],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+o[m],i.y,i.z)):1===t?(a.up.set(0,0,s[m]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+o[m],i.z)):(a.up.set(0,s[m],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+o[m]));const n=this._cubeSize;_h(r,t*n,m>2?n:0,n,n),l.setRenderTarget(r),p&&l.render(d,a),l.render(e,a)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=u,l.autoClear=c,e.background=f}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===J||e.mapping===$;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=bh()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=xh());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new Ii(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const s=this._cubeSize;_h(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,oh)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=mh[(r-i-1)%mh.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,s){const o=this._renderer,l=this._blurMaterial,c=new Ii(this._lodPlanes[r],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,p=i/d,f=isFinite(i)?1+Math.floor(3*p):sh,m=[];let g=0;for(let _=0;_<sh;++_){const e=_/p,t=Math.exp(-e*e/2);m.push(t),0===_?g+=t:_<f&&(g+=2*t)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===a,s&&(u.poleAxis.value=s);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const y=this._sizeLods[r];_h(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,oh)}}function yh(e,t,n){const r=new An(e,t,n);return r.texture.mapping=ee,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function _h(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function xh(){return new ki({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Sh(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function bh(){return new ki({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Sh(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Sh(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Mh(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,s=a===K||a===Q,o=a===J||a===$;if(s||o){let a=t.get(i);const l=void 0!==a?a.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new vh(e)),a=s?n.fromEquirectangular(i,a):n.fromCubemap(i,a),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),a.texture;if(void 0!==a)return a.texture;{const l=i.image;return s&&l&&l.height>0||o&&l&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(l)?(null===n&&(n=new vh(e)),a=s?n.fromEquirectangular(i):n.fromCubemap(i),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),i.addEventListener("dispose",r),a.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function wh(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&un("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Th(e,t,n,r){const i={},a=new WeakMap;function s(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",s),delete i[o.id];const l=a.get(o);l&&(t.remove(l),a.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{if(void 0===i)return;{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const o=new(rn(n)?ui:ci)(n,1);o.version=s;const l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const i in r)t.update(r[i],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return a.get(e)}}}function Eh(e,t,n){let r,i,a;function s(t,s,o){0!==o&&(e.drawElementsInstanced(r,s,i,t*a,o),n.update(s,r,o))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,s){e.drawElements(r,s,i,t*a),n.update(s,r,1)},this.renderInstances=s,this.renderMultiDraw=function(e,a,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,a,0,i,e,0,s);let o=0;for(let t=0;t<s;t++)o+=a[t];n.update(o,r,1)},this.renderMultiDrawInstances=function(e,o,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)s(e[t]/a,o[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(r,o,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e]*c[e];n.update(t,r,1)}}}function Ah(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n}}}}function Ch(e,t,n){const r=new WeakMap,i=new Tn;return{update:function(a,s,o){const l=a.morphTargetInfluences,c=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,u=void 0!==c?c.length:0;let h=r.get(s);if(void 0===h||h.count!==u){let e=function(){v.dispose(),r.delete(s),s.removeEventListener("dispose",e)};void 0!==h&&h.texture.dispose();const n=void 0!==s.morphAttributes.position,a=void 0!==s.morphAttributes.normal,o=void 0!==s.morphAttributes.color,l=s.morphAttributes.position||[],c=s.morphAttributes.normal||[],d=s.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===a&&(p=2),!0===o&&(p=3);let f=s.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);const g=new Float32Array(f*m*4*u),v=new Cn(g,f,m,u);v.type=ve,v.needsUpdate=!0;const y=4*p;for(let t=0;t<u;t++){const e=l[t],r=c[t],s=d[t],u=f*m*4*t;for(let t=0;t<e.count;t++){const l=t*y;!0===n&&(i.fromBufferAttribute(e,t),g[u+l+0]=i.x,g[u+l+1]=i.y,g[u+l+2]=i.z,g[u+l+3]=0),!0===a&&(i.fromBufferAttribute(r,t),g[u+l+4]=i.x,g[u+l+5]=i.y,g[u+l+6]=i.z,g[u+l+7]=0),!0===o&&(i.fromBufferAttribute(s,t),g[u+l+8]=i.x,g[u+l+9]=i.y,g[u+l+10]=i.z,g[u+l+11]=4===s.itemSize?i.w:1)}}h={count:u,texture:v,size:new Jt(f,m)},r.set(s,h),s.addEventListener("dispose",e)}if(!0===a.isInstancedMesh&&null!==a.morphTexture)o.getUniforms().setValue(e,"morphTexture",a.morphTexture,n);else{let t=0;for(let e=0;e<l.length;e++)t+=l[e];const n=s.morphTargetsRelative?1:1-t;o.getUniforms().setValue(e,"morphTargetBaseInfluence",n),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),o.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function Rh(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(s){const o=r.render.frame,l=s.geometry,c=t.get(s,l);if(i.get(c)!==o&&(t.update(c),i.set(c,o)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",a)&&s.addEventListener("dispose",a),i.get(s)!==o&&(n.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&n.update(s.instanceColor,e.ARRAY_BUFFER),i.set(s,o))),s.isSkinnedMesh){const e=s.skeleton;i.get(e)!==o&&(e.update(),i.set(e,o))}return c},dispose:function(){i=new WeakMap}}}const Ph=new wn,Ih=new Ws(1,1),Dh=new Cn,Nh=new Rn,Lh=new Xi,Uh=[],Oh=[],Fh=new Float32Array(16),kh=new Float32Array(9),zh=new Float32Array(4);function Bh(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=Uh[i];if(void 0===a&&(a=new Float32Array(i),Uh[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function Vh(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Hh(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function jh(e,t){let n=Oh[t];void 0===n&&(n=new Int32Array(t),Oh[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Gh(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Wh(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Vh(n,t))return;e.uniform2fv(this.addr,t),Hh(n,t)}}function Xh(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Vh(n,t))return;e.uniform3fv(this.addr,t),Hh(n,t)}}function qh(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Vh(n,t))return;e.uniform4fv(this.addr,t),Hh(n,t)}}function Yh(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Vh(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Hh(n,t)}else{if(Vh(n,r))return;zh.set(r),e.uniformMatrix2fv(this.addr,!1,zh),Hh(n,r)}}function Zh(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Vh(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Hh(n,t)}else{if(Vh(n,r))return;kh.set(r),e.uniformMatrix3fv(this.addr,!1,kh),Hh(n,r)}}function Jh(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Vh(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Hh(n,t)}else{if(Vh(n,r))return;Fh.set(r),e.uniformMatrix4fv(this.addr,!1,Fh),Hh(n,r)}}function $h(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Kh(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Vh(n,t))return;e.uniform2iv(this.addr,t),Hh(n,t)}}function Qh(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Vh(n,t))return;e.uniform3iv(this.addr,t),Hh(n,t)}}function ed(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Vh(n,t))return;e.uniform4iv(this.addr,t),Hh(n,t)}}function td(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function nd(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Vh(n,t))return;e.uniform2uiv(this.addr,t),Hh(n,t)}}function rd(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Vh(n,t))return;e.uniform3uiv(this.addr,t),Hh(n,t)}}function id(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Vh(n,t))return;e.uniform4uiv(this.addr,t),Hh(n,t)}}function ad(e,t,n){const r=this.cache,i=n.allocateTextureUnit();let a;r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),this.type===e.SAMPLER_2D_SHADOW?(Ih.compareFunction=515,a=Ih):a=Ph,n.setTexture2D(t||a,i)}function sd(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Nh,i)}function od(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||Lh,i)}function ld(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Dh,i)}function cd(e,t){e.uniform1fv(this.addr,t)}function ud(e,t){const n=Bh(t,this.size,2);e.uniform2fv(this.addr,n)}function hd(e,t){const n=Bh(t,this.size,3);e.uniform3fv(this.addr,n)}function dd(e,t){const n=Bh(t,this.size,4);e.uniform4fv(this.addr,n)}function pd(e,t){const n=Bh(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function fd(e,t){const n=Bh(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function md(e,t){const n=Bh(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function gd(e,t){e.uniform1iv(this.addr,t)}function vd(e,t){e.uniform2iv(this.addr,t)}function yd(e,t){e.uniform3iv(this.addr,t)}function _d(e,t){e.uniform4iv(this.addr,t)}function xd(e,t){e.uniform1uiv(this.addr,t)}function bd(e,t){e.uniform2uiv(this.addr,t)}function Sd(e,t){e.uniform3uiv(this.addr,t)}function Md(e,t){e.uniform4uiv(this.addr,t)}function wd(e,t,n){const r=this.cache,i=t.length,a=jh(n,i);Vh(r,a)||(e.uniform1iv(this.addr,a),Hh(r,a));for(let s=0;s!==i;++s)n.setTexture2D(t[s]||Ph,a[s])}function Td(e,t,n){const r=this.cache,i=t.length,a=jh(n,i);Vh(r,a)||(e.uniform1iv(this.addr,a),Hh(r,a));for(let s=0;s!==i;++s)n.setTexture3D(t[s]||Nh,a[s])}function Ed(e,t,n){const r=this.cache,i=t.length,a=jh(n,i);Vh(r,a)||(e.uniform1iv(this.addr,a),Hh(r,a));for(let s=0;s!==i;++s)n.setTextureCube(t[s]||Lh,a[s])}function Ad(e,t,n){const r=this.cache,i=t.length,a=jh(n,i);Vh(r,a)||(e.uniform1iv(this.addr,a),Hh(r,a));for(let s=0;s!==i;++s)n.setTexture2DArray(t[s]||Dh,a[s])}class Cd{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return Gh;case 35664:return Wh;case 35665:return Xh;case 35666:return qh;case 35674:return Yh;case 35675:return Zh;case 35676:return Jh;case 5124:case 35670:return $h;case 35667:case 35671:return Kh;case 35668:case 35672:return Qh;case 35669:case 35673:return ed;case 5125:return td;case 36294:return nd;case 36295:return rd;case 36296:return id;case 35678:case 36198:case 36298:case 36306:case 35682:return ad;case 35679:case 36299:case 36307:return sd;case 35680:case 36300:case 36308:case 36293:return od;case 36289:case 36303:case 36311:case 36292:return ld}}(t.type)}}class Rd{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return cd;case 35664:return ud;case 35665:return hd;case 35666:return dd;case 35674:return pd;case 35675:return fd;case 35676:return md;case 5124:case 35670:return gd;case 35667:case 35671:return vd;case 35668:case 35672:return yd;case 35669:case 35673:return _d;case 5125:return xd;case 36294:return bd;case 36295:return Sd;case 36296:return Md;case 35678:case 36198:case 36298:case 36306:case 35682:return wd;case 35679:case 36299:case 36307:return Td;case 35680:case 36300:case 36308:case 36293:return Ed;case 36289:case 36303:case 36311:case 36292:return Ad}}(t.type)}}class Pd{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const Id=/(\w+)(\])?(\[|\.)?/g;function Dd(e,t){e.seq.push(t),e.map[t.id]=t}function Nd(e,t,n){const r=e.name,i=r.length;for(Id.lastIndex=0;;){const a=Id.exec(r),s=Id.lastIndex;let o=a[1];const l="]"===a[2],c=a[3];if(l&&(o|=0),void 0===c||"["===c&&s+2===i){Dd(n,void 0===c?new Cd(o,e,t):new Rd(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new Pd(o),Dd(n,e)),n=e}}}class Ld{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);Nd(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Ud(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let Od=0;const Fd=new tn;function kd(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let s=i;s<a;s++){const e=s+1;r.push(`${e===t?">":" "} ${e}: ${n[s]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function zd(e,t){const n=function(e){fn._getMatrix(Fd,fn.workingColorSpace,e);const t=`mat3( ${Fd.elements.map(e=>e.toFixed(4))} )`;switch(fn.getTransfer(e)){case Mt:return[t,"LinearTransferOETF"];case wt:return[t,"sRGBTransferOETF"];default:return[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function Bd(e,t){let n;switch(t){case 1:default:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Vd=new Kt;function Hd(){fn.getLuminanceCoefficients(Vd);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${Vd.x.toFixed(4)}, ${Vd.y.toFixed(4)}, ${Vd.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function jd(e){return""!==e}function Gd(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Wd(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Xd=/^[ \t]*#include +<([\w\d./]+)>/gm;function qd(e){return e.replace(Xd,Zd)}const Yd=new Map;function Zd(e,t){let n=qu[t];if(void 0===n){const e=Yd.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=qu[e]}return qd(n)}const Jd=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function $d(e){return e.replace(Jd,Kd)}function Kd(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Qd(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function ep(e,t,n,r){const i=e.getContext(),a=n.defines;let s=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case J:case $:t="ENVMAP_TYPE_CUBE";break;case ee:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===$&&(t="ENVMAP_MODE_REFRACTION");return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),d=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),p=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(jd).join("\n")}(n),f=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),m=i.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(jd).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(jd).join("\n"),v.length>0&&(v+="\n")):(g=[Qd(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(jd).join("\n"),v=[Qd(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?qu.tonemapping_pars_fragment:"",0!==n.toneMapping?Bd("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",qu.colorspace_pars_fragment,zd("linearToOutputTexel",n.outputColorSpace),Hd(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(jd).join("\n")),s=qd(s),s=Gd(s,n),s=Wd(s,n),o=qd(o),o=Gd(o,n),o=Wd(o,n),s=$d(s),o=$d(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===Ut?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Ut?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+s,x=y+v+o,b=Ud(i,i.VERTEX_SHADER,_),S=Ud(i,i.FRAGMENT_SHADER,x);function M(t){if(e.debug.checkShaderErrors){const n=i.getProgramInfoLog(m)||"",r=i.getShaderInfoLog(b)||"",a=i.getShaderInfoLog(S)||"",s=n.trim(),o=r.trim(),l=a.trim();let c=!0,u=!0;if(!1===i.getProgramParameter(m,i.LINK_STATUS))if(c=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(i,m,b,S);else{kd(i,b,"vertex"),kd(i,S,"fragment")}else""!==s||""!==o&&""!==l||(u=!1);u&&(t.diagnostics={runnable:c,programLog:s,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}i.deleteShader(b),i.deleteShader(S),w=new Ld(i,m),T=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let s=1;r.type===e.FLOAT_MAT2&&(s=2),r.type===e.FLOAT_MAT3&&(s=3),r.type===e.FLOAT_MAT4&&(s=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:s}}return n}(i,m)}let w,T;i.attachShader(m,b),i.attachShader(m,S),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),this.getUniforms=function(){return void 0===w&&M(this),w},this.getAttributes=function(){return void 0===T&&M(this),T};let E=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===E&&(E=i.getProgramParameter(m,37297)),E},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Od++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=S,this}let tp=0;class np{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new rp(e),t.set(e,n)),n}}class rp{constructor(e){this.id=tp++,this.code=e,this.usedTimes=0}}function ip(e,t,n,r,i,a,s){const o=new fr,l=new np,c=new Set,u=[],h=i.logarithmicDepthBuffer,d=i.vertexTextures;let p=i.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return c.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(a,o,u,g,v){const y=g.fog,_=v.geometry,x=a.isMeshStandardMaterial?g.environment:null,b=(a.isMeshStandardMaterial?n:t).get(a.envMap||x),S=b&&b.mapping===ee?b.image.height:null,M=f[a.type];null!==a.precision&&(p=i.getMaxPrecision(a.precision),a.precision);const w=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,T=void 0!==w?w.length:0;let E,A,C,R,P=0;if(void 0!==_.morphAttributes.position&&(P=1),void 0!==_.morphAttributes.normal&&(P=2),void 0!==_.morphAttributes.color&&(P=3),M){const e=Zu[M];E=e.vertexShader,A=e.fragmentShader}else E=a.vertexShader,A=a.fragmentShader,l.update(a),C=l.getVertexShaderID(a),R=l.getFragmentShaderID(a);const I=e.getRenderTarget(),D=e.state.buffers.depth.getReversed(),N=!0===v.isInstancedMesh,L=!0===v.isBatchedMesh,U=!!a.map,O=!!a.matcap,F=!!b,k=!!a.aoMap,z=!!a.lightMap,B=!!a.bumpMap,V=!!a.normalMap,H=!!a.displacementMap,j=!!a.emissiveMap,G=!!a.metalnessMap,W=!!a.roughnessMap,X=a.anisotropy>0,q=a.clearcoat>0,Y=a.dispersion>0,Z=a.iridescence>0,J=a.sheen>0,$=a.transmission>0,K=X&&!!a.anisotropyMap,Q=q&&!!a.clearcoatMap,te=q&&!!a.clearcoatNormalMap,ne=q&&!!a.clearcoatRoughnessMap,re=Z&&!!a.iridescenceMap,ie=Z&&!!a.iridescenceThicknessMap,ae=J&&!!a.sheenColorMap,se=J&&!!a.sheenRoughnessMap,oe=!!a.specularMap,le=!!a.specularColorMap,ce=!!a.specularIntensityMap,ue=$&&!!a.transmissionMap,he=$&&!!a.thicknessMap,de=!!a.gradientMap,pe=!!a.alphaMap,fe=a.alphaTest>0,me=!!a.alphaHash,ge=!!a.extensions;let ve=0;a.toneMapped&&(null!==I&&!0!==I.isXRRenderTarget||(ve=e.toneMapping));const ye={shaderID:M,shaderType:a.type,shaderName:a.name,vertexShader:E,fragmentShader:A,defines:a.defines,customVertexShaderID:C,customFragmentShaderID:R,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:p,batching:L,batchingColor:L&&null!==v._colorsTexture,instancing:N,instancingColor:N&&null!==v.instanceColor,instancingMorph:N&&null!==v.morphTexture,supportsVertexTextures:d,outputColorSpace:null===I?e.outputColorSpace:!0===I.isXRRenderTarget?I.texture.colorSpace:St,alphaToCoverage:!!a.alphaToCoverage,map:U,matcap:O,envMap:F,envMapMode:F&&b.mapping,envMapCubeUVHeight:S,aoMap:k,lightMap:z,bumpMap:B,normalMap:V,displacementMap:d&&H,emissiveMap:j,normalMapObjectSpace:V&&1===a.normalMapType,normalMapTangentSpace:V&&0===a.normalMapType,metalnessMap:G,roughnessMap:W,anisotropy:X,anisotropyMap:K,clearcoat:q,clearcoatMap:Q,clearcoatNormalMap:te,clearcoatRoughnessMap:ne,dispersion:Y,iridescence:Z,iridescenceMap:re,iridescenceThicknessMap:ie,sheen:J,sheenColorMap:ae,sheenRoughnessMap:se,specularMap:oe,specularColorMap:le,specularIntensityMap:ce,transmission:$,transmissionMap:ue,thicknessMap:he,gradientMap:de,opaque:!1===a.transparent&&1===a.blending&&!1===a.alphaToCoverage,alphaMap:pe,alphaTest:fe,alphaHash:me,combine:a.combine,mapUv:U&&m(a.map.channel),aoMapUv:k&&m(a.aoMap.channel),lightMapUv:z&&m(a.lightMap.channel),bumpMapUv:B&&m(a.bumpMap.channel),normalMapUv:V&&m(a.normalMap.channel),displacementMapUv:H&&m(a.displacementMap.channel),emissiveMapUv:j&&m(a.emissiveMap.channel),metalnessMapUv:G&&m(a.metalnessMap.channel),roughnessMapUv:W&&m(a.roughnessMap.channel),anisotropyMapUv:K&&m(a.anisotropyMap.channel),clearcoatMapUv:Q&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:te&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ne&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:re&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:ae&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:se&&m(a.sheenRoughnessMap.channel),specularMapUv:oe&&m(a.specularMap.channel),specularColorMapUv:le&&m(a.specularColorMap.channel),specularIntensityMapUv:ce&&m(a.specularIntensityMap.channel),transmissionMapUv:ue&&m(a.transmissionMap.channel),thicknessMapUv:he&&m(a.thicknessMap.channel),alphaMapUv:pe&&m(a.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(V||X),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!_.attributes.uv&&(U||pe),fog:!!y,useFog:!0===a.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===a.flatShading&&!1===a.wireframe,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:h,reversedDepthBuffer:D,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:T,morphTextureStride:P,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:ve,decodeVideoTexture:U&&!0===a.map.isVideoTexture&&fn.getTransfer(a.map.colorSpace)===wt,decodeVideoTextureEmissive:j&&!0===a.emissiveMap.isVideoTexture&&fn.getTransfer(a.emissiveMap.colorSpace)===wt,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:ge&&!0===a.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ge&&!0===a.extensions.multiDraw||L)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return ye.vertexUv1s=c.has(1),ye.vertexUv2s=c.has(2),ye.vertexUv3s=c.has(3),c.clear(),ye},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.supportsVertexTextures&&o.enable(0);t.instancing&&o.enable(1);t.instancingColor&&o.enable(2);t.instancingMorph&&o.enable(3);t.matcap&&o.enable(4);t.envMap&&o.enable(5);t.normalMapObjectSpace&&o.enable(6);t.normalMapTangentSpace&&o.enable(7);t.clearcoat&&o.enable(8);t.iridescence&&o.enable(9);t.alphaTest&&o.enable(10);t.vertexColors&&o.enable(11);t.vertexAlphas&&o.enable(12);t.vertexUv1s&&o.enable(13);t.vertexUv2s&&o.enable(14);t.vertexUv3s&&o.enable(15);t.vertexTangents&&o.enable(16);t.anisotropy&&o.enable(17);t.alphaHash&&o.enable(18);t.batching&&o.enable(19);t.dispersion&&o.enable(20);t.batchingColor&&o.enable(21);t.gradientMap&&o.enable(22);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.reversedDepthBuffer&&o.enable(4);t.skinning&&o.enable(5);t.morphTargets&&o.enable(6);t.morphNormals&&o.enable(7);t.morphColors&&o.enable(8);t.premultipliedAlpha&&o.enable(9);t.shadowMapEnabled&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);t.decodeVideoTexture&&o.enable(19);t.decodeVideoTextureEmissive&&o.enable(20);t.alphaToCoverage&&o.enable(21);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=f[e.type];let n;if(t){const e=Zu[t];n=Fi.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,i=u.length;e<i;e++){const t=u[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new ep(e,n,t,a),u.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function ap(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function sp(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function op(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function lp(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,s,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,o,l,c){const u=a(e,t,s,o,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)},unshift:function(e,t,s,o,l,c){const u=a(e,t,s,o,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||sp),r.length>1&&r.sort(t||op),i.length>1&&i.sort(t||op)}}}function cp(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new lp,e.set(t,[i])):n>=r.length?(i=new lp,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function up(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Kt,color:new Zr};break;case"SpotLight":n={position:new Kt,direction:new Kt,color:new Zr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Kt,color:new Zr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Kt,skyColor:new Zr,groundColor:new Zr};break;case"RectAreaLight":n={color:new Zr,position:new Kt,halfWidth:new Kt,halfHeight:new Kt}}return e[t.id]=n,n}}}let hp=0;function dp(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function pp(e){const t=new up,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)r.probe.push(new Kt);const i=new Kt,a=new rr,s=new rr;return{setup:function(i){let a=0,s=0,o=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,v=0,y=0;i.sort(dp);for(let e=0,x=i.length;e<x;e++){const _=i[e],x=_.color,b=_.intensity,S=_.distance,M=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)a+=x.r*b,s+=x.g*b,o+=x.b*b;else if(_.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(_.sh.coefficients[e],b);y++}else if(_.isDirectionalLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[l]=t,r.directionalShadowMap[l]=M,r.directionalShadowMatrix[l]=_.shadow.matrix,p++}r.directional[l]=e,l++}else if(_.isSpotLight){const e=t.get(_);e.position.setFromMatrixPosition(_.matrixWorld),e.color.copy(x).multiplyScalar(b),e.distance=S,e.coneCos=Math.cos(_.angle),e.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),e.decay=_.decay,r.spot[u]=e;const i=_.shadow;if(_.map&&(r.spotLightMap[g]=_.map,g++,i.updateMatrices(_),_.castShadow&&v++),r.spotLightMatrix[u]=i.matrix,_.castShadow){const e=n.get(_);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,r.spotShadow[u]=e,r.spotShadowMap[u]=M,m++}u++}else if(_.isRectAreaLight){const e=t.get(_);e.color.copy(x).multiplyScalar(b),e.halfWidth.set(.5*_.width,0,0),e.halfHeight.set(0,.5*_.height,0),r.rectArea[h]=e,h++}else if(_.isPointLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),e.distance=_.distance,e.decay=_.decay,_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[c]=t,r.pointShadowMap[c]=M,r.pointShadowMatrix[c]=_.shadow.matrix,f++}r.point[c]=e,c++}else if(_.isHemisphereLight){const e=t.get(_);e.skyColor.copy(_.color).multiplyScalar(b),e.groundColor.copy(_.groundColor).multiplyScalar(b),r.hemi[d]=e,d++}}h>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=Yu.LTC_FLOAT_1,r.rectAreaLTC2=Yu.LTC_FLOAT_2):(r.rectAreaLTC1=Yu.LTC_HALF_1,r.rectAreaLTC2=Yu.LTC_HALF_2)),r.ambient[0]=a,r.ambient[1]=s,r.ambient[2]=o;const _=r.hash;_.directionalLength===l&&_.pointLength===c&&_.spotLength===u&&_.rectAreaLength===h&&_.hemiLength===d&&_.numDirectionalShadows===p&&_.numPointShadows===f&&_.numSpotShadows===m&&_.numSpotMaps===g&&_.numLightProbes===y||(r.directional.length=l,r.spot.length=u,r.rectArea.length=h,r.point.length=c,r.hemi.length=d,r.directionalShadow.length=p,r.directionalShadowMap.length=p,r.pointShadow.length=f,r.pointShadowMap.length=f,r.spotShadow.length=m,r.spotShadowMap.length=m,r.directionalShadowMatrix.length=p,r.pointShadowMatrix.length=f,r.spotLightMatrix.length=m+g-v,r.spotLightMap.length=g,r.numSpotLightShadowsWithMaps=v,r.numLightProbes=y,_.directionalLength=l,_.pointLength=c,_.spotLength=u,_.rectAreaLength=h,_.hemiLength=d,_.numDirectionalShadows=p,_.numPointShadows=f,_.numSpotShadows=m,_.numSpotMaps=g,_.numLightProbes=y,r.version=hp++)},setupView:function(e,t){let n=0,o=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){const t=e[d];if(t.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),i.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),i.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),s.identity(),a.copy(t.matrixWorld),a.premultiply(h),s.extractRotation(a),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(t.isPointLight){const e=r.point[o];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o++}else if(t.isHemisphereLight){const e=r.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:r}}function fp(e){const t=new pp(e),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function mp(e){let t=new WeakMap;return{get:function(n,r=0){const i=t.get(n);let a;return void 0===i?(a=new fp(e),t.set(n,[a])):r>=i.length?(a=new fp(e),i.push(a)):a=i[r],a},dispose:function(){t=new WeakMap}}}function gp(e,t,n){let r=new Qa;const i=new Jt,a=new Jt,s=new Tn,o=new Cl({depthPacking:3201}),l=new Rl,c={},u=n.maxTextureSize,h={[y]:1,[_]:0,[x]:2},d=new ki({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Jt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new _i;f.setAttribute("position",new li(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Ii(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let v=this.type;function b(n,r){const a=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new An(i.x,i.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,p,m,null)}function S(t,n,r,i){let a=null;const s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)a=s;else if(a=!0===r.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=a.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=a.clone(),r[t]=i,n.addEventListener("dispose",w)),a=i}if(a.visible=n.visible,a.wireframe=n.wireframe,a.side=3===i?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],a.alphaMap=n.alphaMap,a.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial){e.properties.get(a).light=r}return a}function M(n,i,a,s,o){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),l=n.material;if(Array.isArray(l)){const t=r.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],h=l[u.materialIndex];if(h&&h.visible){const t=S(n,h,s,o);n.onBeforeShadow(e,n,i,a,r,t,u),e.renderBufferDirect(a,null,r,t,n,u),n.onAfterShadow(e,n,i,a,r,t,u)}}}else if(l.visible){const t=S(n,l,s,o);n.onBeforeShadow(e,n,i,a,r,t,null),e.renderBufferDirect(a,null,r,t,n,null),n.onAfterShadow(e,n,i,a,r,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)M(l[e],i,a,s,o)}function w(e){e.target.removeEventListener("dispose",w);for(const t in c){const n=c[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),!0===d.buffers.depth.getReversed()?d.buffers.color.setClear(0,0,0,0):d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=3!==v&&3===this.type,f=3===v&&3!==this.type;for(let m=0,g=t.length;m<g;m++){const l=t[m],c=l.shadow;if(void 0===c)continue;if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const h=c.getFrameExtents();if(i.multiply(h),a.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(a.x=Math.floor(u/h.x),i.x=a.x*h.x,c.mapSize.x=a.x),i.y>u&&(a.y=Math.floor(u/h.y),i.y=a.y*h.y,c.mapSize.y=a.y)),null===c.map||!0===p||!0===f){const e=3!==this.type?{minFilter:ie,magFilter:ie}:{};null!==c.map&&c.map.dispose(),c.map=new An(i.x,i.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const g=c.getViewportCount();for(let e=0;e<g;e++){const t=c.getViewport(e);s.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),d.viewport(s),c.updateMatrices(l,e),r=c.getFrustum(),M(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&b(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,h)}}const vp={[z]:1,[V]:6,[j]:7,[H]:5,[B]:0,[W]:2,[X]:4,[G]:3};function yp(e,t){const n=new function(){let t=!1;const n=new Tn;let r=null;const i=new Tn(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,s,o){!0===o&&(t*=s,r*=s,a*=s),n.set(t,r,a,s),!1===i.equals(n)&&(e.clearColor(t,r,a,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,i=null,a=null,s=null;return{setReversed:function(e){if(r!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=e;const i=s;s=null,this.setClear(i)}},getReversed:function(){return r},setTest:function(t){t?ie(e.DEPTH_TEST):ae(e.DEPTH_TEST)},setMask:function(t){i===t||n||(e.depthMask(t),i=t)},setFunc:function(t){if(r&&(t=vp[t]),a!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}a=t}},setLocked:function(e){n=e},setClear:function(t){s!==t&&(r&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){n=!1,i=null,a=null,s=null,r=!1}}},i=new function(){let t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,c=null;return{setTest:function(n){t||(n?ie(e.STENCIL_TEST):ae(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&i===n&&a===s||(e.stencilFunc(t,n,s),r=t,i=n,a=s)},setOp:function(t,n,r){s===t&&o===n&&l===r||(e.stencilOp(t,n,r),s=t,o=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,c=null}}},a=new WeakMap,s=new WeakMap;let o={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,f=null,m=null,g=null,v=null,y=null,_=null,x=new Zr(0,0,0),z=0,B=!1,V=null,H=null,j=null,G=null,W=null;const X=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let q=!1,Y=0;const Z=e.getParameter(e.VERSION);-1!==Z.indexOf("WebGL")?(Y=parseFloat(/^WebGL (\d)/.exec(Z)[1]),q=Y>=1):-1!==Z.indexOf("OpenGL ES")&&(Y=parseFloat(/^OpenGL ES (\d)/.exec(Z)[1]),q=Y>=2);let J=null,$={};const K=e.getParameter(e.SCISSOR_BOX),Q=e.getParameter(e.VIEWPORT),ee=(new Tn).fromArray(K),te=(new Tn).fromArray(Q);function ne(t,n,r,i){const a=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return s}const re={};function ie(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function ae(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}re[e.TEXTURE_2D]=ne(e.TEXTURE_2D,e.TEXTURE_2D,1),re[e.TEXTURE_CUBE_MAP]=ne(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),re[e.TEXTURE_2D_ARRAY]=ne(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),re[e.TEXTURE_3D]=ne(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),i.setClear(0),ie(e.DEPTH_TEST),r.setFunc(3),ce(!1),ue(1),ie(e.CULL_FACE),le(0);const se={[b]:e.FUNC_ADD,[S]:e.FUNC_SUBTRACT,[M]:e.FUNC_REVERSE_SUBTRACT};se[103]=e.MIN,se[104]=e.MAX;const oe={[w]:e.ZERO,[T]:e.ONE,[E]:e.SRC_COLOR,[C]:e.SRC_ALPHA,[L]:e.SRC_ALPHA_SATURATE,[D]:e.DST_COLOR,[P]:e.DST_ALPHA,[A]:e.ONE_MINUS_SRC_COLOR,[R]:e.ONE_MINUS_SRC_ALPHA,[N]:e.ONE_MINUS_DST_COLOR,[I]:e.ONE_MINUS_DST_ALPHA,[U]:e.CONSTANT_COLOR,[O]:e.ONE_MINUS_CONSTANT_COLOR,[F]:e.CONSTANT_ALPHA,[k]:e.ONE_MINUS_CONSTANT_ALPHA};function le(t,n,r,i,a,s,o,l,c,u){if(0!==t){if(!1===d&&(ie(e.BLEND),d=!0),5===t)a=a||n,s=s||r,o=o||i,n===f&&a===v||(e.blendEquationSeparate(se[n],se[a]),f=n,v=a),r===m&&i===g&&s===y&&o===_||(e.blendFuncSeparate(oe[r],oe[i],oe[s],oe[o]),m=r,g=i,y=s,_=o),!1!==l.equals(x)&&c===z||(e.blendColor(l.r,l.g,l.b,c),x.copy(l),z=c),p=t,B=!1;else if(t!==p||u!==B){if(f===b&&v===b||(e.blendEquation(e.FUNC_ADD),f=b,v=b),u)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE)}m=null,g=null,y=null,_=null,x.set(0,0,0),z=0,p=t,B=u}}else!0===d&&(ae(e.BLEND),d=!1)}function ce(t){V!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),V=t)}function ue(t){0!==t?(ie(e.CULL_FACE),t!==H&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ae(e.CULL_FACE),H=t}function he(t,n,r){t?(ie(e.POLYGON_OFFSET_FILL),G===n&&W===r||(e.polygonOffset(n,r),G=n,W=r)):ae(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:i},enable:ie,disable:ae,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=u,i=!1;if(t){r=c.get(n),void 0===r&&(r=[],c.set(n,r));const a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=a.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=a.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:le,setMaterial:function(t,a){2===t.side?ae(e.CULL_FACE):ie(e.CULL_FACE);let s=1===t.side;a&&(s=!s),ce(s),1===t.blending&&!1===t.transparent?le(0):le(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite);const o=t.stencilWrite;i.setTest(o),o&&(i.setMask(t.stencilWriteMask),i.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),i.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),he(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?ie(e.SAMPLE_ALPHA_TO_COVERAGE):ae(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:ce,setCullFace:ue,setLineWidth:function(t){t!==j&&(q&&e.lineWidth(t),j=t)},setPolygonOffset:he,setScissorTest:function(t){t?ie(e.SCISSOR_TEST):ae(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+X-1),J!==t&&(e.activeTexture(t),J=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===J?e.TEXTURE0+X-1:J);let i=$[r];void 0===i&&(i={type:void 0,texture:void 0},$[r]=i),i.type===t&&i.texture===n||(J!==r&&(e.activeTexture(r),J=r),e.bindTexture(t,n||re[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=$[J];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(t){}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(t){}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(t){}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(t){}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);a.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),a.set(n,r))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(t){}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(t){}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(t){}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(t){}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(t){}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(t){}},scissor:function(t){!1===ee.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ee.copy(t))},viewport:function(t){!1===te.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),te.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),r.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},J=null,$={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,f=null,m=null,g=null,v=null,y=null,_=null,x=new Zr(0,0,0),z=0,B=!1,V=null,H=null,j=null,G=null,W=null,ee.set(0,0,e.canvas.width,e.canvas.height),te.set(0,0,e.canvas.width,e.canvas.height),n.reset(),r.reset(),i.reset()}}}function _p(e,t,n,r,i,a,s){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new Jt,u=new WeakMap;let h;const d=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(G){}function f(e,t){return p?new OffscreenCanvas(e,t):on("canvas")}function m(e,t,n){let r=1;const i=j(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),a=Math.floor(r*i.height);void 0===h&&(h=f(n,a));const s=t?f(n,a):h;s.width=n,s.height=a;return s.getContext("2d").drawImage(e,0,0,n,a),s}return e}return e}function g(e){return e.generateMipmaps}function v(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function _(n,r,i,a,s=!1){if(null!==n&&void 0!==e[n])return e[n];let o=r;if(r===e.RED&&(i===e.FLOAT&&(o=e.R32F),i===e.HALF_FLOAT&&(o=e.R16F),i===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.R8UI),i===e.UNSIGNED_SHORT&&(o=e.R16UI),i===e.UNSIGNED_INT&&(o=e.R32UI),i===e.BYTE&&(o=e.R8I),i===e.SHORT&&(o=e.R16I),i===e.INT&&(o=e.R32I)),r===e.RG&&(i===e.FLOAT&&(o=e.RG32F),i===e.HALF_FLOAT&&(o=e.RG16F),i===e.UNSIGNED_BYTE&&(o=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RG8UI),i===e.UNSIGNED_SHORT&&(o=e.RG16UI),i===e.UNSIGNED_INT&&(o=e.RG32UI),i===e.BYTE&&(o=e.RG8I),i===e.SHORT&&(o=e.RG16I),i===e.INT&&(o=e.RG32I)),r===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RGB8UI),i===e.UNSIGNED_SHORT&&(o=e.RGB16UI),i===e.UNSIGNED_INT&&(o=e.RGB32UI),i===e.BYTE&&(o=e.RGB8I),i===e.SHORT&&(o=e.RGB16I),i===e.INT&&(o=e.RGB32I)),r===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(o=e.RGBA16UI),i===e.UNSIGNED_INT&&(o=e.RGBA32UI),i===e.BYTE&&(o=e.RGBA8I),i===e.SHORT&&(o=e.RGBA16I),i===e.INT&&(o=e.RGBA32I)),r===e.RGB&&(i===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),i===e.UNSIGNED_INT_10F_11F_11F_REV&&(o=e.R11F_G11F_B10F)),r===e.RGBA){const t=s?Mt:fn.getTransfer(a);i===e.FLOAT&&(o=e.RGBA32F),i===e.HALF_FLOAT&&(o=e.RGBA16F),i===e.UNSIGNED_BYTE&&(o=t===wt?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return o!==e.R16F&&o!==e.R32F&&o!==e.RG16F&&o!==e.RG32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function x(t,n){let r;return t?null===n||n===ge||n===be?r=e.DEPTH24_STENCIL8:n===ve?r=e.DEPTH32F_STENCIL8:n===fe&&(r=e.DEPTH24_STENCIL8):null===n||n===ge||n===be?r=e.DEPTH_COMPONENT24:n===ve?r=e.DEPTH_COMPONENT32F:n===fe&&(r=e.DEPTH_COMPONENT16),r}function b(e,t){return!0===g(e)||e.isFramebufferTexture&&e.minFilter!==ie&&e.minFilter!==oe?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){const t=e.target;t.removeEventListener("dispose",S),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=d.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&w(e),0===Object.keys(i).length&&d.delete(n)}r.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function M(t){const n=t.target;n.removeEventListener("dispose",M),function(t){const n=r.get(t);t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++){if(Array.isArray(n.__webglFramebuffer[r]))for(let t=0;t<n.__webglFramebuffer[r].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[r][t]);else e.deleteFramebuffer(n.__webglFramebuffer[r]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[r])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=t.textures;for(let a=0,o=i.length;a<o;a++){const t=r.get(i[a]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),r.remove(i[a])}r.remove(t)}(n)}function w(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete d.get(i)[n.__cacheKey],s.memory.textures--}let T=0;function E(t,i){const a=r.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&a.__version!==t.version){const e=t.image;if(null===e);else if(!1!==e.complete)return void N(a,t,i)}else t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null);n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}const A={[te]:e.REPEAT,[ne]:e.CLAMP_TO_EDGE,[re]:e.MIRRORED_REPEAT},C={[ie]:e.NEAREST,[ae]:e.NEAREST_MIPMAP_NEAREST,[se]:e.NEAREST_MIPMAP_LINEAR,[oe]:e.LINEAR,[le]:e.LINEAR_MIPMAP_NEAREST,[ce]:e.LINEAR_MIPMAP_LINEAR},R={[Et]:e.NEVER,[Nt]:e.ALWAYS,[At]:e.LESS,[Rt]:e.LEQUAL,[Ct]:e.EQUAL,[Dt]:e.GEQUAL,[Pt]:e.GREATER,[It]:e.NOTEQUAL};function P(n,a){if(a.type===ve&&!1===t.has("OES_texture_float_linear")&&(a.magFilter===oe||a.magFilter===le||a.magFilter===se||a.magFilter===ce||a.minFilter===oe||a.minFilter===le||a.minFilter===se||a.minFilter),e.texParameteri(n,e.TEXTURE_WRAP_S,A[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,A[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,A[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,C[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,C[a.minFilter]),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,R[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(a.magFilter===ie)return;if(a.minFilter!==se&&a.minFilter!==ce)return;if(a.type===ve&&!1===t.has("OES_texture_float_linear"))return;if(a.anisotropy>1||r.get(a).__currentAnisotropy){const s=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy}}}function I(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S));const i=n.source;let a=d.get(i);void 0===a&&(a={},d.set(i,a));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&w(n)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function D(e,t,n){return Math.floor(Math.floor(e/n)/t)}function N(t,s,o){let l=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(l=e.TEXTURE_3D);const c=I(t,s),u=s.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const h=r.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+o);const t=fn.getPrimaries(fn.workingColorSpace),r=s.colorSpace===xt?null:fn.getPrimaries(s.colorSpace),d=s.colorSpace===xt||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let p=m(s.image,!1,i.maxTextureSize);p=H(s,p);const f=a.convert(s.format,s.colorSpace),y=a.convert(s.type);let S,M=_(s.internalFormat,f,y,s.colorSpace,s.isVideoTexture);P(l,s);const w=s.mipmaps,T=!0!==s.isVideoTexture,E=void 0===h.__version||!0===c,A=u.dataReady,C=b(s,p);if(s.isDepthTexture)M=x(s.format===Ce,s.type),E&&(T?n.texStorage2D(e.TEXTURE_2D,1,M,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,M,p.width,p.height,0,f,y,null));else if(s.isDataTexture)if(w.length>0){T&&E&&n.texStorage2D(e.TEXTURE_2D,C,M,w[0].width,w[0].height);for(let t=0,r=w.length;t<r;t++)S=w[t],T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,f,y,S.data):n.texImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,f,y,S.data);s.generateMipmaps=!1}else T?(E&&n.texStorage2D(e.TEXTURE_2D,C,M,p.width,p.height),A&&function(t,r,i,a){const s=t.updateRanges;if(0===s.length)n.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,i,a,r.data);else{s.sort((e,t)=>e.start-t.start);let o=0;for(let e=1;e<s.length;e++){const t=s[o],n=s[e],i=t.start+t.count,a=D(n.start,r.width,4),l=D(t.start,r.width,4);n.start<=i+1&&a===l&&D(n.start+n.count-1,r.width,4)===a?t.count=Math.max(t.count,n.start+n.count-t.start):(++o,s[o]=n)}s.length=o+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),u=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,r.width);for(let t=0,h=s.length;t<h;t++){const o=s[t],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),u=l%r.width,h=Math.floor(l/r.width),d=c,p=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,h),n.texSubImage2D(e.TEXTURE_2D,0,u,h,d,p,i,a,r.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,u)}}(s,p,f,y)):n.texImage2D(e.TEXTURE_2D,0,M,p.width,p.height,0,f,y,p.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){T&&E&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,M,w[0].width,w[0].height,p.depth);for(let t=0,r=w.length;t<r;t++)if(S=w[t],s.format!==Ee){if(null!==f)if(T){if(A)if(s.layerUpdates.size>0){const r=Gu(S.width,S.height,s.format,s.type);for(const i of s.layerUpdates){const a=S.data.subarray(i*r/S.data.BYTES_PER_ELEMENT,(i+1)*r/S.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,i,S.width,S.height,1,f,a)}s.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,p.depth,f,S.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,M,S.width,S.height,p.depth,0,S.data,0,0)}else T?A&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,p.depth,f,y,S.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,M,S.width,S.height,p.depth,0,f,y,S.data)}else{T&&E&&n.texStorage2D(e.TEXTURE_2D,C,M,w[0].width,w[0].height);for(let t=0,r=w.length;t<r;t++)S=w[t],s.format!==Ee?null!==f&&(T?A&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,f,S.data):n.compressedTexImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,S.data)):T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,f,y,S.data):n.texImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,f,y,S.data)}else if(s.isDataArrayTexture)if(T){if(E&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,M,p.width,p.height,p.depth),A)if(s.layerUpdates.size>0){const t=Gu(p.width,p.height,s.format,s.type);for(const r of s.layerUpdates){const i=p.data.subarray(r*t/p.data.BYTES_PER_ELEMENT,(r+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,p.width,p.height,1,f,y,i)}s.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,f,y,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,M,p.width,p.height,p.depth,0,f,y,p.data);else if(s.isData3DTexture)T?(E&&n.texStorage3D(e.TEXTURE_3D,C,M,p.width,p.height,p.depth),A&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,f,y,p.data)):n.texImage3D(e.TEXTURE_3D,0,M,p.width,p.height,p.depth,0,f,y,p.data);else if(s.isFramebufferTexture){if(E)if(T)n.texStorage2D(e.TEXTURE_2D,C,M,p.width,p.height);else{let t=p.width,r=p.height;for(let i=0;i<C;i++)n.texImage2D(e.TEXTURE_2D,i,M,t,r,0,f,y,null),t>>=1,r>>=1}}else if(w.length>0){if(T&&E){const t=j(w[0]);n.texStorage2D(e.TEXTURE_2D,C,M,t.width,t.height)}for(let t=0,r=w.length;t<r;t++)S=w[t],T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,f,y,S):n.texImage2D(e.TEXTURE_2D,t,M,f,y,S);s.generateMipmaps=!1}else if(T){if(E){const t=j(p);n.texStorage2D(e.TEXTURE_2D,C,M,t.width,t.height)}A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,f,y,p)}else n.texImage2D(e.TEXTURE_2D,0,M,f,y,p);g(s)&&v(l),h.__version=u.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function L(t,i,s,l,c,u){const h=a.convert(s.format,s.colorSpace),d=a.convert(s.type),p=_(s.internalFormat,h,d,s.colorSpace),f=r.get(i),m=r.get(s);if(m.__renderTarget=i,!f.__hasExternalTextures){const t=Math.max(1,i.width>>u),r=Math.max(1,i.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,p,t,r,i.depth,0,h,d,null):n.texImage2D(c,u,p,t,r,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),V(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,m.__webglTexture,0,B(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function U(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,a=i&&i.isDepthTexture?i.type:null,s=x(n.stencilBuffer,a),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=B(n);V(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,s,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,s,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,s,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const s=t[i],l=a.convert(s.format,s.colorSpace),c=a.convert(s.type),u=_(s.internalFormat,l,c,s.colorSpace),h=B(n);r&&!1===V(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,u,n.width,n.height):V(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function O(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const a=r.get(i.depthTexture);a.__renderTarget=i,a.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),E(i.depthTexture,0);const s=a.__webglTexture,l=B(i);if(i.depthTexture.format===Ae)V(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(i.depthTexture.format!==Ce)throw new Error("Unknown depthTexture format");V(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}function F(t){const i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),e){const t=()=>{delete i.__boundDepthTexture,delete i.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),i.__depthDisposeCallback=t}i.__boundDepthTexture=e}if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?O(i.__webglFramebuffer[0],t):O(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),void 0===i.__webglDepthbuffer[r])i.__webglDepthbuffer[r]=e.createRenderbuffer(),U(i.__webglDepthbuffer[r],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,a=i.__webglDepthbuffer[r];e.bindRenderbuffer(e.RENDERBUFFER,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,a)}}else{const r=t.texture.mipmaps;if(r&&r.length>0?n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=e.createRenderbuffer(),U(i.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,r=i.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,r)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const k=[],z=[];function B(e){return Math.min(i.maxSamples,e.samples)}function V(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function H(e,t){const n=e.colorSpace;e.format,e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==St&&n!==xt&&fn.getTransfer(n),t}function j(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=T;return i.maxTextures,T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=E,this.setTexture2DArray=function(t,i){const a=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?N(a,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){const a=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?N(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,s){const o=r.get(t);t.version>0&&o.__version!==t.version?function(t,s,o){if(6!==s.image.length)return;const l=I(t,s),c=s.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const u=r.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+o);const t=fn.getPrimaries(fn.workingColorSpace),r=s.colorSpace===xt?null:fn.getPrimaries(s.colorSpace),h=s.colorSpace===xt||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=s.isCompressedTexture||s.image[0].isCompressedTexture,p=s.image[0]&&s.image[0].isDataTexture,f=[];for(let e=0;e<6;e++)f[e]=d||p?p?s.image[e].image:s.image[e]:m(s.image[e],!0,i.maxCubemapSize),f[e]=H(s,f[e]);const y=f[0],x=a.convert(s.format,s.colorSpace),S=a.convert(s.type),M=_(s.internalFormat,x,S,s.colorSpace),w=!0!==s.isVideoTexture,T=void 0===u.__version||!0===l,E=c.dataReady;let A,C=b(s,y);if(P(e.TEXTURE_CUBE_MAP,s),d){w&&T&&n.texStorage2D(e.TEXTURE_CUBE_MAP,C,M,y.width,y.height);for(let t=0;t<6;t++){A=f[t].mipmaps;for(let r=0;r<A.length;r++){const i=A[r];s.format!==Ee?null!==x&&(w?E&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,x,i.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,M,i.width,i.height,0,i.data)):w?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,x,S,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,M,i.width,i.height,0,x,S,i.data)}}}else{if(A=s.mipmaps,w&&T){A.length>0&&C++;const t=j(f[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,C,M,t.width,t.height)}for(let t=0;t<6;t++)if(p){w?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,f[t].width,f[t].height,x,S,f[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,M,f[t].width,f[t].height,0,x,S,f[t].data);for(let r=0;r<A.length;r++){const i=A[r].image[t].image;w?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,x,S,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,M,i.width,i.height,0,x,S,i.data)}}else{w?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,x,S,f[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,M,x,S,f[t]);for(let r=0;r<A.length;r++){const i=A[r];w?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,x,S,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,M,x,S,i.image[t])}}}g(s)&&v(e.TEXTURE_CUBE_MAP),u.__version=c.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(o,t,s):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,n,i){const a=r.get(t);void 0!==n&&L(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&F(t)},this.setupRenderTarget=function(t){const i=t.texture,o=r.get(t),l=r.get(i);t.addEventListener("dispose",M);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,s.memory.textures++),u){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<i.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===V(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const i=a.convert(r.format,r.colorSpace),s=a.convert(r.type),l=_(r.internalFormat,i,s,r.colorSpace,!0===t.isXRRenderTarget),u=B(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),U(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),P(e.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)L(o.__webglFramebuffer[n][r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else L(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(i)&&v(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let i=0,a=c.length;i<a;i++){const a=c[i],s=r.get(a);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(l,s.__webglTexture),P(l,a),L(o.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+i,l,0),g(a)&&v(l)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),P(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)L(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,r,n);else L(o.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,r,0);g(i)&&v(r),n.unbindTexture()}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let i=0,a=t.length;i<a;i++){const a=t[i];if(g(a)){const t=y(e),i=r.get(a).__webglTexture;n.bindTexture(t,i),v(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===V(t)){const i=t.textures,a=t.width,s=t.height;let o=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=r.get(t),h=i.length>1;if(h)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const d=t.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<i.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,s,0,0,a,s,o,e.NEAREST),!0===l&&(k.length=0,z.length=0,k.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(k.push(c),z.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,z)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,k))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const a=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=L,this.useMultisampledRTT=V}function xp(e,t){return{convert:function(n,r=""){let i;const a=fn.getTransfer(r);if(n===he)return e.UNSIGNED_BYTE;if(n===_e)return e.UNSIGNED_SHORT_4_4_4_4;if(n===xe)return e.UNSIGNED_SHORT_5_5_5_1;if(n===Se)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===Me)return e.UNSIGNED_INT_10F_11F_11F_REV;if(n===de)return e.BYTE;if(n===pe)return e.SHORT;if(n===fe)return e.UNSIGNED_SHORT;if(n===me)return e.INT;if(n===ge)return e.UNSIGNED_INT;if(n===ve)return e.FLOAT;if(n===ye)return e.HALF_FLOAT;if(n===we)return e.ALPHA;if(n===Te)return e.RGB;if(n===Ee)return e.RGBA;if(n===Ae)return e.DEPTH_COMPONENT;if(n===Ce)return e.DEPTH_STENCIL;if(n===Re)return e.RED;if(n===Pe)return e.RED_INTEGER;if(n===Ie)return e.RG;if(n===De)return e.RG_INTEGER;if(n===Ne)return e.RGBA_INTEGER;if(n===Le||n===Ue||n===Oe||n===Fe)if(a===wt){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===Le)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ue)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Oe)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Fe)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===Le)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ue)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Oe)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Fe)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===ke||n===ze||n===Be||n===Ve){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===ke)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===ze)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Be)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Ve)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===He||n===je||n===Ge){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===He||n===je)return a===wt?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Ge)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===We||n===Xe||n===qe||n===Ye||n===Ze||n===Je||n===$e||n===Ke||n===Qe||n===et||n===tt||n===nt||n===rt||n===it){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===We)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Xe)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===qe)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Ye)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Ze)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Je)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===$e)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Ke)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Qe)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===et)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===tt)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===nt)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===rt)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===it)return a===wt?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===at||n===st||n===ot){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===at)return a===wt?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===st)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===ot)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===lt||n===ct||n===ut||n===ht){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===lt)return i.COMPRESSED_RED_RGTC1_EXT;if(n===ct)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===ut)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===ht)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===be?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class bp{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new Xs(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new ki({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ii(new cl(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Sp extends kt{constructor(e,t){super();const n=this;let r=null,i=1,a=null,s="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,p=null;const f="undefined"!=typeof XRWebGLBinding,m=new bp,g={},v=t.getContextAttributes();let y=null,_=null;const x=[],b=[],S=new Jt;let M=null;const w=new ji;w.viewport=new Tn;const T=new ji;T.viewport=new Tn;const E=[w,T],A=new Vc;let C=null,R=null;function P(e){const t=b.indexOf(e.inputSource);if(-1===t)return;const n=x[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||a),n.dispatchEvent({type:e.type,data:e.inputSource}))}function I(){r.removeEventListener("select",P),r.removeEventListener("selectstart",P),r.removeEventListener("selectend",P),r.removeEventListener("squeeze",P),r.removeEventListener("squeezestart",P),r.removeEventListener("squeezeend",P),r.removeEventListener("end",I),r.removeEventListener("inputsourceschange",D);for(let e=0;e<x.length;e++){const t=b[e];null!==t&&(b[e]=null,x[e].disconnect(t))}C=null,R=null,m.reset();for(const e in g)delete g[e];e.setRenderTarget(y),d=null,h=null,u=null,r=null,_=null,F.stop(),n.isPresenting=!1,e.setPixelRatio(M),e.setSize(S.width,S.height,!1),n.dispatchEvent({type:"sessionend"})}function D(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=b.indexOf(n);r>=0&&(b[r]=null,x[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=b.indexOf(n);if(-1===r){for(let e=0;e<x.length;e++){if(e>=b.length){b.push(n),r=e;break}if(null===b[e]){b[e]=n,r=e;break}}if(-1===r)break}const i=x[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=x[e];return void 0===t&&(t=new Ji,x[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=x[e];return void 0===t&&(t=new Ji,x[e]=t),t.getGripSpace()},this.getHand=function(e){let t=x[e];return void 0===t&&(t=new Ji,x[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,n.isPresenting},this.setReferenceSpaceType=function(e){s=e,n.isPresenting},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return null===u&&f&&(u=new XRWebGLBinding(r,t)),u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){y=e.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",I),r.addEventListener("inputsourceschange",D),!0!==v.xrCompatible&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(S);if(f&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,a=null,s=null;v.depth&&(s=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=v.stencil?Ce:Ae,a=v.stencil?be:ge);const o={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:i};u=this.getBinding(),h=u.createProjectionLayer(o),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),_=new An(h.textureWidth,h.textureHeight,{format:Ee,type:he,depthTexture:new Ws(h.textureWidth,h.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),_=new An(d.framebufferWidth,d.framebufferHeight,{format:Ee,type:he,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}_.isXRRenderTarget=!0,this.setFoveation(o),l=null,a=await r.requestReferenceSpace(s),F.setContext(r),F.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const N=new Kt,L=new Kt;function U(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;let t=e.near,n=e.far;null!==m.texture&&(m.depthNear>0&&(t=m.depthNear),m.depthFar>0&&(n=m.depthFar)),A.near=T.near=w.near=t,A.far=T.far=w.far=n,C===A.near&&R===A.far||(r.updateRenderState({depthNear:A.near,depthFar:A.far}),C=A.near,R=A.far),A.layers.mask=6|e.layers.mask,w.layers.mask=3&A.layers.mask,T.layers.mask=5&A.layers.mask;const i=e.parent,a=A.cameras;U(A,i);for(let r=0;r<a.length;r++)U(a[r],i);2===a.length?function(e,t,n){N.setFromMatrixPosition(t.matrixWorld),L.setFromMatrixPosition(n.matrixWorld);const r=N.distanceTo(L),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=s*u,p=s*h,f=r/(-u+h),m=f*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=s+f,n=o+f,i=d-m,a=p+(r-m),u=l*o/n*t,h=c*o/n*t;e.projectionMatrix.makePerspective(i,a,u,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(A,w,T):A.projectionMatrix.copy(w.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Ht*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,A,i)},this.getCamera=function(){return A},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(e){o=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(A)},this.getCameraTexture=function(e){return g[e]};let O=null;const F=new Wu;F.setAnimationLoop(function(t,i){if(c=i.getViewerPose(l||a),p=i,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(_,d.framebuffer),e.setRenderTarget(_));let i=!1;t.length!==A.cameras.length&&(A.cameras.length=0,i=!0);for(let n=0;n<t.length;n++){const r=t[n];let a=null;if(null!==d)a=d.getViewport(r);else{const t=u.getViewSubImage(h,r);a=t.viewport,0===n&&(e.setRenderTargetTextures(_,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(_))}let s=E[n];void 0===s&&(s=new ji,s.layers.enable(n),s.viewport=new Tn,E[n]=s),s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(r.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(a.x,a.y,a.width,a.height),0===n&&(A.matrix.copy(s.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),!0===i&&A.cameras.push(s)}const a=r.enabledFeatures;if(a&&a.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&f){u=n.getBinding();const e=u.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&m.init(e,r.renderState)}if(a&&a.includes("camera-access")&&f){e.state.unbindTexture(),u=n.getBinding();for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=g[n];e||(e=new Xs,g[n]=e);const t=u.getCameraImage(n);e.sourceTexture=t}}}}for(let e=0;e<x.length;e++){const t=b[e],n=x[e];null!==t&&void 0!==n&&n.update(t,i,l||a)}O&&O(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),p=null}),this.setAnimationLoop=function(e){O=e},this.dispose=function(){}}}const Mp=new pr,wp=new rr;function Tp(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,1===r.side&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),1===r.side&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const i=t.get(r),a=i.envMap,s=i.envMapRotation;a&&(e.envMap.value=a,Mp.copy(s),Mp.x*=-1,Mp.y*=-1,Mp.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(Mp.y*=-1,Mp.z*=-1),e.envMapRotation.value.setFromMatrix4(wp.makeRotationFromEuler(Mp)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Oi(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,s,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,o)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,s):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Ep(e,t,n,r){let i={},a={},s=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;{const e=r[a];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return r[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture,t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let a=0,s=t.length;a<s;a++){const e=Array.isArray(t[a])?t[a]:[t[a]];for(let t=0,i=e.length;t<i;t++){const i=e[t],a=Array.isArray(i.value)?i.value:[i.value];for(let e=0,t=a.length;e<t;e++){const t=c(a[e]),s=n%r,o=s%t.boundary,l=s+o;n+=o,0!==l&&r-l<t.storage&&(n+=r-l),i.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),i.__offset=n,n+=t.storage}}}const i=n%r;i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return 0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const p=h.program;r.updateUBOMapping(n,p);const f=t.render.frame;a[n.id]!==f&&(!function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let i=0,s=r.length;i<s;i++){const t=Array.isArray(r[i])?r[i]:[r[i]];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!0===l(r,i,n,a)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let a=0;a<n.length;a++){const s=n[a],o=c(s);"number"==typeof s||"boolean"==typeof s?(r.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,t+i,r.__data)):s.isMatrix3?(r.__data[0]=s.elements[0],r.__data[1]=s.elements[1],r.__data[2]=s.elements[2],r.__data[3]=0,r.__data[4]=s.elements[3],r.__data[5]=s.elements[4],r.__data[6]=s.elements[5],r.__data[7]=0,r.__data[8]=s.elements[6],r.__data[9]=s.elements[7],r.__data[10]=s.elements[8],r.__data[11]=0):(s.toArray(r.__data,i),i+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=f)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);s=[],i={},a={}}}}class Ap{constructor(e={}){const{canvas:t=ln(),context:n=null,depth:r=!0,stencil:i=!1,alpha:a=!1,antialias:s=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:h=!1}=e;let d;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=a;const p=new Uint32Array(4),f=new Int32Array(4);let g=null,v=null;const y=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const x=this;let b=!1;this._outputColorSpace=bt;let S=0,M=0,w=null,T=-1,E=null;const A=new Tn,C=new Tn;let R=null;const P=new Zr(0);let I=0,D=t.width,N=t.height,L=1,U=null,O=null;const F=new Tn(0,0,D,N),k=new Tn(0,0,D,N);let z=!1;const B=new Qa;let V=!1,H=!1;const j=new rr,G=new Kt,W=new Tn,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let q=!1;function Y(){return null===w?L:1}let Z,J,$,K,Q,ee,te,ne,re,ie,ae,se,oe,le,ue,de,pe,me,ve,Se,Me,we,Te,Ee,Ae=n;function Ce(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:r,stencil:i,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${m}`),t.addEventListener("webglcontextlost",Le,!1),t.addEventListener("webglcontextrestored",Ue,!1),t.addEventListener("webglcontextcreationerror",Oe,!1),null===Ae){const t="webgl2";if(Ae=Ce(t,e),null===Ae)throw Ce(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(et){throw et}function Re(){Z=new wh(Ae),Z.init(),we=new xp(Ae,Z),J=new nh(Ae,Z,e,we),$=new yp(Ae,Z),J.reversedDepthBuffer&&h&&$.buffers.depth.setReversed(!0),K=new Ah(Ae),Q=new ap,ee=new _p(Ae,Z,$,Q,J,we,K),te=new ih(x),ne=new Mh(x),re=new Xu(Ae),Te=new eh(Ae,re),ie=new Th(Ae,re,K,Te),ae=new Rh(Ae,ie,re,K),ve=new Ch(Ae,J,ee),de=new rh(Q),se=new ip(x,te,ne,Z,J,Te,de),oe=new Tp(x,Q),le=new cp,ue=new mp(Z),me=new Qu(x,te,ne,$,ae,d,o),pe=new gp(x,ae,J),Ee=new Ep(Ae,K,J,$),Se=new th(Ae,Z,K),Me=new Eh(Ae,Z,K),K.programs=se.programs,x.capabilities=J,x.extensions=Z,x.properties=Q,x.renderLists=le,x.shadowMap=pe,x.state=$,x.info=K}Re();const Ie=new Sp(x,Ae);function Le(e){e.preventDefault(),b=!0}function Ue(){b=!1;const e=K.autoReset,t=pe.enabled,n=pe.autoUpdate,r=pe.needsUpdate,i=pe.type;Re(),K.autoReset=e,pe.enabled=t,pe.autoUpdate=n,pe.needsUpdate=r,pe.type=i}function Oe(e){}function Fe(e){const t=e.target;t.removeEventListener("dispose",Fe),function(e){(function(e){const t=Q.get(e).programs;void 0!==t&&(t.forEach(function(e){se.releaseProgram(e)}),e.isShaderMaterial&&se.releaseShaderCache(e))})(e),Q.remove(e)}(t)}function ke(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Ye(e,t,n),e.side=0,e.needsUpdate=!0,Ye(e,t,n),e.side=2):Ye(e,t,n)}this.xr=Ie,this.getContext=function(){return Ae},this.getContextAttributes=function(){return Ae.getContextAttributes()},this.forceContextLoss=function(){const e=Z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=Z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(e){void 0!==e&&(L=e,this.setSize(D,N,!1))},this.getSize=function(e){return e.set(D,N)},this.setSize=function(e,n,r=!0){Ie.isPresenting||(D=e,N=n,t.width=Math.floor(e*L),t.height=Math.floor(n*L),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(D*L,N*L).floor()},this.setDrawingBufferSize=function(e,n,r){D=e,N=n,L=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(A)},this.getViewport=function(e){return e.copy(F)},this.setViewport=function(e,t,n,r){e.isVector4?F.set(e.x,e.y,e.z,e.w):F.set(e,t,n,r),$.viewport(A.copy(F).multiplyScalar(L).round())},this.getScissor=function(e){return e.copy(k)},this.setScissor=function(e,t,n,r){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,r),$.scissor(C.copy(k).multiplyScalar(L).round())},this.getScissorTest=function(){return z},this.setScissorTest=function(e){$.setScissorTest(z=e)},this.setOpaqueSort=function(e){U=e},this.setTransparentSort=function(e){O=e},this.getClearColor=function(e){return e.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor(...arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha(...arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==w){const t=w.texture.format;e=t===Ne||t===De||t===Pe}if(e){const e=w.texture.type,t=e===he||e===ge||e===fe||e===be||e===_e||e===xe,n=me.getClearColor(),r=me.getClearAlpha(),i=n.r,a=n.g,s=n.b;t?(p[0]=i,p[1]=a,p[2]=s,p[3]=r,Ae.clearBufferuiv(Ae.COLOR,0,p)):(f[0]=i,f[1]=a,f[2]=s,f[3]=r,Ae.clearBufferiv(Ae.COLOR,0,f))}else r|=Ae.COLOR_BUFFER_BIT}t&&(r|=Ae.DEPTH_BUFFER_BIT),n&&(r|=Ae.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ae.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Le,!1),t.removeEventListener("webglcontextrestored",Ue,!1),t.removeEventListener("webglcontextcreationerror",Oe,!1),me.dispose(),le.dispose(),ue.dispose(),Q.dispose(),te.dispose(),ne.dispose(),ae.dispose(),Te.dispose(),Ee.dispose(),se.dispose(),Ie.dispose(),Ie.removeEventListener("sessionstart",Be),Ie.removeEventListener("sessionend",Ve),He.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=X);const s=i.isMesh&&i.matrixWorld.determinant()<0,o=function(e,t,n,r,i){!0!==t.isScene&&(t=X);ee.resetTextureUnits();const a=t.fog,s=r.isMeshStandardMaterial?t.environment:null,o=null===w?x.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:St,l=(r.isMeshStandardMaterial?ne:te).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let f=0;r.toneMapped&&(null!==w&&!0!==w.isXRRenderTarget||(f=x.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,g=void 0!==m?m.length:0,y=Q.get(r),_=v.state.lights;if(!0===V&&(!0===H||e!==E)){const t=e===E&&r.id===T;de.setState(r,e,t)}let b=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==_.state.version||y.outputColorSpace!==o||i.isBatchedMesh&&!1===y.batching?b=!0:i.isBatchedMesh||!0!==y.batching?i.isBatchedMesh&&!0===y.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===y.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===y.instancing?b=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?b=!0:i.isSkinnedMesh||!0!==y.skinning?i.isInstancedMesh&&!0===y.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===y.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===y.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===y.instancingMorph&&null!==i.morphTexture||y.envMap!==l||!0===r.fog&&y.fog!==a?b=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===de.numPlanes&&y.numIntersection===de.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==d||y.morphColors!==p||y.toneMapping!==f||y.morphTargetsCount!==g)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,y.__version=r.version);let S=y.currentProgram;!0===b&&(S=Ye(r,t,i));let M=!1,A=!1,C=!1;const R=S.getUniforms(),P=y.uniforms;$.useProgram(S.program)&&(M=!0,A=!0,C=!0);r.id!==T&&(T=r.id,A=!0);if(M||E!==e){$.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),R.setValue(Ae,"projectionMatrix",e.projectionMatrix),R.setValue(Ae,"viewMatrix",e.matrixWorldInverse);const t=R.map.cameraPosition;void 0!==t&&t.setValue(Ae,G.setFromMatrixPosition(e.matrixWorld)),J.logarithmicDepthBuffer&&R.setValue(Ae,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&R.setValue(Ae,"isOrthographic",!0===e.isOrthographicCamera),E!==e&&(E=e,A=!0,C=!0)}if(i.isSkinnedMesh){R.setOptional(Ae,i,"bindMatrix"),R.setOptional(Ae,i,"bindMatrixInverse");const e=i.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),R.setValue(Ae,"boneTexture",e.boneTexture,ee))}i.isBatchedMesh&&(R.setOptional(Ae,i,"batchingTexture"),R.setValue(Ae,"batchingTexture",i._matricesTexture,ee),R.setOptional(Ae,i,"batchingIdTexture"),R.setValue(Ae,"batchingIdTexture",i._indirectTexture,ee),R.setOptional(Ae,i,"batchingColorTexture"),null!==i._colorsTexture&&R.setValue(Ae,"batchingColorTexture",i._colorsTexture,ee));const I=n.morphAttributes;void 0===I.position&&void 0===I.normal&&void 0===I.color||ve.update(i,n,S);(A||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,R.setValue(Ae,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(P.envMap.value=l,P.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(P.envMapIntensity.value=t.environmentIntensity);A&&(R.setValue(Ae,"toneMappingExposure",x.toneMappingExposure),y.needsLights&&(U=C,(D=P).ambientLightColor.needsUpdate=U,D.lightProbe.needsUpdate=U,D.directionalLights.needsUpdate=U,D.directionalLightShadows.needsUpdate=U,D.pointLights.needsUpdate=U,D.pointLightShadows.needsUpdate=U,D.spotLights.needsUpdate=U,D.spotLightShadows.needsUpdate=U,D.rectAreaLights.needsUpdate=U,D.hemisphereLights.needsUpdate=U),a&&!0===r.fog&&oe.refreshFogUniforms(P,a),oe.refreshMaterialUniforms(P,r,L,N,v.state.transmissionRenderTarget[e.id]),Ld.upload(Ae,Ze(y),P,ee));var D,U;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Ld.upload(Ae,Ze(y),P,ee),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&R.setValue(Ae,"center",i.center);if(R.setValue(Ae,"modelViewMatrix",i.modelViewMatrix),R.setValue(Ae,"normalMatrix",i.normalMatrix),R.setValue(Ae,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];Ee.update(n,S),Ee.bind(n,S)}}return S}(e,t,n,r,i);$.setMaterial(r,s);let l=n.index,c=1;if(!0===r.wireframe){if(l=ie.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,p=(u.start+u.count)*c;null!==a&&(d=Math.max(d,a.start*c),p=Math.min(p,(a.start+a.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):null!=h&&(d=Math.max(d,0),p=Math.min(p,h.count));const f=p-d;if(f<0||f===1/0)return;let m;Te.setup(i,r,o,n,l);let g=Se;if(null!==l&&(m=re.get(l),g=Me,g.setIndex(m)),i.isMesh)!0===r.wireframe?($.setLineWidth(r.wireframeLinewidth*Y()),g.setMode(Ae.LINES)):g.setMode(Ae.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),$.setLineWidth(e*Y()),i.isLineSegments?g.setMode(Ae.LINES):i.isLineLoop?g.setMode(Ae.LINE_LOOP):g.setMode(Ae.LINE_STRIP)}else i.isPoints?g.setMode(Ae.POINTS):i.isSprite&&g.setMode(Ae.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)un("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),g.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if(Z.get("WEBGL_multi_draw"))g.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const e=i._multiDrawStarts,t=i._multiDrawCounts,n=i._multiDrawCount,a=l?re.get(l).bytesPerElement:1,s=Q.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)s.setValue(Ae,"_gl_DrawID",r),g.render(e[r]/a,t[r])}else if(i.isInstancedMesh)g.renderInstances(d,f,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);g.renderInstances(d,f,t)}else g.render(d,f)},this.compile=function(e,t,n=null){null===n&&(n=e),v=ue.get(n),v.init(t),_.push(v),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(v.pushLight(e),e.castShadow&&v.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(v.pushLight(e),e.castShadow&&v.pushShadow(e))}),v.setupLights();const r=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];ke(a,n,e),r.add(a)}else ke(t,n,e),r.add(t)}),v=_.pop(),r},this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise(t=>{function n(){r.forEach(function(e){Q.get(e).currentProgram.isReady()&&r.delete(e)}),0!==r.size?setTimeout(n,10):t(e)}null!==Z.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let ze=null;function Be(){He.stop()}function Ve(){He.start()}const He=new Wu;function je(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)v.pushLight(e),e.castShadow&&v.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||B.intersectsSprite(e)){r&&W.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j);const t=ae.update(e),i=e.material;i.visible&&g.push(e,t,i,n,W.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||B.intersectsObject(e))){const t=ae.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),W.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),W.copy(t.boundingSphere.center)),W.applyMatrix4(e.matrixWorld).applyMatrix4(j)),Array.isArray(i)){const r=t.groups;for(let a=0,s=r.length;a<s;a++){const s=r[a],o=i[s.materialIndex];o&&o.visible&&g.push(e,t,o,n,W.z,s)}}else i.visible&&g.push(e,t,i,n,W.z,null)}const i=e.children;for(let a=0,s=i.length;a<s;a++)je(i[a],t,n,r)}function Ge(e,t,n,r){const i=e.opaque,a=e.transmissive,s=e.transparent;v.setupLightsView(n),!0===V&&de.setGlobalState(x.clippingPlanes,n),r&&$.viewport(A.copy(r)),i.length>0&&Xe(i,t,n),a.length>0&&Xe(a,t,n),s.length>0&&Xe(s,t,n),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1)}function We(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===v.state.transmissionRenderTarget[r.id]&&(v.state.transmissionRenderTarget[r.id]=new An(1,1,{generateMipmaps:!0,type:Z.has("EXT_color_buffer_half_float")||Z.has("EXT_color_buffer_float")?ye:he,minFilter:ce,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:fn.workingColorSpace}));const a=v.state.transmissionRenderTarget[r.id],s=r.viewport||A;a.setSize(s.z*x.transmissionResolutionScale,s.w*x.transmissionResolutionScale);const o=x.getRenderTarget(),l=x.getActiveCubeFace(),c=x.getActiveMipmapLevel();x.setRenderTarget(a),x.getClearColor(P),I=x.getClearAlpha(),I<1&&x.setClearColor(16777215,.5),x.clear(),q&&me.render(n);const u=x.toneMapping;x.toneMapping=0;const h=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),v.setupLightsView(r),!0===V&&de.setGlobalState(x.clippingPlanes,r),Xe(e,n,r),ee.updateMultisampleRenderTarget(a),ee.updateRenderTargetMipmap(a),!1===Z.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let i=0,a=t.length;i<a;i++){const a=t[i],s=a.object,o=a.geometry,l=a.material,c=a.group;if(2===l.side&&s.layers.test(r.layers)){const t=l.side;l.side=1,l.needsUpdate=!0,qe(s,n,r,o,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(ee.updateMultisampleRenderTarget(a),ee.updateRenderTargetMipmap(a))}x.setRenderTarget(o,l,c),x.setClearColor(P,I),void 0!==h&&(r.viewport=h),x.toneMapping=u}function Xe(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],s=a.object,o=a.geometry,l=a.group;let c=a.material;!0===c.allowOverride&&null!==r&&(c=r),s.layers.test(n.layers)&&qe(s,t,n,o,c,l)}}function qe(e,t,n,r,i,a){e.onBeforeRender(x,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(x,t,n,r,e,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,x.renderBufferDirect(n,t,r,i,e,a),i.side=0,i.needsUpdate=!0,x.renderBufferDirect(n,t,r,i,e,a),i.side=2):x.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(x,t,n,r,i,a)}function Ye(e,t,n){!0!==t.isScene&&(t=X);const r=Q.get(e),i=v.state.lights,a=v.state.shadowsArray,s=i.state.version,o=se.getParameters(e,i.state,a,t,n),l=se.getProgramCacheKey(o);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ne:te).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Fe),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===s)return Je(e,o),u}else o.uniforms=se.getUniforms(e),e.onBeforeCompile(o,x),u=se.acquireProgram(o,l),c.set(l,u),r.uniforms=o.uniforms;const h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=de.uniform),Je(e,o),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function Ze(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=Ld.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Je(e,t){const n=Q.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}He.setAnimationLoop(function(e){ze&&ze(e)}),"undefined"!=typeof self&&He.setContext(self),this.setAnimationLoop=function(e){ze=e,Ie.setAnimationLoop(e),null===e?He.stop():He.start()},Ie.addEventListener("sessionstart",Be),Ie.addEventListener("sessionend",Ve),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return;if(!0===b)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Ie.enabled&&!0===Ie.isPresenting&&(!0===Ie.cameraAutoUpdate&&Ie.updateCamera(t),t=Ie.getCamera()),!0===e.isScene&&e.onBeforeRender(x,e,t,w),v=ue.get(e,_.length),v.init(t),_.push(v),j.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(j,Ot,t.reversedDepth),H=this.localClippingEnabled,V=de.init(this.clippingPlanes,H),g=le.get(e,y.length),g.init(),y.push(g),!0===Ie.enabled&&!0===Ie.isPresenting){const e=x.xr.getDepthSensingMesh();null!==e&&je(e,t,-1/0,x.sortObjects)}je(e,t,0,x.sortObjects),g.finish(),!0===x.sortObjects&&g.sort(U,O),q=!1===Ie.enabled||!1===Ie.isPresenting||!1===Ie.hasDepthSensing(),q&&me.addToRenderList(g,e),this.info.render.frame++,!0===V&&de.beginShadows();const n=v.state.shadowsArray;pe.render(n,e,t),!0===V&&de.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=g.opaque,i=g.transmissive;if(v.setupLights(),t.isArrayCamera){const n=t.cameras;if(i.length>0)for(let t=0,a=n.length;t<a;t++){We(r,i,e,n[t])}q&&me.render(e);for(let t=0,r=n.length;t<r;t++){const r=n[t];Ge(g,e,r,r.viewport)}}else i.length>0&&We(r,i,e,t),q&&me.render(e),Ge(g,e,t);null!==w&&0===M&&(ee.updateMultisampleRenderTarget(w),ee.updateRenderTargetMipmap(w)),!0===e.isScene&&e.onAfterRender(x,e,t),Te.resetDefaultState(),T=-1,E=null,_.pop(),_.length>0?(v=_[_.length-1],!0===V&&de.setGlobalState(x.clippingPlanes,v.state.camera)):v=null,y.pop(),g=y.length>0?y[y.length-1]:null},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(e,t,n){const r=Q.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),Q.get(e.texture).__webglTexture=t,Q.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=Q.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const $e=Ae.createFramebuffer();this.setRenderTarget=function(e,t=0,n=0){w=e,S=t,M=n;let r=!0,i=null,a=!1,s=!1;if(e){const o=Q.get(e);if(void 0!==o.__useDefaultFramebuffer)$.bindFramebuffer(Ae.FRAMEBUFFER,null),r=!1;else if(void 0===o.__webglFramebuffer)ee.setupRenderTarget(e);else if(o.__hasExternalTextures)ee.rebindTextures(e,Q.get(e.texture).__webglTexture,Q.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(o.__boundDepthTexture!==t){if(null!==t&&Q.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ee.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(s=!0);const c=Q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],a=!0):i=e.samples>0&&!1===ee.useMultisampledRTT(e)?Q.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,A.copy(e.viewport),C.copy(e.scissor),R=e.scissorTest}else A.copy(F).multiplyScalar(L).floor(),C.copy(k).multiplyScalar(L).floor(),R=z;0!==n&&(i=$e);if($.bindFramebuffer(Ae.FRAMEBUFFER,i)&&r&&$.drawBuffers(e,i),$.viewport(A),$.scissor(C),$.setScissorTest(R),a){const r=Q.get(e.texture);Ae.framebufferTexture2D(Ae.FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Ae.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(s){const r=t;for(let t=0;t<e.textures.length;t++){const i=Q.get(e.textures[t]);Ae.framebufferTextureLayer(Ae.FRAMEBUFFER,Ae.COLOR_ATTACHMENT0+t,i.__webglTexture,n,r)}}else if(null!==e&&0!==n){const t=Q.get(e.texture);Ae.framebufferTexture2D(Ae.FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Ae.TEXTURE_2D,t.__webglTexture,n)}T=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,s,o=0){if(!e||!e.isWebGLRenderTarget)return;let l=Q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){$.bindFramebuffer(Ae.FRAMEBUFFER,l);try{const s=e.textures[o],l=s.format,c=s.type;if(!J.textureFormatReadable(l))return;if(!J.textureTypeReadable(c))return;t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&(e.textures.length>1&&Ae.readBuffer(Ae.COLOR_ATTACHMENT0+o),Ae.readPixels(t,n,r,i,we.convert(l),we.convert(c),a))}finally{const e=null!==w?Q.get(w).__webglFramebuffer:null;$.bindFramebuffer(Ae.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,r,i,a,s,o=0){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=Q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i){$.bindFramebuffer(Ae.FRAMEBUFFER,l);const s=e.textures[o],c=s.format,u=s.type;if(!J.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!J.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const h=Ae.createBuffer();Ae.bindBuffer(Ae.PIXEL_PACK_BUFFER,h),Ae.bufferData(Ae.PIXEL_PACK_BUFFER,a.byteLength,Ae.STREAM_READ),e.textures.length>1&&Ae.readBuffer(Ae.COLOR_ATTACHMENT0+o),Ae.readPixels(t,n,r,i,we.convert(c),we.convert(u),0);const d=null!==w?Q.get(w).__webglFramebuffer:null;$.bindFramebuffer(Ae.FRAMEBUFFER,d);const p=Ae.fenceSync(Ae.SYNC_GPU_COMMANDS_COMPLETE,0);return Ae.flush(),await function(e,t,n){return new Promise(function(r,i){setTimeout(function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:r()}},n)})}(Ae,p,4),Ae.bindBuffer(Ae.PIXEL_PACK_BUFFER,h),Ae.getBufferSubData(Ae.PIXEL_PACK_BUFFER,0,a),Ae.deleteBuffer(h),Ae.deleteSync(p),a}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),s=null!==t?t.x:0,o=null!==t?t.y:0;ee.setTexture2D(e,0),Ae.copyTexSubImage2D(Ae.TEXTURE_2D,n,0,0,s,o,i,a),$.unbindTexture()};const Ke=Ae.createFramebuffer(),Qe=Ae.createFramebuffer();this.copyTextureToTexture=function(e,t,n=null,r=null,i=0,a=null){let s,o,l,c,u,h,d,p,f;null===a&&(0!==i?(un("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),a=i,i=0):a=0);const m=e.isCompressedTexture?e.mipmaps[a]:e.image;if(null!==n)s=n.max.x-n.min.x,o=n.max.y-n.min.y,l=n.isBox3?n.max.z-n.min.z:1,c=n.min.x,u=n.min.y,h=n.isBox3?n.min.z:0;else{const t=Math.pow(2,-i);s=Math.floor(m.width*t),o=Math.floor(m.height*t),l=e.isDataArrayTexture?m.depth:e.isData3DTexture?Math.floor(m.depth*t):1,c=0,u=0,h=0}null!==r?(d=r.x,p=r.y,f=r.z):(d=0,p=0,f=0);const g=we.convert(t.format),v=we.convert(t.type);let y;t.isData3DTexture?(ee.setTexture3D(t,0),y=Ae.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(ee.setTexture2DArray(t,0),y=Ae.TEXTURE_2D_ARRAY):(ee.setTexture2D(t,0),y=Ae.TEXTURE_2D),Ae.pixelStorei(Ae.UNPACK_FLIP_Y_WEBGL,t.flipY),Ae.pixelStorei(Ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ae.pixelStorei(Ae.UNPACK_ALIGNMENT,t.unpackAlignment);const _=Ae.getParameter(Ae.UNPACK_ROW_LENGTH),x=Ae.getParameter(Ae.UNPACK_IMAGE_HEIGHT),b=Ae.getParameter(Ae.UNPACK_SKIP_PIXELS),S=Ae.getParameter(Ae.UNPACK_SKIP_ROWS),M=Ae.getParameter(Ae.UNPACK_SKIP_IMAGES);Ae.pixelStorei(Ae.UNPACK_ROW_LENGTH,m.width),Ae.pixelStorei(Ae.UNPACK_IMAGE_HEIGHT,m.height),Ae.pixelStorei(Ae.UNPACK_SKIP_PIXELS,c),Ae.pixelStorei(Ae.UNPACK_SKIP_ROWS,u),Ae.pixelStorei(Ae.UNPACK_SKIP_IMAGES,h);const w=e.isDataArrayTexture||e.isData3DTexture,T=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const n=Q.get(e),r=Q.get(t),m=Q.get(n.__renderTarget),g=Q.get(r.__renderTarget);$.bindFramebuffer(Ae.READ_FRAMEBUFFER,m.__webglFramebuffer),$.bindFramebuffer(Ae.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<l;v++)w&&(Ae.framebufferTextureLayer(Ae.READ_FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Q.get(e).__webglTexture,i,h+v),Ae.framebufferTextureLayer(Ae.DRAW_FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Q.get(t).__webglTexture,a,f+v)),Ae.blitFramebuffer(c,u,s,o,d,p,s,o,Ae.DEPTH_BUFFER_BIT,Ae.NEAREST);$.bindFramebuffer(Ae.READ_FRAMEBUFFER,null),$.bindFramebuffer(Ae.DRAW_FRAMEBUFFER,null)}else if(0!==i||e.isRenderTargetTexture||Q.has(e)){const n=Q.get(e),r=Q.get(t);$.bindFramebuffer(Ae.READ_FRAMEBUFFER,Ke),$.bindFramebuffer(Ae.DRAW_FRAMEBUFFER,Qe);for(let e=0;e<l;e++)w?Ae.framebufferTextureLayer(Ae.READ_FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,n.__webglTexture,i,h+e):Ae.framebufferTexture2D(Ae.READ_FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Ae.TEXTURE_2D,n.__webglTexture,i),T?Ae.framebufferTextureLayer(Ae.DRAW_FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,r.__webglTexture,a,f+e):Ae.framebufferTexture2D(Ae.DRAW_FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Ae.TEXTURE_2D,r.__webglTexture,a),0!==i?Ae.blitFramebuffer(c,u,s,o,d,p,s,o,Ae.COLOR_BUFFER_BIT,Ae.NEAREST):T?Ae.copyTexSubImage3D(y,a,d,p,f+e,c,u,s,o):Ae.copyTexSubImage2D(y,a,d,p,c,u,s,o);$.bindFramebuffer(Ae.READ_FRAMEBUFFER,null),$.bindFramebuffer(Ae.DRAW_FRAMEBUFFER,null)}else T?e.isDataTexture||e.isData3DTexture?Ae.texSubImage3D(y,a,d,p,f,s,o,l,g,v,m.data):t.isCompressedArrayTexture?Ae.compressedTexSubImage3D(y,a,d,p,f,s,o,l,g,m.data):Ae.texSubImage3D(y,a,d,p,f,s,o,l,g,v,m):e.isDataTexture?Ae.texSubImage2D(Ae.TEXTURE_2D,a,d,p,s,o,g,v,m.data):e.isCompressedTexture?Ae.compressedTexSubImage2D(Ae.TEXTURE_2D,a,d,p,m.width,m.height,g,m.data):Ae.texSubImage2D(Ae.TEXTURE_2D,a,d,p,s,o,g,v,m);Ae.pixelStorei(Ae.UNPACK_ROW_LENGTH,_),Ae.pixelStorei(Ae.UNPACK_IMAGE_HEIGHT,x),Ae.pixelStorei(Ae.UNPACK_SKIP_PIXELS,b),Ae.pixelStorei(Ae.UNPACK_SKIP_ROWS,S),Ae.pixelStorei(Ae.UNPACK_SKIP_IMAGES,M),0===a&&t.generateMipmaps&&Ae.generateMipmap(y),$.unbindTexture()},this.initRenderTarget=function(e){void 0===Q.get(e).__webglFramebuffer&&ee.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?ee.setTextureCube(e,0):e.isData3DTexture?ee.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ee.setTexture2DArray(e,0):ee.setTexture2D(e,0),$.unbindTexture()},this.resetState=function(){S=0,M=0,w=null,$.reset(),Te.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ot}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=fn._getDrawingBufferColorSpace(e),t.unpackColorSpace=fn._getUnpackColorSpace()}}const Cp=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:4,AddEquation:b,AddOperation:2,AdditiveAnimationBlendMode:_t,AdditiveBlending:2,AgXToneMapping:6,AlphaFormat:we,AlwaysCompare:519,AlwaysDepth:1,AlwaysStencilFunc:519,AmbientLight:wc,AnimationAction:ou,AnimationClip:Zl,AnimationLoader:class extends ec{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new rc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r&&r(a),i.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Zl.parse(e[n]);t.push(r)}return t}},AnimationMixer:class extends kt{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,s=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let c=l[o];void 0===c&&(c={},l[o]=c);for(let u=0;u!==i;++u){const e=r[u],i=e.name;let l=c[i];if(void 0!==l)++l.referenceCount,a[u]=l;else{if(l=a[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,i));continue}const r=t&&t._propertyBindings[u].binding.parsedPath;l=new Qc(su.create(n,i,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,i),a[u]=l}s[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,s=a[i],o=s.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;delete s.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,s=a[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[i],0===Object.keys(s).length&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new zl(new Float32Array(2),new Float32Array(2),1,lu),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a="string"==typeof e?Zl.findByName(r,e):e;const s=null!==a?a.uuid:e,o=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==a?a.blendMode:yt),void 0!==o){const e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const c=new ou(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,s,i),c}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"==typeof e?Zl.findByName(n,e):e,a=i?i.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(r,e,i,a)}const s=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)s[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const e=n[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const i in r){const e=r[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},AnimationObjectGroup:class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=jt(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length;let s,o=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=o++,t[h]=d,e.push(u);for(let e=0,t=a;e!==t;++e)i[e].push(new su(u,n[e],r[e]))}else if(d<l){s=e[d];const o=--l,c=e[o];t[c.uuid]=d,e[d]=c,t[h]=o,e[o]=u;for(let e=0,t=a;e!==t;++e){const t=i[e],a=t[o];let s=t[d];t[d]=a,void 0===s&&(s=new su(u,n[e],r[e])),t[o]=s}}else e[d]}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a],o=s.uuid,l=t[o];if(void 0!==l&&l>=i){const a=i++,c=e[a];t[c.uuid]=l,e[l]=c,t[o]=a,e[a]=s;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[a],i=t[l];t[l]=r,t[a]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,a=e.length;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s].uuid,l=t[o];if(void 0!==l)if(delete t[o],l<i){const s=--i,o=e[s],c=--a,u=e[c];t[o.uuid]=l,e[l]=o,t[u.uuid]=s,e[s]=u,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[s],i=t[c];t[l]=r,t[s]=i,t.pop()}}else{const i=--a,s=e[i];i>0&&(t[s.uuid]=l),e[l]=s,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(void 0!==r)return i[r];const a=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[e]=r,a.push(e),s.push(t),i.push(u);for(let h=c,d=o.length;h!==d;++h){const n=o[h];u[h]=new su(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,a=this._bindings,s=a.length-1,o=a[s];t[e[s]]=n,a[n]=o,a.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}},AnimationUtils:class{static convertArray(e,t){return Dl(e,t)}static isTypedArray(e){return Nl(e)}static getKeyframeOrder(e){return Ll(e)}static sortedArray(e,t,n){return Ul(e,t,n)}static flattenJSON(e,t,n,r){Ol(e,t,n,r)}static subclip(e,t,n,r,i=30){return function(e,t,n,r,i=30){const a=e.clone();a.name=t;const s=[];for(let l=0;l<a.tracks.length;++l){const e=a.tracks[l],t=e.getValueSize(),o=[],c=[];for(let a=0;a<e.times.length;++a){const s=e.times[a]*i;if(!(s<n||s>=r)){o.push(e.times[a]);for(let n=0;n<t;++n)c.push(e.values[a*t+n])}}0!==o.length&&(e.times=Dl(o,e.times.constructor),e.values=Dl(c,e.values.constructor),s.push(e))}a.tracks=s;let o=1/0;for(let l=0;l<a.tracks.length;++l)o>a.tracks[l].times[0]&&(o=a.tracks[l].times[0]);for(let l=0;l<a.tracks.length;++l)a.tracks[l].shift(-1*o);return a.resetDuration(),a}(e,t,n,r,i)}static makeClipAdditive(e,t=0,n=e,r=30){return function(e,t=0,n=e,r=30){r<=0&&(r=30);const i=n.tracks.length,a=t/r;for(let s=0;s<i;++s){const t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)continue;const i=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===r});if(void 0===i)continue;let o=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=t.times.length-1;let d;if(a<=t.times[0]){const e=o,n=l-o;d=t.values.slice(e,n)}else if(a>=t.times[h]){const e=h*l+o,n=e+l-o;d=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=o,r=l-o;e.evaluate(a),d=e.resultBuffer.slice(n,r)}"quaternion"===r&&(new $t).fromArray(d).normalize().conjugate().toArray(d);const p=i.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===r)$t.multiplyQuaternionsFlat(i.values,t,d,0,i.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)i.values[t+n]-=d[n]}}}return e.blendMode=_t,e}(e,t,n,r)}},ArcCurve:so,ArrayCamera:Vc,ArrowHelper:class extends Pr{constructor(e=new Kt(0,0,1),t=new Kt(0,0,0),n=1,r=16776960,i=.2*n,a=.2*i){super(),this.type="ArrowHelper",void 0===Hu&&(Hu=new _i,Hu.setAttribute("position",new hi([0,0,0,0,1,0],3)),ju=new Js(.5,1,5,1),ju.translate(0,-.5,0)),this.position.copy(t),this.line=new Ps(Hu,new Ss({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ii(ju,new Qr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Vu.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Vu,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},AttachedBindMode:q,Audio:Yc,AudioAnalyser:class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}},AudioContext:Fc,AudioListener:class extends Pr{constructor(){super(),this.type="AudioListener",this.context=Fc.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Hc}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(jc,Gc,Wc),Xc.set(0,0,-1).applyQuaternion(Gc),qc.set(0,1,0).applyQuaternion(Gc),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(jc.x,e),t.positionY.linearRampToValueAtTime(jc.y,e),t.positionZ.linearRampToValueAtTime(jc.z,e),t.forwardX.linearRampToValueAtTime(Xc.x,e),t.forwardY.linearRampToValueAtTime(Xc.y,e),t.forwardZ.linearRampToValueAtTime(Xc.z,e),t.upX.linearRampToValueAtTime(qc.x,e),t.upY.linearRampToValueAtTime(qc.y,e),t.upZ.linearRampToValueAtTime(qc.z,e)}else t.setPosition(jc.x,jc.y,jc.z),t.setOrientation(Xc.x,Xc.y,Xc.z,qc.x,qc.y,qc.z)}},AudioLoader:class extends ec{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new rc(this.manager);function s(t){r&&r(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(e){try{const n=e.slice(0);Fc.getContext().decodeAudioData(n,function(e){t(e)}).catch(s)}catch(n){s(n)}},n,r)}},AxesHelper:class extends Ls{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new _i;n.setAttribute("position",new hi(t,3)),n.setAttribute("color",new hi([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new Ss({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new Zr,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BackSide:1,BasicDepthPacking:3200,BasicShadowMap:0,BatchedMesh:bs,Bone:Da,BooleanKeyframeTrack:Hl,Box2:class{constructor(e=new Jt(1/0,1/0),t=new Jt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yu.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,yu).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Box3:Pn,Box3Helper:class extends Ls{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new _i;r.setIndex(new li(n,1)),r.setAttribute("position",new hi([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new Ss({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},BoxGeometry:Ni,BoxHelper:class extends Ls{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new _i;i.setIndex(new li(n,1)),i.setAttribute("position",new li(r,3)),super(i,new Ss({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&Bu.setFromObject(this.object),Bu.isEmpty())return;const e=Bu.min,t=Bu.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BufferAttribute:li,BufferGeometry:_i,BufferGeometryLoader:Ic,ByteType:de,Cache:$l,Camera:zi,CameraHelper:class extends Ls{constructor(e){const t=new _i,n=new Ss({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={};function s(e,t){o(e),o(t)}function o(e){r.push(0,0,0),i.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4"),t.setAttribute("position",new hi(r,3)),t.setAttribute("color",new hi(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new Zr(16755200),c=new Zr(16711680),u=new Zr(43775),h=new Zr(16777215),d=new Zr(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,n,r,i){const a=this.geometry.getAttribute("color");return a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap;let n,r;if(ku.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),!0===this.camera.reversedDepth)n=1,r=0;else if(this.camera.coordinateSystem===Ot)n=-1,r=1;else{if(this.camera.coordinateSystem!==Ft)throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);n=0,r=1}zu("c",t,e,ku,0,0,n),zu("t",t,e,ku,0,0,r),zu("n1",t,e,ku,-1,-1,n),zu("n2",t,e,ku,1,-1,n),zu("n3",t,e,ku,-1,1,n),zu("n4",t,e,ku,1,1,n),zu("f1",t,e,ku,-1,-1,r),zu("f2",t,e,ku,1,-1,r),zu("f3",t,e,ku,-1,1,r),zu("f4",t,e,ku,1,1,r),zu("u1",t,e,ku,.7,1.1,n),zu("u2",t,e,ku,-.7,1.1,n),zu("u3",t,e,ku,0,2,n),zu("cf1",t,e,ku,-1,0,r),zu("cf2",t,e,ku,1,0,r),zu("cf3",t,e,ku,0,-1,r),zu("cf4",t,e,ku,0,1,r),zu("cn1",t,e,ku,-1,0,n),zu("cn2",t,e,ku,1,0,n),zu("cn3",t,e,ku,0,-1,n),zu("cn4",t,e,ku,0,1,n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},CanvasTexture:class extends wn{constructor(e,t,n,r,i,a,s,o,l){super(e,t,n,r,i,a,s,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},CapsuleGeometry:qs,CatmullRomCurve3:po,CineonToneMapping:3,CircleGeometry:Ys,ClampToEdgeWrapping:ne,Clock:Hc,Color:Zr,ColorKeyframeTrack:jl,ColorManagement:fn,CompressedArrayTexture:class extends Gs{constructor(e,t,n,r,i,a){super(e,t,n,i,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=ne,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},CompressedCubeTexture:class extends Gs{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,J),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}},CompressedTexture:Gs,CompressedTextureLoader:class extends ec{constructor(e){super(e)}load(e,t,n,r){const i=this,a=[],s=new Gs,o=new rc(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials);let l=0;function c(c){o.load(e[c],function(e){const n=i.parse(e,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=oe),s.image=a,s.format=n.format,s.needsUpdate=!0,t&&t(s))},n,r)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)c(u);else o.load(e,function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)a[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),a[t].format=n.format,a[t].width=n.width,a[t].height=n.height}s.image=a}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=oe),s.format=n.format,s.needsUpdate=!0,t&&t(s)},n,r);return s}},ConeGeometry:Js,ConstantAlphaFactor:213,ConstantColorFactor:211,Controls:class extends kt{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e&&(null!==this.domElement&&this.disconnect(),this.domElement=e)}disconnect(){}dispose(){}update(){}},CubeCamera:Wi,CubeReflectionMapping:J,CubeRefractionMapping:$,CubeTexture:Xi,CubeTextureLoader:sc,CubeUVReflectionMapping:ee,CubicBezierCurve:vo,CubicBezierCurve3:yo,CubicInterpolant:kl,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,CullFaceNone:0,Curve:io,CurvePath:To,CustomBlending:5,CustomToneMapping:5,CylinderGeometry:Zs,Cylindrical:class{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}},Data3DTexture:Rn,DataArrayTexture:Cn,DataTexture:Na,DataTextureLoader:oc,DataUtils:ii,DecrementStencilOp:7683,DecrementWrapStencilOp:34056,DefaultLoadingManager:Ql,DepthFormat:Ae,DepthStencilFormat:Ce,DepthTexture:Ws,DetachedBindMode:Y,DirectionalLight:Mc,DirectionalLightHelper:class extends Pr{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new _i;r.setAttribute("position",new hi([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new Ss({fog:!1,toneMapped:!1});this.lightPlane=new Ps(r,i),this.add(this.lightPlane),r=new _i,r.setAttribute("position",new hi([0,0,0,0,0,1],3)),this.targetLine=new Ps(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Lu.setFromMatrixPosition(this.light.matrixWorld),Uu.setFromMatrixPosition(this.light.target.matrixWorld),Ou.subVectors(Uu,Lu),this.lightPlane.lookAt(Uu),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Uu),this.targetLine.scale.z=Ou.length()}},DiscreteInterpolant:Bl,DodecahedronGeometry:Ks,DoubleSide:2,DstAlphaFactor:206,DstColorFactor:208,DynamicCopyUsage:35050,DynamicDrawUsage:35048,DynamicReadUsage:35049,EdgesGeometry:ro,EllipseCurve:ao,EqualCompare:514,EqualDepth:4,EqualStencilFunc:514,EquirectangularReflectionMapping:K,EquirectangularRefractionMapping:Q,Euler:pr,EventDispatcher:kt,ExternalTexture:Xs,ExtrudeGeometry:il,FileLoader:rc,Float16BufferAttribute:class extends li{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=ri(this.array[e*this.itemSize]);return this.normalized&&(t=qt(t,this.array)),t}setX(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize]=ni(t),this}getY(e){let t=ri(this.array[e*this.itemSize+1]);return this.normalized&&(t=qt(t,this.array)),t}setY(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize+1]=ni(t),this}getZ(e){let t=ri(this.array[e*this.itemSize+2]);return this.normalized&&(t=qt(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize+2]=ni(t),this}getW(e){let t=ri(this.array[e*this.itemSize+3]);return this.normalized&&(t=qt(t,this.array)),t}setW(e,t){return this.normalized&&(t=Yt(t,this.array)),this.array[e*this.itemSize+3]=ni(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array)),this.array[e+0]=ni(t),this.array[e+1]=ni(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array),r=Yt(r,this.array)),this.array[e+0]=ni(t),this.array[e+1]=ni(n),this.array[e+2]=ni(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=Yt(t,this.array),n=Yt(n,this.array),r=Yt(r,this.array),i=Yt(i,this.array)),this.array[e+0]=ni(t),this.array[e+1]=ni(n),this.array[e+2]=ni(r),this.array[e+3]=ni(i),this}},Float32BufferAttribute:hi,FloatType:ve,Fog:Ki,FogExp2:$i,FramebufferTexture:class extends wn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ie,this.minFilter=ie,this.generateMipmaps=!1,this.needsUpdate=!0}},FrontSide:0,Frustum:Qa,FrustumArray:ns,GLBufferAttribute:class{constructor(e,t,n,r,i,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.normalized=a,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},GLSL1:"100",GLSL3:Ut,GreaterCompare:516,GreaterDepth:6,GreaterEqualCompare:518,GreaterEqualDepth:5,GreaterEqualStencilFunc:518,GreaterStencilFunc:516,GridHelper:class extends Ls{constructor(e=10,t=10,n=4473924,r=8947848){n=new Zr(n),r=new Zr(r);const i=t/2,a=e/t,s=e/2,o=[],l=[];for(let u=0,h=0,d=-s;u<=t;u++,d+=a){o.push(-s,0,d,s,0,d),o.push(d,0,-s,d,0,s);const e=u===i?n:r;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const c=new _i;c.setAttribute("position",new hi(o,3)),c.setAttribute("color",new hi(l,3));super(c,new Ss({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},Group:Yi,HalfFloatType:ye,HemisphereLight:cc,HemisphereLightHelper:class extends Pr{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new ll(t);r.rotateY(.5*Math.PI),this.material=new Qr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new li(a,3)),this.add(new Ii(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Du.copy(this.light.color),Nu.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?Du:Nu;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Iu.setFromMatrixPosition(this.light.matrixWorld).negate())}},IcosahedronGeometry:sl,ImageBitmapLoader:class extends ec{constructor(e){super(e),this.isImageBitmapLoader=!0,this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=$l.get(`image-bitmap:${e}`);if(void 0!==a)return i.manager.itemStart(e),a.then?void a.then(n=>{if(!0!==Uc.has(a))return t&&t(n),i.manager.itemEnd(e),n;r&&r(Uc.get(a)),i.manager.itemError(e),i.manager.itemEnd(e)}):(setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a);const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,s.signal="function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const o=fetch(e,s).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(n){return $l.add(`image-bitmap:${e}`,n),t&&t(n),i.manager.itemEnd(e),n}).catch(function(t){r&&r(t),Uc.set(o,t),$l.remove(`image-bitmap:${e}`),i.manager.itemError(e),i.manager.itemEnd(e)});$l.add(`image-bitmap:${e}`,o),i.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}},ImageLoader:ac,ImageUtils:yn,IncrementStencilOp:7682,IncrementWrapStencilOp:34055,InstancedBufferAttribute:Fa,InstancedBufferGeometry:Pc,InstancedInterleavedBuffer:class extends ea{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}},InstancedMesh:Wa,Int16BufferAttribute:class extends li{constructor(e,t,n){super(new Int16Array(e),t,n)}},Int32BufferAttribute:class extends li{constructor(e,t,n){super(new Int32Array(e),t,n)}},Int8BufferAttribute:class extends li{constructor(e,t,n){super(new Int8Array(e),t,n)}},IntType:me,InterleavedBuffer:ea,InterleavedBufferAttribute:na,Interpolant:Fl,InterpolateDiscrete:dt,InterpolateLinear:pt,InterpolateSmooth:ft,InterpolationSamplingMode:{NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"},InterpolationSamplingType:{PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},InvertStencilOp:5386,KeepStencilOp:Tt,KeyframeTrack:Vl,LOD:ba,LatheGeometry:ol,Layers:fr,LessCompare:513,LessDepth:2,LessEqualCompare:515,LessEqualDepth:3,LessEqualStencilFunc:515,LessStencilFunc:513,Light:lc,LightProbe:Ac,Line:Ps,Line3:class{constructor(e=new Kt,t=new Kt){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){_u.subVectors(e,this.start),xu.subVectors(this.end,this.start);const n=xu.dot(xu);let r=xu.dot(_u)/n;return t&&(r=Gt(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=wu,n=Tu){const r=1e-8*1e-8;let i,a;const s=this.start,o=e.start,l=this.end,c=e.end;bu.subVectors(l,s),Su.subVectors(c,o),Mu.subVectors(s,o);const u=bu.dot(bu),h=Su.dot(Su),d=Su.dot(Mu);if(u<=r&&h<=r)return t.copy(s),n.copy(o),t.sub(n),t.dot(t);if(u<=r)i=0,a=d/h,a=Gt(a,0,1);else{const e=bu.dot(Mu);if(h<=r)a=0,i=Gt(-e/u,0,1);else{const t=bu.dot(Su),n=u*h-t*t;i=0!==n?Gt((t*d-e*h)/n,0,1):0,a=(t*i+d)/h,a<0?(a=0,i=Gt(-e/u,0,1)):a>1&&(a=1,i=Gt((t-e)/u,0,1))}}return t.copy(s).add(bu.multiplyScalar(i)),n.copy(o).add(Su.multiplyScalar(a)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},LineBasicMaterial:Ss,LineCurve:_o,LineCurve3:xo,LineDashedMaterial:Il,LineLoop:Us,LineSegments:Ls,LinearFilter:oe,LinearInterpolant:zl,LinearMipMapLinearFilter:ue,LinearMipMapNearestFilter:1007,LinearMipmapLinearFilter:ce,LinearMipmapNearestFilter:le,LinearSRGBColorSpace:St,LinearToneMapping:1,LinearTransfer:Mt,Loader:ec,LoaderUtils:Rc,LoadingManager:Kl,LoopOnce:2200,LoopPingPong:2202,LoopRepeat:2201,MOUSE:g,Material:Kr,MaterialLoader:Cc,MathUtils:Zt,Matrix2:vu,Matrix3:tn,Matrix4:rr,MaxEquation:104,Mesh:Ii,MeshBasicMaterial:Qr,MeshDepthMaterial:Cl,MeshDistanceMaterial:Rl,MeshLambertMaterial:Al,MeshMatcapMaterial:Pl,MeshNormalMaterial:El,MeshPhongMaterial:wl,MeshPhysicalMaterial:Ml,MeshStandardMaterial:Sl,MeshToonMaterial:Tl,MinEquation:103,MirroredRepeatWrapping:re,MixOperation:1,MultiplyBlending:4,MultiplyOperation:0,NearestFilter:ie,NearestMipMapLinearFilter:1005,NearestMipMapNearestFilter:1004,NearestMipmapLinearFilter:se,NearestMipmapNearestFilter:ae,NeutralToneMapping:7,NeverCompare:512,NeverDepth:0,NeverStencilFunc:512,NoBlending:0,NoColorSpace:xt,NoToneMapping:0,NormalAnimationBlendMode:yt,NormalBlending:1,NotEqualCompare:517,NotEqualDepth:7,NotEqualStencilFunc:517,NumberKeyframeTrack:Gl,Object3D:Pr,ObjectLoader:class extends ec{constructor(e){super(e)}load(e,t,n,r){const i=this,a=""===this.path?Rc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const s=new rc(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){let a=null;try{a=JSON.parse(n)}catch(o){return void(void 0!==r&&r(o))}const s=a.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?i.parse(a,t):void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e))},n,r)}async loadAsync(e,t){const n=""===this.path?Rc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new rc(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),a=JSON.parse(i),s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){void 0!==t&&t(l)}),s=this.parseTextures(e.textures,a),o=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,i,o,s,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(const t in a)if(a[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,a),o=this.parseObject(e.object,r,s,a,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),this.bindLightTargets(o),o}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new Ao).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(e){e.isBone&&(r[e.uuid]=e)}),void 0!==e)for(let i=0,a=e.length;i<a;i++){const t=(new Oa).fromJSON(e[i],r);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new Ic;for(let i=0,a=e.length;i<a;i++){let a;const s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;default:s.type in _l&&(a=_l[s.type].fromJSON(s,t))}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const i=new Cc;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){const a=e[t];void 0===n[a.uuid]&&(n[a.uuid]=i.parse(a)),r[a.uuid]=n[a.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],i=Zl.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function a(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),i.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:sn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new Kl(t);i=new ac(n),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const n=e[t],i=n.url;if(Array.isArray(i)){const e=[];for(let t=0,n=i.length;t<n;t++){const n=a(i[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new Na(n.data,n.width,n.height)))}r[n.uuid]=new xn(e)}else{const e=a(n.url);r[n.uuid]=new xn(e)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(e){if("string"==typeof e){const n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}return e.data?{data:sn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){r=new ac(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],a=r.url;if(Array.isArray(a)){const e=[];for(let t=0,n=a.length;t<n;t++){const n=a[t],r=await i(n);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new Na(r.data,r.width,r.height)))}n[r.uuid]=new xn(e)}else{const e=await i(r.url);n[r.uuid]=new xn(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:t[e]}const r={};if(void 0!==e)for(let i=0,a=e.length;i<a;i++){const a=e[i];a.image,t[a.image];const s=t[a.image],o=s.data;let l;Array.isArray(o)?(l=new Xi,6===o.length&&(l.needsUpdate=!0)):(l=o&&o.data?new Na:new wn,o&&(l.needsUpdate=!0)),l.source=s,l.uuid=a.uuid,void 0!==a.name&&(l.name=a.name),void 0!==a.mapping&&(l.mapping=n(a.mapping,Dc)),void 0!==a.channel&&(l.channel=a.channel),void 0!==a.offset&&l.offset.fromArray(a.offset),void 0!==a.repeat&&l.repeat.fromArray(a.repeat),void 0!==a.center&&l.center.fromArray(a.center),void 0!==a.rotation&&(l.rotation=a.rotation),void 0!==a.wrap&&(l.wrapS=n(a.wrap[0],Nc),l.wrapT=n(a.wrap[1],Nc)),void 0!==a.format&&(l.format=a.format),void 0!==a.internalFormat&&(l.internalFormat=a.internalFormat),void 0!==a.type&&(l.type=a.type),void 0!==a.colorSpace&&(l.colorSpace=a.colorSpace),void 0!==a.minFilter&&(l.minFilter=n(a.minFilter,Lc)),void 0!==a.magFilter&&(l.magFilter=n(a.magFilter,Lc)),void 0!==a.anisotropy&&(l.anisotropy=a.anisotropy),void 0!==a.flipY&&(l.flipY=a.flipY),void 0!==a.generateMipmaps&&(l.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(l.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(l.unpackAlignment=a.unpackAlignment),void 0!==a.compareFunction&&(l.compareFunction=a.compareFunction),void 0!==a.userData&&(l.userData=a.userData),r[a.uuid]=l}return r}parseObject(e,t,n,r,i){let a,s,o;function l(e){return t[e],t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];n[i],t.push(n[i])}return t}return n[e],n[e]}}function u(e){return r[e],r[e]}switch(e.type){case"Scene":a=new Qi,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new Zr(e.background):a.background=u(e.background)),void 0!==e.environment&&(a.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new Ki(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new $i(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&a.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(a.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new ji(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new bc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new wc(e.color,e.intensity);break;case"DirectionalLight":a=new Mc(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new xc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Tc(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new mc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new cc(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Ac).fromJSON(e);break;case"SkinnedMesh":s=l(e.geometry),o=c(e.material),a=new Ia(s,o),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":s=l(e.geometry),o=c(e.material),a=new Ii(s,o);break;case"InstancedMesh":s=l(e.geometry),o=c(e.material);const t=e.count,n=e.instanceMatrix,r=e.instanceColor;a=new Wa(s,o,t),a.instanceMatrix=new Fa(new Float32Array(n.array),16),void 0!==r&&(a.instanceColor=new Fa(new Float32Array(r.array),r.itemSize));break;case"BatchedMesh":s=l(e.geometry),o=c(e.material),a=new bs(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,o),a.geometry=s,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(e=>{let t=null,n=null;return void 0!==e.boundingBox&&(t=(new Pn).fromJSON(e.boundingBox)),void 0!==e.boundingSphere&&(n=(new Yn).fromJSON(e.boundingSphere)),{...e,boundingBox:t,boundingSphere:n}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=u(e.matricesTexture.uuid),a._indirectTexture=u(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(a._colorsTexture=u(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(a.boundingSphere=(new Yn).fromJSON(e.boundingSphere)),void 0!==e.boundingBox&&(a.boundingBox=(new Pn).fromJSON(e.boundingBox));break;case"LOD":a=new ba;break;case"Line":a=new Ps(l(e.geometry),c(e.material));break;case"LineLoop":a=new Us(l(e.geometry),c(e.material));break;case"LineSegments":a=new Ls(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new Vs(l(e.geometry),c(e.material));break;case"Sprite":a=new va(c(e.material));break;case"Group":a=new Yi;break;case"Bone":a=new Da;break;default:a=new Pr}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(a.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children){const s=e.children;for(let e=0;e<s.length;e++)a.add(this.parseObject(s[e],t,n,r,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];a.animations.push(i[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=a.getObjectByProperty("uuid",n.object);void 0!==r&&a.addLevel(r,n.distance,n.hysteresis)}}return a}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n||e.bind(n,e.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);t.target=void 0!==r?r:new Pr}})}},ObjectSpaceNormalMap:1,OctahedronGeometry:ll,OneFactor:201,OneMinusConstantAlphaFactor:214,OneMinusConstantColorFactor:212,OneMinusDstAlphaFactor:207,OneMinusDstColorFactor:209,OneMinusSrcAlphaFactor:R,OneMinusSrcColorFactor:203,OrthographicCamera:bc,PCFShadowMap:1,PCFSoftShadowMap:2,PMREMGenerator:vh,Path:Eo,PerspectiveCamera:ji,Plane:Za,PlaneGeometry:cl,PlaneHelper:class extends Ps{constructor(e,t=1,n=16776960){const r=n,i=new _i;i.setAttribute("position",new hi([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new Ss({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=new _i;a.setAttribute("position",new hi([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),a.computeBoundingSphere(),this.add(new Ii(a,new Qr({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},PointLight:xc,PointLightHelper:class extends Ii{constructor(e,t,n){super(new dl(t,4,2),new Qr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Points:Vs,PointsMaterial:Os,PolarGridHelper:class extends Ls{constructor(e=10,t=16,n=8,r=64,i=4473924,a=8947848){i=new Zr(i),a=new Zr(a);const s=[],o=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),r=Math.sin(n)*e,l=Math.cos(n)*e;s.push(0,0,0),s.push(r,0,l);const u=1&c?i:a;o.push(u.r,u.g,u.b),o.push(u.r,u.g,u.b)}for(let c=0;c<n;c++){const t=1&c?i:a,l=e-e/n*c;for(let e=0;e<r;e++){let n=e/r*(2*Math.PI),i=Math.sin(n)*l,a=Math.cos(n)*l;s.push(i,0,a),o.push(t.r,t.g,t.b),n=(e+1)/r*(2*Math.PI),i=Math.sin(n)*l,a=Math.cos(n)*l,s.push(i,0,a),o.push(t.r,t.g,t.b)}}const l=new _i;l.setAttribute("position",new hi(s,3)),l.setAttribute("color",new hi(o,3));super(l,new Ss({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},PolyhedronGeometry:$s,PositionalAudio:class extends Yc{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Zc,Jc,$c),Kc.set(0,0,1).applyQuaternion(Jc);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Zc.x,e),t.positionY.linearRampToValueAtTime(Zc.y,e),t.positionZ.linearRampToValueAtTime(Zc.z,e),t.orientationX.linearRampToValueAtTime(Kc.x,e),t.orientationY.linearRampToValueAtTime(Kc.y,e),t.orientationZ.linearRampToValueAtTime(Kc.z,e)}else t.setPosition(Zc.x,Zc.y,Zc.z),t.setOrientation(Kc.x,Kc.y,Kc.z)}},PropertyBinding:su,PropertyMixer:Qc,QuadraticBezierCurve:bo,QuadraticBezierCurve3:So,Quaternion:$t,QuaternionKeyframeTrack:Xl,QuaternionLinearInterpolant:Wl,RED_GREEN_RGTC2_Format:ut,RED_RGTC1_Format:lt,REVISION:m,RGBADepthPacking:3201,RGBAFormat:Ee,RGBAIntegerFormat:Ne,RGBA_ASTC_10x10_Format:nt,RGBA_ASTC_10x5_Format:Qe,RGBA_ASTC_10x6_Format:et,RGBA_ASTC_10x8_Format:tt,RGBA_ASTC_12x10_Format:rt,RGBA_ASTC_12x12_Format:it,RGBA_ASTC_4x4_Format:We,RGBA_ASTC_5x4_Format:Xe,RGBA_ASTC_5x5_Format:qe,RGBA_ASTC_6x5_Format:Ye,RGBA_ASTC_6x6_Format:Ze,RGBA_ASTC_8x5_Format:Je,RGBA_ASTC_8x6_Format:$e,RGBA_ASTC_8x8_Format:Ke,RGBA_BPTC_Format:at,RGBA_ETC2_EAC_Format:Ge,RGBA_PVRTC_2BPPV1_Format:Ve,RGBA_PVRTC_4BPPV1_Format:Be,RGBA_S3TC_DXT1_Format:Ue,RGBA_S3TC_DXT3_Format:Oe,RGBA_S3TC_DXT5_Format:Fe,RGBDepthPacking:3202,RGBFormat:Te,RGBIntegerFormat:1032,RGB_BPTC_SIGNED_Format:st,RGB_BPTC_UNSIGNED_Format:ot,RGB_ETC1_Format:He,RGB_ETC2_Format:je,RGB_PVRTC_2BPPV1_Format:ze,RGB_PVRTC_4BPPV1_Format:ke,RGB_S3TC_DXT1_Format:Le,RGDepthPacking:3203,RGFormat:Ie,RGIntegerFormat:De,RawShaderMaterial:bl,Ray:nr,Raycaster:du,RectAreaLight:Tc,RedFormat:Re,RedIntegerFormat:Pe,ReinhardToneMapping:2,RenderTarget:En,RenderTarget3D:class extends En{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Rn(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},RepeatWrapping:te,ReplaceStencilOp:7681,ReverseSubtractEquation:102,RingGeometry:ul,SIGNED_RED_GREEN_RGTC2_Format:ht,SIGNED_RED_RGTC1_Format:ct,SRGBColorSpace:bt,SRGBTransfer:wt,Scene:Qi,ShaderChunk:qu,ShaderLib:Zu,ShaderMaterial:ki,ShadowMaterial:xl,Shape:Ao,ShapeGeometry:hl,ShapePath:class{constructor(){this.type="ShapePath",this.color=new Zr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Eo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let r=!1;for(let i=n-1,a=0;a<n;i=a++){let n=t[i],s=t[a],o=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[a],o=-o,s=t[i],l=-l),e.y<n.y||e.y>s.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-o*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x)return!0}}return r}const n=tl.isClockWise,r=this.subPaths;if(0===r.length)return[];let i,a,s;const o=[];if(1===r.length)return a=r[0],s=new Ao,s.curves=a.curves,o.push(s),o;let l=!n(r[0].getPoints());l=e?!l:l;const c=[],u=[];let h,d,p=[],f=0;u[f]=void 0,p[f]=[];for(let m=0,g=r.length;m<g;m++)a=r[m],h=a.getPoints(),i=n(h),i=e?!i:i,i?(!l&&u[f]&&f++,u[f]={s:new Ao,p:h},u[f].s.curves=a.curves,l&&f++,p[f]=[]):p[f].push({h:a,p:h[0]});if(!u[0])return function(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new Ao;i.curves=r.curves,t.push(i)}return t}(r);if(u.length>1){let e=!1,n=0;for(let t=0,r=u.length;t<r;t++)c[t]=[];for(let r=0,i=u.length;r<i;r++){const i=p[r];for(let a=0;a<i.length;a++){const s=i[a];let o=!0;for(let i=0;i<u.length;i++)t(s.p,u[i].p)&&(r!==i&&n++,o?(o=!1,c[i].push(s)):e=!0);o&&c[r].push(s)}}n>0&&!1===e&&(p=c)}for(let m=0,g=u.length;m<g;m++){s=u[m].s,o.push(s),d=p[m];for(let e=0,t=d.length;e<t;e++)s.holes.push(d[e].h)}return o}},ShapeUtils:tl,ShortType:pe,Skeleton:Oa,SkeletonHelper:class extends Ls{constructor(e){const t=Pu(e),n=new _i,r=[],i=[];for(let o=0;o<t.length;o++){const e=t[o];e.parent&&e.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(0,0,0),i.push(0,0,0))}n.setAttribute("position",new hi(r,3)),n.setAttribute("color",new hi(i,3));super(n,new Ss({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const a=new Zr(255),s=new Zr(65280);this.setColors(a,s)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Ru.copy(this.root.matrixWorld).invert();for(let i=0,a=0;i<t.length;i++){const e=t[i];e.parent&&e.parent.isBone&&(Cu.multiplyMatrices(Ru,e.matrixWorld),Au.setFromMatrixPosition(Cu),r.setXYZ(a,Au.x,Au.y,Au.z),Cu.multiplyMatrices(Ru,e.parent.matrixWorld),Au.setFromMatrixPosition(Cu),r.setXYZ(a+1,Au.x,Au.y,Au.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const n=this.geometry.getAttribute("color");for(let r=0;r<n.count;r+=2)n.setXYZ(r,e.r,e.g,e.b),n.setXYZ(r+1,t.r,t.g,t.b);return n.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},SkinnedMesh:Ia,Source:xn,Sphere:Yn,SphereGeometry:dl,Spherical:gu,SphericalHarmonics3:Ec,SplineCurve:Mo,SpotLight:mc,SpotLightHelper:class extends Pr{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new _i,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,s=1,o=32;a<o;a++,s++){const e=a/o*Math.PI*2,t=s/o*Math.PI*2;r.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new hi(r,3));const i=new Ss({fog:!1,toneMapped:!1});this.cone=new Ls(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Eu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Eu),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Sprite:va,SpriteMaterial:ra,SrcAlphaFactor:C,SrcAlphaSaturateFactor:210,SrcColorFactor:202,StaticCopyUsage:35046,StaticDrawUsage:Lt,StaticReadUsage:35045,StereoCamera:class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ji,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ji,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Bc.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(Vt*t.fov*.5)/t.zoom;let a,s;zc.elements[12]=-n,kc.elements[12]=n,a=-i*t.aspect+r,s=i*t.aspect+r,Bc.elements[0]=2*t.near/(s-a),Bc.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(Bc),a=-i*t.aspect-r,s=i*t.aspect-r,Bc.elements[0]=2*t.near/(s-a),Bc.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(Bc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(zc),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(kc)}},StreamCopyUsage:35042,StreamDrawUsage:35040,StreamReadUsage:35041,StringKeyframeTrack:ql,SubtractEquation:101,SubtractiveBlending:3,TOUCH:v,TangentSpaceNormalMap:0,TetrahedronGeometry:pl,Texture:wn,TextureLoader:class extends ec{constructor(e){super(e)}load(e,t,n,r){const i=new wn,a=new ac(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)},n,r),i}},TextureUtils:class{static contain(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}(e,t)}static cover(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}(e,t)}static fill(e){return function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}(e)}static getByteLength(e,t,n,r){return Gu(e,t,n,r)}},Timer:class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,void 0!==e.hidden&&(this._pageVisibilityHandler=mu.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){null!==this._pageVisibilityHandler&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return null!==this._pageVisibilityHandler&&!0===this._document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==e?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}},TimestampQuery:{COMPUTE:"compute",RENDER:"render"},TorusGeometry:fl,TorusKnotGeometry:ml,Triangle:Gr,TriangleFanDrawMode:2,TriangleStripDrawMode:1,TrianglesDrawMode:0,TubeGeometry:gl,UVMapping:Z,Uint16BufferAttribute:ci,Uint32BufferAttribute:ui,Uint8BufferAttribute:class extends li{constructor(e,t,n){super(new Uint8Array(e),t,n)}},Uint8ClampedBufferAttribute:class extends li{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},Uniform:cu,UniformsGroup:class extends kt{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:uu++}),this.name="",this.usage=Lt,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}},UniformsLib:Yu,UniformsUtils:Fi,UnsignedByteType:he,UnsignedInt101111Type:Me,UnsignedInt248Type:be,UnsignedInt5999Type:Se,UnsignedIntType:ge,UnsignedShort4444Type:_e,UnsignedShort5551Type:xe,UnsignedShortType:fe,VSMShadowMap:3,Vector2:Jt,Vector3:Kt,Vector4:Tn,VectorKeyframeTrack:Yl,VideoFrameTexture:class extends js{constructor(e,t,n,r,i,a,s,o){super({},e,t,n,r,i,a,s,o),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}},VideoTexture:js,WebGL3DRenderTarget:class extends An{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Rn(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},WebGLArrayRenderTarget:class extends An{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Cn(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},WebGLCoordinateSystem:Ot,WebGLCubeRenderTarget:qi,WebGLRenderTarget:An,WebGLRenderer:Ap,WebGLUtils:xp,WebGPUCoordinateSystem:Ft,WebXRController:Ji,WireframeGeometry:vl,WrapAroundEnding:vt,ZeroCurvatureEnding:mt,ZeroFactor:200,ZeroSlopeEnding:gt,ZeroStencilOp:0,createCanvasElement:ln},Symbol.toStringTag,{value:"Module"}));var Rp,Pp,Ip={exports:{}},Dp={};var Np=(Pp||(Pp=1,Ip.exports=(Rp||(Rp=1,
/**
   * @license React
   * use-sync-external-store-shim/with-selector.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */
function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var e=r(),t=o(),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=t.useSyncExternalStore,a=e.useRef,s=e.useEffect,l=e.useMemo,c=e.useDebugValue;Dp.useSyncExternalStoreWithSelector=function(e,t,r,o,u){var h=a(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=l(function(){function e(e){if(!s){if(s=!0,i=e,e=o(e),void 0!==u&&d.hasValue){var t=d.value;if(u(t,e))return a=t}return a=e}if(t=a,n(i,e))return t;var r=o(e);return void 0!==u&&u(t,r)?(i=e,t):(i=e,a=r)}var i,a,s=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,o,u]);var p=i(e,h[0],h[1]);return s(function(){d.hasValue=!0,d.value=p},[p]),c(p),p},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),Dp)),Ip.exports);const Lp=i(Np),{useSyncExternalStoreWithSelector:Up}=Lp,Op=e=>e;const Fp=(t,n)=>{const r=e(t),i=(e,t=n)=>function(e,t=Op,n){const r=Up(e.subscribe,e.getState,e.getInitialState,t,n);return a.useDebugValue(r),r}(r,e,t);return Object.assign(i,r),i},kp=(e,t)=>e?Fp(e,t):Fp,zp=[];function Bp(e,t,n=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}function Vp(e,t=null,n=!1,r={}){null===t&&(t=[e]);for(const s of zp)if(Bp(t,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!n)throw s.promise}const i={keys:t,equal:r.equal,remove:()=>{const e=zp.indexOf(i);-1!==e&&zp.splice(e,1)},promise:(a=e,"object"==typeof a&&"function"==typeof a.then?e:e(...t)).then(e=>{i.response=e,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(e=>i.error=e)};var a;if(zp.push(i),!n)throw i.promise}var Hp,jp,Gp,Wp,Xp={exports:{}},qp={exports:{}},Yp={exports:{}},Zp={};function Jp(){return jp||(jp=1,Yp.exports=(Hp||(Hp=1,e=Zp,
/**
     * @license React
     * scheduler.development.js
     *
     * Copyright (c) Meta Platforms, Inc. and affiliates.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE file in the root directory of this source tree.
     */
function(){function t(){if(T){var t=e.unstable_now();C=t;var n=!0;try{e:{x=!1,b&&(b=!1,M(E),E=-1),_=!0;var a=y;try{t:{for(s(t),v=r(f);null!==v&&!(v.expirationTime>t&&l());){var c=v.callback;if("function"==typeof c){v.callback=null,y=v.priorityLevel;var h=c(v.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof h){v.callback=h,s(t),n=!0;break t}v===r(f)&&i(f),s(t)}else i(f);v=r(f)}if(null!==v)n=!0;else{var d=r(m);null!==d&&u(o,d.startTime-t),n=!1}}break e}finally{v=null,y=a,_=!1}n=void 0}}finally{n?R():T=!1}}}function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}function s(e){for(var t=r(m);null!==t;){if(null===t.callback)i(m);else{if(!(t.startTime<=e))break;i(m),t.sortIndex=t.expirationTime,n(f,t)}t=r(m)}}function o(e){if(b=!1,s(e),!x)if(null!==r(f))x=!0,c();else{var t=r(m);null!==t&&u(o,t.startTime-e)}}function l(){return!(e.unstable_now()-C<A)}function c(){T||(T=!0,R())}function u(t,n){E=S(function(){t(e.unstable_now())},n)}if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error()),e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var h=performance;e.unstable_now=function(){return h.now()}}else{var d=Date,p=d.now();e.unstable_now=function(){return d.now()-p}}var f=[],m=[],g=1,v=null,y=3,_=!1,x=!1,b=!1,S="function"==typeof setTimeout?setTimeout:null,M="function"==typeof clearTimeout?clearTimeout:null,w="undefined"!=typeof setImmediate?setImmediate:null,T=!1,E=-1,A=5,C=-1;if("function"==typeof w)var R=function(){w(t)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=t,R=function(){I.postMessage(null)}}else R=function(){S(t,0)};e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){x||_||(x=!0,c())},e.unstable_forceFrameRate=function(e){0>e||125<e||(A=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(e){switch(y){case 1:case 2:case 3:var t=3;break;default:t=y}var n=y;y=t;try{return e()}finally{y=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=y;y=e;try{return t()}finally{y=n}},e.unstable_scheduleCallback=function(t,i,a){var s=e.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,t){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return t={id:g++,callback:i,priorityLevel:t,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>s?(t.sortIndex=a,n(m,t),null===r(f)&&t===r(m)&&(b?(M(E),E=-1):b=!0,u(o,a-s))):(t.sortIndex=l,n(f,t),x||_||(x=!0,c())),t},e.unstable_shouldYield=l,e.unstable_wrapCallback=function(e){var t=y;return function(){var n=y;y=t;try{return e.apply(this,arguments)}finally{y=n}}},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),Zp)),Yp.exports;var e}function $p(){return Gp||(Gp=1,
/**
     * @license React
     * react-reconciler.development.js
     *
     * Copyright (c) Meta Platforms, Inc. and affiliates.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE file in the root directory of this source tree.
     */
(e=qp).exports=function(e){function t(e,t){for(e=e.memoizedState;null!==e&&0<t;)e=e.next,t--;return e}function n(e,t,r,i){if(r>=t.length)return i;var a=t[r],s=Po(e)?e.slice():no({},e);return s[a]=n(e[a],t,r+1,i),s}function i(e,t,n){if(t.length===n.length){for(var r=0;r<n.length-1;r++)if(t[r]!==n[r])return;return a(e,t,n,0)}}function a(e,t,n,r){var i=t[r],s=Po(e)?e.slice():no({},e);return r+1===t.length?(s[n[r]]=s[i],Po(s)?s.splice(i,1):delete s[i]):s[i]=a(e[i],t,n,r+1),s}function s(e,t,n){var r=t[n],i=Po(e)?e.slice():no({},e);return n+1===t.length?(Po(i)?i.splice(r,1):delete i[r],i):(i[r]=s(e[r],t,n+1),i)}function o(){return!1}function l(){return null}function c(e,t,n,r){return new Es(e,t,n,r)}function u(e,t){e.context===Vc&&(Bs(t,e,null,null),Ha())}function h(e,t){if(null!==rm){var n=t.staleFamilies;t=t.updatedFamilies,ls(),Ts(e.current,t,n),Ha()}}function d(e){rm=e}function p(){}function f(){}function m(e){var t=[];return e.forEach(function(e){t.push(e)}),t.sort().join(", ")}function g(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=xo&&e[xo]||e["@@iterator"])?e:null}function v(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===bo?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case so:return"Fragment";case ao:return"Portal";case lo:return"Profiler";case oo:return"StrictMode";case fo:return"Suspense";case mo:return"SuspenseList"}if("object"==typeof e)switch(e.tag,e.$$typeof){case ho:return(e.displayName||"Context")+".Provider";case uo:return(e._context.displayName||"Context")+".Consumer";case po:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case go:return null!==(t=e.displayName||null)?t:v(e.type)||"Memo";case vo:t=e._payload,e=e._init;try{return v(e(t))}catch(vg){}}return null}function y(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t._context.displayName||"Context")+".Consumer";case 10:return(t.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 26:case 27:case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return v(t);case 8:return t===oo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;break;case 29:if(null!=(t=e._debugInfo))for(var n=t.length-1;0<=n;n--)if("string"==typeof t[n].name)return t[n].name;if(null!==e.return)return y(e.return)}return null}function _(){}function x(e){if(void 0===wo)try{throw Error()}catch(vg){var t=vg.stack.trim().match(/\n( *(at )?)/);wo=t&&t[1]||"",To=-1<vg.stack.indexOf("\n    at")?" (<anonymous>)":-1<vg.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+wo+e+To}function b(e,t){if(!e||Eo)return"";var n,r=Ao.get(e);if(void 0!==r)return r;Eo=!0,r=Error.prepareStackTrace,Error.prepareStackTrace=void 0,n=So.H,So.H=null,function(){if(0===Mo){Xs=console.log,qs=console.info,Ys=console.warn,Zs=console.error,Js=console.group,$s=console.groupCollapsed,Ks=console.groupEnd;var e={configurable:!0,enumerable:!0,value:_,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}Mo++}();try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(vg){var r=vg}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"==typeof s.stack)return[s.stack,r.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),o=s[0],l=s[1];if(o&&l){var c=o.split("\n"),u=l.split("\n");for(s=a=0;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;for(;s<u.length&&!u[s].includes("DetermineComponentFrameRoot");)s++;if(a===c.length||s===u.length)for(a=c.length-1,s=u.length-1;1<=a&&0<=s&&c[a]!==u[s];)s--;for(;1<=a&&0<=s;a--,s--)if(c[a]!==u[s]){if(1!==a||1!==s)do{if(a--,0>--s||c[a]!==u[s]){var h="\n"+c[a].replace(" at new "," at ");return e.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",e.displayName)),"function"==typeof e&&Ao.set(e,h),h}}while(1<=a&&0<=s);break}}}finally{Eo=!1,So.H=n,function(){if(0===--Mo){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:no({},e,{value:Xs}),info:no({},e,{value:qs}),warn:no({},e,{value:Ys}),error:no({},e,{value:Zs}),group:no({},e,{value:Js}),groupCollapsed:no({},e,{value:$s}),groupEnd:no({},e,{value:Ks})})}}(),Error.prepareStackTrace=r}return c=(c=e?e.displayName||e.name:"")?x(c):"","function"==typeof e&&Ao.set(e,c),c}function S(e){switch(e.tag){case 26:case 27:case 5:return x(e.type);case 16:return x("Lazy");case 13:return x("Suspense");case 19:return x("SuspenseList");case 0:case 15:return e=b(e.type,!1);case 11:return e=b(e.type.render,!1);case 1:return e=b(e.type,!0);default:return""}}function M(e){try{var t="";do{t+=S(e);var n=e._debugInfo;if(n)for(var r=n.length-1;0<=r;r--){var i=n[r];if("string"==typeof i.name){var a=t,s=i.env;t=a+x(i.name+(s?" ["+s+"]":""))}}e=e.return}while(e);return t}catch(vg){return"\nError generating stack: "+vg.message+"\n"+vg.stack}}function w(){return null===Co?"":M(Co)}function T(e,t,n,r,i,a,s){var o=Co;So.getCurrentStack=null===e?null:w,Ro=!1,Co=e;try{return t(n,r,i,a,s)}finally{Co=o}throw Error("runWithFiberInDEV should never be called in production. This is a bug in React.")}function E(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function A(e){if(E(e)!==e)throw Error("Unable to find node on an unmounted component.")}function C(e){var t=e.alternate;if(!t){if(null===(t=E(e)))throw Error("Unable to find node on an unmounted component.");return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return A(i),e;if(a===r)return A(i),t;a=a.sibling}throw Error("Unable to find node on an unmounted component.")}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,o=i.child;o;){if(o===n){s=!0,n=i,r=a;break}if(o===r){s=!0,r=i,n=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===n){s=!0,n=a,r=i;break}if(o===r){s=!0,r=a,n=i;break}o=o.sibling}if(!s)throw Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(n.alternate!==r)throw Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}if(3!==n.tag)throw Error("Unable to find node on an unmounted component.");return n.stateNode.current===n?e:t}function R(e){return null!==(e=C(e))?P(e):null}function P(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=P(e)))return t;e=e.sibling}return null}function I(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(4!==e.tag&&null!==(t=I(e)))return t;e=e.sibling}return null}function D(e){return{current:e}}function N(e,t){0>Bc||(zc[Bc],e.current=kc[Bc],kc[Bc]=null,zc[Bc]=null,Bc--)}function L(e,t,n){Bc++,kc[Bc]=e.current,zc[Bc]=n,e.current=t}function U(e){return 1&e?"SyncHydrationLane":2&e?"Sync":4&e?"InputContinuousHydration":8&e?"InputContinuous":16&e?"DefaultHydration":32&e?"Default":64&e?"TransitionHydration":4194176&e?"Transition":62914560&e?"Retry":67108864&e?"SelectiveHydration":134217728&e?"IdleHydration":268435456&e?"Idle":536870912&e?"Offscreen":1073741824&e?"Deferred":void 0}function O(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function F(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=e.warmLanes;e=0!==e.finishedLanes;var o=134217727&n;return 0!==o?0!==(n=o&~i)?r=O(n):0!==(a&=o)?r=O(a):e||0!==(s=o&~s)&&(r=O(s)):0!==(o=n&~i)?r=O(o):0!==a?r=O(a):e||0!==(s=n&~s)&&(r=O(s)),0===r?0:0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||32===i&&4194176&s)?t:r}function k(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function z(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function B(){var e=Wc;return!(4194176&(Wc<<=1))&&(Wc=128),e}function V(){var e=Xc;return!(62914560&(Xc<<=1))&&(Xc=4194304),e}function H(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function j(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function G(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Hc(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&n}function W(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Hc(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function X(e,t,n){if(lu)for(e=e.pendingUpdatersLaneMap;0<n;){var r=31-Hc(n),i=1<<r;e[r].add(t),n&=~i}}function q(e,t){if(lu)for(var n=e.pendingUpdatersLaneMap,r=e.memoizedUpdaters;0<t;){var i=31-Hc(t);e=1<<i,0<(i=n[i]).size&&(i.forEach(function(e){var t=e.alternate;null!==t&&r.has(t)||r.add(e)}),i.clear()),t&=~e}}function Y(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Z(e){if("function"==typeof nu&&ru(e),au&&"function"==typeof au.setStrictMode)try{au.setStrictMode(iu,e)}catch(t){ou||(ou=!0)}}function J(e){su=e}function $(){null!==su&&"function"==typeof su.markCommitStopped&&su.markCommitStopped()}function K(e){null!==su&&"function"==typeof su.markComponentRenderStarted&&su.markComponentRenderStarted(e)}function Q(){null!==su&&"function"==typeof su.markComponentRenderStopped&&su.markComponentRenderStopped()}function ee(e){null!==su&&"function"==typeof su.markRenderStarted&&su.markRenderStarted(e)}function te(){null!==su&&"function"==typeof su.markRenderStopped&&su.markRenderStopped()}function ne(e,t){null!==su&&"function"==typeof su.markStateUpdateScheduled&&su.markStateUpdateScheduled(e,t)}function re(e,t){if("object"==typeof e&&null!==e){var n=uu.get(e);return void 0!==n?n:(t={value:e,source:t,stack:M(t)},uu.set(e,t),t)}return{value:e,source:t,stack:M(t)}}function ie(e,t){hu[du++]=fu,hu[du++]=pu,pu=e,fu=t}function ae(e,t,n){mu[gu++]=yu,mu[gu++]=_u,mu[gu++]=vu,vu=e;var r=yu;e=_u;var i=32-Hc(r)-1;r&=~(1<<i),n+=1;var a=32-Hc(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,yu=1<<32-Hc(t)+i|n<<i|r,_u=a+e}else yu=1<<a|n<<i|r,_u=e}function se(e){null!==e.return&&(ie(e,1),ae(e,1,0))}function oe(e){for(;e===pu;)pu=hu[--du],hu[du]=null,fu=hu[--du],hu[du]=null;for(;e===vu;)vu=mu[--gu],mu[gu]=null,_u=mu[--gu],mu[gu]=null,yu=mu[--gu],mu[gu]=null}function le(e,t){L(Su,t,e),L(bu,e,e),L(xu,null,e),t=Uo(t),N(xu),L(xu,t,e)}function ce(e){N(xu),N(bu),N(Su)}function ue(){return xu.current}function he(e){null!==e.memoizedState&&L(Mu,e,e);var t=xu.current,n=Oo(t,e.type);t!==n&&(L(bu,e,e),L(xu,n,e))}function de(e){bu.current===e&&(N(xu),N(bu)),Mu.current===e&&(N(Mu),qo?ul._currentValue=cl:ul._currentValue2=cl)}function pe(e,t){return void 0===e.serverProps&&0===e.serverTail.length&&1===e.children.length&&3<e.distanceFromLeaf&&e.distanceFromLeaf>15-t?pe(e.children[0],t):e}function fe(e){return"  "+"  ".repeat(e)}function me(e){return"+ "+"  ".repeat(e)}function ge(e){return"- "+"  ".repeat(e)}function ve(e){switch(e.tag){case 26:case 27:case 5:return e.type;case 16:return"Lazy";case 13:return"Suspense";case 19:return"SuspenseList";case 0:case 15:case 1:return(e=e.type).displayName||e.name||null;case 11:return(e=e.type.render).displayName||e.name||null;default:return null}}function ye(e,t){return wu.test(e)?(e=JSON.stringify(e)).length>t-2?8>t?'{"..."}':"{"+e.slice(0,t-7)+'..."}':"{"+e+"}":e.length>t?5>t?'{"..."}':e.slice(0,t-3)+"...":e}function _e(e,t,n){var r=120-2*n;if(null===t)return me(n)+ye(e,r)+"\n";if("string"==typeof t){for(var i=0;i<t.length&&i<e.length&&t.charCodeAt(i)===e.charCodeAt(i);i++);return i>r-8&&10<i&&(e="..."+e.slice(i-8),t="..."+t.slice(i-8)),me(n)+ye(e,r)+"\n"+ge(n)+ye(t,r)+"\n"}return fe(n)+ye(e,r)+"\n"}function xe(e){return Object.prototype.toString.call(e).replace(/^\[object (.*)\]$/,function(e,t){return t})}function be(e,t){switch(typeof e){case"string":return(e=JSON.stringify(e)).length>t?5>t?'"..."':e.slice(0,t-4)+'..."':e;case"object":if(null===e)return"null";if(Po(e))return"[...]";if(e.$$typeof===io)return(t=v(e.type))?"<"+t+">":"<...>";var n=xe(e);if("Object"===n){for(var r in n="",t-=2,e)if(e.hasOwnProperty(r)){var i=JSON.stringify(r);if(i!=='"'+r+'"'&&(r=i),t-=r.length-2,0>(t-=(i=be(e[r],15>t?t:15)).length)){n+=""===n?"...":", ...";break}n+=(""===n?"":",")+r+":"+i}return"{"+n+"}"}return n;case"function":return(t=e.displayName||e.name)?"function "+t:"function";default:return String(e)}}function Se(e,t){return"string"!=typeof e||wu.test(e)?"{"+be(e,t-2)+"}":e.length>t-2?5>t?'"..."':'"'+e.slice(0,t-5)+'..."':'"'+e+'"'}function Me(e,t,n){var r,i=120-n.length-e.length,a=[];for(r in t)if(t.hasOwnProperty(r)&&"children"!==r){var s=Se(t[r],120-n.length-r.length-1);i-=r.length+s.length+2,a.push(r+"="+s)}return 0===a.length?n+"<"+e+">\n":0<i?n+"<"+e+" "+a.join(" ")+">\n":n+"<"+e+"\n"+n+"  "+a.join("\n"+n+"  ")+"\n"+n+">\n"}function we(e,t,n){var r,i="",a=no({},t);for(r in e)if(e.hasOwnProperty(r)){delete a[r];var s=120-2*n-r.length-2,o=be(e[r],s);t.hasOwnProperty(r)?(s=be(t[r],s),i+=me(n)+r+": "+o+"\n",i+=ge(n)+r+": "+s+"\n"):i+=me(n)+r+": "+o+"\n"}for(var l in a)a.hasOwnProperty(l)&&(e=be(a[l],120-2*n-l.length-2),i+=ge(n)+l+": "+e+"\n");return i}function Te(e,t){var n=ve(e);if(null===n){for(n="",e=e.child;e;)n+=Te(e,t),e=e.sibling;return n}return fe(t)+"<"+n+">\n"}function Ee(e,t){var n=pe(e,t);if(n!==e&&(1!==e.children.length||e.children[0]!==n))return fe(t)+"...\n"+Ee(n,t+1);n="";var r=e.fiber._debugInfo;if(r)for(var i=0;i<r.length;i++){var a=r[i].name;"string"==typeof a&&(n+=fe(t)+"<"+a+">\n",t++)}if(r="",i=e.fiber.pendingProps,6===e.fiber.tag)r=_e(i,e.serverProps,t),t++;else if(null!==(a=ve(e.fiber)))if(void 0===e.serverProps){var s=120-2*(r=t)-a.length-2,o="";for(c in i)if(i.hasOwnProperty(c)&&"children"!==c){var l=Se(i[c],15);if(0>(s-=c.length+l.length+2)){o+=" ...";break}o+=" "+c+"="+l}r=fe(r)+"<"+a+o+">\n",t++}else null===e.serverProps?(r=Me(a,i,me(t)),t++):"string"==typeof e.serverProps||(r=function(e,t,n,r){var i="",a=new Map;for(c in n)n.hasOwnProperty(c)&&a.set(c.toLowerCase(),c);if(1===a.size&&a.has("children"))i+=Me(e,t,fe(r));else{for(var s in t)if(t.hasOwnProperty(s)&&"children"!==s){var o=120-2*(r+1)-s.length-1,l=a.get(s.toLowerCase());if(void 0!==l){a.delete(s.toLowerCase());var c=t[s];l=n[l];var u=Se(c,o);o=Se(l,o),"object"==typeof c&&null!==c&&"object"==typeof l&&null!==l&&"Object"===xe(c)&&"Object"===xe(l)&&(2<Object.keys(c).length||2<Object.keys(l).length||-1<u.indexOf("...")||-1<o.indexOf("..."))?i+=fe(r+1)+s+"={{\n"+we(c,l,r+2)+fe(r+1)+"}}\n":(i+=me(r+1)+s+"="+u+"\n",i+=ge(r+1)+s+"="+o+"\n")}else i+=fe(r+1)+s+"="+Se(t[s],o)+"\n"}a.forEach(function(e){if("children"!==e){var t=120-2*(r+1)-e.length-1;i+=ge(r+1)+e+"="+Se(n[e],t)+"\n"}}),i=""===i?fe(r)+"<"+e+">\n":fe(r)+"<"+e+"\n"+i+fe(r)+">\n"}return e=n.children,t=t.children,"string"==typeof e||"number"==typeof e||"bigint"==typeof e?(a="","string"!=typeof t&&"number"!=typeof t&&"bigint"!=typeof t||(a=""+t),i+=_e(a,""+e,r+1)):"string"!=typeof t&&"number"!=typeof t&&"bigint"!=typeof t||(i=null==e?i+_e(""+t,null,r+1):i+_e(""+t,void 0,r+1)),i}(a,i,e.serverProps,t),t++);var c="";for(i=e.fiber.child,a=0;i&&a<e.children.length;)(s=e.children[a]).fiber===i?(c+=Ee(s,t),a++):c+=Te(i,t),i=i.sibling;for(i&&0<e.children.length&&(c+=fe(t)+"...\n"),i=e.serverTail,null===e.serverProps&&t--,e=0;e<i.length;e++)c="string"==typeof(a=i[e])?c+(ge(t)+ye(a,120-2*t)+"\n"):c+Me(a.type,a.props,ge(t));return n+r+c}function Ae(e){try{return"\n\n"+Ee(e,0)}catch(vg){return""}}function Ce(e,t){if(null===e.return){if(null===Ru)Ru={fiber:e,children:[],serverProps:void 0,serverTail:[],distanceFromLeaf:t};else{if(Ru.fiber!==e)throw Error("Saw multiple hydration diff roots in a pass. This is a bug in React.");Ru.distanceFromLeaf>t&&(Ru.distanceFromLeaf=t)}return Ru}var n=Ce(e.return,t+1).children;return 0<n.length&&n[n.length-1].fiber===e?((n=n[n.length-1]).distanceFromLeaf>t&&(n.distanceFromLeaf=t),n):(t={fiber:e,children:[],serverProps:void 0,serverTail:[],distanceFromLeaf:t},n.push(t),t)}function Re(e,t){Cu||((e=Ce(e,0)).serverProps=null,null!==t&&(t=mc(t),e.serverTail.push(t)))}function Pe(e){var t="",n=Ru;throw null!==n&&(Ru=null,t=Ae(n)),Ue(re(Error("Hydration failed because the server rendered HTML didn't match the client. As a result this tree will be regenerated on the client. This can happen if a SSR-ed Client Component used:\n\n- A server/client branch `if (typeof window !== 'undefined')`.\n- Variable input such as `Date.now()` or `Math.random()` which changes each time it's called.\n- Date formatting in a user's locale which doesn't match the server.\n- External changing data without sending a snapshot of it along with the HTML.\n- Invalid HTML tag nesting.\n\nIt can also happen if the client has a browser extension installed which messes with the HTML before React loaded.\n\nhttps://react.dev/link/hydration-mismatch"+t),e)),Du}function Ie(e,t){if(!Jo)throw Error("Expected prepareToHydrateHostInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");ic(e.stateNode,e.type,e.memoizedProps,t,e)||Pe(e)}function De(e){for(Tu=e.return;Tu;)switch(Tu.tag){case 3:case 27:return void(Iu=!0);case 5:case 13:return void(Iu=!1);default:Tu=Tu.return}}function Ne(e){if(!Jo||e!==Tu)return!1;if(!Au)return De(e),Au=!0,!1;var t=!1;if(Dc?3!==e.tag&&27!==e.tag&&(5!==e.tag||dc(e.type)&&!Ho(e.type,e.memoizedProps))&&(t=!0):3!==e.tag&&(5!==e.tag||dc(e.type)&&!Ho(e.type,e.memoizedProps))&&(t=!0),t&&Eu){for(t=Eu;t;){var n=Ce(e,0),r=mc(t);n.serverTail.push(r),t="Suspense"===r.type?oc(t):$l(t)}Pe(e)}if(De(e),13===e.tag){if(!Jo)throw Error("Expected skipPastDehydratedSuspenseInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");Eu=oc(e)}else Eu=Tu?$l(e.stateNode):null;return!0}function Le(){Jo&&(Eu=Tu=null,Cu=Au=!1)}function Ue(e){null===Pu?Pu=[e]:Pu.push(e)}function Oe(){var e=Ru;null!==e&&(Ru=null,e=Ae(e))}function Fe(){for(var e=Uu,t=Ou=Uu=0;t<e;){var n=Lu[t];Lu[t++]=null;var r=Lu[t];Lu[t++]=null;var i=Lu[t];Lu[t++]=null;var a=Lu[t];if(Lu[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==a&&Ve(n,i,a)}}function ke(e,t,n,r){Lu[Uu++]=e,Lu[Uu++]=t,Lu[Uu++]=n,Lu[Uu++]=r,Ou|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function ze(e,t,n,r){return ke(e,t,n,r),He(e)}function Be(e,t){return ke(e,null,null,t),He(e)}function Ve(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,a=e.return;null!==a;)a.childLanes|=n,null!==(r=a.alternate)&&(r.childLanes|=n),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;i&&null!==t&&3===e.tag&&(a=e.stateNode,i=31-Hc(n),null===(e=(a=a.hiddenUpdates)[i])?a[i]=[t]:e.push(t),t.lane=536870912|n)}function He(e){if(Gf>jf)throw Zf=Gf=0,Jf=Wf=null,Error("Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.");Zf>Yf&&(Zf=0,Jf=null),null===e.alternate&&4098&e.flags&&_s(e);for(var t=e,n=t.return;null!==n;)null===t.alternate&&!!(4098&t.flags)&&_s(e),n=(t=n).return;return 3===t.tag?t.stateNode:null}function je(){var e=Bu;return Bu=0,e}function Ge(e){var t=Bu;return Bu=e,t}function We(e){var t=Bu;return Bu+=e,t}function Xe(e){zu=Fu(),0>e.actualStartTime&&(e.actualStartTime=zu)}function qe(e){if(0<=zu){var t=Fu()-zu;e.actualDuration+=t,e.selfBaseDuration=t,zu=-1}}function Ye(e){if(0<=zu){var t=Fu()-zu;e.actualDuration+=t,zu=-1}}function Ze(){if(0<=zu){var e=Fu()-zu;zu=-1,Bu+=e}}function Je(){zu=Fu()}function $e(e){for(var t=e.child;t;)e.actualDuration+=t.actualDuration,t=t.sibling}function Ke(e){e!==Gu&&null===e.next&&(null===Gu?ju=Gu=e:Gu=Gu.next=e),qu=!0,null!==So.actQueue?Xu||(Xu=!0,at(et)):Wu||(Wu=!0,at(et))}function Qe(e,t){if(!Yu&&qu){Yu=!0;do{for(var n=!1,r=ju;null!==r;){if(0!==e){var i=r.pendingLanes;if(0===i)var a=0;else{var s=r.suspendedLanes,o=r.pingedLanes;a=(1<<31-Hc(42|e)+1)-1,a=201326677&(a&=i&~(s&~o))?201326677&a|1:a?2|a:0}0!==a&&(n=!0,rt(r,a))}else a=of,!(3&(a=F(r,r===af?a:0)))||k(r,a)||(n=!0,rt(r,a));r=r.next}}while(n);Yu=!1}}function et(){qu=Xu=Wu=!1;var e=0;0!==Zu&&(nl()&&(e=Zu),Zu=0);for(var t=$c(),n=null,r=ju;null!==r;){var i=r.next,a=tt(r,t);0===a?(r.next=null,null===n?ju=i:n.next=i,null===i&&(Gu=n)):(n=r,(0!==e||3&a)&&(qu=!0)),r=i}Qe(e)}function tt(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var s=31-Hc(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=z(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}if(n=of,n=F(e,e===(t=af)?n:0),r=e.callbackNode,0===n||e===t&&vf===uf||null!==e.cancelPendingCommit)return null!==r&&it(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||k(e,n)){if((t=n&-n)===e.callbackPriority&&(null===So.actQueue||r===Ju))return t;switch(it(r),Y(n)){case 2:case 8:n=Qc;break;case 32:default:n=eu;break;case 268435456:n=tu}return r=nt.bind(null,e),null!==So.actQueue?(So.actQueue.push(r),n=Ju):n=qc(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&it(r),e.callbackPriority=2,e.callbackNode=null,2}function nt(e,t){Hu=Vu=!1;var n=e.callbackNode;if(ls()&&e.callbackNode!==n)return null;var r=of;return 0===(r=F(e,e===af?r:0))?null:(Fa(e,r,t),tt(e,$c()),null!=e.callbackNode&&e.callbackNode===n?nt.bind(null,e):null)}function rt(e,t){if(ls())return null;Vu=Hu,Hu=!1,Fa(e,t,!0)}function it(e){e!==Ju&&null!==e&&Yc(e)}function at(e){null!==So.actQueue&&So.actQueue.push(function(){return e(),null}),pl?fl(function(){(rf&(qp|Yp))!==Xp?qc(Kc,e):e()}):qc(Kc,e)}function st(){return 0===Zu&&(Zu=B()),Zu}function ot(){if(0===--Ku&&null!==$u){null!==eh&&(eh.status="fulfilled");var e=$u;$u=null,Qu=0,eh=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function lt(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ct(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ut(e){return{lane:e,tag:th,payload:null,callback:null,next:null}}function ht(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,oh===r&&!sh){var i=y(e);sh=!0}return(rf&qp)!==Xp?(null===(i=r.pending)?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=He(e),Ve(e,null,n),t):(ke(e,r,t,n),He(e))}function dt(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194176&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,W(e,n)}}function pt(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ft(){if(lh&&null!==eh)throw eh}function mt(e,t,n,r){lh=!1;var i=e.updateQueue;ah=!1,oh=i.shared;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&(o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l)}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=-536870913&o.lane,p=d!==o.lane;if(p?(of&d)===d:(r&d)===d){0!==d&&d===Qu&&(lh=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{d=e;var f=o,m=t,g=n;switch(f.tag){case nh:if("function"==typeof(f=f.payload)){var v=f.call(g,h,m);if(8&d.mode){Z(!0);try{f.call(g,h,m)}finally{Z(!1)}}h=v;break e}h=f;break e;case ih:d.flags=-65537&d.flags|128;case th:if("function"==typeof(v=f.payload)){if(f=v.call(g,h,m),8&d.mode){Z(!0);try{v.call(g,h,m)}finally{Z(!1)}}}else f=v;if(null==f)break e;h=no({},h,f);break e;case rh:ah=!0}}null!==(d=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[d]:p.push(d))}else p={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(p=o).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===a&&(i.shared.lanes=0),wf|=s,e.lanes=s,e.memoizedState=h}oh=null}function gt(e,t){if("function"!=typeof e)throw Error("Invalid argument passed as callback. Expected a function. Instead received: "+e);e.call(t)}function vt(e,t){var n=e.shared.hiddenCallbacks;if(null!==n)for(e.shared.hiddenCallbacks=null,e=0;e<n.length;e++)gt(n[e],t)}function yt(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)gt(n[e],t)}function _t(e,t){if(cu(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ch.call(t,i)||!cu(e[i],t[i]))return!1}return!0}function xt(e){return"fulfilled"===(e=e.status)||"rejected"===e}function bt(){}function St(e,t,n){null!==So.actQueue&&(So.didUsePromise=!0);var r=e.thenables;switch(void 0===(n=r[n])?r.push(t):n!==t&&(e.didWarnAboutUncachedPromise||(e.didWarnAboutUncachedPromise=!0),t.then(bt,bt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw wt(e=t.reason),e;default:if("string"==typeof t.status)t.then(bt,bt);else{if(null!==(e=af)&&100<e.shellSuspendCounter)throw Error("async/await is not yet supported in Client Components, only Server Components. This error is often caused by accidentally adding `'use client'` to a module that was originally written for the server.");(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw wt(e=t.reason),e}throw wh=t,Th=!0,bh}}function Mt(){if(null===wh)throw Error("Expected a suspended thenable. This is a bug in React. Please file an issue.");var e=wh;return wh=null,Th=!1,e}function wt(e){if(e===bh)throw Error("Hooks are not supported inside an async component. This error is often caused by accidentally adding `'use client'` to a module that was originally written for the server.")}function Tt(e){var t=Xh;return null!=e&&(Xh=null===t?e:t.concat(e)),t}function Et(e,t,n){for(var r=Object.keys(e.props),i=0;i<r.length;i++){var a=r[i];if("children"!==a&&"key"!==a){null===t&&((t=Is(e,n.mode,0))._debugInfo=Xh,t.return=n),T(t,function(e){},a);break}}}function At(e){var t=Wh;return Wh+=1,null===Gh&&(Gh={didWarnAboutUncachedPromise:!1,thenables:[]}),St(Gh,e,t)}function Ct(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Rt(e,t){if(t.$$typeof===ro)throw Error('A React Element from an older version of React was rendered. This is not supported. It can happen if:\n- Multiple copies of the "react" package is used.\n- A library pre-bundled an old copy of "react" or "react/jsx-runtime".\n- A compiler tries to "inline" JSX instead of using the runtime.');throw e=Object.prototype.toString.call(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}function Pt(e,t){var n=y(e)||"Component";Yh[n]||(Yh[n]=!0,t=t.displayName||t.name||"Component",e.tag)}function It(e,t){var n=y(e)||"Component";Zh[n]||(Zh[n]=!0,t=String(t),e.tag)}function Dt(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Cs(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=33554434,n):r:(t.flags|=33554434,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function o(e,t,n,r){return null===t||6!==t.tag?((t=Ls(n,e.mode,r)).return=e,t._debugOwner=e,t._debugInfo=Xh,t):((t=i(t,n)).return=e,t._debugInfo=Xh,t)}function l(e,t,n,r){var a=n.type;return a===so?(Et(n,t=h(e,t,n.props.children,r,n.key),e),t):null!==t&&(t.elementType===a||Ms(t,n)||"object"==typeof a&&null!==a&&a.$$typeof===vo&&jh(a)===t.type)?(Ct(t=i(t,n.props),n),t.return=e,t._debugOwner=n._owner,t._debugInfo=Xh,t):(Ct(t=Is(n,e.mode,r),n),t.return=e,t._debugInfo=Xh,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Us(n,e.mode,r)).return=e,t._debugInfo=Xh,t):((t=i(t,n.children||[])).return=e,t._debugInfo=Xh,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Ds(n,e.mode,r,a)).return=e,t._debugOwner=e,t._debugInfo=Xh,t):((t=i(t,n)).return=e,t._debugInfo=Xh,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Ls(""+t,e.mode,n)).return=e,t._debugOwner=e,t._debugInfo=Xh,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case io:return Ct(n=Is(t,e.mode,n),t),n.return=e,e=Tt(t._debugInfo),n._debugInfo=Xh,Xh=e,n;case ao:return(t=Us(t,e.mode,n)).return=e,t._debugInfo=Xh,t;case vo:var r=Tt(t._debugInfo);return e=d(e,t=jh(t),n),Xh=r,e}if(Po(t)||g(t))return(n=Ds(t,e.mode,n,null)).return=e,n._debugOwner=e,e=Tt(t._debugInfo),n._debugInfo=Xh,Xh=e,n;if("function"==typeof t.then)return r=Tt(t._debugInfo),e=d(e,At(t),n),Xh=r,e;if(t.$$typeof===ho)return d(e,si(e,t),n);Rt(e,t)}return"function"==typeof t&&Pt(e,t),"symbol"==typeof t&&It(e,t),null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==i?null:o(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case io:return n.key===i?(i=Tt(n._debugInfo),e=l(e,t,n,r),Xh=i,e):null;case ao:return n.key===i?u(e,t,n,r):null;case vo:return i=Tt(n._debugInfo),e=p(e,t,n=jh(n),r),Xh=i,e}if(Po(n)||g(n))return null!==i?null:(i=Tt(n._debugInfo),e=h(e,t,n,r,null),Xh=i,e);if("function"==typeof n.then)return i=Tt(n._debugInfo),e=p(e,t,At(n),r),Xh=i,e;if(n.$$typeof===ho)return p(e,t,si(e,n),r);Rt(e,n)}return"function"==typeof n&&Pt(e,n),"symbol"==typeof n&&It(e,n),null}function m(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return o(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case io:return n=e.get(null===r.key?n:r.key)||null,e=Tt(r._debugInfo),t=l(t,n,r,i),Xh=e,t;case ao:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case vo:var a=Tt(r._debugInfo);return t=m(e,t,n,r=jh(r),i),Xh=a,t}if(Po(r)||g(r))return n=e.get(n)||null,e=Tt(r._debugInfo),t=h(t,n,r,i,null),Xh=e,t;if("function"==typeof r.then)return a=Tt(r._debugInfo),t=m(e,t,n,At(r),i),Xh=a,t;if(r.$$typeof===ho)return m(e,t,n,si(t,r),i);Rt(t,r)}return"function"==typeof r&&Pt(t,r),"symbol"==typeof r&&It(t,r),null}function v(e,t,n,r){if("object"!=typeof n||null===n)return r;switch(n.$$typeof){case io:case ao:f(e,t,n);var i=n.key;if("string"!=typeof i)break;if(null===r){(r=new Set).add(i);break}if(!r.has(i)){r.add(i);break}T(t,function(){});break;case vo:v(e,t,n=jh(n),r)}return r}function y(o,l,c,u){if("object"==typeof c&&null!==c&&c.type===so&&null===c.key&&(Et(c,null,o),c=c.props.children),"object"==typeof c&&null!==c){switch(c.$$typeof){case io:var h=Tt(c._debugInfo);e:{for(var f=c.key;null!==l;){if(l.key===f){if((f=c.type)===so){if(7===l.tag){n(o,l.sibling),(u=i(l,c.props.children)).return=o,u._debugOwner=c._owner,u._debugInfo=Xh,Et(c,u,o),o=u;break e}}else if(l.elementType===f||Ms(l,c)||"object"==typeof f&&null!==f&&f.$$typeof===vo&&jh(f)===l.type){n(o,l.sibling),Ct(u=i(l,c.props),c),u.return=o,u._debugOwner=c._owner,u._debugInfo=Xh,o=u;break e}n(o,l);break}t(o,l),l=l.sibling}c.type===so?((u=Ds(c.props.children,o.mode,u,c.key)).return=o,u._debugOwner=o,u._debugInfo=Xh,Et(c,u,o),o=u):(Ct(u=Is(c,o.mode,u),c),u.return=o,u._debugInfo=Xh,o=u)}return o=s(o),Xh=h,o;case ao:e:{for(c=(h=c).key;null!==l;){if(l.key===c){if(4===l.tag&&l.stateNode.containerInfo===h.containerInfo&&l.stateNode.implementation===h.implementation){n(o,l.sibling),(u=i(l,h.children||[])).return=o,o=u;break e}n(o,l);break}t(o,l),l=l.sibling}(u=Us(h,o.mode,u)).return=o,o=u}return s(o);case vo:return h=Tt(c._debugInfo),o=y(o,l,c=jh(c),u),Xh=h,o}if(Po(c))return h=Tt(c._debugInfo),o=function(i,s,o,l){for(var c=null,u=null,h=null,f=s,g=s=0,y=null;null!==f&&g<o.length;g++){f.index>g?(y=f,f=null):y=f.sibling;var _=p(i,f,o[g],l);if(null===_){null===f&&(f=y);break}c=v(i,_,o[g],c),e&&f&&null===_.alternate&&t(i,f),s=a(_,s,g),null===h?u=_:h.sibling=_,h=_,f=y}if(g===o.length)return n(i,f),Au&&ie(i,g),u;if(null===f){for(;g<o.length;g++)null!==(f=d(i,o[g],l))&&(c=v(i,f,o[g],c),s=a(f,s,g),null===h?u=f:h.sibling=f,h=f);return Au&&ie(i,g),u}for(f=r(f);g<o.length;g++)null!==(y=m(f,i,g,o[g],l))&&(c=v(i,y,o[g],c),e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?u=y:h.sibling=y,h=y);return e&&f.forEach(function(e){return t(i,e)}),Au&&ie(i,g),u}(o,l,c,u),Xh=h,o;if(g(c)){if(h=Tt(c._debugInfo),"function"!=typeof(f=g(c)))throw Error("An object is not an iterable. This error is likely caused by a bug in React. Please file an issue.");var _=f.call(c);return _===c?0===o.tag&&"[object GeneratorFunction]"===Object.prototype.toString.call(o.type)&&Object.prototype.toString.call(_):c.entries!==f||xh||(xh=!0),o=function(i,s,o,l){if(null==o)throw Error("An iterable object provided no iterator.");for(var c=null,u=null,h=s,f=s=0,g=null,y=null,_=o.next();null!==h&&!_.done;f++,_=o.next()){h.index>f?(g=h,h=null):g=h.sibling;var x=p(i,h,_.value,l);if(null===x){null===h&&(h=g);break}y=v(i,x,_.value,y),e&&h&&null===x.alternate&&t(i,h),s=a(x,s,f),null===u?c=x:u.sibling=x,u=x,h=g}if(_.done)return n(i,h),Au&&ie(i,f),c;if(null===h){for(;!_.done;f++,_=o.next())null!==(h=d(i,_.value,l))&&(y=v(i,h,_.value,y),s=a(h,s,f),null===u?c=h:u.sibling=h,u=h);return Au&&ie(i,f),c}for(h=r(h);!_.done;f++,_=o.next())null!==(g=m(h,i,f,_.value,l))&&(y=v(i,g,_.value,y),e&&null!==g.alternate&&h.delete(null===g.key?f:g.key),s=a(g,s,f),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),Au&&ie(i,f),c}(o,l,_,u),Xh=h,o}if("function"==typeof c.then)return h=Tt(c._debugInfo),o=y(o,l,At(c),u),Xh=h,o;if(c.$$typeof===ho)return y(o,l,si(o,c),u);Rt(o,c)}return"string"==typeof c&&""!==c||"number"==typeof c||"bigint"==typeof c?(h=""+c,null!==l&&6===l.tag?(n(o,l.sibling),(u=i(l,h)).return=o,o=u):(n(o,l),(u=Ls(h,o.mode,u)).return=o,u._debugOwner=o,u._debugInfo=Xh,o=u),s(o)):("function"==typeof c&&Pt(o,c),"symbol"==typeof c&&It(o,c),n(o,l))}return function(e,t,n,r){var i=Xh;Xh=null;try{Wh=0;var a=y(e,t,n,r);return Gh=null,a}catch(vg){if(vg===bh)throw vg;var s=c(29,vg,null,e.mode);s.lanes=r,s.return=e;var o=s._debugInfo=Xh;if(s._debugOwner=e._debugOwner,null!=o)for(var l=o.length-1;0<=l;l--)if("string"==typeof o[l].stack){s._debugOwner=o[l];break}return s}finally{Xh=i}}}function Nt(e,t){var n=Sf;L(ed,n,e),L(Qh,t,e),Sf=n|t.baseLanes}function Lt(e){L(ed,Sf,e),L(Qh,Qh.current,e)}function Ut(e){Sf=ed.current,N(Qh),N(ed)}function Ot(e){var t=e.alternate;L(ad,ad.current&rd,e),L(td,e,e),null===nd&&(null===t||null!==Qh.current||null!==t.memoizedState)&&(nd=e)}function Ft(e){if(22===e.tag){if(L(ad,ad.current,e),L(td,e,e),null===nd){var t=e.alternate;null!==t&&null!==t.memoizedState&&(nd=e)}}else kt(e)}function kt(e){L(ad,ad.current,e),L(td,td.current,e)}function zt(e){N(td),nd===e&&(nd=null),N(ad)}function Bt(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Wl(n)||Xl(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Vt(){var e=Ad;null===Cd?Cd=[e]:Cd.push(e)}function Ht(){var e=Ad;if(null!==Cd&&(Rd++,Cd[Rd]!==e)){var t=y(gd);if(!hd.has(t)&&(hd.add(t),null!==Cd))for(var n=0;n<=Rd;n++){var r=Cd[n],i=n===Rd?e:r;for(r=n+1+". "+r;30>r.length;)r+=" ";r+=i+"\n"}}}function jt(e){null==e||Po(e)}function Gt(){var e=y(gd);fd.has(e)||fd.add(e)}function Wt(){throw Error("Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:\n1. You might have mismatching versions of React and the renderer (such as React DOM)\n2. You might be breaking the Rules of Hooks\n3. You might have more than one copy of React in the same app\nSee https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.")}function Xt(e,t){if(Pd)return!1;if(null===t)return!1;e.length,t.length;for(var n=0;n<t.length&&n<e.length;n++)if(!cu(e[n],t[n]))return!1;return!0}function qt(e,t,n,r,i,a){md=a,gd=t,Cd=null!==e?e._debugHookTypes:null,Rd=-1,Pd=null!==e&&e.type!==t.type,"[object AsyncFunction]"!==Object.prototype.toString.call(n)&&"[object AsyncGeneratorFunction]"!==Object.prototype.toString.call(n)||(a=y(gd),pd.has(a)||pd.add(a)),t.memoizedState=null,t.updateQueue=null,t.lanes=0,So.H=null!==e&&null!==e.memoizedState?Ud:null!==Cd?Ld:Nd,bd=a=(8&t.mode)!==Nu;var s=Ah(n,r,i);if(bd=!1,xd&&(s=Zt(t,n,r,i)),a){Z(!0);try{s=Zt(t,n,r,i)}finally{Z(!1)}}return Yt(e,t),s}function Yt(e,t){t._debugHookTypes=Cd,null===t.dependencies?null!==wd&&(t.dependencies={lanes:0,firstContext:null,_debugThenableState:wd}):t.dependencies._debugThenableState=wd,So.H=Dd;var n=null!==vd&&null!==vd.next;if(md=0,Cd=Ad=yd=vd=gd=null,Rd=-1,null!==e&&(e.flags,t.flags),_d=!1,Md=0,wd=null,n)throw Error("Rendered fewer hooks than expected. This may be caused by an accidental early return statement.");null===e||np||null!==(e=e.dependencies)&&ri(e)&&(np=!0),Th?(Th=!1,e=!0):e=!1,e&&(t=y(t)||"Unknown",dd.has(t)||pd.has(t)||dd.add(t))}function Zt(e,t,n,r){gd=e;var i=0;do{if(xd&&(wd=null),Md=0,xd=!1,i>=Ed)throw Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.");if(i+=1,Pd=!1,yd=vd=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}Rd=-1,So.H=Od,a=Ah(t,n,r)}while(xd);return a}function Jt(){var e=So.H,t=e.useState()[0];return t="function"==typeof t.then?nn(t):t,e=e.useState()[0],(null!==vd?vd.memoizedState:null)!==e&&(gd.flags|=1024),t}function $t(){var e=0!==Sd;return Sd=0,e}function Kt(e,t,n){t.updateQueue=e.updateQueue,t.flags=(16&t.mode)!==Nu?-201328645&t.flags:-2053&t.flags,e.lanes&=~n}function Qt(e){if(_d){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}_d=!1}md=0,Cd=yd=vd=gd=null,Rd=-1,Ad=null,xd=!1,Md=Sd=0,wd=null}function en(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yd?gd.memoizedState=yd=e:yd=yd.next=e,yd}function tn(){if(null===vd){var e=gd.alternate;e=null!==e?e.memoizedState:null}else e=vd.next;var t=null===yd?gd.memoizedState:yd.next;if(null!==t)yd=t,vd=e;else{if(null===e){if(null===gd.alternate)throw Error("Update hook called on initial render. This is likely a bug in React. Please file an issue.");throw Error("Rendered more hooks than during the previous render.")}e={memoizedState:(vd=e).memoizedState,baseState:vd.baseState,baseQueue:vd.baseQueue,queue:vd.queue,next:null},null===yd?gd.memoizedState=yd=e:yd=yd.next=e}return yd}function nn(e){var t=Md;return Md+=1,null===wd&&(wd={didWarnAboutUncachedPromise:!1,thenables:[]}),e=St(wd,e,t),t=gd,null===(null===yd?t.memoizedState:yd.next)&&(t=t.alternate,So.H=null!==t&&null!==t.memoizedState?Ud:Nd),e}function rn(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return nn(e);if(e.$$typeof===ho)return ai(e)}throw Error("An unsupported type was passed to use(): "+String(e))}function an(e){var t=null,n=gd.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=gd.alternate;null!==r&&null!==(r=r.updateQueue)&&null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===n&&(n=Id(),gd.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index])||Pd)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=_o;else n.length;return t.index++,n}function sn(e,t){return"function"==typeof t?t(e):t}function on(e,t,n){var r=en();if(void 0!==n){var i=n(t);if(bd){Z(!0);try{n(t)}finally{Z(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=cr.bind(null,gd,e),[r.memoizedState,e]}function ln(e){return cn(tn(),vd,e)}function cn(e,t,n){var r=e.queue;if(null===r)throw Error("Should have a queue. You are likely calling Hooks conditionally, which is not allowed. (https://react.dev/link/invalid-hook-call)");r.lastRenderedReducer=n;var i=e.baseQueue,a=r.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}t.baseQueue,t.baseQueue=i=a,r.pending=null}if(a=e.baseState,null===i)e.memoizedState=a;else{var o=s=null,l=null,c=t=i.next,u=!1;do{var h=-536870913&c.lane;if(h!==c.lane?(of&h)===h:(md&h)===h){var d=c.revertLane;if(0===d)null!==l&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===Qu&&(u=!0);else{if((md&d)===d){c=c.next,d===Qu&&(u=!0);continue}h={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===l?(o=l=h,s=a):l=l.next=h,gd.lanes|=d,wf|=d}h=c.action,bd&&n(a,h),a=c.hasEagerState?c.eagerState:n(a,h)}else d={lane:h,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===l?(o=l=d,s=a):l=l.next=d,gd.lanes|=h,wf|=h;c=c.next}while(null!==c&&c!==t);if(null===l?s=a:l.next=o,!cu(a,e.memoizedState)&&(np=!0,u&&null!==(n=eh)))throw n;e.memoizedState=a,e.baseState=s,e.baseQueue=l,r.lastRenderedState=a}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function un(e){var t=tn(),n=t.queue;if(null===n)throw Error("Should have a queue. You are likely calling Hooks conditionally, which is not allowed. (https://react.dev/link/invalid-hook-call)");n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);cu(a,t.memoizedState)||(np=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function hn(e,t,n){var r=gd,i=en();if(Au){if(void 0===n)throw Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");var a=n();Jh||a===n()||(Jh=!0)}else{if(a=t(),Jh||(n=t(),cu(a,n)||(Jh=!0)),null===af)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");60&of||pn(r,t,a)}return i.memoizedState=a,n={value:a,getSnapshot:t},i.queue=n,Bn(mn.bind(null,r,n,e),[e]),r.flags|=2048,On(od|ud,fn.bind(null,r,n,a,t),{destroy:void 0},null),a}function dn(e,t,n){var r=gd,i=tn(),a=Au;if(a){if(void 0===n)throw Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");n=n()}else if(n=t(),!Jh){var s=t();cu(n,s)||(Jh=!0)}(s=!cu((vd||i).memoizedState,n))&&(i.memoizedState=n,np=!0),i=i.queue;var o=mn.bind(null,r,i,e);if(zn(2048,ud,o,[e]),i.getSnapshot!==t||s||null!==yd&&yd.memoizedState.tag&od){if(r.flags|=2048,On(od|ud,fn.bind(null,r,i,n,t),{destroy:void 0},null),null===af)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");a||60&md||pn(r,t,n)}return n}function pn(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=gd.updateQueue)?(t=Id(),gd.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function fn(e,t,n,r){t.value=n,t.getSnapshot=r,gn(t)&&vn(e)}function mn(e,t,n){return n(function(){gn(t)&&vn(e)})}function gn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!cu(e,n)}catch(r){return!0}}function vn(e){var t=Be(e,2);null!==t&&Oa(t,e,2)}function yn(e){var t=en();if("function"==typeof e){var n=e;if(e=n(),bd){Z(!0);try{n()}finally{Z(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sn,lastRenderedState:e},t}function _n(e){var t=(e=yn(e)).queue,n=ur.bind(null,gd,t);return t.dispatch=n,[e.memoizedState,n]}function xn(e){var t=en();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=dr.bind(null,gd,!0,n),n.dispatch=t,[e,t]}function bn(e,t){return Sn(tn(),0,e,t)}function Sn(e,t,n,r){return e.baseState=n,cn(e,vd,"function"==typeof r?r:sn)}function Mn(e,t){var n=tn();return null!==vd?Sn(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])}function wn(e,t,n,r,i){if(pr(e))throw Error("Cannot update form state while rendering.");if(null!==(e=t.action)){var a={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==So.T?n(!0):a.isTransition=!1,r(a),null===(n=t.pending)?(a.next=t.pending=a,Tn(t,a)):(a.next=n.next,t.pending=n.next=a)}}function Tn(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=So.T,s={};So.T=s,So.T._updatedFibers=new Set;try{var o=n(i,r),l=So.S;null!==l&&l(s,o),En(e,t,o)}catch(c){Cn(e,t,c)}finally{So.T=a,null===a&&s._updatedFibers&&(e=s._updatedFibers.size,s._updatedFibers.clear())}}else try{En(e,t,s=n(i,r))}catch(u){Cn(e,t,u)}}function En(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?(n.then(function(n){An(e,t,n)},function(n){return Cn(e,t,n)}),t.isTransition):An(e,t,n)}function An(e,t,n){t.status="fulfilled",t.value=n,Rn(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Tn(e,n)))}function Cn(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Rn(t),t=t.next}while(t!==r)}e.action=null}function Rn(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Pn(e,t){return t}function In(e,t){if(Au){var n=af.formState;if(null!==n){e:{var r=gd;if(Au){if(Eu){var i=Zl(Eu,Iu);if(i){Eu=$l(i),r=Jl(i);break e}}Pe(r)}r=!1}r&&(t=n[0])}}(n=en()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pn,lastRenderedState:t},n.queue=r,n=ur.bind(null,gd,r),r.dispatch=n,r=yn(!1);var a=dr.bind(null,gd,!1,r.queue);return i={state:t,dispatch:null,action:e,pending:null},(r=en()).queue=i,n=wn.bind(null,gd,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function Dn(e){return Nn(tn(),vd,e)}function Nn(e,t,n){t=cn(e,t,Pn)[0],e=ln(sn)[0],t="object"==typeof t&&null!==t&&"function"==typeof t.then?nn(t):t;var r=tn(),i=r.queue,a=i.dispatch;return n!==r.memoizedState&&(gd.flags|=2048,On(od|ud,Ln.bind(null,i,n),{destroy:void 0},null)),[t,a,e]}function Ln(e,t){e.action=t}function Un(e){var t=tn(),n=vd;if(null!==n)return Nn(t,n,e);tn(),t=t.memoizedState;var r=(n=tn()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function On(e,t,n,r){return e={tag:e,create:t,inst:n,deps:r,next:null},null===(t=gd.updateQueue)&&(t=Id(),gd.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fn(e){return e={current:e},en().memoizedState=e}function kn(e,t,n,r){var i=en();gd.flags|=e,i.memoizedState=On(od|t,n,{destroy:void 0},void 0===r?null:r)}function zn(e,t,n,r){var i=tn();r=void 0===r?null:r;var a=i.memoizedState.inst;null!==vd&&null!==r&&Xt(r,vd.memoizedState.deps)?i.memoizedState=On(t,n,a,r):(gd.flags|=e,i.memoizedState=On(od|t,n,a,r))}function Bn(e,t){(16&gd.mode)!==Nu&&(64&gd.mode)===Nu?kn(142608384,ud,e,t):kn(8390656,ud,e,t)}function Vn(e,t){var n=4194308;return(16&gd.mode)!==Nu&&(n|=67108864),kn(n,cd,e,t)}function Hn(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return t.hasOwnProperty("current"),e=e(),t.current=e,function(){t.current=null}}function jn(e,t,n){n=null!=n?n.concat([e]):null;var r=4194308;(16&gd.mode)!==Nu&&(r|=67108864),kn(r,cd,Hn.bind(null,t,e),n)}function Gn(e,t,n){n=null!=n?n.concat([e]):null,zn(4,cd,Hn.bind(null,t,e),n)}function Wn(e,t){return en().memoizedState=[e,void 0===t?null:t],e}function Xn(e,t){var n=tn();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Xt(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qn(e,t){var n=en();t=void 0===t?null:t;var r=e();if(bd){Z(!0);try{e()}finally{Z(!1)}}return n.memoizedState=[r,t],r}function Yn(e,t){var n=tn();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Xt(t,r[1]))return r[0];if(r=e(),bd){Z(!0);try{e()}finally{Z(!1)}}return n.memoizedState=[r,t],r}function Zn(e,t){return Kn(en(),e,t)}function Jn(e,t){return Qn(tn(),vd.memoizedState,e,t)}function $n(e,t){var n=tn();return null===vd?Kn(n,e,t):Qn(n,vd.memoizedState,e,t)}function Kn(e,t,n){return void 0===n||1073741824&md?e.memoizedState=t:(e.memoizedState=n,e=Ua(),gd.lanes|=e,wf|=e,n)}function Qn(e,t,n,r){return cu(n,t)?n:null!==Qh.current?(e=Kn(e,n,r),cu(e,t)||(np=!0),e):42&md?(e=Ua(),gd.lanes|=e,wf|=e,t):(np=!0,e.memoizedState=n)}function er(e,t,n,r,i){var a=el();Qo(0!==a&&8>a?a:8);var s,o,l,c=So.T,u={};So.T=u,dr(e,!1,t,n),u._updatedFibers=new Set;try{var h=i(),d=So.S;if(null!==d&&d(u,h),null!==h&&"object"==typeof h&&"function"==typeof h.then){var p=(s=r,o=[],l={status:"pending",value:null,reason:null,then:function(e){o.push(e)}},h.then(function(){l.status="fulfilled",l.value=s;for(var e=0;e<o.length;e++)(0,o[e])(s)},function(e){for(l.status="rejected",l.reason=e,e=0;e<o.length;e++)(0,o[e])(void 0)}),l);hr(e,t,p,La(e))}else hr(e,t,r,La(e))}catch(f){hr(e,t,{then:function(){},status:"rejected",reason:f},La(e))}finally{Qo(a),So.T=c,null===c&&u._updatedFibers&&(e=u._updatedFibers.size,u._updatedFibers.clear())}}function tr(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:cl,baseState:cl,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sn,lastRenderedState:cl},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sn,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function nr(){var e=yn(!1);return e=er.bind(null,gd,e.queue,!0,!1),en().memoizedState=e,[!1,e]}function rr(){var e=ln(sn)[0],t=tn().memoizedState;return["boolean"==typeof e?e:nn(e),t]}function ir(){var e=un(sn)[0],t=tn().memoizedState;return["boolean"==typeof e?e:nn(e),t]}function ar(){return ai(ul)}function sr(){var e=en(),t=af.identifierPrefix;if(Au){var n=_u;t=":"+t+"R"+(n=(yu&~(1<<32-Hc(yu)-1)).toString(32)+n),0<(n=Sd++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Td++).toString(32)+":";return e.memoizedState=t}function or(){return en().memoizedState=lr.bind(null,gd)}function lr(e,t){for(var n=e.return;null!==n;){switch(n.tag){case 24:case 3:var r=La(n),i=ht(n,e=ut(r),r);return null!==i&&(Oa(i,n,r),dt(i,n,r)),n=li(),void(e.payload={cache:n})}n=n.return}}function cr(e,t,n,r){n={lane:r=La(e),revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},pr(e)?fr(t,n):null!==(n=ze(e,t,n,r))&&(Oa(n,e,r),mr(n,t,r)),ne(e,r)}function ur(e,t,n,r){hr(e,t,n,r=La(e)),ne(e,r)}function hr(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(pr(e))fr(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer)){var s=So.H;So.H=kd;try{var o=t.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,cu(l,o))return ke(e,t,i,0),null===af&&Fe(),!1}catch(c){}finally{So.H=s}}if(null!==(n=ze(e,t,i,r)))return Oa(n,e,r),mr(n,t,r),!0}return!1}function dr(e,t,n,r){if(So.T,r={lane:2,revertLane:st(),action:r,hasEagerState:!1,eagerState:null,next:null},pr(e)){if(t)throw Error("Cannot update optimistic state while rendering.")}else null!==(t=ze(e,n,r,2))&&Oa(t,e,2);ne(e,2)}function pr(e){var t=e.alternate;return e===gd||null!==t&&t===gd}function fr(e,t){xd=_d=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function mr(e,t,n){if(4194176&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,W(e,n)}}function gr(e){if(null!==e&&"function"!=typeof e){var t=String(e);Jd.has(t)||Jd.add(t)}}function vr(e,t,n,r){var i=e.memoizedState,a=n(r,i);if(8&e.mode){Z(!0);try{a=n(r,i)}finally{Z(!1)}}void 0===a&&(t=v(t)||"Component",Xd.has(t)||Xd.add(t)),i=null==a?i:no({},i,a),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}function yr(e,t,n,r,i,a,s){var o=e.stateNode;if("function"==typeof o.shouldComponentUpdate){if(n=o.shouldComponentUpdate(r,a,s),8&e.mode){Z(!0);try{n=o.shouldComponentUpdate(r,a,s)}finally{Z(!1)}}return n}return!(t.prototype&&t.prototype.isPureReactComponent&&_t(n,r)&&_t(i,a))}function _r(e,t,n,r){var i=t.state;"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==i&&(e=y(e)||"Component",Vd.has(e)||Vd.add(e),$d.enqueueReplaceState(t,t.state,null))}function xr(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=no({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function br(e,t){try{Qd=t.source?y(t.source):null,ep=null;var n=t.value;null!==So.actQueue?So.thrownErrors.push(n):(0,e.onUncaughtError)(n,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function Sr(e,t,n){try{Qd=n.source?y(n.source):null,ep=y(t),(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Mr(e,t,n){return(n=ut(n)).tag=ih,n.payload={element:null},n.callback=function(){T(t.source,br,e,t)},n}function wr(e){return(e=ut(e)).tag=ih,e}function Tr(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"==typeof i){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){ws(n),T(r.source,Sr,t,n,r)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){ws(n),T(r.source,Sr,t,n,r),"function"!=typeof i&&(null===Ff?Ff=new Set([this]):Ff.add(this)),Uh(this,r),"function"==typeof i||n.lanes})}function Er(e,t,n,r){t.child=null===e?Kh(t,null,n,r):$h(t,e.child,n,r)}function Ar(e,t,n,r,i){n=n.render;var a=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return ii(t),K(t),r=qt(e,t,n,s,a,i),o=$t(),Q(),null===e||np?(Au&&o&&se(t),t.flags|=1,Er(e,t,r,i),t.child):(Kt(e,t,i),Yr(e,t,i))}function Cr(e,t,n,r,i){if(null===e){var a=n.type;return"function"!=typeof a||As(a)||void 0!==a.defaultProps||null!==n.compare?((e=Ps(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(n=bs(a),t.tag=15,t.type=n,Fr(t,a),Rr(e,t,n,r,i))}if(a=e.child,!Zr(e,i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:_t)(s,r)&&e.ref===t.ref)return Yr(e,t,i)}return t.flags|=1,(e=Cs(a,r)).ref=t.ref,e.return=t,t.child=e}function Rr(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(_t(a,r)&&e.ref===t.ref&&t.type===e.type){if(np=!1,t.pendingProps=r=a,!Zr(e,i))return t.lanes=e.lanes,Yr(e,t,i);131072&e.flags&&(np=!0)}}return Nr(e,t,n,r,i)}function Pr(e,t,n){var r=t.pendingProps,i=r.children,a=!!(2&t.stateNode._pendingVisibility),s=null!==e?e.memoizedState:null;if(Dr(e,t),"hidden"===r.mode||a){if(128&t.flags){if(r=null!==s?s.baseLanes|n:n,null!==e){for(i=t.child=e.child,a=0;null!==i;)a=a|i.lanes|i.childLanes,i=i.sibling;t.childLanes=a&~r}else t.childLanes=0,t.child=null;return Ir(e,t,r,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,Ir(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&di(t,null!==s?s.cachePool:null),null!==s?Nt(t,s):Lt(t),Ft(t)}else null!==s?(di(t,s.cachePool),Nt(t,s),kt(t),t.memoizedState=null):(null!==e&&di(t,null),Lt(t),kt(t));return Er(e,t,i,n),t.child}function Ir(e,t,n,r){var i=hi();return i=null===i?null:{parent:qo?bp._currentValue:bp._currentValue2,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&di(t,null),Lt(t),Ft(t),null!==e&&ni(e,t,r,!0),null}function Dr(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!=typeof n&&"object"!=typeof n)throw Error("Expected ref to be a function, an object returned by React.createRef(), or undefined/null.");null!==e&&e.ref===n||(t.flags|=2097664)}}function Nr(e,t,n,r,i){if(n.prototype&&"function"==typeof n.prototype.render){var a=v(n)||"Unknown";rp[a]||(rp[a]=!0)}return 8&t.mode&&uh.recordLegacyContextWarning(t,null),null===e&&(Fr(t,t.type),n.contextTypes&&(a=v(n)||"Unknown",ap[a]||(ap[a]=!0))),ii(t),K(t),n=qt(e,t,n,r,void 0,i),r=$t(),Q(),null===e||np?(Au&&r&&se(t),t.flags|=1,Er(e,t,n,i),t.child):(Kt(e,t,i),Yr(e,t,i))}function Lr(e,t,n,r,i,a){return ii(t),K(t),Rd=-1,Pd=null!==e&&e.type!==t.type,t.updateQueue=null,n=Zt(t,r,n,i),Yt(e,t),r=$t(),Q(),null===e||np?(Au&&r&&se(t),t.flags|=1,Er(e,t,n,a),t.child):(Kt(e,t,a),Yr(e,t,a))}function Ur(e,t,n,r,i){switch(l(t)){case!1:var a=t.stateNode,s=new t.type(t.memoizedProps,a.context).state;a.updater.enqueueSetState(a,s,null);break;case!0:t.flags|=128,t.flags|=65536,a=Error("Simulated error coming from DevTools");var o=i&-i;if(t.lanes|=o,null===(s=af))throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");Tr(o=wr(o),s,t,re(a,t)),pt(t,o)}if(ii(t),null===t.stateNode){if(s=Vc,a=n.contextType,"contextType"in n&&null!==a&&(void 0===a||a.$$typeof!==ho)&&!Zd.has(n)&&(Zd.add(n),o=void 0===a?" However, it is set to undefined. This can be caused by a typo or by mixing up named and default imports. This can also happen due to a circular dependency, so try moving the createContext() call to a separate file.":"object"!=typeof a?" However, it is set to a "+typeof a+".":a.$$typeof===uo?" Did you accidentally pass the Context.Consumer instead?":" However, it is set to an object with keys {"+Object.keys(a).join(", ")+"}."),"object"==typeof a&&null!==a&&(s=ai(a)),a=new n(r,s),8&t.mode){Z(!0);try{a=new n(r,s)}finally{Z(!1)}}if(s=t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=$d,t.stateNode=a,a._reactInternals=t,a._reactInternalInstance=Bd,"function"==typeof n.getDerivedStateFromProps&&null===s&&(s=v(n)||"Component",Hd.has(s)||Hd.add(s)),"function"==typeof n.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate){var c=o=s=null;if("function"==typeof a.componentWillMount&&!0!==a.componentWillMount.__suppressDeprecationWarning?s="componentWillMount":"function"==typeof a.UNSAFE_componentWillMount&&(s="UNSAFE_componentWillMount"),"function"==typeof a.componentWillReceiveProps&&!0!==a.componentWillReceiveProps.__suppressDeprecationWarning?o="componentWillReceiveProps":"function"==typeof a.UNSAFE_componentWillReceiveProps&&(o="UNSAFE_componentWillReceiveProps"),"function"==typeof a.componentWillUpdate&&!0!==a.componentWillUpdate.__suppressDeprecationWarning?c="componentWillUpdate":"function"==typeof a.UNSAFE_componentWillUpdate&&(c="UNSAFE_componentWillUpdate"),null!==s||null!==o||null!==c){a=v(n)||"Component";var u="function"==typeof n.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";Gd.has(a)||Gd.add(a)}}a=t.stateNode,s=v(n)||"Component",a.render||n.prototype&&n.prototype.render,!a.getInitialState||a.getInitialState.isReactClassApproved||a.state,a.getDefaultProps&&a.getDefaultProps.isReactClassApproved,a.contextType,n.childContextTypes&&!Yd.has(n)&&Yd.add(n),n.contextTypes&&!qd.has(n)&&qd.add(n),a.componentShouldUpdate,n.prototype&&n.prototype.isPureReactComponent&&a.shouldComponentUpdate,a.componentDidUnmount,a.componentDidReceiveProps,a.componentWillRecieveProps,a.UNSAFE_componentWillRecieveProps,o=a.props!==r,a.props,a.defaultProps,"function"!=typeof a.getSnapshotBeforeUpdate||"function"==typeof a.componentDidUpdate||jd.has(n)||jd.add(n),a.getDerivedStateFromProps,a.getDerivedStateFromError,n.getSnapshotBeforeUpdate,(o=a.state)&&("object"!=typeof o||Po(o)),"function"==typeof a.getChildContext&&n.childContextTypes,(a=t.stateNode).props=r,a.state=t.memoizedState,a.refs={},lt(t),s=n.contextType,a.context="object"==typeof s&&null!==s?ai(s):Vc,a.state===r&&(s=v(n)||"Component",Wd.has(s)||Wd.add(s)),8&t.mode&&uh.recordLegacyContextWarning(t,a),uh.recordUnsafeLifecycleWarnings(t,a),a.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(vr(t,n,s,r),a.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(s=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&$d.enqueueReplaceState(a,a.state,null),mt(t,r,a,i),ft(),a.state=t.memoizedState),"function"==typeof a.componentDidMount&&(t.flags|=4194308),(16&t.mode)!==Nu&&(t.flags|=67108864),a=!0}else if(null===e){a=t.stateNode;var h=t.memoizedProps;o=xr(n,h),a.props=o;var d=a.context;c=n.contextType,s=Vc,"object"==typeof c&&null!==c&&(s=ai(c)),c="function"==typeof(u=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate,h=t.pendingProps!==h,c||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(h||d!==s)&&_r(t,a,r,s),ah=!1;var p=t.memoizedState;a.state=p,mt(t,r,a,i),ft(),d=t.memoizedState,h||p!==d||ah?("function"==typeof u&&(vr(t,n,u,r),d=t.memoizedState),(o=ah||yr(t,n,o,r,p,d,s))?(c||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308),(16&t.mode)!==Nu&&(t.flags|=67108864)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),(16&t.mode)!==Nu&&(t.flags|=67108864),t.memoizedProps=r,t.memoizedState=d),a.props=r,a.state=d,a.context=s,a=o):("function"==typeof a.componentDidMount&&(t.flags|=4194308),(16&t.mode)!==Nu&&(t.flags|=67108864),a=!1)}else{a=t.stateNode,ct(e,t),c=xr(n,s=t.memoizedProps),a.props=c,u=t.pendingProps,p=a.context,d=n.contextType,o=Vc,"object"==typeof d&&null!==d&&(o=ai(d)),(d="function"==typeof(h=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==u||p!==o)&&_r(t,a,r,o),ah=!1,p=t.memoizedState,a.state=p,mt(t,r,a,i),ft();var f=t.memoizedState;s!==u||p!==f||ah||null!==e&&null!==e.dependencies&&ri(e.dependencies)?("function"==typeof h&&(vr(t,n,h,r),f=t.memoizedState),(c=ah||yr(t,n,c,r,p,f,o)||null!==e&&null!==e.dependencies&&ri(e.dependencies))?(d||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,o),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,o)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=o,a=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}if(o=a,Dr(e,t),s=!!(128&t.flags),o||s){if(o=t.stateNode,So.getCurrentStack=null===t?null:w,Ro=!1,Co=t,s&&"function"!=typeof n.getDerivedStateFromError)n=null,zu=-1;else{if(K(t),n=Rh(o),8&t.mode){Z(!0);try{Rh(o)}finally{Z(!1)}}Q()}t.flags|=1,null!==e&&s?(t.child=$h(t,e.child,null,i),t.child=$h(t,null,n,i)):Er(e,t,n,i),t.memoizedState=o.state,e=t.child}else e=Yr(e,t,i);return i=t.stateNode,a&&i.props!==r&&(op=!0),e}function Or(e,t,n,r){return Le(),t.flags|=256,Er(e,t,n,r),t.child}function Fr(e,t){t&&t.childContextTypes,"function"==typeof t.getDerivedStateFromProps&&(e=v(t)||"Unknown",sp[e]||(sp[e]=!0)),"object"==typeof t.contextType&&null!==t.contextType&&(t=v(t)||"Unknown",ip[t]||(ip[t]=!0))}function kr(e){return{baseLanes:e,cachePool:pi()}}function zr(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Af),e}function Br(e,t,n){var r=t.pendingProps;o(t)&&(t.flags|=128);var i,a=!1,s=!!(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&0!==(ad.current&id)),i&&(a=!0,t.flags&=-129),i=!!(32&t.flags),t.flags&=-33,null===e){if(Au){if(a?Ot(t):kt(t),Au){var l,u=Eu;(l=!u)||(null!==(l=rc(u,Iu))?(t.memoizedState={dehydrated:l,treeContext:null!==vu?{id:yu,overflow:_u}:null,retryLane:536870912},(s=c(18,null,null,Nu)).stateNode=l,s.return=t,t.child=s,Tu=t,Eu=null,l=!0):l=!1,l=!l),l&&(Re(t,u),Pe(t))}if(null!==(u=t.memoizedState)&&null!==(u=u.dehydrated))return Xl(u)?t.lanes=16:t.lanes=536870912,null;zt(t)}return u=r.children,r=r.fallback,a?(kt(t),u=Hr({mode:"hidden",children:u},a=t.mode),r=Ds(r,a,n,null),u.return=t,r.return=t,u.sibling=r,t.child=u,(a=t.child).memoizedState=kr(n),a.childLanes=zr(e,i,n),t.memoizedState=up,r):(Ot(t),Vr(t,u))}if(null!==(l=e.memoizedState)&&null!==(u=l.dehydrated)){if(s)256&t.flags?(Ot(t),t.flags&=-257,t=jr(e,t,n)):null!==t.memoizedState?(kt(t),t.child=e.child,t.flags|=128,t=null):(kt(t),a=r.fallback,u=t.mode,r=Hr({mode:"visible",children:r.children},u),(a=Ds(a,u,n,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,$h(t,e.child,null,n),(r=t.child).memoizedState=kr(n),r.childLanes=zr(e,i,n),t.memoizedState=up,t=a);else if(Ot(t),Xl(u))i=(u=ql(u)).digest,a=u.message,r=u.stack,u=u.componentStack,(a=a?Error(a):Error("The server could not finish this Suspense boundary, likely due to an error during server rendering. Switched to client rendering.")).stack=r||"",a.digest=i,r={value:a,source:null,stack:i=void 0===u?null:u},"string"==typeof i&&uu.set(a,r),Ue(r),t=jr(e,t,n);else if(np||ni(e,t,n,!1),i=0!==(n&e.childLanes),np||i){if(null!==(i=af)){if(42&(r=n&-n))r=1;else switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=64;break;case 268435456:r=134217728;break;default:r=0}if(0!==(r=0!==(r&(i.suspendedLanes|n))?0:r)&&r!==l.retryLane)throw l.retryLane=r,Be(e,r),Oa(i,e,r),tp}Wl(u)||Za(),t=jr(e,t,n)}else Wl(u)?(t.flags|=128,t.child=e.child,t=fs.bind(null,e),Yl(u,t),t=null):(e=l.treeContext,Jo&&(Eu=ec(u),Tu=t,Au=!0,Pu=null,Cu=!1,Ru=null,Iu=!1,null!==e&&(mu[gu++]=yu,mu[gu++]=_u,mu[gu++]=vu,yu=e.id,_u=e.overflow,vu=t)),(t=Vr(t,r.children)).flags|=4096);return t}return a?(kt(t),a=r.fallback,u=t.mode,s=(l=e.child).sibling,(r=Cs(l,{mode:"hidden",children:r.children})).subtreeFlags=31457280&l.subtreeFlags,null!==s?a=Cs(s,a):(a=Ds(a,u,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,null===(u=e.child.memoizedState)?u=kr(n):(null!==(l=u.cachePool)?(s=qo?bp._currentValue:bp._currentValue2,l=l.parent!==s?{parent:s,pool:s}:l):l=pi(),u={baseLanes:u.baseLanes|n,cachePool:l}),a.memoizedState=u,a.childLanes=zr(e,i,n),t.memoizedState=up,r):(Ot(t),e=(n=e.child).sibling,(n=Cs(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Vr(e,t){return(t=Hr({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Hr(e,t){return Ns(e,t,0,null)}function jr(e,t,n){return $h(t,e.child,null,n),(e=Vr(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Gr(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ei(e.return,t,n)}function Wr(e,t){var n=Po(e);return e=!n&&"function"==typeof g(e),!n&&!e||(n=n?"array":"iterable",!1)}function Xr(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function qr(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;r=r.children,void 0===i||"forwards"===i||"backwards"===i||"together"===i||lp[i]||(lp[i]=!0,"string"==typeof i&&i.toLowerCase()),void 0===a||cp[a]||("collapsed"!==a&&"hidden"!==a||"forwards"!==i&&"backwards"!==i)&&(cp[a]=!0);e:if(("forwards"===i||"backwards"===i)&&null!=r&&!1!==r)if(Po(r)){for(var s=0;s<r.length;s++)if(!Wr(r[s]))break e}else if(s=g(r),"function"==typeof s&&(s=s.call(r)))for(var o=s.next();!o.done;o=s.next())if(!Wr(o.value))break e;if(Er(e,t,r,n),0!==((r=ad.current)&id))r=r&rd|id,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Gr(e,n,t);else if(19===e.tag)Gr(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=rd}switch(L(ad,r,t),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Bt(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Xr(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Bt(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Xr(t,!0,n,null,a);break;case"together":Xr(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yr(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),zu=-1,wf|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(ni(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error("Resuming work not yet implemented.");if(null!==t.child){for(n=Cs(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Cs(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Zr(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!ri(e))}function Jr(e,t,n){if(t._debugNeedsRemount&&null!==e){n=Ps(t.type,t.key,t.pendingProps,t._debugOwner||null,t.mode,t.lanes);var r=t.return;if(null===r)throw Error("Cannot swap the root fiber.");if(e.alternate=null,t.alternate=null,n.index=t.index,n.sibling=t.sibling,n.return=t.return,n.ref=t.ref,n._debugInfo=t._debugInfo,t===r.child)r.child=n;else{var i=r.child;if(null===i)throw Error("Expected parent to have a child.");for(;i.sibling!==t;)if(null===(i=i.sibling))throw Error("Expected to find the previous sibling.");i.sibling=n}return null===(t=r.deletions)?(r.deletions=[e],r.flags|=16):t.push(e),n.flags|=2,n}if(null!==e)if(e.memoizedProps!==t.pendingProps||t.type!==e.type)np=!0;else{if(!(Zr(e,n)||128&t.flags))return np=!1,function(e,t,n){switch(t.tag){case 3:le(t,t.stateNode.containerInfo),Kr(t,bp,e.memoizedState.cache),Le();break;case 27:case 5:he(t);break;case 4:le(t,t.stateNode.containerInfo);break;case 10:Kr(t,t.type,t.memoizedProps.value);break;case 12:0!==(n&t.childLanes)&&(t.flags|=4),t.flags|=2048;var r=t.stateNode;r.effectDuration=-0,r.passiveEffectDuration=-0;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ot(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Br(e,t,n):(Ot(t),null!==(e=Yr(e,t,n))?e.sibling:null);Ot(t);break;case 19:var i=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(ni(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return qr(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),L(ad,ad.current,t),r)break;return null;case 22:case 23:return t.lanes=0,Pr(e,t,n);case 24:Kr(t,bp,e.memoizedState.cache)}return Yr(e,t,n)}(e,t,n);np=!!(131072&e.flags)}else np=!1,(r=Au)&&(r=!!(1048576&t.flags)),r&&(r=t.index,ae(t,fu,r));switch(t.lanes=0,t.tag){case 16:e:{if(r=t.pendingProps,e=jh(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){if((i=e.$$typeof)===po){t.tag=11,t.type=e=Ss(e),t=Ar(null,t,e,r,n);break e}if(i===go){t.tag=14,t=Cr(null,t,e,r,n);break e}}throw t="",null!==e&&"object"==typeof e&&e.$$typeof===vo&&(t=" Did you wrap a component in React.lazy() more than once?"),e=v(e)||e,Error("Element type is invalid. Received a promise that resolves to: "+e+". Lazy element type must resolve to a class or function."+t)}As(e)?(r=xr(e,r),t.tag=1,t.type=e=bs(e),t=Ur(null,t,e,r,n)):(t.tag=0,Fr(t,e),t.type=e=bs(e),t=Nr(null,t,e,r,n))}return t;case 0:return Nr(e,t,t.type,t.pendingProps,n);case 1:return Ur(e,t,r=t.type,i=xr(r,t.pendingProps),n);case 3:e:{if(le(t,t.stateNode.containerInfo),null===e)throw Error("Should have a current fiber. This is a bug in React.");var a=t.pendingProps;r=(i=t.memoizedState).element,ct(e,t),mt(t,a,null,n);var s=t.memoizedState;if(a=s.cache,Kr(t,bp,a),a!==i.cache&&ti(t,[bp],n,!0),ft(),a=s.element,Jo&&i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Or(e,t,a,n);break e}if(a!==r){Ue(r=re(Error("This root received an early update, before anything was able hydrate. Switched the entire root to client rendering."),t)),t=Or(e,t,a,n);break e}for(Jo&&(Eu=Ql(t.stateNode.containerInfo),Tu=t,Au=!0,Pu=null,Cu=!1,Ru=null,Iu=!0),e=Kh(t,null,a,n),t.child=e;e;)e.flags=-3&e.flags|4096,e=e.sibling}else{if(Le(),a===r){t=Yr(e,t,n);break e}Er(e,t,a,n)}t=t.child}return t;case 26:if(yc)return Dr(e,t),null===e?(e=bc(t.type,null,t.pendingProps,null))?t.memoizedState=e:Au||(t.stateNode=Ac(t.type,t.pendingProps,Su.current,t)):t.memoizedState=bc(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:if(Dc)return he(t),null===e&&Dc&&Au&&(i=Su.current,r=ue(),i=t.stateNode=Nc(t.type,t.pendingProps,i,r,!1),Cu||null!==(r=pc(i,t.type,t.pendingProps,r))&&(Ce(t,0).serverProps=r),Tu=t,Iu=!0,Eu=Kl(i)),r=t.pendingProps.children,null!==e||Au?Er(e,t,r,n):t.child=$h(t,null,r,n),Dr(e,t),t.child;case 5:return null===e&&Au&&(a=ue(),r=gc(t.type,t.pendingProps,a),(s=!(i=Eu))||(null!==(s=tc(i,t.type,t.pendingProps,Iu))?(t.stateNode=s,Cu||null!==(a=pc(s,t.type,t.pendingProps,a))&&(Ce(t,0).serverProps=a),Tu=t,Eu=Kl(s),Iu=!1,a=!0):a=!1,s=!a),s&&(r&&Re(t,i),Pe(t))),he(t),i=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,r=a.children,Ho(i,a)?r=null:null!==s&&Ho(i,s)&&(t.flags|=32),null!==t.memoizedState&&(i=qt(e,t,Jt,null,null,n),qo?ul._currentValue=i:ul._currentValue2=i),Dr(e,t),Er(e,t,r,n),t.child;case 6:return null===e&&Au&&(e=t.pendingProps,n=ue(),e=vc(e,n),(r=!(n=Eu))||(null!==(r=nc(n,t.pendingProps,Iu))?(t.stateNode=r,Tu=t,Eu=null,r=!0):r=!1,r=!r),r&&(e&&Re(t,n),Pe(t))),null;case 13:return Br(e,t,n);case 4:return le(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=$h(t,null,r,n):Er(e,t,r,n),t.child;case 11:return Ar(e,t,t.type,t.pendingProps,n);case 7:return Er(e,t,t.pendingProps,n),t.child;case 8:return Er(e,t,t.pendingProps.children,n),t.child;case 12:return t.flags|=4,t.flags|=2048,(r=t.stateNode).effectDuration=-0,r.passiveEffectDuration=-0,Er(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.type,a=(i=t.pendingProps).value,"value"in i||hp||(hp=!0),Kr(t,r,a),Er(e,t,i.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,ii(t),i=ai(i),K(t),r=Ah(r,i,void 0),Q(),t.flags|=1,Er(e,t,r,n),t.child;case 14:return Cr(e,t,t.type,t.pendingProps,n);case 15:return Rr(e,t,t.type,t.pendingProps,n);case 19:return qr(e,t,n);case 22:return Pr(e,t,n);case 24:return ii(t),r=ai(bp),null===e?(null===(i=hi())&&(i=af,a=li(),i.pooledCache=a,ci(a),null!==a&&(i.pooledCacheLanes|=n),i=a),t.memoizedState={parent:r,cache:i},lt(t),Kr(t,bp,i)):(0!==(e.lanes&n)&&(ct(e,t),mt(t,null,null,n),ft()),i=e.memoizedState,a=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Kr(t,bp,r)):(r=a.cache,Kr(t,bp,r),r!==i.cache&&ti(t,[bp],n,!0))),Er(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error("Unknown unit of work tag ("+t.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function $r(){vp=gp=null}function Kr(e,t,n){qo?(L(dp,t._currentValue,e),t._currentValue=n,L(pp,t._currentRenderer,e),void 0!==t._currentRenderer&&null!==t._currentRenderer&&t._currentRenderer,t._currentRenderer=mp):(L(dp,t._currentValue2,e),t._currentValue2=n,L(fp,t._currentRenderer2,e),void 0!==t._currentRenderer2&&null!==t._currentRenderer2&&t._currentRenderer2,t._currentRenderer2=mp)}function Qr(e,t){var n=dp.current;qo?(e._currentValue=n,n=pp.current,N(pp),e._currentRenderer=n):(e._currentValue2=n,n=fp.current,N(fp),e._currentRenderer2=n),N(dp)}function ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ti(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var a=i.dependencies;if(null!==a){var s=i.child;a=a.firstContext;e:for(;null!==a;){var o=a;a=i;for(var l=0;l<t.length;l++)if(o.context===t[l]){a.lanes|=n,null!==(o=a.alternate)&&(o.lanes|=n),ei(a.return,n,e),r||(s=null);break e}a=o.next}}else if(18===i.tag){if(null===(s=i.return))throw Error("We just came from a parent so we must have had a parent. This is a bug in React.");s.lanes|=n,null!==(a=s.alternate)&&(a.lanes|=n),ei(s,n,e),s=null}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===e){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}}function ni(e,t,n,r){e=null;for(var i=t,a=!1;null!==i;){if(!a)if(524288&i.flags)a=!0;else if(262144&i.flags)break;if(10===i.tag){var s=i.alternate;if(null===s)throw Error("Should have a current fiber. This is a bug in React.");if(null!==(s=s.memoizedProps)){var o=i.type;cu(i.pendingProps.value,s.value)||(null!==e?e.push(o):e=[o])}}else if(i===Mu.current){if(null===(s=i.alternate))throw Error("Should have a current fiber. This is a bug in React.");s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(ul):e=[ul])}i=i.return}null!==e&&ti(t,e,n,r),t.flags|=262144}function ri(e){for(e=e.firstContext;null!==e;){var t=e.context;if(!cu(qo?t._currentValue:t._currentValue2,e.memoizedValue))return!0;e=e.next}return!1}function ii(e){gp=e,vp=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ai(e){return oi(gp,e)}function si(e,t){return null===gp&&ii(e),oi(e,t)}function oi(e,t){var n=qo?t._currentValue:t._currentValue2;if(t={context:t,memoizedValue:n,next:null},null===vp){if(null===e)throw Error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");vp=t,e.dependencies={lanes:0,firstContext:t,_debugThenableState:null},e.flags|=524288}else vp=vp.next=t;return n}function li(){return{controller:new yp,data:new Map,refCount:0}}function ci(e){e.controller.signal.aborted,e.refCount++}function ui(e){e.refCount--,e.refCount,0===e.refCount&&_p(xp,function(){e.controller.abort()})}function hi(){var e=Mp.current;return null!==e?e:af.pooledCache}function di(e,t){L(Mp,null===t?Mp.current:t.pool,e)}function pi(){var e=hi();return null===e?null:{parent:qo?bp._currentValue:bp._currentValue2,pool:e}}function fi(e){e.flags|=4}function mi(e,t){if(null!==e&&e.child===t.child)return!1;if(16&t.flags)return!0;for(e=t.child;null!==e;){if(13878&e.flags||13878&e.subtreeFlags)return!0;e=e.sibling}return!1}function gi(e,t,n,r){if(Yo)for(n=t.child;null!==n;){if(5===n.tag||6===n.tag)Bo(e,n.stateNode);else if(!(4===n.tag||Dc&&27===n.tag)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else if(Zo)for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;n&&r&&(a=jl(a,i.type,i.memoizedProps)),Bo(e,a)}else if(6===i.tag)a=i.stateNode,n&&r&&(a=Gl(a,i.memoizedProps)),Bo(e,a);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),gi(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function vi(e,t,n,r){if(Zo)for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;n&&r&&(a=jl(a,i.type,i.memoizedProps)),Bl(e,a)}else if(6===i.tag)a=i.stateNode,n&&r&&(a=Gl(a,i.memoizedProps)),Bl(e,a);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),vi(e,i,!(null!==i.memoizedProps&&"manual"===i.memoizedProps.mode),!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function yi(e,t){if(Zo&&mi(e,t)){var n=(e=t.stateNode).containerInfo,r=zl();vi(r,t,!1,!1),e.pendingChildren=r,fi(t),Vl(n,r)}}function _i(e,t,n,r){if(Yo)e.memoizedProps!==r&&fi(t);else if(Zo){var i=e.stateNode,a=e.memoizedProps;if((e=mi(e,t))||a!==r){var s=ue();(a=kl(i,n,a,r,!e,null))===i?t.stateNode=i:(Vo(a,n,r,s)&&fi(t),t.stateNode=a,e?gi(a,t,!1,!1):fi(t))}else t.stateNode=i}}function xi(e,t,n){if(il(t,n)){if(e.flags|=16777216,!al(t,n)){if(!Xa())throw wh=Mh,Sh;e.flags|=8192}}else e.flags&=-16777217}function bi(e,t){if(Rc(t)){if(e.flags|=16777216,!Pc(t)){if(!Xa())throw wh=Mh,Sh;e.flags|=8192}}else e.flags&=-16777217}function Si(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?V():536870912,e.lanes|=t,Cf|=t)}function Mi(e,t){if(!Au)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function wi(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)if((2&e.mode)!==Nu){for(var i=e.selfBaseDuration,a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=31457280&a.subtreeFlags,r|=31457280&a.flags,i+=a.treeBaseDuration,a=a.sibling;e.treeBaseDuration=i}else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=31457280&i.subtreeFlags,r|=31457280&i.flags,i.return=e,i=i.sibling;else if((2&e.mode)!==Nu){i=e.actualDuration,a=e.selfBaseDuration;for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,i+=s.actualDuration,a+=s.treeBaseDuration,s=s.sibling;e.actualDuration=i,e.treeBaseDuration=a}else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ti(e,t,n){var r=t.pendingProps;switch(oe(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return wi(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Qr(bp),ce(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(Ne(t)?(Oe(),fi(t)):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==Pu&&(ka(Pu),Pu=null))),yi(e,t),wi(t),null;case 26:if(yc){n=t.type;var i=t.memoizedState;return null===e?(fi(t),null!==i?(wi(t),bi(t,i)):(wi(t),xi(t,n,r))):i?i!==e.memoizedState?(fi(t),wi(t),bi(t,i)):(wi(t),t.flags&=-16777217):(Yo?e.memoizedProps!==r&&fi(t):_i(e,t,n,r),wi(t),xi(t,n,r)),null}case 27:if(Dc){if(de(t),n=Su.current,i=t.type,null!==e&&null!=t.stateNode)Yo?e.memoizedProps!==r&&fi(t):_i(e,t,i,r);else{if(!r){if(null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return wi(t),null}e=ue(),Ne(t)?Ie(t,e):(e=Nc(i,r,n,e,!0),t.stateNode=e,fi(t))}return wi(t),null}case 5:if(de(t),n=t.type,null!==e&&null!=t.stateNode)_i(e,t,n,r);else{if(!r){if(null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return wi(t),null}e=ue(),Ne(t)?Ie(t,e):(i=Su.current,gi(i=zo(n,r,i,e,t),t,!1,!1),t.stateNode=i,Vo(i,n,r,e)&&fi(t))}return wi(t),xi(t,t.type,t.pendingProps),null;case 6:if(e&&null!=t.stateNode)n=e.memoizedProps,Yo?n!==r&&fi(t):Zo&&(n!==r?(e=Su.current,n=ue(),t.stateNode=jo(r,e,n,t),fi(t)):t.stateNode=e.stateNode);else{if("string"!=typeof r&&null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");if(e=Su.current,n=ue(),Ne(t)){if(!Jo)throw Error("Expected prepareToHydrateHostTextInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");e=t.stateNode,n=t.memoizedProps,i=!Cu,r=null;var a=Tu;if(null!==a)switch(a.tag){case 3:i&&null!==(i=fc(e,n,r))&&(Ce(t,0).serverProps=i);break;case 27:case 5:r=a.memoizedProps,i&&null!==(i=fc(e,n,r))&&(Ce(t,0).serverProps=i)}ac(e,n,t,r)||Pe(t)}else t.stateNode=jo(r,e,n,t)}return wi(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=Ne(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error("A dehydrated suspense component was completed without a hydrated node. This is probably a bug in React.");if(!Jo)throw Error("Expected prepareToHydrateHostSuspenseInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");sc(i,t),wi(t),(2&t.mode)!==Nu&&null!==r&&null!==(i=t.child)&&(t.treeBaseDuration-=i.treeBaseDuration)}else Oe(),Le(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4,wi(t),(2&t.mode)!==Nu&&null!==r&&null!==(i=t.child)&&(t.treeBaseDuration-=i.treeBaseDuration);i=!1}else null!==Pu&&(ka(Pu),Pu=null),i=!0;if(!i)return 256&t.flags?(zt(t),t):(zt(t),null)}return zt(t),128&t.flags?(t.lanes=n,(2&t.mode)!==Nu&&$e(t),t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),a=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(a=r.memoizedState.cachePool.pool),a!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Si(t,t.updateQueue),wi(t),(2&t.mode)!==Nu&&n&&null!==(e=t.child)&&(t.treeBaseDuration-=e.treeBaseDuration),null);case 4:return ce(),yi(e,t),null===e&&Ko(t.stateNode.containerInfo),wi(t),null;case 10:return Qr(t.type),wi(t),null;case 19:if(N(ad),null===(i=t.memoizedState))return wi(t),null;if(r=!!(128&t.flags),null===(a=i.rendering))if(r)Mi(i,!1);else{if(Mf!==Zp||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(a=Bt(e))){for(t.flags|=128,Mi(i,!1),e=a.updateQueue,t.updateQueue=e,Si(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Rs(n,e),n=n.sibling;return L(ad,ad.current&rd|id,t),t.child}e=e.sibling}null!==i.tail&&$c()>Lf&&(t.flags|=128,r=!0,Mi(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Bt(a))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,Si(t,e),Mi(i,!0),null===i.tail&&"hidden"===i.tailMode&&!a.alternate&&!Au)return wi(t),null}else 2*$c()-i.renderingStartTime>Lf&&536870912!==n&&(t.flags|=128,r=!0,Mi(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=i.last)?e.sibling=a:t.child=a,i.last=a)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=$c(),e.sibling=null,n=ad.current,L(ad,n=r?n&rd|id:n&rd,t),e):(wi(t),null);case 22:case 23:return zt(t),Ut(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?!!(536870912&n)&&!(128&t.flags)&&(wi(t),6&t.subtreeFlags&&(t.flags|=8192)):wi(t),null!==(n=t.updateQueue)&&Si(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&N(Mp),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Qr(bp),wi(t),null;case 25:return null}throw Error("Unknown unit of work tag ("+t.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function Ei(e,t){switch(oe(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,(2&t.mode)!==Nu&&$e(t),t):null;case 3:return Qr(bp),ce(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return de(t),null;case 13:if(zt(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error("Threw in newly mounted dehydrated component. This is likely a bug in React. Please file an issue.");Le()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,(2&t.mode)!==Nu&&$e(t),t):null;case 19:return N(ad),null;case 4:return ce(),null;case 10:return Qr(t.type),null;case 22:case 23:return zt(t),Ut(),null!==e&&N(Mp),65536&(e=t.flags)?(t.flags=-65537&e|128,(2&t.mode)!==Nu&&$e(t),t):null;case 24:return Qr(bp),null;default:return null}}function Ai(e,t){switch(oe(t),t.tag){case 3:Qr(bp),ce();break;case 26:case 27:case 5:de(t);break;case 4:ce();break;case 13:zt(t);break;case 19:N(ad);break;case 10:Qr(t.type);break;case 22:case 23:zt(t),Ut(),null!==e&&N(Mp);break;case 24:Qr(bp)}}function Ci(e){return(2&e.mode)!==Nu}function Ri(e,t){Ci(e)?(Je(),Ii(t,e),Ze()):Ii(t,e)}function Pi(e,t,n){Ci(e)?(Je(),Di(n,e,t),Ze()):Di(n,e,t)}function Ii(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{var a;if((n.tag&e)===e&&((e&ud)!==sd?null!==su&&"function"==typeof su.markComponentPassiveEffectMountStarted&&su.markComponentPassiveEffectMountStarted(t):(e&cd)!==sd&&null!==su&&"function"==typeof su.markComponentLayoutEffectMountStarted&&su.markComponentLayoutEffectMountStarted(t),r=void 0,r=T(t,zh,n),(e&ud)!==sd?null!==su&&"function"==typeof su.markComponentPassiveEffectMountStopped&&su.markComponentPassiveEffectMountStopped():(e&cd)!==sd&&null!==su&&"function"==typeof su.markComponentLayoutEffectMountStopped&&su.markComponentLayoutEffectMountStopped(),void 0!==r&&"function"!=typeof r))T(t,function(e,t){},a=0!==(n.tag&cd)?"useLayoutEffect":0!==(n.tag&ld)?"useInsertionEffect":"useEffect",null===r?" You returned null. If your effect does not require clean up, return undefined (or nothing).":"function"==typeof r.then?"\n\nIt looks like you wrote "+a+"(async () => ...) or returned a Promise. Instead, write the async function inside your effect and call it immediately:\n\n"+a+"(() => {\n  async function fetchData() {\n    // You can await here\n    const response = await MyAPI.getData(someId);\n    // ...\n  }\n  fetchData();\n}, [someId]); // Or [] if effect doesn't need props or state\n\nLearn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching":" You returned: "+r);n=n.next}while(n!==i)}}catch(s){us(t,t.return,s)}}function Di(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var a=i.next;r=a;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;void 0!==o&&(s.destroy=void 0,(e&ud)!==sd?null!==su&&"function"==typeof su.markComponentPassiveEffectUnmountStarted&&su.markComponentPassiveEffectUnmountStarted(t):(e&cd)!==sd&&null!==su&&"function"==typeof su.markComponentLayoutEffectUnmountStarted&&su.markComponentLayoutEffectUnmountStarted(t),T(t,Vh,t,n,o),(e&ud)!==sd?null!==su&&"function"==typeof su.markComponentPassiveEffectUnmountStopped&&su.markComponentPassiveEffectUnmountStopped():(e&cd)!==sd&&null!==su&&"function"==typeof su.markComponentLayoutEffectUnmountStopped&&su.markComponentLayoutEffectUnmountStopped())}r=r.next}while(r!==a)}}catch(l){us(t,t.return,l)}}function Ni(e,t){Ci(e)?(Je(),Ii(t,e),Ze()):Ii(t,e)}function Li(e,t,n){Ci(e)?(Je(),Di(n,e,t),Ze()):Di(n,e,t)}function Ui(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;e.type.defaultProps||"ref"in e.memoizedProps||op||(n.props,e.memoizedProps,n.state,e.memoizedState);try{T(e,yt,t,n)}catch(r){us(e,e.return,r)}}}function Oi(e,t,n){return e.getSnapshotBeforeUpdate(t,n)}function Fi(e,t){var n=t.memoizedProps,r=t.memoizedState;t=e.stateNode,e.type.defaultProps||"ref"in e.memoizedProps||op||(t.props,e.memoizedProps,t.state,e.memoizedState);try{var i=T(e,Oi,t,xr(e.type,n,(e.elementType,e.type)),r);n=wp,void 0!==i||n.has(e.type)||(n.add(e.type),T(e,function(){})),t.__reactInternalSnapshotBeforeUpdate=i}catch(a){us(e,e.return,a)}}function ki(e,t,n){n.props=xr(e.type,e.memoizedProps),n.state=e.memoizedState,Ci(e)?(Je(),T(e,Fh,e,t,n),Ze()):T(e,Fh,e,t,n)}function zi(e){var t=e.ref;if(null!==t){var n=e.stateNode;switch(e.tag){case 26:case 27:case 5:n=Lo(n)}if("function"==typeof t)if(Ci(e))try{Je(),e.refCleanup=t(n)}finally{Ze()}else e.refCleanup=t(n);else"string"==typeof t||t.hasOwnProperty("current"),t.current=n}}function Bi(e,t){try{T(e,zi,e)}catch(n){us(e,t,n)}}function Vi(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{if(Ci(e))try{Je(),T(e,r)}finally{Ze()}else T(e,r)}catch(i){us(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{if(Ci(e))try{Je(),T(e,n,null)}finally{Ze()}else T(e,n,null)}catch(a){us(e,t,a)}else n.current=null}function Hi(e,t,n,r){var i=e.memoizedProps,a=i.id,s=i.onCommit;i=i.onRender,t=null===t?"mount":"update",Vu&&(t="nested-update"),"function"==typeof i&&i(a,t,e.actualDuration,e.treeBaseDuration,e.actualStartTime,n),"function"==typeof s&&s(e.memoizedProps.id,t,r,n)}function ji(e,t,n,r){var i=e.memoizedProps;e=i.id,i=i.onPostCommit,t=null===t?"mount":"update",Vu&&(t="nested-update"),"function"==typeof i&&i(e,t,r,n)}function Gi(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{T(e,El,r,t,n,e)}catch(i){us(e,e.return,i)}}function Wi(e,t,n){try{T(e,Al,e.stateNode,e.type,n,t,e)}catch(r){us(e,e.return,r)}}function Xi(e){return 5===e.tag||3===e.tag||!!yc&&26===e.tag||!!Dc&&27===e.tag||4===e.tag}function qi(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Xi(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&(!Dc||27!==e.tag)&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Yi(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?Rl(n,e,t):wl(n,e);else if(!(4===r||Dc&&27===r)&&null!==(e=e.child))for(Yi(e,t,n),e=e.sibling;null!==e;)Yi(e,t,n),e=e.sibling}function Zi(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?Cl(n,e,t):Ml(n,e);else if(!(4===r||Dc&&27===r)&&null!==(e=e.child))for(Zi(e,t,n),e=e.sibling;null!==e;)Zi(e,t,n),e=e.sibling}function Ji(e){if(Yo&&(!Dc||27!==e.tag)){e:{for(var t=e.return;null!==t;){if(Xi(t)){var n=t;break e}t=t.return}throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.")}switch(n.tag){case 27:if(Dc){t=n.stateNode,Zi(e,n=qi(e),t);break}case 5:t=n.stateNode,32&n.flags&&(Dl(t),n.flags&=-33),Zi(e,n=qi(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,Yi(e,n=qi(e),t);break;default:throw Error("Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}}}function $i(e,t,n){e=e.containerInfo;try{T(t,Hl,e,n)}catch(r){us(t,t.return,r)}}function Ki(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:la(e,n),4&r&&Ri(n,cd|od);break;case 1:if(la(e,n),4&r)if(e=n.stateNode,null===t)n.type.defaultProps||"ref"in n.memoizedProps||op||(e.props,n.memoizedProps,e.state,n.memoizedState),Ci(n)?(Je(),T(n,Ih,n,e),Ze()):T(n,Ih,n,e);else{var i=xr(n.type,t.memoizedProps);t=t.memoizedState,n.type.defaultProps||"ref"in n.memoizedProps||op||(e.props,n.memoizedProps,e.state,n.memoizedState),Ci(n)?(Je(),T(n,Nh,n,e,i,t,e.__reactInternalSnapshotBeforeUpdate),Ze()):T(n,Nh,n,e,i,t,e.__reactInternalSnapshotBeforeUpdate)}64&r&&Ui(n),512&r&&Bi(n,n.return);break;case 3:if(t=je(),la(e,n),64&r&&null!==(r=n.updateQueue)){if(i=null,null!==n.child)switch(n.child.tag){case 27:case 5:i=Lo(n.child.stateNode);break;case 1:i=n.child.stateNode}try{T(n,yt,r,i)}catch(o){us(n,n.return,o)}}e.effectDuration+=Ge(t);break;case 26:if(yc){la(e,n),512&r&&Bi(n,n.return);break}case 27:case 5:la(e,n),null===t&&4&r&&Gi(n),512&r&&Bi(n,n.return);break;case 12:if(4&r){r=je(),la(e,n),(e=n.stateNode).effectDuration+=We(r);try{T(n,Hi,n,t,ku,e.effectDuration)}catch(o){us(n,n.return,o)}}else la(e,n);break;case 13:la(e,n),4&r&&na(e,n);break;case 22:if(!(i=null!==n.memoizedState||Tp)){t=null!==t&&null!==t.memoizedState||Ep;var a=Tp,s=Ep;Tp=i,(Ep=t)&&!s?da(e,n,!!(8772&n.subtreeFlags)):la(e,n),Tp=a,Ep=s}512&r&&("manual"===n.memoizedProps.mode?Bi(n,n.return):Vi(n,n.return));break;default:la(e,n)}}function Qi(e){var t=e.alternate;null!==t&&(e.alternate=null,Qi(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&rl(t),e.stateNode=null,e._debugOwner=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ea(e,t,n){for(n=n.child;null!==n;)ta(e,t,n),n=n.sibling}function ta(e,t,n){if(au&&"function"==typeof au.onCommitFiberUnmount)try{au.onCommitFiberUnmount(iu,n)}catch(a){ou||(ou=!0)}switch(n.tag){case 26:if(yc){Ep||Vi(n,t),ea(e,t,n),n.memoizedState?Mc(n.memoizedState):n.stateNode&&Ec(n.stateNode);break}case 27:if(Dc){Ep||Vi(n,t);var r=Np,i=Lp;Np=n.stateNode,ea(e,t,n),Oc(n.stateNode),Np=r,Lp=i;break}case 5:Ep||Vi(n,t);case 6:if(Yo){if(r=Np,i=Lp,Np=null,ea(e,t,n),Lp=i,null!==(Np=r))if(Lp)try{T(n,Il,Np,n.stateNode)}catch(s){us(n,t,s)}else try{T(n,Pl,Np,n.stateNode)}catch(s){us(n,t,s)}}else ea(e,t,n);break;case 18:Yo&&null!==Np&&(Lp?hc(Np,n.stateNode):uc(Np,n.stateNode));break;case 4:Yo?(r=Np,i=Lp,Np=n.stateNode.containerInfo,Lp=!0,ea(e,t,n),Np=r,Lp=i):(Zo&&$i(n.stateNode,n,zl()),ea(e,t,n));break;case 0:case 11:case 14:case 15:Ep||Di(ld,n,t),Ep||Pi(n,t,cd),ea(e,t,n);break;case 1:Ep||(Vi(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&ki(n,t,r)),ea(e,t,n);break;case 21:ea(e,t,n);break;case 22:Ep||Vi(n,t),Ep=(r=Ep)||null!==n.memoizedState,ea(e,t,n),Ep=r;break;default:ea(e,t,n)}}function na(e,t){if(Jo&&null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{T(t,cc,e)}catch(n){us(t,t.return,n)}}function ra(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Cp),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Cp),t;default:throw Error("Unexpected Suspense handler tag ("+e.tag+"). This is a bug in React.")}}(e);t.forEach(function(t){var r=ms.bind(null,e,t);if(!n.has(t)){if(n.add(t),lu){if(null===Pp||null===Ip)throw Error("Expected finished root and lanes to be set. This is a bug in React.");xs(Ip,Pp)}t.then(r,r)}})}function ia(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=e,a=t,s=n[r];if(Yo){var o=a;e:for(;null!==o;){switch(o.tag){case 27:case 5:Np=o.stateNode,Lp=!1;break e;case 3:case 4:Np=o.stateNode.containerInfo,Lp=!0;break e}o=o.return}if(null===Np)throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");ta(i,a,s),Np=null,Lp=!1}else ta(i,a,s);null!==(a=(i=s).alternate)&&(a.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)aa(t,e),t=t.sibling}function aa(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ia(t,e),sa(e),4&r&&(Di(ld|od,e,e.return),Ii(ld|od,e),Pi(e,e.return,cd|od));break;case 1:ia(t,e),sa(e),512&r&&(Ep||null===n||Vi(n,n.return)),64&r&&Tp&&null!==(e=e.updateQueue)&&null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r));break;case 26:if(yc){var i=Up;ia(t,e),sa(e),512&r&&(Ep||null===n||Vi(n,n.return)),4&r&&(r=null!==n?n.memoizedState:null,t=e.memoizedState,null===n?null===t?null===e.stateNode?e.stateNode=wc(i,e.type,e.memoizedProps,e):Tc(i,e.type,e.stateNode):e.stateNode=Sc(i,t,e.memoizedProps):r!==t?(null===r?null!==n.stateNode&&Ec(n.stateNode):Mc(r),null===t?Tc(i,e.type,e.stateNode):Sc(i,t,e.memoizedProps)):null===t&&null!==e.stateNode&&Wi(e,e.memoizedProps,n.memoizedProps));break}case 27:if(Dc&&4&r&&null===e.alternate){i=e.stateNode;var a=e.memoizedProps;try{Lc(i),T(e,Uc,e.type,a,i,e)}catch(u){us(e,e.return,u)}}case 5:if(ia(t,e),sa(e),512&r&&(Ep||null===n||Vi(n,n.return)),Yo){if(32&e.flags){t=e.stateNode;try{T(e,Dl,t)}catch(u){us(e,e.return,u)}}4&r&&null!=e.stateNode&&Wi(e,t=e.memoizedProps,null!==n?n.memoizedProps:t),1024&r&&(Ap=!0,e.type)}break;case 6:if(ia(t,e),sa(e),4&r&&Yo){if(null===e.stateNode)throw Error("This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");r=e.memoizedProps,n=null!==n?n.memoizedProps:r,t=e.stateNode;try{T(e,Tl,t,n,r)}catch(u){us(e,e.return,u)}}break;case 3:if(i=je(),yc?(Cc(),a=Up,Up=xc(t.containerInfo),ia(t,e),Up=a):ia(t,e),sa(e),4&r){if(Yo&&Jo&&null!==n&&n.memoizedState.isDehydrated)try{T(e,lc,t.containerInfo)}catch(u){us(e,e.return,u)}if(Zo){r=t.containerInfo,n=t.pendingChildren;try{T(e,Hl,r,n)}catch(u){us(e,e.return,u)}}}Ap&&(Ap=!1,oa(e)),t.effectDuration+=Ge(i);break;case 4:yc?(n=Up,Up=xc(e.stateNode.containerInfo),ia(t,e),sa(e),Up=n):(ia(t,e),sa(e)),4&r&&Zo&&$i(e.stateNode,e,e.stateNode.pendingChildren);break;case 12:r=je(),ia(t,e),sa(e),e.stateNode.effectDuration+=We(r);break;case 13:ia(t,e),sa(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Df=$c()),4&r&&null!==(r=e.updateQueue)&&(e.updateQueue=null,ra(e,r));break;case 22:512&r&&(Ep||null===n||Vi(n,n.return)),i=null!==e.memoizedState;var s=null!==n&&null!==n.memoizedState,o=Tp,l=Ep;if(Tp=o||i,Ep=l||s,ia(t,e),Ep=l,Tp=o,sa(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&r&&(t._visibility=i?-2&t._visibility:1|t._visibility,i&&(t=Tp||Ep,null===n||s||t||ua(e)),Yo&&(null===e.memoizedProps||"manual"!==e.memoizedProps.mode)))e:if(n=null,Yo)for(t=e;;){if(5===t.tag||yc&&26===t.tag||Dc&&27===t.tag){if(null===n){s=n=t;try{a=s.stateNode,i?T(s,Nl,a):T(s,Ul,s.stateNode,s.memoizedProps)}catch(u){us(s,s.return,u)}}}else if(6===t.tag){if(null===n){s=t;try{var c=s.stateNode;i?T(s,Ll,c):T(s,Ol,c,s.memoizedProps)}catch(u){us(s,s.return,u)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&null!==(r=e.updateQueue)&&null!==(n=r.retryQueue)&&(r.retryQueue=null,ra(e,n));break;case 19:ia(t,e),sa(e),4&r&&null!==(r=e.updateQueue)&&(e.updateQueue=null,ra(e,r));break;case 21:break;default:ia(t,e),sa(e)}}function sa(e){var t=e.flags;if(2&t){try{T(e,Ji,e)}catch(n){us(e,e.return,n)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function oa(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;oa(t),5===t.tag&&1024&t.flags&&hl(t.stateNode),e=e.sibling}}function la(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ki(e,t.alternate,t),t=t.sibling}function ca(e){switch(e.tag){case 0:case 11:case 14:case 15:Pi(e,e.return,cd),ua(e);break;case 1:Vi(e,e.return);var t=e.stateNode;"function"==typeof t.componentWillUnmount&&ki(e,e.return,t),ua(e);break;case 26:case 27:case 5:Vi(e,e.return),ua(e);break;case 22:Vi(e,e.return),null===e.memoizedState&&ua(e);break;default:ua(e)}}function ua(e){for(e=e.child;null!==e;)ca(e),e=e.sibling}function ha(e,t,n,r){var i=n.flags;switch(n.tag){case 0:case 11:case 15:da(e,n,r),Ri(n,cd);break;case 1:if(da(e,n,r),"function"==typeof(t=n.stateNode).componentDidMount&&T(n,Ih,n,t),null!==(t=n.updateQueue)){e=n.stateNode;try{T(n,vt,t,e)}catch(a){us(n,n.return,a)}}r&&64&i&&Ui(n),Bi(n,n.return);break;case 26:case 27:case 5:da(e,n,r),r&&null===t&&4&i&&Gi(n),Bi(n,n.return);break;case 12:if(r&&4&i){i=je(),da(e,n,r),(r=n.stateNode).effectDuration+=We(i);try{T(n,Hi,n,t,ku,r.effectDuration)}catch(a){us(n,n.return,a)}}else da(e,n,r);break;case 13:da(e,n,r),r&&4&i&&na(e,n);break;case 22:null===n.memoizedState&&da(e,n,r),Bi(n,n.return);break;default:da(e,n,r)}}function da(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;)ha(e,t.alternate,t,n),t=t.sibling}function pa(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&ci(e),null!=n&&ui(n))}function fa(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(ci(t),null!=e&&ui(e))}function ma(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ga(e,t,n,r),t=t.sibling}function ga(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:ma(e,t,n,r),2048&i&&Ni(t,ud|od);break;case 3:var a=je();ma(e,t,n,r),2048&i&&(n=null,null!==t.alternate&&(n=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==n&&(ci(t),null!=n&&ui(n))),e.passiveEffectDuration+=Ge(a);break;case 12:if(2048&i){a=je(),ma(e,t,n,r),(e=t.stateNode).passiveEffectDuration+=We(a);try{T(t,ji,t,t.alternate,ku,e.passiveEffectDuration)}catch(s){us(t,t.return,s)}}else ma(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,null!==t.memoizedState?4&a._visibility?ma(e,t,n,r):_a(e,t):4&a._visibility?ma(e,t,n,r):(a._visibility|=4,va(e,t,n,r,!!(10256&t.subtreeFlags))),2048&i&&pa(t.alternate,t);break;case 24:ma(e,t,n,r),2048&i&&fa(t.alternate,t);break;default:ma(e,t,n,r)}}function va(e,t,n,r,i){for(i=i&&!!(10256&t.subtreeFlags),t=t.child;null!==t;)ya(e,t,n,r,i),t=t.sibling}function ya(e,t,n,r,i){var a=t.flags;switch(t.tag){case 0:case 11:case 15:va(e,t,n,r,i),Ni(t,ud);break;case 23:break;case 22:var s=t.stateNode;null!==t.memoizedState?4&s._visibility?va(e,t,n,r,i):_a(e,t):(s._visibility|=4,va(e,t,n,r,i)),i&&2048&a&&pa(t.alternate,t);break;case 24:va(e,t,n,r,i),i&&2048&a&&fa(t.alternate,t);break;default:va(e,t,n,r,i)}}function _a(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:_a(n,r),2048&i&&pa(r.alternate,r);break;case 24:_a(n,r),2048&i&&fa(r.alternate,r);break;default:_a(n,r)}t=t.sibling}}function xa(e){if(e.subtreeFlags&Op)for(e=e.child;null!==e;)ba(e),e=e.sibling}function ba(e){switch(e.tag){case 26:xa(e),e.flags&Op&&(null!==e.memoizedState?Ic(Up,e.memoizedState,e.memoizedProps):ol(e.type,e.memoizedProps));break;case 5:xa(e),e.flags&Op&&ol(e.type,e.memoizedProps);break;case 3:case 4:if(yc){var t=Up;Up=xc(e.stateNode.containerInfo),xa(e),Up=t}else xa(e);break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Op,Op=16777216,xa(e),Op=t):xa(e));break;default:xa(e)}}function Sa(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Ma(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Rp=r,Aa(r,e)}Sa(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)wa(e),e=e.sibling}function wa(e){switch(e.tag){case 0:case 11:case 15:Ma(e),2048&e.flags&&Li(e,e.return,ud|od);break;case 3:var t=je();Ma(e),e.stateNode.passiveEffectDuration+=Ge(t);break;case 12:t=je(),Ma(e),e.stateNode.passiveEffectDuration+=We(t);break;case 22:t=e.stateNode,null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Ta(e)):Ma(e);break;default:Ma(e)}}function Ta(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Rp=r,Aa(r,e)}Sa(e)}for(e=e.child;null!==e;)Ea(e),e=e.sibling}function Ea(e){switch(e.tag){case 0:case 11:case 15:Li(e,e.return,ud),Ta(e);break;case 22:var t=e.stateNode;4&t._visibility&&(t._visibility&=-5,Ta(e));break;default:Ta(e)}}function Aa(e,t){for(;null!==Rp;){var n=Rp,r=n;switch(r.tag){case 0:case 11:case 15:Li(r,t,ud);break;case 23:case 22:null!==r.memoizedState&&null!==r.memoizedState.cachePool&&null!=(r=r.memoizedState.cachePool.pool)&&ci(r);break;case 24:ui(r.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Rp=r;else e:for(n=e;null!==Rp;){var i=(r=Rp).sibling,a=r.return;if(Qi(r),r===n){Rp=null;break e}if(null!==i){i.return=a,Rp=i;break e}Rp=a}}}function Ca(e){var t=$o(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error("Invalid host root specified. Should be either a React container or a node with a testname attribute.");return t}if(null===(e=gl(e)))throw Error("Could not find React container within specified host subtree.");return e.stateNode.current}function Ra(e,t){var n=e.tag;switch(t.$$typeof){case kp:if(e.type===t.value)return!0;break;case zp:e:{for(t=t.value,e=[e,0],n=0;n<e.length;){var r=e[n++],i=r.tag,a=e[n++],s=t[a];if(5!==i&&26!==i&&27!==i||!_l(r)){for(;null!=s&&Ra(r,s);)s=t[++a];if(a===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,a),r=r.sibling}}t=!1}return t;case Bp:if((5===n||26===n||27===n)&&xl(e.stateNode,t.value))return!0;break;case Hp:if((5===n||6===n||26===n||27===n)&&null!==(e=yl(e))&&0<=e.indexOf(t.value))return!0;break;case Vp:if((5===n||26===n||27===n)&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error("Invalid selector type specified.")}return!1}function Pa(e){switch(e.$$typeof){case kp:return"<"+(v(e.value)||"Unknown")+">";case zp:return":has("+(Pa(e)||"")+")";case Bp:return'[role="'+e.value+'"]';case Hp:return'"'+e.value+'"';case Vp:return'[data-testname="'+e.value+'"]';default:throw Error("Invalid selector type specified.")}}function Ia(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var i=e[r++],a=i.tag,s=e[r++],o=t[s];if(5!==a&&26!==a&&27!==a||!_l(i)){for(;null!=o&&Ra(i,o);)o=t[++s];if(s===t.length)n.push(i);else for(i=i.child;null!==i;)e.push(i,s),i=i.sibling}}return n}function Da(e,t){if(!ml)throw Error("Test selector API is not supported by this renderer.");e=Ia(e=Ca(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++],i=r.tag;if(5===i||26===i||27===i)_l(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}function Na(){var e="undefined"!=typeof IS_REACT_ACT_ENVIRONMENT?IS_REACT_ACT_ENVIRONMENT:void 0;return e||So.actQueue,e}function La(e){if((rf&qp)!==Xp&&0!==of)return of&-of;var t=So.T;return null!==t?(t._updatedFibers||(t._updatedFibers=new Set),t._updatedFibers.add(e),0!==(e=Qu)?e:st()):tl()}function Ua(){0===Af&&(Af=536870912&of&&!Au?536870912:B());var e=td.current;return null!==e&&(e.flags|=32),Af}function Oa(e,t,n){if(Xf&&(qf=!0),(e===af&&vf===uf||null!==e.cancelPendingCommit)&&(Ga(e,0),Va(e,of,Af,!1)),j(e,n),0!==(rf&qp)&&e===af){if(Ro)switch(t.tag){case 0:case 11:case 15:e=sf&&y(sf)||"Unknown",nm.has(e)||(nm.add(e),t=y(t)||"Unknown");break;case 1:tm||(tm=!0)}}else lu&&X(e,t,n),function(e){Na()&&null===So.actQueue&&T(e,function(){})}(t),e===af&&((rf&qp)===Xp&&(Tf|=n),Mf===ef&&Va(e,of,Af,!1)),Ke(e)}function Fa(e,t,n){if((rf&(qp|Yp))!==Xp)throw Error("Should not already be working.");for(var r=!n&&!(60&t)&&0===(t&e.expiredLanes)||k(e,t),i=r?function(e,t){var n=rf;rf|=qp;var r=qa(),i=Ya();if(af!==e||of!==t){if(lu){var a=e.memoizedUpdaters;0<a.size&&(xs(e,of),a.clear()),q(e,t)}Of=null,Lf=$c()+Uf,Ga(e,t)}else xf=k(e,t);ee(t);e:for(;;)try{if(vf!==lf&&null!==sf)t:switch(t=sf,a=yf,vf){case cf:vf=lf,yf=null,ns(e,t,a,cf);break;case uf:if(xt(a)){vf=lf,yf=null,es(t);break}t=function(){vf===uf&&af===e&&(vf=mf),Ke(e)},a.then(t,t);break e;case hf:vf=mf;break e;case df:vf=pf;break e;case mf:xt(a)?(vf=lf,yf=null,es(t)):(vf=lf,yf=null,ns(e,t,a,mf));break;case pf:var s=null;switch(sf.tag){case 26:s=sf.memoizedState;case 5:case 27:var o=sf,l=o.type,c=o.pendingProps;if(s?Pc(s):al(l,c)){vf=lf,yf=null;var u=o.sibling;if(null!==u)sf=u;else{var h=o.return;null!==h?(sf=h,rs(h)):sf=null}break t}}vf=lf,yf=null,ns(e,t,a,pf);break;case ff:vf=lf,yf=null,ns(e,t,a,ff);break;case gf:ja(),Mf=nf;break e;default:throw Error("Unexpected SuspendedReason. This is a bug in React.")}null!==So.actQueue?$a():Ka();break}catch(d){Wa(e,d)}return $r(),So.H=r,So.A=i,rf=n,null!==sf?(null!==su&&"function"==typeof su.markRenderYielded&&su.markRenderYielded(),Zp):(te(),af=null,of=0,Fe(),Mf)}(e,t):Ja(e,t,!0),a=r;;){if(i===Zp){xf&&!r&&Va(e,t,0,!1);break}if(i===nf)Va(e,t,0,!_f);else{if(n=e.current.alternate,a&&!Ba(n)){i=Ja(e,t,!1),a=!1;continue}if(i===Kp){if(a=t,e.errorRecoveryDisabledLanes&a)var s=0;else s=0!=(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{i=e;var o=s;s=Rf;var l=Jo&&i.current.memoizedState.isDehydrated;if(l&&(Ga(i,o).flags|=256),(o=Ja(i,o,!1))!==Kp){if(bf&&!l){i.errorRecoveryDisabledLanes|=a,Tf|=a,i=ef;break e}i=Pf,Pf=s,null!==i&&ka(i)}i=o}if(a=!1,i!==Kp)continue}}if(i===$p){Ga(e,0),Va(e,t,0,!0);break}e:{switch(r=e,i){case Zp:case $p:throw Error("Root did not complete. This is a bug in React.");case ef:if((4194176&t)===t){Va(r,t,Af,!_f);break e}break;case Kp:Pf=null;break;case Qp:case tf:break;default:throw Error("Unknown root exit status.")}if(r.finishedWork=n,r.finishedLanes=t,null!==So.actQueue)as(r,Pf,Of,If,Af,Tf,Cf);else{if((62914560&t)===t&&10<(i=Df+Nf-$c())){if(Va(r,t,Af,!_f),0!==F(r,0))break e;r.timeoutHandle=Go(za.bind(null,r,n,Pf,Of,If,t,Af,Tf,Cf,_f,Qf,-0,0),i);break e}za(r,n,Pf,Of,If,t,Af,Tf,Cf,_f,$f,-0,0)}}}break}Ke(e)}function ka(e){null===Pf?Pf=e:Pf.push.apply(Pf,e)}function za(e,t,n,r,i,a,s,o,l,c,u,h,d){var p=t.subtreeFlags;if((8192&p||!(16785408&~p))&&(sl(),ba(t),null!==(t=ll())))return e.cancelPendingCommit=t(as.bind(null,e,n,r,i,s,o,l,Kf,h,d)),void Va(e,a,s,!c);as(e,n,r,i,s,o,l)}function Ba(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&null!==(n=t.updateQueue)&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!cu(a(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Va(e,t,n,r){t&=~Ef,t&=~Tf,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-Hc(i),s=1<<a;r[a]=-1,i&=~s}0!==n&&G(e,n,t)}function Ha(){return(rf&(qp|Yp))!==Xp||(Qe(0),!1)}function ja(){if(null!==sf){if(vf===lf)var e=sf.return;else e=sf,$r(),Qt(e),Gh=null,Wh=0,e=sf;for(;null!==e;)Ai(e.alternate,e),e=e.return;sf=null}}function Ga(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==Xo&&(e.timeoutHandle=Xo,Wo(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),ja(),af=e,sf=n=Cs(e.current,null),of=t,vf=lf,yf=null,_f=!1,xf=k(e,t),bf=!1,Mf=Zp,Cf=Af=Ef=Tf=wf=0,Pf=Rf=null,If=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-Hc(r),a=1<<i;t|=e[i],r&=~a}return Sf=t,Fe(),uh.discardPendingWarnings(),n}function Wa(e,t){gd=null,So.H=Dd,So.getCurrentStack=null,Ro=!1,Co=null,t===bh?(t=Mt(),vf=hf):t===Sh?(t=Mt(),vf=df):vf=t===tp?gf:null!==t&&"object"==typeof t&&"function"==typeof t.then?ff:cf,yf=t;var n=sf;if(null===n)Mf=$p,br(e,re(t,e.current));else switch(2&n.mode&&qe(n),Q(),vf){case cf:null!==su&&"function"==typeof su.markComponentErrored&&su.markComponentErrored(n,t,of);break;case uf:case hf:case ff:case mf:null!==su&&"function"==typeof su.markComponentSuspended&&su.markComponentSuspended(n,t,of)}}function Xa(){var e=td.current;return null===e||((4194176&of)===of?null===nd:!!((62914560&of)===of||536870912&of)&&e===nd)}function qa(){var e=So.H;return So.H=Dd,null===e?Dd:e}function Ya(){var e=So.A;return So.A=Fp,e}function Za(){Mf=ef,_f||(4194176&of)!==of&&null!==td.current||(xf=!0),!(134217727&wf)&&!(134217727&Tf)||null===af||Va(af,of,Af,!1)}function Ja(e,t,n){var r=rf;rf|=qp;var i=qa(),a=Ya();if(af!==e||of!==t){if(lu){var s=e.memoizedUpdaters;0<s.size&&(xs(e,of),s.clear()),q(e,t)}Of=null,Ga(e,t)}ee(t),t=!1,s=Mf;e:for(;;)try{if(vf!==lf&&null!==sf){var o=sf,l=yf;switch(vf){case gf:ja(),s=nf;break e;case hf:case uf:case ff:null===td.current&&(t=!0);var c=vf;if(vf=lf,yf=null,ns(e,o,l,c),n&&xf){s=Zp;break e}break;default:c=vf,vf=lf,yf=null,ns(e,o,l,c)}}$a(),s=Mf;break}catch(u){Wa(e,u)}return t&&e.shellSuspendCounter++,$r(),rf=r,So.H=i,So.A=a,te(),null===sf&&(af=null,of=0,Fe()),s}function $a(){for(;null!==sf;)Qa(sf)}function Ka(){for(;null!==sf&&!Zc();)Qa(sf)}function Qa(e){var t=e.alternate;(2&e.mode)!==Nu?(Xe(e),t=T(e,Jr,t,e,Sf),qe(e)):t=T(e,Jr,t,e,Sf),e.memoizedProps=e.pendingProps,null===t?rs(e):sf=t}function es(e){var t=T(e,ts,e);e.memoizedProps=e.pendingProps,null===t?rs(e):sf=t}function ts(e){var t=e.alternate,n=(2&e.mode)!==Nu;switch(n&&Xe(e),e.tag){case 15:case 0:t=Lr(t,e,e.pendingProps,e.type,void 0,of);break;case 11:t=Lr(t,e,e.pendingProps,e.type.render,e.ref,of);break;case 5:Qt(e);default:Ai(t,e),t=Jr(t,e=sf=Rs(e,Sf),Sf)}return n&&qe(e),t}function ns(e,t,n,r){$r(),Qt(t),Gh=null,Wh=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,lu&&xs(e,i),null!==r&&"object"==typeof r&&"function"==typeof r.then){if(null!==(t=n.alternate)&&ni(t,n,i,!0),Au&&(Cu=!0),null!==(n=td.current)){switch(n.tag){case 13:return null===nd?Za():null===n.alternate&&Mf===Zp&&(Mf=Qp),n.flags&=-257,n.flags|=65536,n.lanes=i,r===Mh?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),hs(e,r,i)),!1;case 22:return n.flags|=65536,r===Mh?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),hs(e,r,i)),!1}throw Error("Unexpected Suspense handler tag ("+n.tag+"). This is a bug in React.")}return hs(e,r,i),Za(),!1}if(Au)return Cu=!0,null!==(t=td.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==Du&&Ue(re(Error("There was an error while hydrating but React was able to recover by instead client rendering from the nearest Suspense boundary.",{cause:r}),n))):(r!==Du&&Ue(re(Error("There was an error while hydrating but React was able to recover by instead client rendering the entire root.",{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=re(r,n),pt(e,i=Mr(e.stateNode,r,i)),Mf!==ef&&(Mf=Kp)),!1;var a=re(Error("There was an error during concurrent rendering but React was able to recover by instead synchronously rendering the entire root.",{cause:r}),n);if(null===Rf?Rf=[a]:Rf.push(a),Mf!==ef&&(Mf=Kp),null===t)return!0;r=re(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,pt(n,e=Mr(n.stateNode,r,e)),!1;case 1:if(t=n.type,a=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===a||"function"!=typeof a.componentDidCatch||null!==Ff&&Ff.has(a))))return n.flags|=65536,i&=-i,n.lanes|=i,Tr(i=wr(i),e,n,r),pt(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,of))return Mf=$p,br(e,re(n,e.current)),void(sf=null)}catch(a){if(null!==i)throw sf=i,a;return Mf=$p,br(e,re(n,e.current)),void(sf=null)}32768&t.flags?(Au||r===cf?e=!0:xf||536870912&of?e=!1:(_f=e=!0,(r===uf||r===hf||r===ff)&&null!==(r=td.current)&&13===r.tag&&(r.flags|=16384)),is(t,e)):rs(t)}function rs(e){var t=e;do{if(32768&t.flags)return void is(t,_f);var n=t.alternate;if(e=t.return,Xe(t),n=T(t,Ti,n,t,Sf),(2&t.mode)!==Nu&&Ye(t),null!==n)return void(sf=n);if(null!==(t=t.sibling))return void(sf=t);sf=t=e}while(null!==t);Mf===Zp&&(Mf=tf)}function is(e,t){do{var n=Ei(e.alternate,e);if(null!==n)return n.flags&=32767,void(sf=n);if((2&e.mode)!==Nu){Ye(e),n=e.actualDuration;for(var r=e.child;null!==r;)n+=r.actualDuration,r=r.sibling;e.actualDuration=n}if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(sf=e);sf=e=n}while(null!==e);Mf=nf,sf=null}function as(e,t,n,r,i,a,s,o,l,c){var u=So.T,h=el();try{Qo(2),So.T=null,function(e,t,n,r,i,a,s,o){do{ls()}while(null!==zf);if(uh.flushLegacyContextWarning(),uh.flushPendingUnsafeLifecycleWarnings(),(rf&(qp|Yp))!==Xp)throw Error("Should not already be working.");var l=e.finishedWork;if(r=e.finishedLanes,null!==su&&"function"==typeof su.markCommitStarted&&su.markCommitStarted(r),null===l)return $(),null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error("Cannot commit the same tree as before. This error is likely caused by a bug in React. Please file an issue.");e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var c,u,h,d=l.lanes|l.childLanes;if(function(e,t,n,r,i,a){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-Hc(n),h=1<<u;o[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var p=d[u];null!==p&&(p.lane&=-536870913)}n&=~h}0!==r&&G(e,r,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(s&~t))}(e,r,d|=Ou,a,s,o),e===af&&(sf=af=null,of=0),!(10256&l.subtreeFlags)&&!(10256&l.flags)||kf||(kf=!0,Vf=d,Hf=n,c=eu,u=function(){return ls(),null},null!==(h=So.actQueue)?h.push(u):qc(c,u)),ku=Fu(),n=!!(15990&l.flags),15990&l.subtreeFlags||n?(n=So.T,So.T=null,a=el(),Qo(2),s=rf,rf|=Yp,function(e,t){for(Fo(e.containerInfo),Rp=t;null!==Rp;)if(t=(e=Rp).child,1028&e.subtreeFlags&&null!==t)t.return=e,Rp=t;else for(;null!==Rp;){var n=(t=e=Rp).alternate,r=t.flags;switch(t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:1024&r&&null!==n&&Fi(t,n);break;case 3:1024&r&&Yo&&Fl(t.stateNode.containerInfo);break;default:if(1024&r)throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}if(null!==(t=e.sibling)){t.return=e.return,Rp=t;break}Rp=e.return}e=Dp,Dp=!1}(e,l),function(e,t,n){Pp=n,Ip=e,aa(t,e),Ip=Pp=null}(e,l,r),ko(e.containerInfo),e.current=l,null!==su&&"function"==typeof su.markLayoutEffectsStarted&&su.markLayoutEffectsStarted(r),function(e,t,n){Pp=n,Ip=t,Ki(t,e.alternate,e),Ip=Pp=null}(l,e,r),null!==su&&"function"==typeof su.markLayoutEffectsStopped&&su.markLayoutEffectsStopped(),Jc(),rf=s,Qo(a),So.T=n):e.current=l,(n=kf)?(kf=!1,zf=e,Bf=r):(os(e,d),Zf=0,Jf=null),0===(d=e.pendingLanes)&&(Ff=null),n||ys(e),function(e,t){if(au&&"function"==typeof au.onCommitFiberRoot)try{var n=!(128&~e.current.flags);switch(t){case 2:var r=Kc;break;case 8:r=Qc;break;case 32:default:r=eu;break;case 268435456:r=tu}au.onCommitFiberRoot(iu,e,r,n)}catch(i){ou||(ou=!0)}}(l.stateNode,i),lu&&e.memoizedUpdaters.clear(),ml&&Gp.forEach(function(e){return e()}),Ke(e),null!==t)for(i=e.onRecoverableError,l=0;l<t.length;l++)d=t[l],n=ss(d.stack),T(d.source,i,d.value,n);!!(3&Bf)&&ls(),d=e.pendingLanes,4194218&r&&42&d?(Hu=!0,e===Wf?Gf++:(Gf=0,Wf=e)):Gf=0,Qe(0),$()}(e,t,n,r,h,i,a,s)}finally{So.T=u,Qo(h)}}function ss(e){return e={componentStack:e},Object.defineProperty(e,"digest",{get:function(){}}),e}function os(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,ui(t))}function ls(){if(null!==zf){var e=zf,t=Vf;Vf=0;var n=Y(Bf),r=32>n?32:n;n=So.T;var i=el();try{if(Qo(r),So.T=null,null===zf)var a=!1;else{r=Hf,Hf=null;var s=zf,o=Bf;if(zf=null,Bf=0,(rf&(qp|Yp))!==Xp)throw Error("Cannot flush passive effects while already rendering.");Xf=!0,qf=!1,null!==su&&"function"==typeof su.markPassiveEffectsStarted&&su.markPassiveEffectsStarted(o);var l=rf;if(rf|=Yp,wa(s.current),ga(s,s.current,o,r),null!==su&&"function"==typeof su.markPassiveEffectsStopped&&su.markPassiveEffectsStopped(),ys(s),rf=l,Qe(0),qf?s===Jf?Zf++:(Zf=0,Jf=s):Zf=0,qf=Xf=!1,au&&"function"==typeof au.onPostCommitFiberRoot)try{au.onPostCommitFiberRoot(iu,s)}catch(u){ou||(ou=!0)}var c=s.current.stateNode;c.effectDuration=0,c.passiveEffectDuration=0,a=!0}return a}finally{Qo(i),So.T=n,os(e,t)}}return!1}function cs(e,t,n){t=re(n,t),null!==(e=ht(e,t=Mr(e.stateNode,t,2),2))&&(j(e,2),Ke(e))}function us(e,t,n){if(3===e.tag)cs(e,e,n);else for(;null!==t;){if(3===t.tag)return void cs(t,e,n);if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Ff||!Ff.has(r)))return e=re(n,e),void(null!==(r=ht(t,n=wr(2),2))&&(Tr(n,r,t,e),j(r,2),Ke(r)))}t=t.return}}function hs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Wp;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(bf=!0,i.add(n),r=ds.bind(null,e,t,n),lu&&xs(e,n),t.then(r,r))}function ds(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Na()&&So.actQueue,af===e&&(of&n)===n&&(Mf===ef||Mf===Qp&&(62914560&of)===of&&$c()-Df<Nf?(rf&qp)===Xp&&Ga(e,0):Ef|=n,Cf===of&&(Cf=0)),Ke(e)}function ps(e,t){0===t&&(t=V()),null!==(e=Be(e,t))&&(j(e,t),Ke(e))}function fs(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ps(e,n)}function ms(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error("Pinged unknown suspense boundary type. This is probably a bug in React.")}null!==r&&r.delete(t),ps(e,n)}function gs(e,t,n){if(33562624&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,i=t,a=i.type===oo;a=n||a,22!==i.tag?33554432&i.flags?a&&T(i,vs,r,i,(64&i.mode)===Nu):gs(r,i,a):null===i.memoizedState&&(a&&8192&i.flags?T(i,vs,r,i):33554432&i.subtreeFlags&&T(i,gs,r,i,a)),t=t.sibling}}function vs(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];Z(!0);try{ca(t),n&&Ea(t),ha(e,t.alternate,t,!1),n&&ya(e,t,0,null,!1)}finally{Z(!1)}}function ys(e){var t=!0;24&e.current.mode||(t=!1),gs(e,e.current,t)}function _s(e){if((rf&qp)===Xp){var t=e.tag;if(3===t||1===t||0===t||11===t||14===t||15===t){if(t=y(e)||"ReactComponent",null!==em){if(em.has(t))return;em.add(t)}else em=new Set([t]);T(e,function(){})}}}function xs(e,t){lu&&e.memoizedUpdaters.forEach(function(n){X(e,n,t)})}function bs(e){if(null===rm)return e;var t=rm(e);return void 0===t?e:t.current}function Ss(e){if(null===rm)return e;var t=rm(e);return void 0===t?null!=e&&"function"==typeof e.render&&(t=bs(e.render),e.render!==t)?(t={$$typeof:po,render:t},void 0!==e.displayName&&(t.displayName=e.displayName),t):e:t.current}function Ms(e,t){if(null===rm)return!1;var n=e.elementType,r=!1,i="object"==typeof(t=t.type)&&null!==t?t.$$typeof:null;switch(e.tag){case 1:"function"==typeof t&&(r=!0);break;case 0:("function"==typeof t||i===vo)&&(r=!0);break;case 11:(i===po||i===vo)&&(r=!0);break;case 14:case 15:(i===go||i===vo)&&(r=!0);break;default:return!1}return!(!r||(e=rm(n),void 0===e||e!==rm(t)))}function ws(e){null!==rm&&"function"==typeof WeakSet&&(null===im&&(im=new WeakSet),im.add(e))}function Ts(e,t,n){var r=e.alternate,i=e.child,a=e.sibling,s=e.tag,o=e.type,l=null;switch(s){case 0:case 15:case 1:l=o;break;case 11:l=o.render}if(null===rm)throw Error("Expected resolveFamily to be set during hot reload.");var c=!1;o=!1,null!==l&&void 0!==(l=rm(l))&&(n.has(l)?o=!0:t.has(l)&&(1===s?o=!0:c=!0)),null!==im&&(im.has(e)||null!==r&&im.has(r))&&(o=!0),o&&(e._debugNeedsRemount=!0),(o||c)&&null!==(r=Be(e,2))&&Oa(r,e,2),null===i||o||Ts(i,t,n),null!==a&&Ts(a,t,n)}function Es(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null,this.actualDuration=-0,this.actualStartTime=-1.1,this.treeBaseDuration=this.selfBaseDuration=-0,this._debugOwner=this._debugInfo=null,this._debugNeedsRemount=!1,this._debugHookTypes=null,am||"function"!=typeof Object.preventExtensions||Object.preventExtensions(this)}function As(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Cs(e,t){var n=e.alternate;switch(null===n?((n=c(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n._debugOwner=e._debugOwner,n._debugHookTypes=e._debugHookTypes,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null,n.actualDuration=-0,n.actualStartTime=-1.1),n.flags=31457280&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext,_debugThenableState:t._debugThenableState},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n.selfBaseDuration=e.selfBaseDuration,n.treeBaseDuration=e.treeBaseDuration,n._debugInfo=e._debugInfo,n._debugNeedsRemount=e._debugNeedsRemount,n.tag){case 0:case 15:case 1:n.type=bs(e.type);break;case 11:n.type=Ss(e.type)}return n}function Rs(e,t){e.flags&=31457282;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null,e.selfBaseDuration=0,e.treeBaseDuration=0):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext,_debugThenableState:t._debugThenableState},e.selfBaseDuration=n.selfBaseDuration,e.treeBaseDuration=n.treeBaseDuration),e}function Ps(e,t,n,r,i,a){var s=0,o=e;if("function"==typeof e)As(e)&&(s=1),o=bs(o);else if("string"==typeof e)yc&&Dc?(s=ue(),s=_c(e,n,s)?26:Fc(e)?27:5):yc?(s=ue(),s=_c(e,n,s)?26:5):s=Dc&&Fc(e)?27:5;else e:switch(e){case so:return Ds(n.children,i,a,t);case oo:s=8,i|=24;break;case lo:return r=i,(e=n).id,(t=c(12,e,t,2|r)).elementType=lo,t.lanes=a,t.stateNode={effectDuration:0,passiveEffectDuration:0},t;case fo:return(t=c(13,n,t,i)).elementType=fo,t.lanes=a,t;case mo:return(t=c(19,n,t,i)).elementType=mo,t.lanes=a,t;case yo:return Ns(n,i,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case co:case ho:s=10;break e;case uo:s=9;break e;case po:s=11,o=Ss(o);break e;case go:s=14;break e;case vo:s=16,o=null;break e}o="",(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(o+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),null===e?n="null":Po(e)?n="array":void 0!==e&&e.$$typeof===io?(n="<"+(v(e.type)||"Unknown")+" />",o=" Did you accidentally export a JSX literal instead of a component?"):n=typeof e,(s=r?"number"==typeof r.tag?y(r):"string"==typeof r.name?r.name:null:null)&&(o+="\n\nCheck the render method of `"+s+"`."),s=29,n=Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: "+n+"."+o),o=null}return(t=c(s,n,t,i)).elementType=e,t.type=o,t.lanes=a,t._debugOwner=r,t}function Is(e,t,n){return(t=Ps(e.type,e.key,e.props,e._owner,t,n))._debugOwner=e._owner,t}function Ds(e,t,n,r){return(e=c(7,e,r,t)).lanes=n,e}function Ns(e,t,n,r){(e=c(22,e,r,t)).elementType=yo,e.lanes=n;var i={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=i,t=e._current;if(null===t)throw Error("Calling Offscreen.detach before instance handle has been set.");if(!(2&e._pendingVisibility)){var n=Be(t,2);null!==n&&(e._pendingVisibility|=2,Oa(n,t,2))}},attach:function(){var e=i,t=e._current;if(null===t)throw Error("Calling Offscreen.detach before instance handle has been set.");if(2&e._pendingVisibility){var n=Be(t,2);null!==n&&(e._pendingVisibility&=-3,Oa(n,t,2))}}};return e.stateNode=i,e}function Ls(e,t,n){return(e=c(6,e,null,t)).lanes=n,e}function Us(e,t,n){return(t=c(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Os(e,t,n,r,i,a,s,o){for(this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Xo,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=H(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H(0),this.hiddenUpdates=H(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map,this.passiveEffectDuration=this.effectDuration=-0,this.memoizedUpdaters=new Set,e=this.pendingUpdatersLaneMap=[],t=0;31>t;t++)e.push(new Set);this._debugRootType=n?"hydrateRoot()":"createRoot()"}function Fs(e,t,n,r,i,a,s,o,l,u,h,d){return e=new Os(e,t,n,s,o,l,u,d),t=1,!0===a&&(t|=24),lu&&(t|=2),a=c(3,null,null,t),e.current=a,a.stateNode=e,ci(t=li()),e.pooledCache=t,ci(t),a.memoizedState={element:r,isDehydrated:n,cache:t},lt(a),e}function ks(e){return""+e}function zs(e){return e?e=Vc:Vc}function Bs(e,t,n,r){return 0===t.tag&&ls(),Vs(t.current,2,e,t,n,r),2}function Vs(e,t,n,r,i,a){if(au&&"function"==typeof au.onScheduleFiberRoot)try{au.onScheduleFiberRoot(iu,r,n)}catch(s){ou||(ou=!0)}null!==su&&"function"==typeof su.markRenderScheduled&&su.markRenderScheduled(t),i=zs(i),null===r.context?r.context=i:r.pendingContext=i,Ro&&null!==Co&&!mm&&(mm=!0),(r=ut(t)).payload={element:n},null!==(a=void 0===a?null:a)&&(r.callback=a),null!==(n=ht(e,r,t))&&(Oa(n,e,t),dt(n,e,t))}function Hs(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function js(e,t){Hs(e,t),(e=e.alternate)&&Hs(e,t)}function Gs(){return Co}function Ws(){for(var e=new Map,t=1,n=0;31>n;n++){var r=U(t);e.set(t,r),t*=2}return e}var Xs,qs,Ys,Zs,Js,$s,Ks,Qs={},eo=r(),to=Jp(),no=Object.assign,ro=Symbol.for("react.element"),io=Symbol.for("react.transitional.element"),ao=Symbol.for("react.portal"),so=Symbol.for("react.fragment"),oo=Symbol.for("react.strict_mode"),lo=Symbol.for("react.profiler"),co=Symbol.for("react.provider"),uo=Symbol.for("react.consumer"),ho=Symbol.for("react.context"),po=Symbol.for("react.forward_ref"),fo=Symbol.for("react.suspense"),mo=Symbol.for("react.suspense_list"),go=Symbol.for("react.memo"),vo=Symbol.for("react.lazy"),yo=Symbol.for("react.offscreen"),_o=Symbol.for("react.memo_cache_sentinel"),xo=Symbol.iterator,bo=Symbol.for("react.client.reference"),So=eo.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Mo=0;_.__reactDisabledLog=!0;var wo,To,Eo=!1,Ao=new("function"==typeof WeakMap?WeakMap:Map),Co=null,Ro=!1,Po=Array.isArray,Io=e.rendererVersion,Do=e.rendererPackageName,No=e.extraDevToolsConfig,Lo=e.getPublicInstance,Uo=e.getRootHostContext,Oo=e.getChildHostContext,Fo=e.prepareForCommit,ko=e.resetAfterCommit,zo=e.createInstance,Bo=e.appendInitialChild,Vo=e.finalizeInitialChildren,Ho=e.shouldSetTextContent,jo=e.createTextInstance,Go=e.scheduleTimeout,Wo=e.cancelTimeout,Xo=e.noTimeout,qo=e.isPrimaryRenderer,Yo=e.supportsMutation,Zo=e.supportsPersistence,Jo=e.supportsHydration,$o=e.getInstanceFromNode,Ko=e.preparePortalMount,Qo=e.setCurrentUpdatePriority,el=e.getCurrentUpdatePriority,tl=e.resolveUpdatePriority,nl=e.shouldAttemptEagerTransition,rl=e.detachDeletedInstance,il=e.maySuspendCommit,al=e.preloadInstance,sl=e.startSuspendingCommit,ol=e.suspendInstance,ll=e.waitForCommitToBeReady,cl=e.NotPendingTransition,ul=e.HostTransitionContext,hl=e.resetFormInstance,dl=e.bindToConsole,pl=e.supportsMicrotasks,fl=e.scheduleMicrotask,ml=e.supportsTestSelectors,gl=e.findFiberRoot,vl=e.getBoundingRect,yl=e.getTextContent,_l=e.isHiddenSubtree,xl=e.matchAccessibilityRole,bl=e.setFocusIfFocusable,Sl=e.setupIntersectionObserver,Ml=e.appendChild,wl=e.appendChildToContainer,Tl=e.commitTextUpdate,El=e.commitMount,Al=e.commitUpdate,Cl=e.insertBefore,Rl=e.insertInContainerBefore,Pl=e.removeChild,Il=e.removeChildFromContainer,Dl=e.resetTextContent,Nl=e.hideInstance,Ll=e.hideTextInstance,Ul=e.unhideInstance,Ol=e.unhideTextInstance,Fl=e.clearContainer,kl=e.cloneInstance,zl=e.createContainerChildSet,Bl=e.appendChildToContainerChildSet,Vl=e.finalizeContainerChildren,Hl=e.replaceContainerChildren,jl=e.cloneHiddenInstance,Gl=e.cloneHiddenTextInstance,Wl=e.isSuspenseInstancePending,Xl=e.isSuspenseInstanceFallback,ql=e.getSuspenseInstanceFallbackErrorDetails,Yl=e.registerSuspenseInstanceRetry,Zl=e.canHydrateFormStateMarker,Jl=e.isFormStateMarkerMatching,$l=e.getNextHydratableSibling,Kl=e.getFirstHydratableChild,Ql=e.getFirstHydratableChildWithinContainer,ec=e.getFirstHydratableChildWithinSuspenseInstance,tc=e.canHydrateInstance,nc=e.canHydrateTextInstance,rc=e.canHydrateSuspenseInstance,ic=e.hydrateInstance,ac=e.hydrateTextInstance,sc=e.hydrateSuspenseInstance,oc=e.getNextHydratableInstanceAfterSuspenseInstance,lc=e.commitHydratedContainer,cc=e.commitHydratedSuspenseInstance,uc=e.clearSuspenseBoundary,hc=e.clearSuspenseBoundaryFromContainer,dc=e.shouldDeleteUnhydratedTailInstances,pc=e.diffHydratedPropsForDevWarnings,fc=e.diffHydratedTextForDevWarnings,mc=e.describeHydratableInstanceForDevWarnings,gc=e.validateHydratableInstance,vc=e.validateHydratableTextInstance,yc=e.supportsResources,_c=e.isHostHoistableType,xc=e.getHoistableRoot,bc=e.getResource,Sc=e.acquireResource,Mc=e.releaseResource,wc=e.hydrateHoistable,Tc=e.mountHoistable,Ec=e.unmountHoistable,Ac=e.createHoistableInstance,Cc=e.prepareToCommitHoistables,Rc=e.mayResourceSuspendCommit,Pc=e.preloadResource,Ic=e.suspendResource,Dc=e.supportsSingletons,Nc=e.resolveSingletonInstance,Lc=e.clearSingleton,Uc=e.acquireSingletonInstance,Oc=e.releaseSingletonInstance,Fc=e.isHostSingletonType,kc=[],zc=[],Bc=-1,Vc={};Object.freeze(Vc);var Hc=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(jc(e)/Gc|0)|0},jc=Math.log,Gc=Math.LN2,Wc=128,Xc=4194304,qc=to.unstable_scheduleCallback,Yc=to.unstable_cancelCallback,Zc=to.unstable_shouldYield,Jc=to.unstable_requestPaint,$c=to.unstable_now,Kc=to.unstable_ImmediatePriority,Qc=to.unstable_UserBlockingPriority,eu=to.unstable_NormalPriority,tu=to.unstable_IdlePriority,nu=to.log,ru=to.unstable_setDisableYieldValue,iu=null,au=null,su=null,ou=!1,lu="undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__,cu="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},uu=new WeakMap,hu=[],du=0,pu=null,fu=0,mu=[],gu=0,vu=null,yu=1,_u="",xu=D(null),bu=D(null),Su=D(null),Mu=D(null),wu=/["'&<>\n\t]|^\s|\s$/,Tu=null,Eu=null,Au=!1,Cu=!1,Ru=null,Pu=null,Iu=!1,Du=Error("Hydration Mismatch Exception: This is not a real error, and should not leak into userspace. If you're seeing this, it's likely a bug in React."),Nu=0,Lu=[],Uu=0,Ou=0,Fu=to.unstable_now,ku=-0,zu=-1.1,Bu=-0,Vu=!1,Hu=!1,ju=null,Gu=null,Wu=!1,Xu=!1,qu=!1,Yu=!1,Zu=0,Ju={},$u=null,Ku=0,Qu=0,eh=null,th=0,nh=1,rh=2,ih=3,ah=!1,sh=!1,oh=null,lh=!1,ch=Object.prototype.hasOwnProperty,uh={recordUnsafeLifecycleWarnings:function(){},flushPendingUnsafeLifecycleWarnings:function(){},recordLegacyContextWarning:function(){},flushLegacyContextWarning:function(){},discardPendingWarnings:function(){}},hh=[],dh=[],ph=[],fh=[],mh=[],gh=[],vh=new Set;uh.recordUnsafeLifecycleWarnings=function(e,t){vh.has(e.type)||("function"==typeof t.componentWillMount&&!0!==t.componentWillMount.__suppressDeprecationWarning&&hh.push(e),8&e.mode&&"function"==typeof t.UNSAFE_componentWillMount&&dh.push(e),"function"==typeof t.componentWillReceiveProps&&!0!==t.componentWillReceiveProps.__suppressDeprecationWarning&&ph.push(e),8&e.mode&&"function"==typeof t.UNSAFE_componentWillReceiveProps&&fh.push(e),"function"==typeof t.componentWillUpdate&&!0!==t.componentWillUpdate.__suppressDeprecationWarning&&mh.push(e),8&e.mode&&"function"==typeof t.UNSAFE_componentWillUpdate&&gh.push(e))},uh.flushPendingUnsafeLifecycleWarnings=function(){var e=new Set;0<hh.length&&(hh.forEach(function(t){e.add(y(t)||"Component"),vh.add(t.type)}),hh=[]);var t=new Set;0<dh.length&&(dh.forEach(function(e){t.add(y(e)||"Component"),vh.add(e.type)}),dh=[]);var n=new Set;0<ph.length&&(ph.forEach(function(e){n.add(y(e)||"Component"),vh.add(e.type)}),ph=[]);var r=new Set;0<fh.length&&(fh.forEach(function(e){r.add(y(e)||"Component"),vh.add(e.type)}),fh=[]);var i=new Set;0<mh.length&&(mh.forEach(function(e){i.add(y(e)||"Component"),vh.add(e.type)}),mh=[]);var a=new Set;0<gh.length&&(gh.forEach(function(e){a.add(y(e)||"Component"),vh.add(e.type)}),gh=[]),0<t.size&&m(t),0<r.size&&m(r),0<a.size&&m(a),0<e.size&&m(e),0<n.size&&m(n),0<i.size&&m(i)};var yh=new Map,_h=new Set;uh.recordLegacyContextWarning=function(e,t){for(var n=null,r=e;null!==r;)8&r.mode&&(n=r),r=r.return;null===n||!_h.has(e.type)&&(r=yh.get(n),null!=e.type.contextTypes||null!=e.type.childContextTypes||null!==t&&"function"==typeof t.getChildContext)&&(void 0===r&&(r=[],yh.set(n,r)),r.push(e))},uh.flushLegacyContextWarning=function(){yh.forEach(function(e){if(0!==e.length){var t=e[0],n=new Set;e.forEach(function(e){n.add(y(e)||"Component"),_h.add(e.type)}),m(n),T(t,function(){})}})},uh.discardPendingWarnings=function(){hh=[],dh=[],ph=[],fh=[],mh=[],gh=[],yh=new Map};var xh,bh=Error("Suspense Exception: This is not a real error! It's an implementation detail of `use` to interrupt the current render. You must either rethrow it immediately, or move the `use` call outside of the `try/catch` block. Capturing without rethrowing will lead to unexpected behavior.\n\nTo handle async errors, wrap your component in an error boundary, or call the promise's `.catch` method and pass the result to `use`"),Sh=Error("Suspense Exception: This is not a real error, and should not leak into userspace. If you're seeing this, it's likely a bug in React."),Mh={then:function(){}},wh=null,Th=!1,Eh={"react-stack-bottom-frame":function(e,t,n){var r=Ro;Ro=!0;try{return e(t,n)}finally{Ro=r}}},Ah=Eh["react-stack-bottom-frame"].bind(Eh),Ch={"react-stack-bottom-frame":function(e){var t=Ro;Ro=!0;try{return e.render()}finally{Ro=t}}},Rh=Ch["react-stack-bottom-frame"].bind(Ch),Ph={"react-stack-bottom-frame":function(e,t){try{t.componentDidMount()}catch(n){us(e,e.return,n)}}},Ih=Ph["react-stack-bottom-frame"].bind(Ph),Dh={"react-stack-bottom-frame":function(e,t,n,r,i){try{t.componentDidUpdate(n,r,i)}catch(a){us(e,e.return,a)}}},Nh=Dh["react-stack-bottom-frame"].bind(Dh),Lh={"react-stack-bottom-frame":function(e,t){var n=t.stack;e.componentDidCatch(t.value,{componentStack:null!==n?n:""})}},Uh=Lh["react-stack-bottom-frame"].bind(Lh),Oh={"react-stack-bottom-frame":function(e,t,n){try{n.componentWillUnmount()}catch(r){us(e,t,r)}}},Fh=Oh["react-stack-bottom-frame"].bind(Oh),kh={"react-stack-bottom-frame":function(e){var t=e.create;return e=e.inst,t=t(),e.destroy=t}},zh=kh["react-stack-bottom-frame"].bind(kh),Bh={"react-stack-bottom-frame":function(e,t,n){try{n()}catch(r){us(e,t,r)}}},Vh=Bh["react-stack-bottom-frame"].bind(Bh),Hh={"react-stack-bottom-frame":function(e){return(0,e._init)(e._payload)}},jh=Hh["react-stack-bottom-frame"].bind(Hh),Gh=null,Wh=0,Xh=null,qh=(xh=!1,{}),Yh={},Zh={};f=function(e,t,n){if(null!==n&&"object"==typeof n&&n._store&&(!n._store.validated&&null==n.key||2===n._store.validated)){if("object"!=typeof n._store)throw Error("React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue.");n._store.validated=1;var r=y(e),i=r||"null";if(!qh[i]){qh[i]=!0,n=n._owner;var a="";(e=e._debugOwner)&&"number"==typeof e.tag&&(i=y(e))&&(a="\n\nCheck the render method of `"+i+"`."),a||r&&(a="\n\nCheck the top-level render call using <"+r+">."),null!=n&&e!==n&&(r=null,"number"==typeof n.tag?r=y(n):"string"==typeof n.name&&(r=n.name)),T(t,function(){})}}};var Jh,$h=Dt(!0),Kh=Dt(!1),Qh=D(null),ed=D(0),td=D(null),nd=null,rd=1,id=2,ad=D(0),sd=0,od=1,ld=2,cd=4,ud=8,hd=new Set,dd=new Set,pd=new Set,fd=new Set,md=0,gd=null,vd=null,yd=null,_d=!1,xd=!1,bd=!1,Sd=0,Md=0,wd=null,Td=0,Ed=25,Ad=null,Cd=null,Rd=-1,Pd=!1,Id=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Dd={readContext:ai,use:rn,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useLayoutEffect:Wt,useInsertionEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useSyncExternalStore:Wt,useId:Wt};Dd.useCacheRefresh=Wt,Dd.useMemoCache=Wt,Dd.useHostTransitionStatus=Wt,Dd.useFormState=Wt,Dd.useActionState=Wt,Dd.useOptimistic=Wt;var Nd=null,Ld=null,Ud=null,Od=null,Fd=null,kd=null,zd=null;(Nd={readContext:function(e){return ai(e)},use:rn,useCallback:function(e,t){return Ad="useCallback",Vt(),jt(t),Wn(e,t)},useContext:function(e){return Ad="useContext",Vt(),ai(e)},useEffect:function(e,t){return Ad="useEffect",Vt(),jt(t),Bn(e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Vt(),jt(n),jn(e,t,n)},useInsertionEffect:function(e,t){Ad="useInsertionEffect",Vt(),jt(t),kn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Vt(),jt(t),Vn(e,t)},useMemo:function(e,t){Ad="useMemo",Vt(),jt(t);var n=So.H;So.H=Fd;try{return qn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Vt();var r=So.H;So.H=Fd;try{return on(e,t,n)}finally{So.H=r}},useRef:function(e){return Ad="useRef",Vt(),Fn(e)},useState:function(e){Ad="useState",Vt();var t=So.H;So.H=Fd;try{return _n(e)}finally{So.H=t}},useDebugValue:function(){Ad="useDebugValue",Vt()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Vt(),Zn(e,t)},useTransition:function(){return Ad="useTransition",Vt(),nr()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Vt(),hn(e,t,n)},useId:function(){return Ad="useId",Vt(),sr()},useCacheRefresh:function(){return Ad="useCacheRefresh",Vt(),or()}}).useMemoCache=an,Nd.useHostTransitionStatus=ar,Nd.useFormState=function(e,t){return Ad="useFormState",Vt(),Gt(),In(e,t)},Nd.useActionState=function(e,t){return Ad="useActionState",Vt(),In(e,t)},Nd.useOptimistic=function(e){return Ad="useOptimistic",Vt(),xn(e)},(Ld={readContext:function(e){return ai(e)},use:rn,useCallback:function(e,t){return Ad="useCallback",Ht(),Wn(e,t)},useContext:function(e){return Ad="useContext",Ht(),ai(e)},useEffect:function(e,t){return Ad="useEffect",Ht(),Bn(e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Ht(),jn(e,t,n)},useInsertionEffect:function(e,t){Ad="useInsertionEffect",Ht(),kn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Ht(),Vn(e,t)},useMemo:function(e,t){Ad="useMemo",Ht();var n=So.H;So.H=Fd;try{return qn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Ht();var r=So.H;So.H=Fd;try{return on(e,t,n)}finally{So.H=r}},useRef:function(e){return Ad="useRef",Ht(),Fn(e)},useState:function(e){Ad="useState",Ht();var t=So.H;So.H=Fd;try{return _n(e)}finally{So.H=t}},useDebugValue:function(){Ad="useDebugValue",Ht()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Ht(),Zn(e,t)},useTransition:function(){return Ad="useTransition",Ht(),nr()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Ht(),hn(e,t,n)},useId:function(){return Ad="useId",Ht(),sr()},useCacheRefresh:function(){return Ad="useCacheRefresh",Ht(),or()}}).useMemoCache=an,Ld.useHostTransitionStatus=ar,Ld.useFormState=function(e,t){return Ad="useFormState",Ht(),Gt(),In(e,t)},Ld.useActionState=function(e,t){return Ad="useActionState",Ht(),In(e,t)},Ld.useOptimistic=function(e){return Ad="useOptimistic",Ht(),xn(e)},(Ud={readContext:function(e){return ai(e)},use:rn,useCallback:function(e,t){return Ad="useCallback",Ht(),Xn(e,t)},useContext:function(e){return Ad="useContext",Ht(),ai(e)},useEffect:function(e,t){Ad="useEffect",Ht(),zn(2048,ud,e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Ht(),Gn(e,t,n)},useInsertionEffect:function(e,t){return Ad="useInsertionEffect",Ht(),zn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Ht(),zn(4,cd,e,t)},useMemo:function(e,t){Ad="useMemo",Ht();var n=So.H;So.H=kd;try{return Yn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Ht();var r=So.H;So.H=kd;try{return ln(e)}finally{So.H=r}},useRef:function(){return Ad="useRef",Ht(),tn().memoizedState},useState:function(){Ad="useState",Ht();var e=So.H;So.H=kd;try{return ln(sn)}finally{So.H=e}},useDebugValue:function(){Ad="useDebugValue",Ht()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Ht(),Jn(e,t)},useTransition:function(){return Ad="useTransition",Ht(),rr()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Ht(),dn(e,t,n)},useId:function(){return Ad="useId",Ht(),tn().memoizedState},useCacheRefresh:function(){return Ad="useCacheRefresh",Ht(),tn().memoizedState}}).useMemoCache=an,Ud.useHostTransitionStatus=ar,Ud.useFormState=function(e){return Ad="useFormState",Ht(),Gt(),Dn(e)},Ud.useActionState=function(e){return Ad="useActionState",Ht(),Dn(e)},Ud.useOptimistic=function(e,t){return Ad="useOptimistic",Ht(),bn(e,t)},(Od={readContext:function(e){return ai(e)},use:rn,useCallback:function(e,t){return Ad="useCallback",Ht(),Xn(e,t)},useContext:function(e){return Ad="useContext",Ht(),ai(e)},useEffect:function(e,t){Ad="useEffect",Ht(),zn(2048,ud,e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Ht(),Gn(e,t,n)},useInsertionEffect:function(e,t){return Ad="useInsertionEffect",Ht(),zn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Ht(),zn(4,cd,e,t)},useMemo:function(e,t){Ad="useMemo",Ht();var n=So.H;So.H=zd;try{return Yn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Ht();var r=So.H;So.H=zd;try{return un(e)}finally{So.H=r}},useRef:function(){return Ad="useRef",Ht(),tn().memoizedState},useState:function(){Ad="useState",Ht();var e=So.H;So.H=zd;try{return un(sn)}finally{So.H=e}},useDebugValue:function(){Ad="useDebugValue",Ht()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Ht(),$n(e,t)},useTransition:function(){return Ad="useTransition",Ht(),ir()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Ht(),dn(e,t,n)},useId:function(){return Ad="useId",Ht(),tn().memoizedState},useCacheRefresh:function(){return Ad="useCacheRefresh",Ht(),tn().memoizedState}}).useMemoCache=an,Od.useHostTransitionStatus=ar,Od.useFormState=function(e){return Ad="useFormState",Ht(),Gt(),Un(e)},Od.useActionState=function(e){return Ad="useActionState",Ht(),Un(e)},Od.useOptimistic=function(e,t){return Ad="useOptimistic",Ht(),Mn(e,t)},(Fd={readContext:function(e){return ai(e)},use:function(e){return rn(e)},useCallback:function(e,t){return Ad="useCallback",Vt(),Wn(e,t)},useContext:function(e){return Ad="useContext",Vt(),ai(e)},useEffect:function(e,t){return Ad="useEffect",Vt(),Bn(e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Vt(),jn(e,t,n)},useInsertionEffect:function(e,t){Ad="useInsertionEffect",Vt(),kn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Vt(),Vn(e,t)},useMemo:function(e,t){Ad="useMemo",Vt();var n=So.H;So.H=Fd;try{return qn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Vt();var r=So.H;So.H=Fd;try{return on(e,t,n)}finally{So.H=r}},useRef:function(e){return Ad="useRef",Vt(),Fn(e)},useState:function(e){Ad="useState",Vt();var t=So.H;So.H=Fd;try{return _n(e)}finally{So.H=t}},useDebugValue:function(){Ad="useDebugValue",Vt()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Vt(),Zn(e,t)},useTransition:function(){return Ad="useTransition",Vt(),nr()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Vt(),hn(e,t,n)},useId:function(){return Ad="useId",Vt(),sr()},useCacheRefresh:function(){return Ad="useCacheRefresh",Vt(),or()},useMemoCache:function(e){return an(e)}}).useHostTransitionStatus=ar,Fd.useFormState=function(e,t){return Ad="useFormState",Vt(),In(e,t)},Fd.useActionState=function(e,t){return Ad="useActionState",Vt(),In(e,t)},Fd.useOptimistic=function(e){return Ad="useOptimistic",Vt(),xn(e)},(kd={readContext:function(e){return ai(e)},use:function(e){return rn(e)},useCallback:function(e,t){return Ad="useCallback",Ht(),Xn(e,t)},useContext:function(e){return Ad="useContext",Ht(),ai(e)},useEffect:function(e,t){Ad="useEffect",Ht(),zn(2048,ud,e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Ht(),Gn(e,t,n)},useInsertionEffect:function(e,t){return Ad="useInsertionEffect",Ht(),zn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Ht(),zn(4,cd,e,t)},useMemo:function(e,t){Ad="useMemo",Ht();var n=So.H;So.H=kd;try{return Yn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Ht();var r=So.H;So.H=kd;try{return ln(e)}finally{So.H=r}},useRef:function(){return Ad="useRef",Ht(),tn().memoizedState},useState:function(){Ad="useState",Ht();var e=So.H;So.H=kd;try{return ln(sn)}finally{So.H=e}},useDebugValue:function(){Ad="useDebugValue",Ht()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Ht(),Jn(e,t)},useTransition:function(){return Ad="useTransition",Ht(),rr()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Ht(),dn(e,t,n)},useId:function(){return Ad="useId",Ht(),tn().memoizedState},useCacheRefresh:function(){return Ad="useCacheRefresh",Ht(),tn().memoizedState},useMemoCache:function(e){return an(e)}}).useHostTransitionStatus=ar,kd.useFormState=function(e){return Ad="useFormState",Ht(),Dn(e)},kd.useActionState=function(e){return Ad="useActionState",Ht(),Dn(e)},kd.useOptimistic=function(e,t){return Ad="useOptimistic",Ht(),bn(e,t)},(zd={readContext:function(e){return ai(e)},use:function(e){return rn(e)},useCallback:function(e,t){return Ad="useCallback",Ht(),Xn(e,t)},useContext:function(e){return Ad="useContext",Ht(),ai(e)},useEffect:function(e,t){Ad="useEffect",Ht(),zn(2048,ud,e,t)},useImperativeHandle:function(e,t,n){return Ad="useImperativeHandle",Ht(),Gn(e,t,n)},useInsertionEffect:function(e,t){return Ad="useInsertionEffect",Ht(),zn(4,ld,e,t)},useLayoutEffect:function(e,t){return Ad="useLayoutEffect",Ht(),zn(4,cd,e,t)},useMemo:function(e,t){Ad="useMemo",Ht();var n=So.H;So.H=kd;try{return Yn(e,t)}finally{So.H=n}},useReducer:function(e,t,n){Ad="useReducer",Ht();var r=So.H;So.H=kd;try{return un(e)}finally{So.H=r}},useRef:function(){return Ad="useRef",Ht(),tn().memoizedState},useState:function(){Ad="useState",Ht();var e=So.H;So.H=kd;try{return un(sn)}finally{So.H=e}},useDebugValue:function(){Ad="useDebugValue",Ht()},useDeferredValue:function(e,t){return Ad="useDeferredValue",Ht(),$n(e,t)},useTransition:function(){return Ad="useTransition",Ht(),ir()},useSyncExternalStore:function(e,t,n){return Ad="useSyncExternalStore",Ht(),dn(e,t,n)},useId:function(){return Ad="useId",Ht(),tn().memoizedState},useCacheRefresh:function(){return Ad="useCacheRefresh",Ht(),tn().memoizedState},useMemoCache:function(e){return an(e)}}).useHostTransitionStatus=ar,zd.useFormState=function(e){return Ad="useFormState",Ht(),Un(e)},zd.useActionState=function(e){return Ad="useActionState",Ht(),Un(e)},zd.useOptimistic=function(e,t){return Ad="useOptimistic",Ht(),Mn(e,t)};var Bd={},Vd=new Set,Hd=new Set,jd=new Set,Gd=new Set,Wd=new Set,Xd=new Set,qd=new Set,Yd=new Set,Zd=new Set,Jd=new Set;Object.freeze(Bd);var $d={isMounted:function(e){var t=Co;if(null!==t&&Ro&&1===t.tag){var n=t.stateNode;n._warnedAboutRefsInRender,n._warnedAboutRefsInRender=!0}return!!(e=e._reactInternals)&&E(e)===e},enqueueSetState:function(e,t,n){var r=La(e=e._reactInternals),i=ut(r);i.payload=t,null!=n&&(gr(n),i.callback=n),null!==(t=ht(e,i,r))&&(Oa(t,e,r),dt(t,e,r)),ne(e,r)},enqueueReplaceState:function(e,t,n){var r=La(e=e._reactInternals),i=ut(r);i.tag=nh,i.payload=t,null!=n&&(gr(n),i.callback=n),null!==(t=ht(e,i,r))&&(Oa(t,e,r),dt(t,e,r)),ne(e,r)},enqueueForceUpdate:function(e,t){var n=La(e=e._reactInternals),r=ut(n);r.tag=rh,null!=t&&(gr(t),r.callback=t),null!==(t=ht(e,r,n))&&(Oa(t,e,n),dt(t,e,n)),null!==su&&"function"==typeof su.markForceUpdateScheduled&&su.markForceUpdateScheduled(e,n)}},Kd="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)},Qd=null,ep=null,tp=Error("This is not a real error. It's an implementation detail of React's selective hydration feature. If this leaks into userspace, it's a bug in React. Please file an issue."),np=!1,rp={},ip={},ap={},sp={},op=!1,lp={},cp={},up={dehydrated:null,treeContext:null,retryLane:0},hp=!1,dp=D(null),pp=D(null),fp=D(null),mp={},gp=null,vp=null,yp="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},_p=to.unstable_scheduleCallback,xp=to.unstable_NormalPriority,bp={$$typeof:ho,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0,_currentRenderer:null,_currentRenderer2:null},Sp=So.S;So.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===$u){var n=$u=[];Ku=0,Qu=st(),eh={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ku++,t.then(ot,ot)}(0,t),null!==Sp&&Sp(e,t)};var Mp=D(null),wp=null;wp=new Set;var Tp=!1,Ep=!1,Ap=!1,Cp="function"==typeof WeakSet?WeakSet:Set,Rp=null,Pp=null,Ip=null,Dp=!1,Np=null,Lp=!1,Up=null,Op=8192,Fp={getCacheForType:function(e){var t=ai(bp),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},getOwner:function(){return Co}},kp=0,zp=1,Bp=2,Vp=3,Hp=4;if("function"==typeof Symbol&&Symbol.for){var jp=Symbol.for;kp=jp("selector.component"),zp=jp("selector.has_pseudo_class"),Bp=jp("selector.role"),Vp=jp("selector.test_id"),Hp=jp("selector.text")}var Gp=[],Wp="function"==typeof WeakMap?WeakMap:Map,Xp=0,qp=2,Yp=4,Zp=0,$p=1,Kp=2,Qp=3,ef=4,tf=5,nf=6,rf=Xp,af=null,sf=null,of=0,lf=0,cf=1,uf=2,hf=3,df=4,pf=5,ff=6,mf=7,gf=8,vf=lf,yf=null,_f=!1,xf=!1,bf=!1,Sf=0,Mf=Zp,wf=0,Tf=0,Ef=0,Af=0,Cf=0,Rf=null,Pf=null,If=!1,Df=0,Nf=300,Lf=1/0,Uf=500,Of=null,Ff=null,kf=!1,zf=null,Bf=0,Vf=0,Hf=null,jf=50,Gf=0,Wf=null,Xf=!1,qf=!1,Yf=50,Zf=0,Jf=null,$f=0,Kf=1,Qf=2,em=null,tm=!1,nm=new Set,rm=null,im=null,am=!1;try{Object.preventExtensions({})}catch(vm){am=!0}var sm,om,lm,cm,um,hm,dm,pm,fm,mm=!1,gm={};return sm=function(e,r,i,a){null!==(r=t(e,r))&&(i=n(r.memoizedState,i,0,a),r.memoizedState=i,r.baseState=i,e.memoizedProps=no({},e.memoizedProps),null!==(i=Be(e,2))&&Oa(i,e,2))},om=function(e,n,r){null!==(n=t(e,n))&&(r=s(n.memoizedState,r,0),n.memoizedState=r,n.baseState=r,e.memoizedProps=no({},e.memoizedProps),null!==(r=Be(e,2))&&Oa(r,e,2))},lm=function(e,n,r,a){null!==(n=t(e,n))&&(r=i(n.memoizedState,r,a),n.memoizedState=r,n.baseState=r,e.memoizedProps=no({},e.memoizedProps),null!==(r=Be(e,2))&&Oa(r,e,2))},cm=function(e,t,r){e.pendingProps=n(e.memoizedProps,t,0,r),e.alternate&&(e.alternate.pendingProps=e.pendingProps),null!==(t=Be(e,2))&&Oa(t,e,2)},um=function(e,t){e.pendingProps=s(e.memoizedProps,t,0),e.alternate&&(e.alternate.pendingProps=e.pendingProps),null!==(t=Be(e,2))&&Oa(t,e,2)},hm=function(e,t,n){e.pendingProps=i(e.memoizedProps,t,n),e.alternate&&(e.alternate.pendingProps=e.pendingProps),null!==(t=Be(e,2))&&Oa(t,e,2)},dm=function(e){var t=Be(e,2);null!==t&&Oa(t,e,2)},pm=function(e){l=e},fm=function(e){o=e},Qs.attemptContinuousHydration=function(e){if(13===e.tag){var t=Be(e,67108864);null!==t&&Oa(t,e,67108864),js(e,67108864)}},Qs.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=La(e),n=Be(e,t);null!==n&&Oa(n,e,t),js(e,t)}},Qs.attemptSynchronousHydration=function(e){switch(e.tag){case 3:if((e=e.stateNode).current.memoizedState.isDehydrated){var t=O(e.pendingLanes);if(0!==t){for(e.pendingLanes|=2,e.entangledLanes|=2;t;){var n=1<<31-Hc(t);e.entanglements[1]|=n,t&=~n}Ke(e),(rf&(qp|Yp))===Xp&&(Lf=$c()+Uf,Qe(0))}}break;case 13:null!==(t=Be(e,2))&&Oa(t,e,2),Ha(),js(e,2)}},Qs.batchedUpdates=function(e,t){return e(t)},Qs.createComponentSelector=function(e){return{$$typeof:kp,value:e}},Qs.createContainer=function(e,t,n,r,i,a,s,o,l,c){return Fs(e,t,!1,null,0,r,a,s,o,l,0,null)},Qs.createHasPseudoClassSelector=function(e){return{$$typeof:zp,value:e}},Qs.createHydrationContainer=function(e,t,n,r,i,a,s,o,l,c,u,h,d){return(e=Fs(n,r,!0,e,0,a,o,l,c,u,0,d)).context=zs(null),(i=ut(r=La(n=e.current))).callback=null!=t?t:null,ht(n,i,r),e.current.lanes=r,j(e,r),Ke(e),e},Qs.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;try{ks(r);var i=!1}catch(a){i=!0}return i&&ks(r),{$$typeof:ao,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},Qs.createRoleSelector=function(e){return{$$typeof:Bp,value:e}},Qs.createTestNameSelector=function(e){return{$$typeof:Vp,value:e}},Qs.createTextSelector=function(e){return{$$typeof:Hp,value:e}},Qs.defaultOnCaughtError=function(e,t){var n=Qd?"The above error occurred in the <"+Qd+"> component.":"The above error occurred in one of your React components.",r="React will try to recreate this component tree from scratch using the error boundary you provided, "+(ep||"Anonymous")+".",i=So.getCurrentStack,a=null!=t.componentStack?t.componentStack:"";So.getCurrentStack=function(){return a};try{"object"==typeof e&&null!==e&&"string"==typeof e.environmentName&&dl("error",["%o\n\n%s\n\n%s\n",e,n,r],e.environmentName)()}finally{So.getCurrentStack=i}},Qs.defaultOnRecoverableError=function(e){Kd(e)},Qs.defaultOnUncaughtError=function(e,t){Kd(e),e=Qd?"An error occurred in the <"+Qd+"> component.":"An error occurred in one of your React components.";var n=So.getCurrentStack,r=null!=t.componentStack?t.componentStack:"";So.getCurrentStack=function(){return r},So.getCurrentStack=n},Qs.deferredUpdates=function(e){var t=So.T,n=el();try{return Qo(32),So.T=null,e()}finally{Qo(n),So.T=t}},Qs.discreteUpdates=function(e,t,n,r,i){var a=So.T,s=el();try{return Qo(2),So.T=null,e(t,n,r,i)}finally{Qo(s),So.T=a,rf===Xp&&(Lf=$c()+Uf)}},Qs.findAllNodes=Da,Qs.findBoundingRects=function(e,t){if(!ml)throw Error("Test selector API is not supported by this renderer.");t=Da(e,t),e=[];for(var n=0;n<t.length;n++)e.push(vl(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,i=r+n.width,a=n.y,s=a+n.height,o=t-1;0<=o;o--)if(t!==o){var l=e[o],c=l.x,u=c+l.width,h=l.y,d=h+l.height;if(r>=c&&a>=h&&i<=u&&s<=d){e.splice(t,1);break}if(!(r!==c||n.width!==l.width||d<a||h>s)){h>a&&(l.height+=h-a,l.y=a),d<s&&(l.height=s-h),e.splice(t,1);break}if(!(a!==h||n.height!==l.height||u<r||c>i)){c>r&&(l.width+=c-r,l.x=r),u<i&&(l.width=i-c),e.splice(t,1);break}}return e},Qs.findHostInstance=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error("Unable to find node on an unmounted component.");throw e=Object.keys(e).join(","),Error("Argument appears to not be a ReactComponent. Keys: "+e)}return null===(e=R(t))?null:Lo(e.stateNode)},Qs.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=C(e))?I(e):null)?null:Lo(e.stateNode)},Qs.findHostInstanceWithWarning=function(e,t){var n=e._reactInternals;if(void 0===n){if("function"==typeof e.render)throw Error("Unable to find node on an unmounted component.");throw e=Object.keys(e).join(","),Error("Argument appears to not be a ReactComponent. Keys: "+e)}if(null===(e=R(n)))return null;if(8&e.mode){var r=y(n)||"Component";gm[r]||(gm[r]=!0,T(e,function(){n.mode}))}return Lo(e.stateNode)},Qs.flushPassiveEffects=ls,Qs.flushSyncFromReconciler=function(e){var t=rf;rf|=1;var n=So.T,r=el();try{if(Qo(2),So.T=null,e)return e()}finally{Qo(r),So.T=n,((rf=t)&(qp|Yp))===Xp&&Qe(0)}},Qs.flushSyncWork=Ha,Qs.focusWithin=function(e,t){if(!ml)throw Error("Test selector API is not supported by this renderer.");for(t=Ia(e=Ca(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++],r=n.tag;if(!_l(n)){if((5===r||26===r||27===r)&&bl(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},Qs.getFindAllNodesFailureDescription=function(e,t){if(!ml)throw Error("Test selector API is not supported by this renderer.");var n=0,r=[];e=[Ca(e),0];for(var i=0;i<e.length;){var a=e[i++],s=a.tag,o=e[i++],l=t[o];if((5!==s&&26!==s&&27!==s||!_l(a))&&(Ra(a,l)&&(r.push(Pa(l)),++o>n&&(n=o)),o<t.length))for(a=a.child;null!==a;)e.push(a,o),a=a.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Pa(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},Qs.getPublicRootInstance=function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 27:case 5:return Lo(e.child.stateNode);default:return e.child.stateNode}},Qs.injectIntoDevTools=function(){var e={bundleType:1,version:Io,rendererPackageName:Do,currentDispatcherRef:So,findFiberByHostInstance:$o,reconcilerVersion:"19.0.0"};return null!==No&&(e.rendererConfig=No),e.overrideHookState=sm,e.overrideHookStateDeletePath=om,e.overrideHookStateRenamePath=lm,e.overrideProps=cm,e.overridePropsDeletePath=um,e.overridePropsRenamePath=hm,e.scheduleUpdate=dm,e.setErrorHandler=pm,e.setSuspenseHandler=fm,e.scheduleRefresh=h,e.scheduleRoot=u,e.setRefreshHandler=d,e.getCurrentFiber=Gs,e.getLaneLabelMap=Ws,e.injectProfilingHooks=J,function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled)return!0;if(!t.supportsFiber)return!0;try{iu=t.inject(e),au=t}catch(n){}return!!t.checkDCE}(e)},Qs.isAlreadyRendering=function(){return(rf&(qp|Yp))!==Xp},Qs.observeVisibleRects=function(e,t,n,r){function i(){var n=Da(e,t);a.forEach(function(e){0>n.indexOf(e)&&l(e)}),n.forEach(function(e){0>a.indexOf(e)&&o(e)})}if(!ml)throw Error("Test selector API is not supported by this renderer.");var a=Da(e,t),s=(n=Sl(a,n,r)).disconnect,o=n.observe,l=n.unobserve;return Gp.push(i),{disconnect:function(){var e=Gp.indexOf(i);0<=e&&Gp.splice(e,1),s()}}},Qs.shouldError=function(e){return l(e)},Qs.shouldSuspend=function(e){return o(e)},Qs.startHostTransition=function(e,t,n,r){if(5!==e.tag)throw Error("Expected the form instance to be a HostComponent. This is a bug in React.");var i=tr(e).queue;er(e,i,t,cl,null===n?p:function(){So.T;var t=tr(e).next.queue;return hr(e,t,{},La(e)),n(r)})},Qs.updateContainer=function(e,t,n,r){var i=t.current,a=La(i);return Vs(i,a,e,t,n,r),a},Qs.updateContainerSync=Bs,Qs},e.exports.default=e.exports,Object.defineProperty(e.exports,"__esModule",{value:!0})),qp.exports;var e}const Kp=i((Wp||(Wp=1,Xp.exports=$p()),Xp.exports));var Qp,ef,tf={exports:{}},nf={};var rf,af=(ef||(ef=1,tf.exports=(Qp||(Qp=1,rf=nf,
/**
     * @license React
     * scheduler.development.js
     *
     * Copyright (c) Meta Platforms, Inc. and affiliates.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE file in the root directory of this source tree.
     */
function(){function e(){if(w){var e=rf.unstable_now();A=e;var t=!0;try{e:{_=!1,x&&(x=!1,S(T),T=-1),y=!0;var i=v;try{t:{for(a(e),g=n(p);null!==g&&!(g.expirationTime>e&&o());){var l=g.callback;if("function"==typeof l){g.callback=null,v=g.priorityLevel;var u=l(g.expirationTime<=e);if(e=rf.unstable_now(),"function"==typeof u){g.callback=u,a(e),t=!0;break t}g===n(p)&&r(p),a(e)}else r(p);g=n(p)}if(null!==g)t=!0;else{var h=n(f);null!==h&&c(s,h.startTime-e),t=!1}}break e}finally{g=null,v=i,y=!1}t=void 0}}finally{t?C():w=!1}}}function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}function a(e){for(var i=n(f);null!==i;){if(null===i.callback)r(f);else{if(!(i.startTime<=e))break;r(f),i.sortIndex=i.expirationTime,t(p,i)}i=n(f)}}function s(e){if(x=!1,a(e),!_)if(null!==n(p))_=!0,l();else{var t=n(f);null!==t&&c(s,t.startTime-e)}}function o(){return!(rf.unstable_now()-A<E)}function l(){w||(w=!0,C())}function c(e,t){T=b(function(){e(rf.unstable_now())},t)}if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error()),rf.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var u=performance;rf.unstable_now=function(){return u.now()}}else{var h=Date,d=h.now();rf.unstable_now=function(){return h.now()-d}}var p=[],f=[],m=1,g=null,v=3,y=!1,_=!1,x=!1,b="function"==typeof setTimeout?setTimeout:null,S="function"==typeof clearTimeout?clearTimeout:null,M="undefined"!=typeof setImmediate?setImmediate:null,w=!1,T=-1,E=5,A=-1;if("function"==typeof M)var C=function(){M(e)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=e,C=function(){P.postMessage(null)}}else C=function(){b(e,0)};rf.unstable_IdlePriority=5,rf.unstable_ImmediatePriority=1,rf.unstable_LowPriority=4,rf.unstable_NormalPriority=3,rf.unstable_Profiling=null,rf.unstable_UserBlockingPriority=2,rf.unstable_cancelCallback=function(e){e.callback=null},rf.unstable_continueExecution=function(){_||y||(_=!0,l())},rf.unstable_forceFrameRate=function(e){0>e||125<e||(E=0<e?Math.floor(1e3/e):5)},rf.unstable_getCurrentPriorityLevel=function(){return v},rf.unstable_getFirstCallbackNode=function(){return n(p)},rf.unstable_next=function(e){switch(v){case 1:case 2:case 3:var t=3;break;default:t=v}var n=v;v=t;try{return e()}finally{v=n}},rf.unstable_pauseExecution=function(){},rf.unstable_requestPaint=function(){},rf.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=v;v=e;try{return t()}finally{v=n}},rf.unstable_scheduleCallback=function(e,r,i){var a=rf.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?a+i:a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:m++,callback:r,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>a?(e.sortIndex=i,t(f,e),null===n(p)&&e===n(f)&&(x?(S(T),T=-1):x=!0,c(s,i-a))):(e.sortIndex=o,t(p,e),_||y||(_=!0,l())),e},rf.unstable_shouldYield=o,rf.unstable_wrapCallback=function(e){var t=v;return function(){var n=v;v=t;try{return e.apply(this,arguments)}finally{v=n}}},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),nf)),tf.exports);function sf(e,t,n){if(!e)return;if(!0===n(e))return e;let r=t?e.return:e.child;for(;r;){const e=sf(r,t,n);if(e)return e;r=t?null:r.sibling}}function of(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}const lf=of(s.createContext(null));class cf extends s.Component{render(){return s.createElement(lf.Provider,{value:this._reactInternals},this.props.children)}}function uf(){const e=s.useContext(lf);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=s.useId();return s.useMemo(()=>{for(const n of[e,null==e?void 0:e.alternate]){if(!n)continue;const e=sf(n,!1,e=>{let n=e.memoizedState;for(;n;){if(n.memoizedState===t)return!0;n=n.next}});if(e)return e}},[e,t])}const hf=Symbol.for("react.context"),df=e=>null!==e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===hf;function pf(){const e=function(){const e=uf(),[t]=s.useState(()=>new Map);t.clear();let n=e;for(;n;){const e=n.type;df(e)&&e!==lf&&!t.has(e)&&t.set(e,s.use(of(e))),n=n.return}return t}();return s.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>r=>s.createElement(t,null,s.createElement(n.Provider,{...r,value:e.get(n)})),e=>s.createElement(cf,{...e})),[e])}function ff(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const mf=e=>e&&e.isOrthographicCamera,gf=e=>null!=e&&("string"==typeof e||"number"==typeof e||e.isColor),vf=((e,t)=>"undefined"!=typeof window&&((null==(e=window.document)?void 0:e.createElement)||"ReactNative"===(null==(t=window.navigator)?void 0:t.product)))()?s.useLayoutEffect:s.useEffect;function yf(e){const t=s.useRef(e);return vf(()=>{t.current=e},[e]),t}function _f({set:e}){return vf(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const xf=(e=>((e=class extends s.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}).getDerivedStateFromError=()=>({error:!0}),e))();function bf(e){var t;const n="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function Sf(e){var t;return null==(t=e.__r3f)?void 0:t.root.getState()}const Mf={obj:e=>e===Object(e)&&!Mf.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,nul:e=>null===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:i=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(Mf.str(e)||Mf.num(e)||Mf.boo(e))return e===t;const a=Mf.obj(e);if(a&&"reference"===r)return e===t;const s=Mf.arr(e);if(s&&"reference"===n)return e===t;if((s||a)&&e===t)return!0;let o;for(o in e)if(!(o in t))return!1;if(a&&"shallow"===n&&"shallow"===r){for(o in i?t:e)if(!Mf.equ(e[o],t[o],{strict:i,objects:"reference"}))return!1}else for(o in i?t:e)if(e[o]!==t[o])return!1;if(Mf.und(o)){if(s&&0===e.length&&0===t.length)return!0;if(a&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};const wf=["children","key","ref"];function Tf(e){const t={};for(const n in e)wf.includes(n)||(t[n]=e[n]);return t}function Ef(e,t,n,r){const i=e;let a=null==i?void 0:i.__r3f;return a||(a={root:t,type:n,parent:null,children:[],props:Tf(r),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=a)),a}function Af(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const i of t.split("-")){var r;t=i,e=n,n=null==(r=n)?void 0:r[t]}return{root:e,key:t,target:n}}const Cf=/-\d+$/;function Rf(e,t){if(Mf.str(t.props.attach)){if(Cf.test(t.props.attach)){const n=t.props.attach.replace(Cf,""),{root:r,key:i}=Af(e.object,n);Array.isArray(r[i])||(r[i]=[])}const{root:n,key:r}=Af(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else Mf.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function Pf(e,t){if(Mf.str(t.props.attach)){const{root:n,key:r}=Af(e.object,t.props.attach),i=t.previousAttach;void 0===i?delete n[r]:n[r]=i}else null==t.previousAttach||t.previousAttach(e.object,t.object);delete t.previousAttach}const If=[...wf,"args","dispose","attach","object","onUpdate","dispose"],Df=new Map;function Nf(e){let t=Df.get(e.constructor);try{t||(t=new e.constructor,Df.set(e.constructor,t))}catch(n){}return t}const Lf=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Uf=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Of(e,t){var n;const r=e.__r3f,i=r&&ff(r).getState(),a=null==r?void 0:r.eventCount;for(const o in t){let n=t[o];if(If.includes(o))continue;if(r&&Uf.test(o)){"function"==typeof n?r.handlers[o]=n:delete r.handlers[o],r.eventCount=Object.keys(r.handlers).length;continue}if(void 0===n)continue;let{root:a,key:l,target:c}=Af(e,o);if(c instanceof fr&&n instanceof fr)c.mask=n.mask;else if(c instanceof Zr&&gf(n))c.set(n);else if(null!==c&&"object"==typeof c&&"function"==typeof c.set&&"function"==typeof c.copy&&null!=n&&n.constructor&&c.constructor===n.constructor)c.copy(n);else if(null!==c&&"object"==typeof c&&"function"==typeof c.set&&Array.isArray(n))"function"==typeof c.fromArray?c.fromArray(n):c.set(...n);else if(null!==c&&"object"==typeof c&&"function"==typeof c.set&&"number"==typeof n)"function"==typeof c.setScalar?c.setScalar(n):c.set(n);else{var s;a[l]=n,i&&!i.linear&&Lf.includes(l)&&null!=(s=a[l])&&s.isTexture&&a[l].format===Ee&&a[l].type===he&&(a[l].colorSpace=bt)}}if(null!=r&&r.parent&&null!=i&&i.internal&&null!=(n=r.object)&&n.isObject3D&&a!==r.eventCount){const e=r.object,t=i.internal.interaction.indexOf(e);t>-1&&i.internal.interaction.splice(t,1),r.eventCount&&null!==e.raycast&&i.internal.interaction.push(e)}return r&&void 0===r.props.attach&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&Ff(r),e}function Ff(e){var t;if(!e.parent)return;null==e.props.onUpdate||e.props.onUpdate(e.object);const n=null==(t=e.root)||null==t.getState?void 0:t.getState();n&&0===n.internal.frames&&n.invalidate()}function kf(e,t){e.manual||(mf(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const zf=e=>null==e?void 0:e.isObject3D;function Bf(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Vf(e,t,n,r){const i=n.get(t);i&&(n.delete(t),0===n.size&&(e.delete(r),i.target.releasePointerCapture(r)))}function Hf(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){const r=e.eventObject.__r3f;if(n.hovered.delete(Bf(e)),null!=r&&r.eventCount){const n=r.handlers,i={...e,intersections:t};null==n.onPointerOut||n.onPointerOut(i),null==n.onPointerLeave||n.onPointerLeave(i)}}}function r(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))})}}return function(a){const{onPointerMissed:s,internal:o}=e.getState();o.lastEvent.current=a;const l="onPointerMove"===i,c="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,u=function(t,n){const r=e.getState(),i=new Set,a=[],s=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<s.length;e++){const t=Sf(s[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let o=s.flatMap(function(e){const n=Sf(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r}).sort((e,t)=>{const n=Sf(e.object),r=Sf(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{const t=Bf(e);return!i.has(t)&&(i.add(t),!0)});r.events.filter&&(o=r.events.filter(o,r));for(const e of o){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&a.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())i.has(Bf(e.intersection))||a.push(e.intersection);return a}(a,l?t:void 0),h=c?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],i=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+i*i))}(a):0;"onPointerDown"===i&&(o.initialClick=[a.offsetX,a.offsetY],o.initialHits=u.map(e=>e.eventObject)),c&&!u.length&&h<=2&&(r(a,o.interaction),s&&s(a)),l&&n(u),function(e,t,r,i){if(e.length){const a={stopped:!1};for(const s of e){let o=Sf(s.object);if(o||s.object.traverseAncestors(e=>{const t=Sf(e);if(t)return o=t,!1}),o){const{raycaster:l,pointer:c,camera:u,internal:h}=o,d=new Kt(c.x,c.y,0).unproject(u),p=e=>{var t,n;return null!=(t=null==(n=h.capturedMap.get(e))?void 0:n.has(s.eventObject))&&t},f=e=>{const n={intersection:s,target:t.target};h.capturedMap.has(e)?h.capturedMap.get(e).set(s.eventObject,n):h.capturedMap.set(e,new Map([[s.eventObject,n]])),t.target.setPointerCapture(e)},m=e=>{const t=h.capturedMap.get(e);t&&Vf(h.capturedMap,s.eventObject,t,e)};let g={};for(let e in t){let n=t[e];"function"!=typeof n&&(g[e]=n)}let v={...s,...g,pointer:c,intersections:e,stopped:a.stopped,delta:r,unprojectedPoint:d,ray:l.ray,camera:u,stopPropagation(){const r="pointerId"in t&&h.capturedMap.get(t.pointerId);(!r||r.has(s.eventObject))&&(v.stopped=a.stopped=!0,h.hovered.size&&Array.from(h.hovered.values()).find(e=>e.eventObject===s.eventObject))&&n([...e.slice(0,e.indexOf(s)),s])},target:{hasPointerCapture:p,setPointerCapture:f,releasePointerCapture:m},currentTarget:{hasPointerCapture:p,setPointerCapture:f,releasePointerCapture:m},nativeEvent:t};if(i(v),!0===a.stopped)break}}}}(u,a,h,function(e){const t=e.eventObject,n=t.__r3f;if(null==n||!n.eventCount)return;const s=n.handlers;if(l){if(s.onPointerOver||s.onPointerEnter||s.onPointerOut||s.onPointerLeave){const t=Bf(e),n=o.hovered.get(t);n?n.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==s.onPointerOver||s.onPointerOver(e),null==s.onPointerEnter||s.onPointerEnter(e))}null==s.onPointerMove||s.onPointerMove(e)}else{const n=s[i];n?c&&!o.initialHits.includes(t)||(r(a,o.interaction.filter(e=>!o.initialHits.includes(e))),n(e)):c&&o.initialHits.includes(t)&&r(a,o.interaction.filter(e=>!o.initialHits.includes(e)))}})}}}}const jf=e=>!(null==e||!e.render),Gf=s.createContext(null);function Wf(){const e=s.useContext(Gf);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function Xf(e=e=>e,t){return Wf()(e,t)}function qf(e,t=0){const n=Wf(),r=n.getState().internal.subscribe,i=yf(e);return vf(()=>r(i,t,n),[t,r,n]),null}const Yf=new WeakMap;function Zf(e,t){return function(n,...r){let i;var a,s;return"function"==typeof(a=n)&&(null==a||null==(s=a.prototype)?void 0:s.constructor)===a?(i=Yf.get(n),i||(i=new n,Yf.set(n,i))):i=n,e&&e(i),Promise.all(r.map(e=>new Promise((n,r)=>i.load(e,e=>{zf(null==e?void 0:e.scene)&&Object.assign(e,function(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material),e.isMesh&&!t.meshes[e.name]&&(t.meshes[e.name]=e)}),t}(e.scene)),n(e)},t,t=>r(new Error(`Could not load ${e}: ${null==t?void 0:t.message}`))))))}}function Jf(e,t,n,r){const i=Array.isArray(t)?t:[t],a=((e,t,n)=>Vp(e,t,!1,n))(Zf(n,r),[e,...i],{equal:Mf.equ});return Array.isArray(t)?a:a[0]}function $f(e){const t=Kp(e);return t.injectIntoDevTools({bundleType:"undefined"!=typeof process?1:0,rendererPackageName:"@react-three/fiber",version:s.version}),t}Jf.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return((e,t,n)=>{Vp(e,t,!0,n)})(Zf(n),[e,...r])},Jf.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)zp.splice(0,zp.length);else{const t=zp.find(t=>Bp(e,t.keys,t.equal));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};const Kf={},Qf=/^three(?=[A-Z])/,em=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let tm=0;function nm(e){if("function"==typeof e){const t=""+tm++;return Kf[t]=e,t}Object.assign(Kf,e)}function rm(e,t){const n=em(e),r=Kf[n];if("primitive"!==e&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if("primitive"===e&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(void 0!==t.args&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function im(e){var t;e.isHidden&&(e.props.attach&&null!=(t=e.parent)&&t.object?Rf(e.parent,e):zf(e.object)&&!1!==e.props.visible&&(e.object.visible=!0),e.isHidden=!1,Ff(e))}function am(e,t,n){const r=t.root.getState();if(e.parent||e.object===r.scene){if(!t.object){var i,a;const e=Kf[em(t.type)];t.object=null!=(i=t.props.object)?i:new e(...null!=(a=t.props.args)?a:[]),t.object.__r3f=t}if(Of(t.object,t.props),t.props.attach)Rf(e,t);else if(zf(t.object)&&zf(e.object)){const r=e.object.children.indexOf(null==n?void 0:n.object);if(n&&-1!==r){const n=e.object.children.indexOf(t.object);if(-1!==n){e.object.children.splice(n,1);const i=n<r?r-1:r;e.object.children.splice(i,0,t.object)}else t.object.parent=e.object,e.object.children.splice(r,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const e of t.children)am(t,e);Ff(t)}}function sm(e,t){t&&(t.parent=e,e.children.push(t),am(e,t))}function om(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);-1!==r?e.children.splice(r,0,t):e.children.push(t),am(e,t,n)}function lm(e){if("function"==typeof e.dispose){const t=()=>{try{e.dispose()}catch{}};"undefined"!=typeof IS_REACT_ACT_ENVIRONMENT?t():af.unstable_scheduleCallback(af.unstable_IdlePriority,t)}}function cm(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);-1!==r&&e.children.splice(r,1),t.props.attach?Pf(e,t):zf(t.object)&&zf(e.object)&&(e.object.remove(t.object),function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}),n.capturedMap.forEach((e,r)=>{Vf(n.capturedMap,t,e,r)})}(ff(t),t.object));const i=null!==t.props.dispose&&!1!==n;for(let a=t.children.length-1;a>=0;a--){cm(t,t.children[a],i)}t.children.length=0,delete t.object.__r3f,i&&"primitive"!==t.type&&"Scene"!==t.object.type&&lm(t.object),void 0===n&&Ff(t)}function um(e,t){for(const n of[e,e.alternate])if(null!==n)if("function"==typeof n.ref){null==n.refCleanup||n.refCleanup();const e=n.ref(t);"function"==typeof e&&(n.refCleanup=e)}else n.ref&&(n.ref.current=t)}const hm=[];const dm=()=>{},pm={};let fm=0;const mm=$f({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:function(e,t,n){var r;return rm(e=em(e)in Kf?e:e.replace(Qf,""),t),"primitive"===e&&null!=(r=t.object)&&r.__r3f&&delete t.object.__r3f,Ef(t.object,n,e,t)},removeChild:cm,appendChild:sm,appendInitialChild:sm,insertBefore:om,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;t&&n&&sm(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;t&&n&&cm(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;t&&n&&r&&om(r,t,n)},getRootHostContext:()=>pm,getChildHostContext:()=>pm,commitUpdate(e,t,n,r,i){var a,s,o;rm(t,r);let l=!1;if(("primitive"===e.type&&n.object!==r.object||(null==(a=r.args)?void 0:a.length)!==(null==(s=n.args)?void 0:s.length)||null!=(o=r.args)&&o.some((e,t)=>{var r;return e!==(null==(r=n.args)?void 0:r[t])}))&&(l=!0),l)hm.push([e,{...r},i]);else{const t=function(e,t){const n={};for(const r in t)if(!If.includes(r)&&!Mf.equ(t[r],e.props[r])){n[r]=t[r];for(const e in t)e.startsWith(`${r}-`)&&(n[e]=t[e])}for(const r in e.props){if(If.includes(r)||t.hasOwnProperty(r))continue;const{root:i,key:a}=Af(e.object,r);if(i.constructor&&0===i.constructor.length){const e=Nf(i);Mf.und(e)||(n[a]=e[a])}else n[a]=0}return n}(e,r);Object.keys(t).length&&(Object.assign(e.props,t),Of(e.object,t))}(null===i.sibling||!(4&i.flags))&&function(){for(const[n]of hm){const e=n.parent;if(e){n.props.attach?Pf(e,n):zf(n.object)&&zf(e.object)&&e.object.remove(n.object);for(const e of n.children)e.props.attach?Pf(n,e):zf(e.object)&&zf(n.object)&&n.object.remove(e.object)}n.isHidden&&im(n),n.object.__r3f&&delete n.object.__r3f,"primitive"!==n.type&&lm(n.object)}for(const[n,r,i]of hm){n.props=r;const a=n.parent;if(a){var e,t;const r=Kf[em(n.type)];n.object=null!=(e=n.props.object)?e:new r(...null!=(t=n.props.args)?t:[]),n.object.__r3f=n,um(i,n.object),Of(n.object,n.props),n.props.attach?Rf(a,n):zf(n.object)&&zf(a.object)&&a.object.add(n.object);for(const e of n.children)e.props.attach?Rf(n,e):zf(e.object)&&zf(n.object)&&n.object.add(e.object);Ff(n)}}hm.length=0}()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>null==e?void 0:e.object,prepareForCommit:()=>null,preparePortalMount:e=>Ef(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:function(e){var t;e.isHidden||(e.props.attach&&null!=(t=e.parent)&&t.object?Pf(e.parent,e):zf(e.object)&&(e.object.visible=!1),e.isHidden=!0,Ff(e))},unhideInstance:im,createTextInstance:dm,hideTextInstance:dm,unhideTextInstance:dm,scheduleTimeout:"function"==typeof setTimeout?setTimeout:void 0,cancelTimeout:"function"==typeof clearTimeout?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:s.createContext(null),setCurrentUpdatePriority(e){fm=e},getCurrentUpdatePriority:()=>fm,resolveUpdatePriority(){var e;if(0!==fm)return fm;switch("undefined"!=typeof window&&(null==(e=window.event)?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return f.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return f.ContinuousEventPriority;default:return f.DefaultEventPriority}},resetFormInstance(){}}),gm=new Map,vm={objects:"shallow",strict:!1};function ym(e){const t=gm.get(e),n=null==t?void 0:t.fiber,r=null==t?void 0:t.store,i="function"==typeof reportError?reportError:console.error,a=r||((e,t)=>{const n=kp((n,r)=>{const i=new Kt,a=new Kt,o=new Kt;function l(e=r().camera,t=a,n=r().size){const{width:s,height:l,top:c,left:u}=n,h=s/l;t.isVector3?o.copy(t):o.set(...t);const d=e.getWorldPosition(i).distanceTo(o);if(mf(e))return{width:s/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:d,aspect:h};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,r=n*(s/l);return{width:r,height:n,top:c,left:u,factor:s/r,distance:d,aspect:h}}}let c;const u=e=>n(t=>({performance:{...t.performance,current:e}})),h=new Jt;return{set:n,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(t=1)=>e(r(),t),advance:(e,n)=>t(e,n,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Hc,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&u(e.performance.min),c=setTimeout(()=>u(r().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>n(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,i=0,s=0)=>{const o=r().camera,c={width:e,height:t,top:i,left:s};n(e=>({size:c,viewport:{...e.viewport,...l(o,a,c)}}))},setDpr:e=>n(t=>{const n=bf(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}}),setFrameloop:(e="always")=>{const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n(()=>({frameloop:e}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:s.createRef(),active:!1,frames:0,priority:0,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}}}),r=n.getState();let i=r.size,a=r.viewport.dpr,o=r.camera;return n.subscribe(()=>{const{camera:e,size:t,viewport:r,gl:s,set:l}=n.getState();if(t.width!==i.width||t.height!==i.height||r.dpr!==a){i=t,a=r.dpr,kf(e,t),r.dpr>0&&s.setPixelRatio(r.dpr);const n="undefined"!=typeof HTMLCanvasElement&&s.domElement instanceof HTMLCanvasElement;s.setSize(t.width,t.height,n)}e!==o&&(o=e,l(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),n.subscribe(t=>e(t)),n})(Om,Fm),o=n||mm.createContainer(a,f.ConcurrentRoot,null,!1,null,"",i,i,i,null);let c,u;t||gm.set(e,{fiber:o,store:a});let h=!1,d=null;return{async configure(t={}){let n;d=new Promise(e=>n=e);let{gl:r,size:i,scene:s,events:o,onCreated:l,shadows:p=!1,linear:f=!1,flat:m=!1,legacy:g=!1,orthographic:v=!1,frameloop:y="always",dpr:_=[1,2],performance:x,raycaster:b,camera:S,onPointerMissed:M}=t,w=a.getState(),T=w.gl;if(!w.gl){const t={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},n="function"==typeof r?await r(t):r;T=jf(n)?n:new Ap({...t,...r}),w.set({gl:T})}let E=w.raycaster;E||w.set({raycaster:E=new du});const{params:A,...C}=b||{};if(Mf.equ(C,E,vm)||Of(E,{...C}),Mf.equ(A,E.params,vm)||Of(E,{params:{...E.params,...A}}),!w.camera||w.camera===u&&!Mf.equ(u,S,vm)){u=S;const e=null==S?void 0:S.isCamera,t=e?S:v?new bc(0,0,0,0,.1,1e3):new ji(75,0,.1,1e3);e||(t.position.z=5,S&&(Of(t,S),t.manual||("aspect"in S||"left"in S||"right"in S||"bottom"in S||"top"in S)&&(t.manual=!0,t.updateProjectionMatrix())),w.camera||null!=S&&S.rotation||t.lookAt(0,0,0)),w.set({camera:t}),E.camera=t}if(!w.scene){let e;null!=s&&s.isScene?(e=s,Ef(e,a,"",{})):(e=new Qi,Ef(e,a,"",{}),s&&Of(e,s)),w.set({scene:e})}o&&!w.events.handlers&&w.set({events:o(a)});const R=function(e,t){if(!t&&"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:r,left:i}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:i}}return!t&&"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0,...t}}(e,i);if(Mf.equ(R,w.size,vm)||w.setSize(R.width,R.height,R.top,R.left),_&&w.viewport.dpr!==bf(_)&&w.setDpr(_),w.frameloop!==y&&w.setFrameloop(y),w.onPointerMissed||w.set({onPointerMissed:M}),x&&!Mf.equ(x,w.performance,vm)&&w.set(e=>({performance:{...e.performance,...x}})),!w.xr){var P;const e=(e,t)=>{const n=a.getState();"never"!==n.frameloop&&Fm(e,!0,n,t)},t=()=>{const t=a.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||Om(t)},n={connect(){const e=a.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=a.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(P=T.xr)?void 0:P.addEventListener)&&n.connect(),w.set({xr:n})}if(T.shadowMap){const e=T.shadowMap.enabled,t=T.shadowMap.type;if(T.shadowMap.enabled=!!p,Mf.boo(p))T.shadowMap.type=2;else if(Mf.str(p)){var I;const e={basic:0,percentage:1,soft:2,variance:3};T.shadowMap.type=null!=(I=e[p])?I:2}else Mf.obj(p)&&Object.assign(T.shadowMap,p);e===T.shadowMap.enabled&&t===T.shadowMap.type||(T.shadowMap.needsUpdate=!0)}return fn.enabled=!g,h||(T.outputColorSpace=f?St:bt,T.toneMapping=m?0:4),w.legacy!==g&&w.set(()=>({legacy:g})),w.linear!==f&&w.set(()=>({linear:f})),w.flat!==m&&w.set(()=>({flat:m})),!r||Mf.fun(r)||jf(r)||Mf.equ(r,T,vm)||Of(T,r),c=l,h=!0,n(),this},render(t){return h||d||this.configure(),d.then(()=>{mm.updateContainer(l.jsx(_m,{store:a,children:t,onCreated:c,rootElement:e}),o,null,()=>{})}),a},unmount(){xm(e)}}}function _m({store:e,children:t,onCreated:n,rootElement:r}){return vf(()=>{const t=e.getState();t.set(e=>({internal:{...e.internal,active:!0}})),n&&n(t),e.getState().events.connected||null==t.events.connect||t.events.connect(r)},[]),l.jsx(Gf.Provider,{value:e,children:t})}function xm(e,t){const n=gm.get(e),r=null==n?void 0:n.fiber;if(r){const t=null==n?void 0:n.store.getState();t&&(t.internal.active=!1),mm.updateContainer(null,r,null,()=>{t&&setTimeout(()=>{try{var n,r,i,a;null==t.events.disconnect||t.events.disconnect(),null==(n=t.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(i=t.gl)||null==i.forceContextLoss||i.forceContextLoss(),null!=(a=t.gl)&&a.xr&&t.xr.disconnect(),function(e){"Scene"!==e.type&&(null==e.dispose||e.dispose());for(const t in e){const n=e[t];"Scene"!==(null==n?void 0:n.type)&&(null==n||null==n.dispose||n.dispose())}}(t.scene),gm.delete(e)}catch(s){}},500)})}}function bm({state:e={},children:t,container:n}){const{events:r,size:i,...a}=e,o=Wf(),[c]=s.useState(()=>new du),[u]=s.useState(()=>new Jt),h=yf((e,t)=>{let a;if(t.camera&&i){const n=t.camera;a=e.viewport.getCurrentViewport(n,new Kt,i),n!==e.camera&&kf(n,i)}return{...e,...t,scene:n,raycaster:c,pointer:u,mouse:u,previousRoot:o,events:{...e.events,...t.events,...r},size:{...e.size,...i},viewport:{...e.viewport,...a},setEvents:e=>t.set(t=>({...t,events:{...t.events,...e}}))}}),d=s.useMemo(()=>{const e=kp((e,t)=>({...a,set:e,get:t})),t=t=>e.setState(e=>h.current(t,e));return t(o.getState()),o.subscribe(t),e},[o,n]);return l.jsx(l.Fragment,{children:mm.createPortal(l.jsx(Gf.Provider,{value:d,children:t}),d,null)})}const Sm=new Set,Mm=new Set,wm=new Set;function Tm(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function Em(e,t){switch(e){case"before":return Tm(Sm,t);case"after":return Tm(Mm,t);case"tail":return Tm(wm,t)}}let Am,Cm;function Rm(e,t,n){let r=t.clock.getDelta();"never"===t.frameloop&&"number"==typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Am=t.internal.subscribers;for(let i=0;i<Am.length;i++)Cm=Am[i],Cm.ref.current(Cm.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}let Pm,Im,Dm,Nm=!1,Lm=!1;function Um(e){Im=requestAnimationFrame(Um),Nm=!0,Pm=0,Em("before",e),Lm=!0;for(const n of gm.values()){var t;Dm=n.store.getState(),!Dm.internal.active||!("always"===Dm.frameloop||Dm.internal.frames>0)||null!=(t=Dm.gl.xr)&&t.isPresenting||(Pm+=Rm(e,Dm))}if(Lm=!1,Em("after",e),0===Pm)return Em("tail",e),Nm=!1,cancelAnimationFrame(Im)}function Om(e,t=1){var n;if(!e)return gm.forEach(e=>Om(e.store.getState(),t));null!=(n=e.gl.xr)&&n.isPresenting||!e.internal.active||"never"===e.frameloop||(e.internal.frames=t>1?Math.min(60,e.internal.frames+t):Lm?2:1,Nm||(Nm=!0,requestAnimationFrame(Um)))}function Fm(e,t=!0,n,r){if(t&&Em("before",e),n)Rm(e,n,r);else for(const i of gm.values())Rm(e,i.store.getState());t&&Em("after",e)}const km={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function zm(e){const{handlePointer:t}=Hf(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(km).reduce((e,n)=>({...e,[n]:t(n)}),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=e.getState();if(null==r.disconnect||r.disconnect(),n(e=>({events:{...e.events,connected:t}})),r.handlers)for(const e in r.handlers){const n=r.handlers[e],[i,a]=km[e];t.addEventListener(i,n,{passive:a})}},disconnect:()=>{const{set:t,events:n}=e.getState();if(n.connected){if(n.handlers)for(const e in n.handlers){const t=n.handlers[e],[r]=km[e];n.connected.removeEventListener(r,t)}t(e=>({events:{...e.events,connected:void 0}}))}}}}function Bm(e,t){let n;return(...r)=>{window.clearTimeout(n),n=window.setTimeout(()=>e(...r),t)}}function Vm({debounce:e,scroll:t,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=n||("undefined"==typeof window?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,o]=s.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=s.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),c=e?"number"==typeof e?e:e.scroll:null,u=e?"number"==typeof e?e:e.resize:null,h=s.useRef(!1);s.useEffect(()=>(h.current=!0,()=>{h.current=!1}));const[d,p,f]=s.useMemo(()=>{const e=()=>{if(!l.current.element)return;const{left:e,top:t,width:n,height:i,bottom:a,right:s,x:c,y:u}=l.current.element.getBoundingClientRect(),d={left:e,top:t,width:n,height:i,bottom:a,right:s,x:c,y:u};l.current.element instanceof HTMLElement&&r&&(d.height=l.current.element.offsetHeight,d.width=l.current.element.offsetWidth),Object.freeze(d),h.current&&!Gm(l.current.lastBounds,d)&&o(l.current.lastBounds=d)};return[e,u?Bm(e,u):e,c?Bm(e,c):e]},[o,r,c,u]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",f,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null),l.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",l.current.orientationHandler))}function g(){l.current.element&&(l.current.resizeObserver=new i(f),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(e=>e.addEventListener("scroll",f,{capture:!0,passive:!0})),l.current.orientationHandler=()=>{f()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",l.current.orientationHandler))}return function(e,t){s.useEffect(()=>{if(t){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[e,t])}(f,!!t),function(e){s.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[e])}(p),s.useEffect(()=>{m(),g()},[t,f,p]),s.useEffect(()=>m,[]),[e=>{!e||e===l.current.element||(m(),l.current.element=e,l.current.scrollContainers=Hm(e),g())},a,d]}function Hm(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(e);return[n,r,i].some(e=>"auto"===e||"scroll"===e)&&t.push(e),[...t,...Hm(e.parentElement)]}const jm=["x","y","top","bottom","left","right","width","height"],Gm=(e,t)=>jm.every(n=>e[n]===t[n]);function Wm({ref:e,children:t,fallback:n,resize:r,style:i,gl:a,events:o=zm,eventSource:c,eventPrefix:u,shadows:h,linear:d,flat:p,legacy:f,orthographic:m,frameloop:g,dpr:v,performance:y,raycaster:_,camera:x,scene:b,onPointerMissed:S,onCreated:M,...w}){s.useMemo(()=>nm(Cp),[]);const T=function(){const e=uf(),t=pf();return s.useMemo(()=>({children:n})=>{const r=sf(e,!0,e=>e.type===s.StrictMode)?s.StrictMode:s.Fragment;return l.jsx(r,{children:l.jsx(t,{children:n})})},[e,t])}(),[E,A]=Vm({scroll:!0,debounce:{scroll:50,resize:0},...r}),C=s.useRef(null),R=s.useRef(null);s.useImperativeHandle(e,()=>C.current);const P=yf(S),[I,D]=s.useState(!1),[N,L]=s.useState(!1);if(I)throw I;if(N)throw N;const U=s.useRef(null);vf(()=>{const e=C.current;if(A.width>0&&A.height>0&&e){async function n(){await U.current.configure({gl:a,scene:b,events:o,shadows:h,linear:d,flat:p,legacy:f,orthographic:m,frameloop:g,dpr:v,performance:y,raycaster:_,camera:x,size:A,onPointerMissed:(...e)=>null==P.current?void 0:P.current(...e),onCreated:e=>{var t;null==e.events.connect||e.events.connect(c?(t=c)&&t.hasOwnProperty("current")?c.current:c:R.current),u&&e.setEvents({compute:(e,t)=>{const n=e[u+"X"],r=e[u+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==M||M(e)}}),U.current.render(l.jsx(T,{children:l.jsx(xf,{set:L,children:l.jsx(s.Suspense,{fallback:l.jsx(_f,{set:D}),children:null!=t?t:null})})}))}U.current||(U.current=ym(e)),n()}}),s.useEffect(()=>{const e=C.current;if(e)return()=>xm(e)},[]);const O=c?"none":"auto";return l.jsx("div",{ref:R,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:O,...i},...w,children:l.jsx("div",{ref:E,style:{width:"100%",height:"100%"},children:l.jsx("canvas",{ref:C,style:{display:"block"},children:n})})})}function Xm(e){return l.jsx(cf,{children:l.jsx(Wm,{...e})})}const qm=new Kt,Ym=new Kt,Zm=new Kt,Jm=new Jt;function $m(e,t,n){const r=qm.setFromMatrixPosition(e.matrixWorld);r.project(t);const i=n.width/2,a=n.height/2;return[r.x*i+i,-r.y*a+a]}const Km=e=>Math.abs(e)<1e-10?0:e;function Qm(e,t,n=""){let r="matrix3d(";for(let i=0;16!==i;i++)r+=Km(t[i]*e.elements[i])+(15!==i?",":")");return n+r}const eg=(e=>t=>Qm(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),tg=(()=>(e,t)=>{return Qm(e,[1/(n=t),1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1],"translate(-50%,-50%)");var n})();const ng=s.forwardRef(({children:e,eps:n=.001,style:r,className:i,prepend:a,center:o,fullscreen:l,portal:u,distanceFactor:h,sprite:d=!1,transform:p=!1,occlude:f,onOcclude:m,castShadow:g,receiveShadow:v,material:y,geometry:_,zIndexRange:x=[16777271,0],calculatePosition:b=$m,as:S="div",wrapperClass:M,pointerEvents:w="auto",...T},E)=>{const{gl:A,camera:C,scene:R,size:P,raycaster:I,events:D,viewport:N}=Xf(),[L]=s.useState(()=>document.createElement(S)),U=s.useRef(null),O=s.useRef(null),F=s.useRef(0),k=s.useRef([0,0]),z=s.useRef(null),B=s.useRef(null),V=(null==u?void 0:u.current)||D.connected||A.domElement.parentNode,H=s.useRef(null),j=s.useRef(!1),G=s.useMemo(()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"==typeof e&&"current"in e}(f[0]),[f]);s.useLayoutEffect(()=>{const e=A.domElement;f&&"blending"===f?(e.style.zIndex=`${Math.floor(x[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[f]),s.useLayoutEffect(()=>{if(O.current){const e=U.current=t.createRoot(L);if(R.updateMatrixWorld(),p)L.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=b(O.current,C,P);L.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return V&&(a?V.prepend(L):V.appendChild(L)),()=>{V&&V.removeChild(L),e.unmount()}}},[V,p]),s.useLayoutEffect(()=>{M&&(L.className=M)},[M]);const W=s.useMemo(()=>p?{position:"absolute",top:0,left:0,width:P.width,height:P.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:o?"translate3d(-50%,-50%,0)":"none",...l&&{top:-P.height/2,left:-P.width/2,width:P.width,height:P.height},...r},[r,o,l,P,p]),X=s.useMemo(()=>({position:"absolute",pointerEvents:w}),[w]);s.useLayoutEffect(()=>{var t,n;(j.current=!1,p)?null==(t=U.current)||t.render(s.createElement("div",{ref:z,style:W},s.createElement("div",{ref:B,style:X},s.createElement("div",{ref:E,className:i,style:r,children:e})))):null==(n=U.current)||n.render(s.createElement("div",{ref:E,style:W,className:i,children:e}))});const q=s.useRef(!0);qf(e=>{if(O.current){C.updateMatrixWorld(),O.current.updateWorldMatrix(!0,!1);const e=p?k.current:b(O.current,C,P);if(p||Math.abs(F.current-C.zoom)>n||Math.abs(k.current[0]-e[0])>n||Math.abs(k.current[1]-e[1])>n){const t=function(e,t){const n=qm.setFromMatrixPosition(e.matrixWorld),r=Ym.setFromMatrixPosition(t.matrixWorld),i=n.sub(r),a=t.getWorldDirection(Zm);return i.angleTo(a)>Math.PI/2}(O.current,C);let n=!1;G&&(Array.isArray(f)?n=f.map(e=>e.current):"blending"!==f&&(n=[R]));const r=q.current;if(n){const e=function(e,t,n,r){const i=qm.setFromMatrixPosition(e.matrixWorld),a=i.clone();a.project(t),Jm.set(a.x,a.y),n.setFromCamera(Jm,t);const s=n.intersectObjects(r,!0);if(s.length){const e=s[0].distance;return i.distanceTo(n.ray.origin)<e}return!0}(O.current,C,I,n);q.current=e&&!t}else q.current=!t;r!==q.current&&(m?m(!q.current):L.style.display=q.current?"block":"none");const i=Math.floor(x[0]/2),a=f?G?[x[0],i]:[i-1,0]:x;if(L.style.zIndex=`${function(e,t,n){if(t instanceof ji||t instanceof bc){const r=qm.setFromMatrixPosition(e.matrixWorld),i=Ym.setFromMatrixPosition(t.matrixWorld),a=r.distanceTo(i),s=(n[1]-n[0])/(t.far-t.near),o=n[1]-s*t.far;return Math.round(s*a+o)}}(O.current,C,a)}`,p){const[e,t]=[P.width/2,P.height/2],n=C.projectionMatrix.elements[5]*t,{isOrthographicCamera:r,top:i,left:a,bottom:s,right:o}=C,l=eg(C.matrixWorldInverse),c=r?`scale(${n})translate(${Km(-(o+a)/2)}px,${Km((i+s)/2)}px)`:`translateZ(${n}px)`;let u=O.current.matrixWorld;d&&(u=C.matrixWorldInverse.clone().transpose().copyPosition(u).scale(O.current.scale),u.elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),L.style.width=P.width+"px",L.style.height=P.height+"px",L.style.perspective=r?"":`${n}px`,z.current&&B.current&&(z.current.style.transform=`${c}${l}translate(${e}px,${t}px)`,B.current.style.transform=tg(u,1/((h||10)/400)))}else{const t=void 0===h?1:function(e,t){if(t instanceof bc)return t.zoom;if(t instanceof ji){const n=qm.setFromMatrixPosition(e.matrixWorld),r=Ym.setFromMatrixPosition(t.matrixWorld),i=t.fov*Math.PI/180,a=n.distanceTo(r);return 1/(2*Math.tan(i/2)*a)}return 1}(O.current,C)*h;L.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}k.current=e,F.current=C.zoom}}if(!G&&H.current&&!j.current)if(p){if(z.current){const e=z.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=C;if(t||_)T.scale&&(Array.isArray(T.scale)?T.scale instanceof Kt?H.current.scale.copy(T.scale.clone().divideScalar(1)):H.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):H.current.scale.setScalar(1/T.scale));else{const t=(h||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;H.current.scale.set(n,r,1)}j.current=!0}}}else{const t=L.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/N.factor,n=t.clientWidth*e,r=t.clientHeight*e;H.current.scale.set(n,r,1),j.current=!0}H.current.lookAt(e.camera.position)}});const Y=s.useMemo(()=>({vertexShader:p?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "}),[p]);return s.createElement("group",c({},T,{ref:O}),f&&!G&&s.createElement("mesh",{castShadow:g,receiveShadow:v,ref:H},_||s.createElement("planeGeometry",null),y||s.createElement("shaderMaterial",{side:2,vertexShader:Y.vertexShader,fragmentShader:Y.fragmentShader})))}),rg=(()=>parseInt(m.replace(/\D+/g,"")))();var ig=Uint8Array,ag=Uint16Array,sg=Uint32Array,og=new ig([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lg=new ig([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cg=new ig([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ug=function(e,t){for(var n=new ag(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new sg(n[30]);for(r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return[n,i]},hg=ug(og,2),dg=hg[0],pg=hg[1];dg[28]=258,pg[258]=28;for(var fg=ug(lg,0)[0],mg=new ag(32768),gg=0;gg<32768;++gg){var vg=(43690&gg)>>>1|(21845&gg)<<1;vg=(61680&(vg=(52428&vg)>>>2|(13107&vg)<<2))>>>4|(3855&vg)<<4,mg[gg]=((65280&vg)>>>8|(255&vg)<<8)>>>1}var yg=function(e,t,n){for(var r=e.length,i=0,a=new ag(t);i<r;++i)++a[e[i]-1];var s,o=new ag(t);for(i=0;i<t;++i)o[i]=o[i-1]+a[i-1]<<1;if(n){s=new ag(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=o[e[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)s[mg[h]>>>l]=c}else for(s=new ag(r),i=0;i<r;++i)e[i]&&(s[i]=mg[o[e[i]-1]++]>>>15-e[i]);return s},_g=new ig(288);for(gg=0;gg<144;++gg)_g[gg]=8;for(gg=144;gg<256;++gg)_g[gg]=9;for(gg=256;gg<280;++gg)_g[gg]=7;for(gg=280;gg<288;++gg)_g[gg]=8;var xg=new ig(32);for(gg=0;gg<32;++gg)xg[gg]=5;var bg=yg(_g,9,1),Sg=yg(xg,5,1),Mg=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},wg=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},Tg=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Eg=function(e){return(e/8|0)+(7&e&&1)},Ag=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new ig(0);var i=!t||n,a=!n||n.i;n||(n={}),t||(t=new ig(3*r));var s=function(e){var n=t.length;if(e>n){var r=new ig(Math.max(2*n,e));r.set(t),t=r}},o=n.f||0,l=n.p||0,c=n.b||0,u=n.l,h=n.d,d=n.m,p=n.n,f=8*r;do{if(!u){n.f=o=wg(e,l,1);var m=wg(e,l+1,3);if(l+=3,!m){var g=e[(A=Eg(l)+4)-4]|e[A-3]<<8,v=A+g;if(v>r){if(a)throw"unexpected EOF";break}i&&s(c+g),t.set(e.subarray(A,v),c),n.b=c+=g,n.p=l=8*v;continue}if(1==m)u=bg,h=Sg,d=9,p=5;else{if(2!=m)throw"invalid block type";var y=wg(e,l,31)+257,_=wg(e,l+10,15)+4,x=y+wg(e,l+5,31)+1;l+=14;for(var b=new ig(x),S=new ig(19),M=0;M<_;++M)S[cg[M]]=wg(e,l+3*M,7);l+=3*_;var w=Mg(S),T=(1<<w)-1,E=yg(S,w,1);for(M=0;M<x;){var A,C=E[wg(e,l,T)];if(l+=15&C,(A=C>>>4)<16)b[M++]=A;else{var R=0,P=0;for(16==A?(P=3+wg(e,l,3),l+=2,R=b[M-1]):17==A?(P=3+wg(e,l,7),l+=3):18==A&&(P=11+wg(e,l,127),l+=7);P--;)b[M++]=R}}var I=b.subarray(0,y),D=b.subarray(y);d=Mg(I),p=Mg(D),u=yg(I,d,1),h=yg(D,p,1)}if(l>f){if(a)throw"unexpected EOF";break}}i&&s(c+131072);for(var N=(1<<d)-1,L=(1<<p)-1,U=l;;U=l){var O=(R=u[Tg(e,l)&N])>>>4;if((l+=15&R)>f){if(a)throw"unexpected EOF";break}if(!R)throw"invalid length/literal";if(O<256)t[c++]=O;else{if(256==O){U=l,u=null;break}var F=O-254;if(O>264){var k=og[M=O-257];F=wg(e,l,(1<<k)-1)+dg[M],l+=k}var z=h[Tg(e,l)&L],B=z>>>4;if(!z)throw"invalid distance";l+=15&z;D=fg[B];if(B>3){k=lg[B];D+=Tg(e,l)&(1<<k)-1,l+=k}if(l>f){if(a)throw"unexpected EOF";break}i&&s(c+131072);for(var V=c+F;c<V;c+=4)t[c]=t[c-D],t[c+1]=t[c+1-D],t[c+2]=t[c+2-D],t[c+3]=t[c+3-D];c=V}}n.l=u,n.p=U,n.b=c,u&&(o=1,n.m=d,n.d=h,n.n=p)}while(!o);return c==t.length?t:function(e,t,n){(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof ag?ag:e instanceof sg?sg:ig)(n-t);return r.set(e.subarray(t,n)),r}(t,0,c)},Cg=new ig(0);function Rg(e,t){return Ag((function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"}(e),e.subarray(2,-4)),t)}var Pg="undefined"!=typeof TextDecoder&&new TextDecoder;try{Pg.decode(Cg,{stream:!0})}catch(sb){}class Ig extends Ii{constructor(e,t){var n,r;const i=(a=e)&&a.isCubeTexture;var a;const s=(null!=(r=i?null==(n=e.image[0])?void 0:n.width:e.image.width)?r:1024)/4,o=Math.floor(Math.log2(s)),l=Math.pow(2,o),c=[i?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH "+1/(3*Math.max(l,112)),"#define CUBEUV_TEXEL_HEIGHT "+1/(4*l),`#define CUBEUV_MAX_MIP ${o}.0`].join("\n")+`\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <${rg>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n        `,u={map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}};super(new sl(1,16),new ki({uniforms:u,fragmentShader:c,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:2}))}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var Dg=Object.defineProperty,Ng=(e,t,n)=>(((e,t,n)=>{t in e?Dg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n),n);class Lg{constructor(){Ng(this,"_listeners")}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}var Ug=Object.defineProperty,Og=(e,t,n)=>(((e,t,n)=>{t in e?Ug(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Fg=new nr,kg=new Za,zg=Math.cos(Math.PI/180*70),Bg=(e,t)=>(e%t+t)%t;let Vg=class extends Lg{constructor(e,t){super(),Og(this,"object"),Og(this,"domElement"),Og(this,"enabled",!0),Og(this,"target",new Kt),Og(this,"minDistance",0),Og(this,"maxDistance",1/0),Og(this,"minZoom",0),Og(this,"maxZoom",1/0),Og(this,"minPolarAngle",0),Og(this,"maxPolarAngle",Math.PI),Og(this,"minAzimuthAngle",-1/0),Og(this,"maxAzimuthAngle",1/0),Og(this,"enableDamping",!1),Og(this,"dampingFactor",.05),Og(this,"enableZoom",!0),Og(this,"zoomSpeed",1),Og(this,"enableRotate",!0),Og(this,"rotateSpeed",1),Og(this,"enablePan",!0),Og(this,"panSpeed",1),Og(this,"screenSpacePanning",!0),Og(this,"keyPanSpeed",7),Og(this,"zoomToCursor",!1),Og(this,"autoRotate",!1),Og(this,"autoRotateSpeed",2),Og(this,"reverseOrbit",!1),Og(this,"reverseHorizontalOrbit",!1),Og(this,"reverseVerticalOrbit",!1),Og(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Og(this,"mouseButtons",{LEFT:g.ROTATE,MIDDLE:g.DOLLY,RIGHT:g.PAN}),Og(this,"touches",{ONE:v.ROTATE,TWO:v.DOLLY_PAN}),Og(this,"target0"),Og(this,"position0"),Og(this,"zoom0"),Og(this,"_domElementKeyEvents",null),Og(this,"getPolarAngle"),Og(this,"getAzimuthalAngle"),Og(this,"setPolarAngle"),Og(this,"setAzimuthalAngle"),Og(this,"getDistance"),Og(this,"getZoomScale"),Og(this,"listenToKeyEvents"),Og(this,"stopListenToKeyEvents"),Og(this,"saveState"),Og(this,"reset"),Og(this,"update"),Og(this,"connect"),Og(this,"dispose"),Og(this,"dollyIn"),Og(this,"dollyOut"),Og(this,"getScale"),Og(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=Bg(e,2*Math.PI),r=c.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-r);2*Math.PI-i<i&&(t<r?t+=2*Math.PI:r+=2*Math.PI),u.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=Bg(e,2*Math.PI),r=c.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-r);2*Math.PI-i<i&&(t<r?t+=2*Math.PI:r+=2*Math.PI),u.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",K),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",K),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),o=s.NONE},this.update=(()=>{const t=new Kt,i=new Kt(0,1,0),a=(new $t).setFromUnitVectors(e.up,i),p=a.clone().invert(),f=new Kt,m=new $t,g=2*Math.PI;return function(){const v=n.object.position;a.setFromUnitVectors(e.up,i),p.copy(a).invert(),t.copy(v).sub(n.target),t.applyQuaternion(a),c.setFromVector3(t),n.autoRotate&&o===s.NONE&&P(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=u.theta*n.dampingFactor,c.phi+=u.phi*n.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let y=n.minAzimuthAngle,_=n.maxAzimuthAngle;isFinite(y)&&isFinite(_)&&(y<-Math.PI?y+=g:y>Math.PI&&(y-=g),_<-Math.PI?_+=g:_>Math.PI&&(_-=g),c.theta=y<=_?Math.max(y,Math.min(_,c.theta)):c.theta>(y+_)/2?Math.max(y,c.theta):Math.min(_,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),n.zoomToCursor&&E||n.object.isOrthographicCamera?c.radius=z(c.radius):c.radius=z(c.radius*h),t.setFromSpherical(c),t.applyQuaternion(p),v.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),d.set(0,0,0));let x=!1;if(n.zoomToCursor&&E){let r=null;if(n.object instanceof ji&&n.object.isPerspectiveCamera){const e=t.length();r=z(e*h);const i=e-r;n.object.position.addScaledVector(w,i),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new Kt(T.x,T.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix(),x=!0;const i=new Kt(T.x,T.y,0);i.unproject(n.object),n.object.position.sub(i).add(e),n.object.updateMatrixWorld(),r=t.length()}else n.zoomToCursor=!1;null!==r&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(r).add(n.object.position):(Fg.origin.copy(n.object.position),Fg.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Fg.direction))<zg?e.lookAt(n.target):(kg.setFromNormalAndCoplanarPoint(n.object.up,n.target),Fg.intersectPlane(kg,n.target))))}else n.object instanceof bc&&n.object.isOrthographicCamera&&(x=1!==h,x&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix()));return h=1,E=!1,!!(x||f.distanceToSquared(n.object.position)>l||8*(1-m.dot(n.object.quaternion))>l)&&(n.dispatchEvent(r),f.copy(n.object.position),m.copy(n.object.quaternion),x=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Q),n.domElement.addEventListener("pointerdown",Y),n.domElement.addEventListener("pointercancel",J),n.domElement.addEventListener("wheel",$)},this.dispose=()=>{var e,t,r,i,a,s;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",Q),null==(t=n.domElement)||t.removeEventListener("pointerdown",Y),null==(r=n.domElement)||r.removeEventListener("pointercancel",J),null==(i=n.domElement)||i.removeEventListener("wheel",$),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointermove",Z),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointerup",J),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",K)};const n=this,r={type:"change"},i={type:"start"},a={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=s.NONE;const l=1e-6,c=new gu,u=new gu;let h=1;const d=new Kt,p=new Jt,f=new Jt,m=new Jt,y=new Jt,_=new Jt,x=new Jt,b=new Jt,S=new Jt,M=new Jt,w=new Kt,T=new Jt;let E=!1;const A=[],C={};function R(){return Math.pow(.95,n.zoomSpeed)}function P(e){n.reverseOrbit||n.reverseHorizontalOrbit?u.theta+=e:u.theta-=e}function I(e){n.reverseOrbit||n.reverseVerticalOrbit?u.phi+=e:u.phi-=e}const D=(()=>{const e=new Kt;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),d.add(e)}})(),N=(()=>{const e=new Kt;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),d.add(e)}})(),L=(()=>{const e=new Kt;return function(t,r){const i=n.domElement;if(i&&n.object instanceof ji&&n.object.isPerspectiveCamera){const a=n.object.position;e.copy(a).sub(n.target);let s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180),D(2*t*s/i.clientHeight,n.object.matrix),N(2*r*s/i.clientHeight,n.object.matrix)}else i&&n.object instanceof bc&&n.object.isOrthographicCamera?(D(t*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),N(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):n.enablePan=!1}})();function U(e){n.object instanceof ji&&n.object.isPerspectiveCamera||n.object instanceof bc&&n.object.isOrthographicCamera?h=e:n.enableZoom=!1}function O(e){U(h/e)}function F(e){U(h*e)}function k(e){if(!n.zoomToCursor||!n.domElement)return;E=!0;const t=n.domElement.getBoundingClientRect(),r=e.clientX-t.left,i=e.clientY-t.top,a=t.width,s=t.height;T.x=r/a*2-1,T.y=-i/s*2+1,w.set(T.x,T.y,1).unproject(n.object).sub(n.object.position).normalize()}function z(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function B(e){p.set(e.clientX,e.clientY)}function V(e){y.set(e.clientX,e.clientY)}function H(){if(1==A.length)p.set(A[0].pageX,A[0].pageY);else{const e=.5*(A[0].pageX+A[1].pageX),t=.5*(A[0].pageY+A[1].pageY);p.set(e,t)}}function j(){if(1==A.length)y.set(A[0].pageX,A[0].pageY);else{const e=.5*(A[0].pageX+A[1].pageX),t=.5*(A[0].pageY+A[1].pageY);y.set(e,t)}}function G(){const e=A[0].pageX-A[1].pageX,t=A[0].pageY-A[1].pageY,n=Math.sqrt(e*e+t*t);b.set(0,n)}function W(e){if(1==A.length)f.set(e.pageX,e.pageY);else{const t=te(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);f.set(n,r)}m.subVectors(f,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(P(2*Math.PI*m.x/t.clientHeight),I(2*Math.PI*m.y/t.clientHeight)),p.copy(f)}function X(e){if(1==A.length)_.set(e.pageX,e.pageY);else{const t=te(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);_.set(n,r)}x.subVectors(_,y).multiplyScalar(n.panSpeed),L(x.x,x.y),y.copy(_)}function q(e){const t=te(e),r=e.pageX-t.x,i=e.pageY-t.y,a=Math.sqrt(r*r+i*i);S.set(0,a),M.set(0,Math.pow(S.y/b.y,n.zoomSpeed)),O(M.y),b.copy(S)}function Y(e){var t,r;!1!==n.enabled&&(0===A.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",Z),null==(r=n.domElement)||r.ownerDocument.addEventListener("pointerup",J)),function(e){A.push(e)}(e),"touch"===e.pointerType?function(e){switch(ee(e),A.length){case 1:switch(n.touches.ONE){case v.ROTATE:if(!1===n.enableRotate)return;H(),o=s.TOUCH_ROTATE;break;case v.PAN:if(!1===n.enablePan)return;j(),o=s.TOUCH_PAN;break;default:o=s.NONE}break;case 2:switch(n.touches.TWO){case v.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&G(),n.enablePan&&j(),o=s.TOUCH_DOLLY_PAN;break;case v.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&G(),n.enableRotate&&H(),o=s.TOUCH_DOLLY_ROTATE;break;default:o=s.NONE}break;default:o=s.NONE}o!==s.NONE&&n.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case g.DOLLY:if(!1===n.enableZoom)return;!function(e){k(e),b.set(e.clientX,e.clientY)}(e),o=s.DOLLY;break;case g.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;V(e),o=s.PAN}else{if(!1===n.enableRotate)return;B(e),o=s.ROTATE}break;case g.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;B(e),o=s.ROTATE}else{if(!1===n.enablePan)return;V(e),o=s.PAN}break;default:o=s.NONE}o!==s.NONE&&n.dispatchEvent(i)}(e))}function Z(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(ee(e),o){case s.TOUCH_ROTATE:if(!1===n.enableRotate)return;W(e),n.update();break;case s.TOUCH_PAN:if(!1===n.enablePan)return;X(e),n.update();break;case s.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&q(e),n.enablePan&&X(e)}(e),n.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&q(e),n.enableRotate&&W(e)}(e),n.update();break;default:o=s.NONE}}(e):function(e){if(!1===n.enabled)return;switch(o){case s.ROTATE:if(!1===n.enableRotate)return;!function(e){f.set(e.clientX,e.clientY),m.subVectors(f,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(P(2*Math.PI*m.x/t.clientHeight),I(2*Math.PI*m.y/t.clientHeight)),p.copy(f),n.update()}(e);break;case s.DOLLY:if(!1===n.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),M.subVectors(S,b),M.y>0?O(R()):M.y<0&&F(R()),b.copy(S),n.update()}(e);break;case s.PAN:if(!1===n.enablePan)return;!function(e){_.set(e.clientX,e.clientY),x.subVectors(_,y).multiplyScalar(n.panSpeed),L(x.x,x.y),y.copy(_),n.update()}(e)}}(e))}function J(e){var t,r,i;!function(e){delete C[e.pointerId];for(let t=0;t<A.length;t++)if(A[t].pointerId==e.pointerId)return void A.splice(t,1)}(e),0===A.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",Z),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointerup",J)),n.dispatchEvent(a),o=s.NONE}function $(e){!1===n.enabled||!1===n.enableZoom||o!==s.NONE&&o!==s.ROTATE||(e.preventDefault(),n.dispatchEvent(i),function(e){k(e),e.deltaY<0?F(R()):e.deltaY>0&&O(R()),n.update()}(e),n.dispatchEvent(a))}function K(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:L(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:L(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:L(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:L(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function Q(e){!1!==n.enabled&&e.preventDefault()}function ee(e){let t=C[e.pointerId];void 0===t&&(t=new Jt,C[e.pointerId]=t),t.set(e.pageX,e.pageY)}function te(e){const t=e.pointerId===A[0].pointerId?A[1]:A[0];return C[t.pointerId]}this.dollyIn=(e=R())=>{F(e),n.update()},this.dollyOut=(e=R())=>{O(e),n.update()},this.getScale=()=>h,this.setScale=e=>{U(e),n.update()},this.getZoomScale=()=>R(),void 0!==t&&this.connect(t),this.update()}};const Hg={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},jg={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "};class Gg extends oc{constructor(e){super(e),this.type=ye}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,n){t=t||1024;let r=e.pos,i=-1,a=0,s="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(i=o.indexOf("\n"))&&a<t&&r<e.byteLength;)s+=o,a+=o.length,r+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<i&&(e.pos+=a+i+1,s+o.slice(0,i))},r=function(e,t,n,r){const i=e[t+3],a=Math.pow(2,i-128)/255;n[r+0]=e[t+0]*a,n[r+1]=e[t+1]*a,n[r+2]=e[t+2]*a,n[r+3]=1},i=function(e,t,n,r){const i=e[t+3],a=Math.pow(2,i-128)/255;n[r+0]=ii.toHalfFloat(Math.min(e[t+0]*a,65504)),n[r+1]=ii.toHalfFloat(Math.min(e[t+1]*a,65504)),n[r+2]=ii.toHalfFloat(Math.min(e[t+2]*a,65504)),n[r+3]=ii.toHalfFloat(1)},a=new Uint8Array(e);a.pos=0;const s=function(e){const r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,o={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((e.pos>=e.byteLength||!(l=n(e)))&&t(1,"no header found"),(c=l.match(/^#\?(\S+)/))||t(3,"bad initial token"),o.valid|=1,o.programtype=c[1],o.string+=l+"\n";l=n(e),!1!==l;)if(o.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(r))&&(o.gamma=parseFloat(c[1])),(c=l.match(i))&&(o.exposure=parseFloat(c[1])),(c=l.match(a))&&(o.valid|=2,o.format=c[1]),(c=l.match(s))&&(o.valid|=4,o.height=parseInt(c[1],10),o.width=parseInt(c[2],10)),2&o.valid&&4&o.valid)break}else o.comments+=l+"\n";return 2&o.valid||t(3,"missing format specifier"),4&o.valid||t(3,"missing image size specifier"),o}(a),o=s.width,l=s.height,c=function(e,n,r){const i=n;if(i<8||i>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);i!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const a=new Uint8Array(4*n*r);a.length||t(4,"unable to allocate buffer space");let s=0,o=0;const l=4*i,c=new Uint8Array(4),u=new Uint8Array(l);let h=r;for(;h>0&&o<e.byteLength;){o+4>e.byteLength&&t(1),c[0]=e[o++],c[1]=e[o++],c[2]=e[o++],c[3]=e[o++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==i||t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&o<e.byteLength;){n=e[o++];const i=n>128;if(i&&(n-=128),(0===n||r+n>l)&&t(3,"bad scanline data"),i){const t=e[o++];for(let e=0;e<n;e++)u[r++]=t}else u.set(e.subarray(o,o+n),r),r+=n,o+=n}const d=i;for(let e=0;e<d;e++){let t=0;a[s]=u[e+t],t+=i,a[s+1]=u[e+t],t+=i,a[s+2]=u[e+t],t+=i,a[s+3]=u[e+t],s+=4}h--}return a}(a.subarray(a.pos),o,l);let u,h,d;switch(this.type){case ve:d=c.length/4;const e=new Float32Array(4*d);for(let n=0;n<d;n++)r(c,4*n,e,4*n);u=e,h=ve;break;case ye:d=c.length/4;const t=new Uint16Array(4*d);for(let n=0;n<d;n++)i(c,4*n,t,4*n);u=t,h=ye;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:o,height:l,data:u,header:s.string,gamma:s.gamma,exposure:s.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){switch(e.type){case ve:case ye:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=oe,e.magFilter=oe,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)},n,r)}}const Wg=rg>=152;class Xg extends oc{constructor(e){super(e),this.type=ye}parse(e){const t=65536,n=14,r=65537,i=16384,a=Math.pow(2.7182818,2.2);const s={l:0,c:0,lc:0};function o(e,t,n,r,i){for(;n<e;)t=t<<8|V(r,i),n+=8;n-=e,s.l=t>>n&(1<<e)-1,s.c=t,s.lc=n}const l=new Array(59);function c(e,t,n,i,a,c,u){for(var h=n,d=0,p=0;a<=c;a++){if(h.value-n.value>i)return!1;o(6,d,p,e,h);var f=s.l;if(d=s.c,p=s.lc,u[a]=f,63==f){if(h.value-n.value>i)throw"Something wrong with hufUnpackEncTable";o(8,d,p,e,h);var m=s.l+6;if(d=s.c,p=s.lc,a+m>c+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)u[a++]=0;a--}else if(f>=59){if(a+(m=f-59+2)>c+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)u[a++]=0;a--}}!function(e){for(var t=0;t<=58;++t)l[t]=0;for(t=0;t<r;++t)l[e[t]]+=1;var n=0;for(t=58;t>0;--t){var i=n+l[t]>>1;l[t]=n,n=i}for(t=0;t<r;++t){var a=e[t];a>0&&(e[t]=a|l[a]++<<6)}}(u)}function u(e){return 63&e}function h(e){return e>>6}const d={c:0,lc:0};function p(e,t,n,r){e=e<<8|V(n,r),t+=8,d.c=e,d.lc=t}const f={c:0,lc:0};function m(e,t,n,r,i,a,s,o,l,c){if(e==t){r<8&&(p(n,r,i,s),n=d.c,r=d.lc);var u=n>>(r-=8);u=new Uint8Array([u])[0];if(l.value+u>c)return!1;for(var h=o[l.value-1];u-- >0;)o[l.value++]=h}else{if(!(l.value<c))return!1;o[l.value++]=e}f.c=n,f.lc=r}function g(e){return 65535&e}function v(e){var t=g(e);return t>32767?t-65536:t}const y={a:0,b:0};function _(e,t){var n=v(e),r=v(t),i=n+(1&r)+(r>>1),a=i,s=i-r;y.a=a,y.b=s}function x(e,t){var n=g(e),r=g(t),i=n-(r>>1)&65535,a=r+i-32768&65535;y.a=a,y.b=i}function b(e,t,n,r,i,a,s){for(var o,l=s<16384,c=n>i?i:n,u=1;u<=c;)u<<=1;for(o=u>>=1,u>>=1;u>=1;){for(var h,d,p,f,m=0,g=m+a*(i-o),v=a*u,b=a*o,S=r*u,M=r*o;m<=g;m+=b){for(var w=m,T=m+r*(n-o);w<=T;w+=M){var E=w+S,A=(C=w+v)+S;l?(_(e[w+t],e[C+t]),h=y.a,p=y.b,_(e[E+t],e[A+t]),d=y.a,f=y.b,_(h,d),e[w+t]=y.a,e[E+t]=y.b,_(p,f),e[C+t]=y.a,e[A+t]=y.b):(x(e[w+t],e[C+t]),h=y.a,p=y.b,x(e[E+t],e[A+t]),d=y.a,f=y.b,x(h,d),e[w+t]=y.a,e[E+t]=y.b,x(p,f),e[C+t]=y.a,e[A+t]=y.b)}if(n&u){var C=w+v;l?_(e[w+t],e[C+t]):x(e[w+t],e[C+t]),h=y.a,e[C+t]=y.b,e[w+t]=h}}if(i&u)for(w=m,T=m+r*(n-o);w<=T;w+=M){E=w+S;l?_(e[w+t],e[E+t]):x(e[w+t],e[E+t]),h=y.a,e[E+t]=y.b,e[w+t]=h}o=u,u>>=1}return m}function S(e,t,a,s,o,l){var g=a.value,v=B(t,a),y=B(t,a);a.value+=4;var _=B(t,a);if(a.value+=4,v<0||v>=r||y<0||y>=r)throw"Something wrong with HUF_ENCSIZE";var x=new Array(r),b=new Array(i);if(function(e){for(var t=0;t<i;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(b),c(e,0,a,s-(a.value-g),v,y,x),_>8*(s-(a.value-g)))throw"Something wrong with hufUncompress";!function(e,t,r,i){for(;t<=r;t++){var a=h(e[t]),s=u(e[t]);if(a>>s)throw"Invalid table entry";if(s>n){if((d=i[a>>s-n]).len)throw"Invalid table entry";if(d.lit++,d.p){var o=d.p;d.p=new Array(d.lit);for(var l=0;l<d.lit-1;++l)d.p[l]=o[l]}else d.p=new Array(1);d.p[d.lit-1]=t}else if(s){var c=0;for(l=1<<n-s;l>0;l--){var d;if((d=i[(a<<n-s)+c]).len||d.p)throw"Invalid table entry";d.len=s,d.lit=t,c++}}}}(x,v,y,b),function(e,t,r,i,a,s,o,l,c,g){for(var v=0,y=0,_=l,x=Math.trunc(a.value+(s+7)/8);a.value<x;)for(p(v,y,r,a),v=d.c,y=d.lc;y>=n;)if((w=t[v>>y-n&16383]).len)y-=w.len,m(w.lit,o,v,y,r,0,a,c,g,_),v=f.c,y=f.lc;else{if(!w.p)throw"hufDecode issues";var b;for(b=0;b<w.lit;b++){for(var S=u(e[w.p[b]]);y<S&&a.value<x;)p(v,y,r,a),v=d.c,y=d.lc;if(y>=S&&h(e[w.p[b]])==(v>>y-S&(1<<S)-1)){y-=S,m(w.p[b],o,v,y,r,0,a,c,g,_),v=f.c,y=f.lc;break}}if(b==w.lit)throw"hufDecode issues"}var M=8-s&7;for(v>>=M,y-=M;y>0;){var w;if(!(w=t[v<<n-y&16383]).len)throw"hufDecode issues";y-=w.len,m(w.lit,o,v,y,r,0,a,c,g,_),v=f.c,y=f.lc}}(x,b,e,0,a,_,y,l,o,{value:0})}function M(e){for(var t=1;t<e.length;t++){var n=e[t-1]+e[t]-128;e[t]=n}}function w(e,t){for(var n=0,r=Math.floor((e.length+1)/2),i=0,a=e.length-1;!(i>a||(t[i++]=e[n++],i>a));)t[i++]=e[r++]}function T(e){for(var t=e.byteLength,n=new Array,r=0,i=new DataView(e);t>0;){var a=i.getInt8(r++);if(a<0){t-=(o=-a)+1;for(var s=0;s<o;s++)n.push(i.getUint8(r++))}else{var o=a;t-=2;var l=i.getUint8(r++);for(s=0;s<o+1;s++)n.push(l)}}return n}function E(e,t,n){for(var r,i=1;i<64;)65280==(r=t[e.value])?i=64:r>>8==255?i+=255&r:(n[i]=r,i++),e.value++}function A(e,t){t[0]=X(e[0]),t[1]=X(e[1]),t[2]=X(e[5]),t[3]=X(e[6]),t[4]=X(e[14]),t[5]=X(e[15]),t[6]=X(e[27]),t[7]=X(e[28]),t[8]=X(e[2]),t[9]=X(e[4]),t[10]=X(e[7]),t[11]=X(e[13]),t[12]=X(e[16]),t[13]=X(e[26]),t[14]=X(e[29]),t[15]=X(e[42]),t[16]=X(e[3]),t[17]=X(e[8]),t[18]=X(e[12]),t[19]=X(e[17]),t[20]=X(e[25]),t[21]=X(e[30]),t[22]=X(e[41]),t[23]=X(e[43]),t[24]=X(e[9]),t[25]=X(e[11]),t[26]=X(e[18]),t[27]=X(e[24]),t[28]=X(e[31]),t[29]=X(e[40]),t[30]=X(e[44]),t[31]=X(e[53]),t[32]=X(e[10]),t[33]=X(e[19]),t[34]=X(e[23]),t[35]=X(e[32]),t[36]=X(e[39]),t[37]=X(e[45]),t[38]=X(e[52]),t[39]=X(e[54]),t[40]=X(e[20]),t[41]=X(e[22]),t[42]=X(e[33]),t[43]=X(e[38]),t[44]=X(e[46]),t[45]=X(e[51]),t[46]=X(e[55]),t[47]=X(e[60]),t[48]=X(e[21]),t[49]=X(e[34]),t[50]=X(e[37]),t[51]=X(e[47]),t[52]=X(e[50]),t[53]=X(e[56]),t[54]=X(e[59]),t[55]=X(e[61]),t[56]=X(e[35]),t[57]=X(e[36]),t[58]=X(e[48]),t[59]=X(e[49]),t[60]=X(e[57]),t[61]=X(e[58]),t[62]=X(e[62]),t[63]=X(e[63])}function C(e){const t=.5*Math.cos(.7853975),n=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),i=.5*Math.cos(3*3.14159/16),a=.5*Math.cos(.981746875),s=.5*Math.cos(3*3.14159/8),o=.5*Math.cos(1.374445625);for(var l=new Array(4),c=new Array(4),u=new Array(4),h=new Array(4),d=0;d<8;++d){var p=8*d;l[0]=r*e[p+2],l[1]=s*e[p+2],l[2]=r*e[p+6],l[3]=s*e[p+6],c[0]=n*e[p+1]+i*e[p+3]+a*e[p+5]+o*e[p+7],c[1]=i*e[p+1]-o*e[p+3]-n*e[p+5]-a*e[p+7],c[2]=a*e[p+1]-n*e[p+3]+o*e[p+5]+i*e[p+7],c[3]=o*e[p+1]-a*e[p+3]+i*e[p+5]-n*e[p+7],u[0]=t*(e[p+0]+e[p+4]),u[3]=t*(e[p+0]-e[p+4]),u[1]=l[0]+l[3],u[2]=l[1]-l[2],h[0]=u[0]+u[1],h[1]=u[3]+u[2],h[2]=u[3]-u[2],h[3]=u[0]-u[1],e[p+0]=h[0]+c[0],e[p+1]=h[1]+c[1],e[p+2]=h[2]+c[2],e[p+3]=h[3]+c[3],e[p+4]=h[3]-c[3],e[p+5]=h[2]-c[2],e[p+6]=h[1]-c[1],e[p+7]=h[0]-c[0]}for(var f=0;f<8;++f)l[0]=r*e[16+f],l[1]=s*e[16+f],l[2]=r*e[48+f],l[3]=s*e[48+f],c[0]=n*e[8+f]+i*e[24+f]+a*e[40+f]+o*e[56+f],c[1]=i*e[8+f]-o*e[24+f]-n*e[40+f]-a*e[56+f],c[2]=a*e[8+f]-n*e[24+f]+o*e[40+f]+i*e[56+f],c[3]=o*e[8+f]-a*e[24+f]+i*e[40+f]-n*e[56+f],u[0]=t*(e[f]+e[32+f]),u[3]=t*(e[f]-e[32+f]),u[1]=l[0]+l[3],u[2]=l[1]-l[2],h[0]=u[0]+u[1],h[1]=u[3]+u[2],h[2]=u[3]-u[2],h[3]=u[0]-u[1],e[0+f]=h[0]+c[0],e[8+f]=h[1]+c[1],e[16+f]=h[2]+c[2],e[24+f]=h[3]+c[3],e[32+f]=h[3]-c[3],e[40+f]=h[2]-c[2],e[48+f]=h[1]-c[1],e[56+f]=h[0]-c[0]}function R(e){for(var t=0;t<64;++t){var n=e[0][t],r=e[1][t],i=e[2][t];e[0][t]=n+1.5747*i,e[1][t]=n-.1873*r-.4682*i,e[2][t]=n+1.8556*r}}function P(e,t,n){for(var r=0;r<64;++r)t[n+r]=ii.toHalfFloat(I(e[r]))}function I(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(a,Math.abs(e)-1)}function D(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function N(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),n=new Uint8Array(T(t)),r=new Uint8Array(n.length);return M(n),w(n,r),new DataView(r.buffer)}function L(e){var t=Rg(e.array.slice(e.offset.value,e.offset.value+e.size)),n=new Uint8Array(t.length);return M(t),w(t,n),new DataView(n.buffer)}function U(e){for(var n=e.viewer,r={value:e.offset.value},i=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),a=new Uint8Array(8192),s=0,o=new Array(e.channels),l=0;l<e.channels;l++)o[l]={},o[l].start=s,o[l].end=o[l].start,o[l].nx=e.width,o[l].ny=e.lines,o[l].size=e.type,s+=o[l].nx*o[l].ny*o[l].size;var c=q(n,r),u=q(n,r);if(u>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=u)for(l=0;l<u-c+1;l++)a[l+c]=H(n,r);var h=new Uint16Array(t),d=function(e,n){for(var r=0,i=0;i<t;++i)(0==i||e[i>>3]&1<<(7&i))&&(n[r++]=i);for(var a=r-1;r<t;)n[r++]=0;return a}(a,h),p=B(n,r);S(e.array,n,r,p,i,s);for(l=0;l<e.channels;++l)for(var f=o[l],m=0;m<o[l].size;++m)b(i,f.start+m,f.nx,f.size,f.ny,f.nx*f.size,d);!function(e,t,n){for(var r=0;r<n;++r)t[r]=e[t[r]]}(h,i,s);for(var g=0,v=new Uint8Array(i.buffer.byteLength),y=0;y<e.lines;y++)for(var _=0;_<e.channels;_++){var x=(f=o[_]).nx*f.size,M=new Uint8Array(i.buffer,2*f.end,2*x);v.set(M,g),g+=2*x,f.end+=x}return new DataView(v.buffer)}function O(e){var t=Rg(e.array.slice(e.offset.value,e.offset.value+e.size));const n=e.lines*e.channels*e.width,r=1==e.type?new Uint16Array(n):new Uint32Array(n);let i=0,a=0;const s=new Array(4);for(let o=0;o<e.lines;o++)for(let n=0;n<e.channels;n++){let n=0;switch(e.type){case 1:s[0]=i,s[1]=s[0]+e.width,i=s[1]+e.width;for(let i=0;i<e.width;++i){n+=t[s[0]++]<<8|t[s[1]++],r[a]=n,a++}break;case 2:s[0]=i,s[1]=s[0]+e.width,s[2]=s[1]+e.width,i=s[2]+e.width;for(let i=0;i<e.width;++i){n+=t[s[0]++]<<24|t[s[1]++]<<16|t[s[2]++]<<8,r[a]=n,a++}}}return new DataView(r.buffer)}function F(e){var t=e.viewer,n={value:e.offset.value},r=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),i={version:j(t,n),unknownUncompressedSize:j(t,n),unknownCompressedSize:j(t,n),acCompressedSize:j(t,n),dcCompressedSize:j(t,n),rleCompressedSize:j(t,n),rleUncompressedSize:j(t,n),rleRawSize:j(t,n),totalAcUncompressedCount:j(t,n),totalDcUncompressedCount:j(t,n),acCompression:j(t,n)};if(i.version<2)throw"EXRLoader.parse: "+Q.compression+" version "+i.version+" is unsupported";for(var a=new Array,s=q(t,n)-2;s>0;){var o=k(t.buffer,n),l=H(t,n),c=l>>2&3,u=new Int8Array([(l>>4)-1])[0],h=H(t,n);a.push({name:o,index:u,type:h,compression:c}),s-=o.length+3}for(var d=Q.channels,p=new Array(e.channels),f=0;f<e.channels;++f){var m=p[f]={},g=d[f];m.name=g.name,m.compression=0,m.decoded=!1,m.type=g.pixelType,m.pLinear=g.pLinear,m.width=e.width,m.height=e.lines}for(var v={idx:new Array(3)},y=0;y<e.channels;++y)for(m=p[y],f=0;f<a.length;++f){var _=a[f];m.name==_.name&&(m.compression=_.compression,_.index>=0&&(v.idx[_.index]=y),m.offset=y)}if(i.acCompressedSize>0)switch(i.acCompression){case 0:var x=new Uint16Array(i.totalAcUncompressedCount);S(e.array,t,n,i.acCompressedSize,x,i.totalAcUncompressedCount);break;case 1:var b=Rg(e.array.slice(n.value,n.value+i.totalAcUncompressedCount));x=new Uint16Array(b.buffer);n.value+=i.totalAcUncompressedCount}if(i.dcCompressedSize>0){var M={array:e.array,offset:n,size:i.dcCompressedSize},w=new Uint16Array(L(M).buffer);n.value+=i.dcCompressedSize}if(i.rleRawSize>0){var I=T((b=Rg(e.array.slice(n.value,n.value+i.rleCompressedSize))).buffer);n.value+=i.rleCompressedSize}var D=0,N=new Array(p.length);for(f=0;f<N.length;++f)N[f]=new Array;for(var U=0;U<e.lines;++U)for(var O=0;O<p.length;++O)N[O].push(D),D+=p[O].width*e.type*2;!function(e,t,n,r,i,a){var s=new DataView(a.buffer),o=n[e.idx[0]].width,l=n[e.idx[0]].height,c=Math.floor(o/8),u=Math.ceil(o/8),h=Math.ceil(l/8),d=o-8*(u-1),p=l-8*(h-1),f={value:0},m=new Array(3),g=new Array(3),v=new Array(3),y=new Array(3),_=new Array(3);for(let E=0;E<3;++E)_[E]=t[e.idx[E]],m[E]=E<1?0:m[E-1]+u*h,g[E]=new Float32Array(64),v[E]=new Uint16Array(64),y[E]=new Uint16Array(64*u);for(let D=0;D<h;++D){var x=8;D==h-1&&(x=p);var b=8;for(let e=0;e<u;++e){e==u-1&&(b=d);for(let e=0;e<3;++e)v[e].fill(0),v[e][0]=i[m[e]++],E(f,r,v[e]),A(v[e],g[e]),C(g[e]);R(g);for(let t=0;t<3;++t)P(g[t],y[t],64*e)}let t=0;for(let r=0;r<3;++r){const i=n[e.idx[r]].type;for(let e=8*D;e<8*D+x;++e){t=_[r][e];for(let n=0;n<c;++n){const a=64*n+8*(7&e);s.setUint16(t+0*i,y[r][a+0],!0),s.setUint16(t+2*i,y[r][a+1],!0),s.setUint16(t+4*i,y[r][a+2],!0),s.setUint16(t+6*i,y[r][a+3],!0),s.setUint16(t+8*i,y[r][a+4],!0),s.setUint16(t+10*i,y[r][a+5],!0),s.setUint16(t+12*i,y[r][a+6],!0),s.setUint16(t+14*i,y[r][a+7],!0),t+=16*i}}if(c!=u)for(let e=8*D;e<8*D+x;++e){const t=_[r][e]+8*c*2*i,n=64*c+8*(7&e);for(let e=0;e<b;++e)s.setUint16(t+2*e*i,y[r][n+e],!0)}}}for(var S=new Uint16Array(o),M=(s=new DataView(a.buffer),0);M<3;++M){n[e.idx[M]].decoded=!0;var w=n[e.idx[M]].type;if(2==n[M].type)for(var T=0;T<l;++T){const e=_[M][T];for(var I=0;I<o;++I)S[I]=s.getUint16(e+2*I*w,!0);for(I=0;I<o;++I)s.setFloat32(e+2*I*w,X(S[I]),!0)}}}(v,N,p,x,w,r);for(f=0;f<p.length;++f){if(!(m=p[f]).decoded){if(2!==m.compression)throw"EXRLoader.parse: unsupported channel compression";var F=0,z=0;for(U=0;U<e.lines;++U){for(var B=N[f][F],V=0;V<m.width;++V){for(var G=0;G<2*m.type;++G)r[B++]=I[z+G*m.width*m.height];z++}F++}}}return new DataView(r.buffer)}function k(e,t){for(var n=new Uint8Array(e),r=0;0!=n[t.value+r];)r+=1;var i=(new TextDecoder).decode(n.slice(t.value,t.value+r));return t.value=t.value+r+1,i}function z(e,t){var n=e.getInt32(t.value,!0);return t.value=t.value+4,n}function B(e,t){var n=e.getUint32(t.value,!0);return t.value=t.value+4,n}function V(e,t){var n=e[t.value];return t.value=t.value+1,n}function H(e,t){var n=e.getUint8(t.value);return t.value=t.value+1,n}const j=function(e,t){let n;return n="getBigInt64"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,n};function G(e,t){var n=e.getFloat32(t.value,!0);return t.value+=4,n}function W(e,t){return ii.toHalfFloat(G(e,t))}function X(e){var t=(31744&e)>>10,n=1023&e;return(e>>15?-1:1)*(t?31===t?n?NaN:1/0:Math.pow(2,t-15)*(1+n/1024):n/1024*6103515625e-14)}function q(e,t){var n=e.getUint16(t.value,!0);return t.value+=2,n}function Y(e,t){return X(q(e,t))}function Z(e,t,n,r,i){return"string"===r||"stringvector"===r||"iccProfile"===r?function(e,t,n){var r=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+n));return t.value=t.value+n,r}(t,n,i):"chlist"===r?function(e,t,n,r){for(var i=n.value,a=[];n.value<i+r-1;){var s=k(t,n),o=z(e,n),l=H(e,n);n.value+=3;var c=z(e,n),u=z(e,n);a.push({name:s,pixelType:o,pLinear:l,xSampling:c,ySampling:u})}return n.value+=1,a}(e,t,n,i):"chromaticities"===r?function(e,t){return{redX:G(e,t),redY:G(e,t),greenX:G(e,t),greenY:G(e,t),blueX:G(e,t),blueY:G(e,t),whiteX:G(e,t),whiteY:G(e,t)}}(e,n):"compression"===r?function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][H(e,t)]}(e,n):"box2i"===r?function(e,t){return{xMin:B(e,t),yMin:B(e,t),xMax:B(e,t),yMax:B(e,t)}}(e,n):"lineOrder"===r?function(e,t){return["INCREASING_Y"][H(e,t)]}(e,n):"float"===r?G(e,n):"v2f"===r?function(e,t){return[G(e,t),G(e,t)]}(e,n):"v3f"===r?function(e,t){return[G(e,t),G(e,t),G(e,t)]}(e,n):"int"===r?z(e,n):"rational"===r?function(e,t){return[z(e,t),B(e,t)]}(e,n):"timecode"===r?function(e,t){return[B(e,t),B(e,t)]}(e,n):"preview"===r?(n.value+=i,"skipped"):void(n.value+=i)}const J=new DataView(e),$=new Uint8Array(e),K={value:0},Q=function(e,t,n){const r={};if(20000630!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";r.version=e.getUint8(4);const i=e.getUint8(5);r.spec={singleTile:!!(2&i),longName:!!(4&i),deepFormat:!!(8&i),multiPart:!!(16&i)},n.value=8;for(var a=!0;a;){var s=k(t,n);if(0==s)a=!1;else{var o=Z(e,t,n,k(t,n),B(e,n));void 0===o||(r[s]=o)}}if(-5&i)throw"THREE.EXRLoader: provided file is currently unsupported.";return r}(J,e,K),ee=function(e,t,n,r,i){const a={size:0,viewer:t,array:n,offset:r,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[Wg?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":a.lines=1,a.uncompress=D;break;case"RLE_COMPRESSION":a.lines=1,a.uncompress=N;break;case"ZIPS_COMPRESSION":a.lines=1,a.uncompress=L;break;case"ZIP_COMPRESSION":a.lines=16,a.uncompress=L;break;case"PIZ_COMPRESSION":a.lines=32,a.uncompress=U;break;case"PXR24_COMPRESSION":a.lines=16,a.uncompress=O;break;case"DWAA_COMPRESSION":a.lines=32,a.uncompress=F;break;case"DWAB_COMPRESSION":a.lines=256,a.uncompress=F;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(a.scanlineBlockSize=a.lines,1==a.type)switch(i){case ve:a.getter=Y,a.inputSize=2;break;case ye:a.getter=q,a.inputSize=2}else{if(2!=a.type)throw"EXRLoader.parse: unsupported pixelType "+a.type+" for "+e.compression+".";switch(i){case ve:a.getter=G,a.inputSize=4;break;case ye:a.getter=W,a.inputSize=4}}a.blockCount=(e.dataWindow.yMax+1)/a.scanlineBlockSize;for(var s=0;s<a.blockCount;s++)j(t,r);a.outputChannels=3==a.channels?4:a.channels;const o=a.width*a.height*a.outputChannels;switch(i){case ve:a.byteArray=new Float32Array(o),a.channels<a.outputChannels&&a.byteArray.fill(1,0,o);break;case ye:a.byteArray=new Uint16Array(o),a.channels<a.outputChannels&&a.byteArray.fill(15360,0,o)}return a.bytesPerLine=a.width*a.inputSize*a.channels,4==a.outputChannels?a.format=Ee:a.format=Re,Wg?a.colorSpace="srgb-linear":a.encoding=3e3,a}(Q,J,$,K,this.type),te={value:0},ne={R:0,G:1,B:2,A:3,Y:0};for(let re=0;re<ee.height/ee.scanlineBlockSize;re++){const e=B(J,K);ee.size=B(J,K),ee.lines=e+ee.scanlineBlockSize>ee.height?ee.height-e:ee.scanlineBlockSize;const t=ee.size<ee.lines*ee.bytesPerLine?ee.uncompress(ee):D(ee);K.value+=ee.size;for(let n=0;n<ee.scanlineBlockSize;n++){const e=n+re*ee.scanlineBlockSize;if(e>=ee.height)break;for(let r=0;r<ee.channels;r++){const i=ne[Q.channels[r].name];for(let a=0;a<ee.width;a++){te.value=(n*(ee.channels*ee.width)+r*ee.width+a)*ee.inputSize;const s=(ee.height-1-e)*(ee.width*ee.outputChannels)+a*ee.outputChannels+i;ee.byteArray[s]=ee.getter(t,te)}}}}return{header:Q,width:ee.width,height:ee.height,data:ee.byteArray,format:ee.format,[Wg?"colorSpace":"encoding"]:ee[Wg?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){Wg?e.colorSpace=n.colorSpace:e.encoding=n.encoding,e.minFilter=oe,e.magFilter=oe,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,n)},n,r)}}const qg=(()=>parseInt(m.replace(/\D+/g,"")))();const Yg=s.forwardRef(({envMap:e,resolution:t=256,frames:n=1/0,makeDefault:r,children:i,...a},o)=>{const l=Xf(({set:e})=>e),u=Xf(({camera:e})=>e),h=Xf(({size:e})=>e),d=s.useRef(null);s.useImperativeHandle(o,()=>d.current,[]);const p=s.useRef(null),f=function(e,t,n){const r=Xf(e=>e.size),i=Xf(e=>e.viewport),a="number"==typeof e?e:r.width*i.dpr,o=r.height*i.dpr,l=("number"==typeof e?n:e)||{},{samples:c=0,depth:u,...h}=l,d=null!=u?u:l.depthBuffer,p=s.useMemo(()=>{const e=new An(a,o,{minFilter:oe,magFilter:oe,type:ye,...h});return d&&(e.depthTexture=new Ws(a,o,ve)),e.samples=c,e},[]);return s.useLayoutEffect(()=>{p.setSize(a,o),c&&(p.samples=c)},[c,p,a,o]),s.useEffect(()=>()=>p.dispose(),[]),p}(t);s.useLayoutEffect(()=>{a.manual||(d.current.aspect=h.width/h.height)},[h,a]),s.useLayoutEffect(()=>{d.current.updateProjectionMatrix()});let m=0,g=null;const v="function"==typeof i;return qf(t=>{v&&(n===1/0||m<n)&&(p.current.visible=!1,t.gl.setRenderTarget(f),g=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,d.current),t.scene.background=g,t.gl.setRenderTarget(null),p.current.visible=!0,m++)}),s.useLayoutEffect(()=>{if(r){const e=u;return l(()=>({camera:d.current})),()=>l(()=>({camera:e}))}},[d,r,l]),s.createElement(s.Fragment,null,s.createElement("perspectiveCamera",c({ref:d},a),!v&&i),s.createElement("group",{ref:p},v&&i(f.texture)))}),Zg=s.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:i=!0,keyEvents:a=!1,onChange:o,onStart:l,onEnd:u,...h},d)=>{const p=Xf(e=>e.invalidate),f=Xf(e=>e.camera),m=Xf(e=>e.gl),g=Xf(e=>e.events),v=Xf(e=>e.setEvents),y=Xf(e=>e.set),_=Xf(e=>e.get),x=Xf(e=>e.performance),b=t||f,S=r||g.connected||m.domElement,M=s.useMemo(()=>new Vg(b),[b]);return qf(()=>{M.enabled&&M.update()},-1),s.useEffect(()=>(a&&M.connect(!0===a?S:a),M.connect(S),()=>{M.dispose()}),[a,S,n,M,p]),s.useEffect(()=>{const e=e=>{p(),n&&x.regress(),o&&o(e)},t=e=>{l&&l(e)},r=e=>{u&&u(e)};return M.addEventListener("change",e),M.addEventListener("start",t),M.addEventListener("end",r),()=>{M.removeEventListener("start",t),M.removeEventListener("end",r),M.removeEventListener("change",e)}},[o,l,u,M,p,v]),s.useEffect(()=>{if(e){const e=_().controls;return y({controls:M}),()=>y({controls:e})}},[e,M]),s.createElement("primitive",c({ref:d,object:M,enableDamping:i},h))});class Jg extends ki{constructor(e=new Jt){super({uniforms:{inputBuffer:new cu(null),depthBuffer:new cu(null),resolution:new cu(new Jt),texelSize:new cu(new Jt),halfTexelSize:new cu(new Jt),kernel:new cu(0),scale:new cu(1),cameraNear:new cu(0),cameraFar:new cu(1),minDepthThreshold:new cu(0),maxDepthThreshold:new cu(1),depthScale:new cu(0),depthToBlurRatioBias:new cu(.25)},fragmentShader:`#include <common>\n        #include <dithering_pars_fragment>      \n        uniform sampler2D inputBuffer;\n        uniform sampler2D depthBuffer;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          float depthFactor = 0.0;\n          \n          #ifdef USE_DEPTH\n            vec4 depth = texture2D(depthBuffer, vUv);\n            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n            depthFactor *= depthScale;\n            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));\n          #endif\n          \n          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));\n          gl_FragColor = sum * 0.25 ;\n\n          #include <dithering_fragment>\n          #include <tonemapping_fragment>\n          #include <${qg>=154?"colorspace_fragment":"encodings_fragment"}>\n        }`,vertexShader:"uniform vec2 texelSize;\n        uniform vec2 halfTexelSize;\n        uniform float kernel;\n        uniform float scale;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          vec2 uv = position.xy * 0.5 + 0.5;\n          vUv = uv;\n\n          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;\n          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n          gl_Position = vec4(position.xy, 1.0, 1.0);\n        }",blending:0,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class $g{constructor({gl:e,resolution:t,width:n=500,height:r=500,minDepthThreshold:i=0,maxDepthThreshold:a=1,depthScale:s=0,depthToBlurRatioBias:o=.25}){this.renderToScreen=!1,this.renderTargetA=new An(t,t,{minFilter:oe,magFilter:oe,stencilBuffer:!1,depthBuffer:!1,type:ye}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Jg,this.convolutionMaterial.setTexelSize(1/n,1/r),this.convolutionMaterial.setResolution(new Jt(n,r)),this.scene=new Qi,this.camera=new zi,this.convolutionMaterial.uniforms.minDepthThreshold.value=i,this.convolutionMaterial.uniforms.maxDepthThreshold.value=a,this.convolutionMaterial.uniforms.depthScale.value=s,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=o,this.convolutionMaterial.defines.USE_DEPTH=s>0;const l=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),c=new Float32Array([0,0,2,0,0,2]),u=new _i;u.setAttribute("position",new li(l,3)),u.setAttribute("uv",new li(c,2)),this.screen=new Ii(u,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,n){const r=this.scene,i=this.camera,a=this.renderTargetA,s=this.renderTargetB;let o=this.convolutionMaterial,l=o.uniforms;l.depthBuffer.value=t.depthTexture;const c=o.kernel;let u,h,d,p=t;for(h=0,d=c.length-1;h<d;++h)u=1&h?s:a,l.kernel.value=c[h],l.inputBuffer.value=p.texture,e.setRenderTarget(u),e.render(r,i),p=u;l.kernel.value=c[h],l.inputBuffer.value=p.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(r,i)}}let Kg=class extends Sl{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;\n      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader=`\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDiffuseBlur;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform float distortion;\n        uniform float cameraNear;\n\t\t\t  uniform float cameraFar;\n        uniform bool hasBlur;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float mixContrast;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;\n        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n\n      float distortionFactor = 0.0;\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      vec4 new_vUv = my_vUv;\n      new_vUv.x += distortionFactor;\n      new_vUv.y += distortionFactor;\n\n      vec4 base = texture2DProj(tDiffuse, new_vUv);\n      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);\n\n      vec4 merge = base;\n\n      #ifdef USE_NORMALMAP\n        vec2 normal_uv = vec2(0.0);\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n        vec3 coord = new_vUv.xyz / new_vUv.w;\n        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;\n        vec4 base_normal = texture2D(tDiffuse, normal_uv);\n        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);\n        merge = base_normal;\n        blur = blur_normal;\n      #endif\n\n      float depthFactor = 0.0001;\n      float blurFactor = 0.0;\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2DProj(tDepth, new_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor));\n\n        #ifdef USE_BLUR\n          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);\n          merge = merge * min(1.0, depthFactor + 0.5);\n        #else\n          merge = merge * depthFactor;\n        #endif\n\n      #endif\n\n      float reflectorRoughnessFactor = roughness;\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n\n      #ifdef USE_BLUR\n        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);\n        merge = mix(merge, blur, blurFactor);\n      #endif\n\n      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);\n      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;\n      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;\n      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;\n\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);\n      ")}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}};const Qg=s.forwardRef(({mixBlur:e=0,mixStrength:t=1,resolution:n=256,blur:r=[0,0],minDepthThreshold:i=.9,maxDepthThreshold:a=1,depthScale:o=0,depthToBlurRatioBias:l=.25,mirror:u=0,distortion:h=1,mixContrast:d=1,distortionMap:p,reflectorOffset:f=0,...m},g)=>{nm({MeshReflectorMaterialImpl:Kg});const v=Xf(({gl:e})=>e),y=Xf(({camera:e})=>e),_=Xf(({scene:e})=>e),x=(r=Array.isArray(r)?r:[r,r])[0]+r[1]>0,b=r[0],S=r[1],M=s.useRef(null);s.useImperativeHandle(g,()=>M.current,[]);const[w]=s.useState(()=>new Za),[T]=s.useState(()=>new Kt),[E]=s.useState(()=>new Kt),[A]=s.useState(()=>new Kt),[C]=s.useState(()=>new rr),[R]=s.useState(()=>new Kt(0,0,-1)),[P]=s.useState(()=>new Tn),[I]=s.useState(()=>new Kt),[D]=s.useState(()=>new Kt),[N]=s.useState(()=>new Tn),[L]=s.useState(()=>new rr),[U]=s.useState(()=>new ji),O=s.useCallback(()=>{var e;const t=M.current.parent||(null==(e=M.current)||null==(e=e.__r3f.parent)?void 0:e.object);if(!t)return;if(E.setFromMatrixPosition(t.matrixWorld),A.setFromMatrixPosition(y.matrixWorld),C.extractRotation(t.matrixWorld),T.set(0,0,1),T.applyMatrix4(C),E.addScaledVector(T,f),I.subVectors(E,A),I.dot(T)>0)return;I.reflect(T).negate(),I.add(E),C.extractRotation(y.matrixWorld),R.set(0,0,-1),R.applyMatrix4(C),R.add(A),D.subVectors(E,R),D.reflect(T).negate(),D.add(E),U.position.copy(I),U.up.set(0,1,0),U.up.applyMatrix4(C),U.up.reflect(T),U.lookAt(D),U.far=y.far,U.updateMatrixWorld(),U.projectionMatrix.copy(y.projectionMatrix),L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),L.multiply(U.projectionMatrix),L.multiply(U.matrixWorldInverse),L.multiply(t.matrixWorld),w.setFromNormalAndCoplanarPoint(T,E),w.applyMatrix4(U.matrixWorldInverse),P.set(w.normal.x,w.normal.y,w.normal.z,w.constant);const n=U.projectionMatrix;N.x=(Math.sign(P.x)+n.elements[8])/n.elements[0],N.y=(Math.sign(P.y)+n.elements[9])/n.elements[5],N.z=-1,N.w=(1+n.elements[10])/n.elements[14],P.multiplyScalar(2/P.dot(N)),n.elements[2]=P.x,n.elements[6]=P.y,n.elements[10]=P.z+1,n.elements[14]=P.w},[y,f]),[F,k,z,B]=s.useMemo(()=>{const r={minFilter:oe,magFilter:oe,type:ye},s=new An(n,n,r);s.depthBuffer=!0,s.depthTexture=new Ws(n,n),s.depthTexture.format=Ae,s.depthTexture.type=fe;const c=new An(n,n,r);return[s,c,new $g({gl:v,resolution:n,width:b,height:S,minDepthThreshold:i,maxDepthThreshold:a,depthScale:o,depthToBlurRatioBias:l}),{mirror:u,textureMatrix:L,mixBlur:e,tDiffuse:s.texture,tDepth:s.depthTexture,tDiffuseBlur:c.texture,hasBlur:x,mixStrength:t,minDepthThreshold:i,maxDepthThreshold:a,depthScale:o,depthToBlurRatioBias:l,distortion:h,distortionMap:p,mixContrast:d,"defines-USE_BLUR":x?"":void 0,"defines-USE_DEPTH":o>0?"":void 0,"defines-USE_DISTORTION":p?"":void 0}]},[v,b,S,L,n,u,x,e,t,i,a,o,l,h,p,d]);return qf(()=>{var e;const t=M.current.parent||(null==(e=M.current)||null==(e=e.__r3f.parent)?void 0:e.object);if(!t)return;t.visible=!1;const n=v.xr.enabled,r=v.shadowMap.autoUpdate;O(),v.xr.enabled=!1,v.shadowMap.autoUpdate=!1,v.setRenderTarget(F),v.state.buffers.depth.setMask(!0),v.autoClear||v.clear(),v.render(_,U),x&&z.render(v,F,k),v.xr.enabled=n,v.shadowMap.autoUpdate=r,t.visible=!0,v.setRenderTarget(null)}),s.createElement("meshReflectorMaterialImpl",c({attach:"material",key:"key"+B["defines-USE_BLUR"]+B["defines-USE_DEPTH"]+B["defines-USE_DISTORTION"],ref:M},B,m))});function ev(e,t){const n=e+"Geometry";return s.forwardRef(({args:e,children:r,...i},a)=>{const o=s.useRef(null);return s.useImperativeHandle(a,()=>o.current),s.useLayoutEffect(()=>{null==t||t(o.current)}),s.createElement("mesh",c({ref:o},i),s.createElement(n,{attach:"geometry",args:e}),r)})}const tv=ev("box"),nv=ev("cylinder"),rv=(e,t,n)=>{let r;switch(e){case he:r=new Uint8ClampedArray(t*n*4);break;case ye:r=new Uint16Array(t*n*4);break;case ge:r=new Uint32Array(t*n*4);break;case de:r=new Int8Array(t*n*4);break;case pe:r=new Int16Array(t*n*4);break;case me:r=new Int32Array(t*n*4);break;case ve:r=new Float32Array(t*n*4);break;default:throw new Error("Unsupported data type")}return r};let iv;class av{constructor(e){var t,n,r,i,a,s,o,l,c,u,h,d,p,f,m,g;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(sb){throw this._renderer.setRenderTarget(null),sb}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const v={format:Ee,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:void 0!==(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)?null===(n=e.renderTargetOptions)||void 0===n?void 0:n.anisotropy:1,generateMipmaps:void 0!==(null===(r=e.renderTargetOptions)||void 0===r?void 0:r.generateMipmaps)&&(null===(i=e.renderTargetOptions)||void 0===i?void 0:i.generateMipmaps),magFilter:void 0!==(null===(a=e.renderTargetOptions)||void 0===a?void 0:a.magFilter)?null===(s=e.renderTargetOptions)||void 0===s?void 0:s.magFilter:oe,minFilter:void 0!==(null===(o=e.renderTargetOptions)||void 0===o?void 0:o.minFilter)?null===(l=e.renderTargetOptions)||void 0===l?void 0:l.minFilter:oe,samples:void 0!==(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.samples)?null===(u=e.renderTargetOptions)||void 0===u?void 0:u.samples:void 0,wrapS:void 0!==(null===(h=e.renderTargetOptions)||void 0===h?void 0:h.wrapS)?null===(d=e.renderTargetOptions)||void 0===d?void 0:d.wrapS:ne,wrapT:void 0!==(null===(p=e.renderTargetOptions)||void 0===p?void 0:p.wrapT)?null===(f=e.renderTargetOptions)||void 0===f?void 0:f.wrapT:ne};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=av.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Qi,this._camera=new bc,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!((e,t,n,r)=>{if(void 0!==iv)return iv;const i=new An(1,1,r);t.setRenderTarget(i);const a=new Ii(new cl,new Qr({color:16777215}));t.render(a,n),t.setRenderTarget(null);const s=rv(e,i.width,i.height);return t.readRenderTargetPixels(i,0,0,i.width,i.height,s),i.dispose(),a.geometry.dispose(),a.material.dispose(),iv=0!==s[0],iv})(this._type,this._renderer,this._camera,v)){let e;if(this._type===ye)e=this._renderer.extensions.has("EXT_color_buffer_float")?ve:void 0;void 0!==e?this._type=e:this._supportsReadPixels=!1}this._quad=new Ii(new cl,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new An(this.width,this.height,v),this._renderTarget.texture.mapping=void 0!==(null===(m=e.renderTargetOptions)||void 0===m?void 0:m.mapping)?null===(g=e.renderTargetOptions)||void 0===g?void 0:g.mapping:Z}static instantiateRenderer(){const e=new Ap;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=rv(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Na(this.toArray(),this.width,this.height,Ee,this._type,(null==e?void 0:e.mapping)||Z,(null==e?void 0:e.wrapS)||ne,(null==e?void 0:e.wrapT)||ne,(null==e?void 0:e.magFilter)||oe,(null==e?void 0:e.minFilter)||oe,(null==e?void 0:e.anisotropy)||1,St);return t.generateMipmaps=void 0!==(null==e?void 0:e.generateMipmaps)&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ki&&Object.values(this.material.uniforms).forEach(e=>{e.value instanceof wn&&e.value.dispose()}),Object.values(this.material).forEach(e=>{e instanceof wn&&e.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class sv extends ki{constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:i,maxDisplayBoost:a,hdrCapacityMin:s,hdrCapacityMax:o,sdr:l,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:l},gainMap:{value:c},gamma:{value:new Kt(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:(new Kt).fromArray(t)},offsetSdr:{value:(new Kt).fromArray(n)},gainMapMin:{value:(new Kt).fromArray(r)},gainMapMax:{value:(new Kt).fromArray(i)},weightFactor:{value:(Math.log2(a)-s)/(o-s)}},blending:0,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=s,this._hdrCapacityMax=o,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class ov extends Error{}class lv extends Error{}const cv=(e,t,n)=>{const r=new RegExp(`${t}="([^"]*)"`,"i").exec(e);if(r)return r[1];const i=new RegExp(`<${t}[^>]*>([\\s\\S]*?)</${t}>`,"i").exec(e);if(i){const e=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return e&&3===e.length?e.map(e=>e.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(void 0!==n)return n;throw new Error(`Can't find ${t} in gainmap metadata`)};class uv{constructor(e){this.options={debug:!(!e||void 0===e.debug)&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}extract(e){return new Promise((t,n)=>{this.options.debug;const r=new DataView(e.buffer);if(65496!==r.getUint16(0))return void n(new Error("Not a valid jpeg"));const i=r.byteLength;let a,s=2,o=0;for(;s<i;){if(++o>250)return void n(new Error(`Found no marker after ${o} loops `));if(255!==r.getUint8(s))return void n(new Error(`Not a valid marker at offset 0x${s.toString(16)}, found: 0x${r.getUint8(s).toString(16)}`));if(a=r.getUint8(s+1),226===a){const e=s+4;if(1297106432===r.getUint32(e)){const i=e+4;let a;if(18761===r.getUint16(i))a=!1;else{if(19789!==r.getUint16(i))return void n(new Error("No valid endianness marker found in TIFF header"));a=!0}if(42!==r.getUint16(i+2,!a))return void n(new Error("Not valid TIFF data! (no 0x002A marker)"));const s=r.getUint32(i+4,!a);if(s<8)return void n(new Error("Not valid TIFF data! (First offset less than 8)"));const o=i+s,l=r.getUint16(o,!a),c=o+2;let u=0;for(let e=c;e<c+12*l;e+=12)45057===r.getUint16(e,!a)&&(u=r.getUint32(e+8,!a));const h=o+2+12*l+4,d=[];for(let e=h;e<h+16*u;e+=16){const t={MPType:r.getUint32(e,!a),size:r.getUint32(e+4,!a),dataOffset:r.getUint32(e+8,!a),dependantImages:r.getUint32(e+12,!a),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=i+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,d.push(t)}if(this.options.extractNonFII&&d.length){const e=new Blob([r]),n=[];for(const t of d){if(t.isFII&&!this.options.extractFII)continue;const r=e.slice(t.start,t.end+1,"image/jpeg");n.push(r)}t(n)}}}s+=2+r.getUint16(s+2)}})}}const hv=async e=>{const t=(e=>{let t;t="undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):e.toString();let n=t.indexOf("<x:xmpmeta");for(;-1!==n;){const e=t.indexOf("x:xmpmeta>",n),r=t.slice(n,e+10);try{const e=cv(r,"hdrgm:GainMapMin","0"),t=cv(r,"hdrgm:GainMapMax"),n=cv(r,"hdrgm:Gamma","1"),i=cv(r,"hdrgm:OffsetSDR","0.015625"),a=cv(r,"hdrgm:OffsetHDR","0.015625"),s=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),o=s?s[1]:"0",l=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!l)throw new Error("Incomplete gainmap metadata");const c=l[1];return{gainMapMin:Array.isArray(e)?e.map(e=>parseFloat(e)):[parseFloat(e),parseFloat(e),parseFloat(e)],gainMapMax:Array.isArray(t)?t.map(e=>parseFloat(e)):[parseFloat(t),parseFloat(t),parseFloat(t)],gamma:Array.isArray(n)?n.map(e=>parseFloat(e)):[parseFloat(n),parseFloat(n),parseFloat(n)],offsetSdr:Array.isArray(i)?i.map(e=>parseFloat(e)):[parseFloat(i),parseFloat(i),parseFloat(i)],offsetHdr:Array.isArray(a)?a.map(e=>parseFloat(e)):[parseFloat(a),parseFloat(a),parseFloat(a)],hdrCapacityMin:parseFloat(o),hdrCapacityMax:parseFloat(c)}}catch(sb){}n=t.indexOf("<x:xmpmeta",e)}})(e);if(!t)throw new lv("Gain map XMP metadata not found");const n=new uv({extractFII:!0,extractNonFII:!0}),r=await n.extract(e);if(2!==r.length)throw new ov("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:t}},dv=e=>new Promise((t,n)=>{const r=document.createElement("img");r.onload=()=>{t(r)},r.onerror=e=>{n(e)},r.src=URL.createObjectURL(e)});class pv extends ec{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new Kl}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer;const e=new sv({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new wn,sdr:new wn});return new av({width:16,height:16,type:ye,colorSpace:St,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,n,r){const i=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([n],{type:"image/jpeg"});let s,o,l=!1;if("undefined"==typeof createImageBitmap){const e=await Promise.all([i?dv(i):Promise.resolve(void 0),dv(a)]);o=e[0],s=e[1],l=!0}else{const e=await Promise.all([i?createImageBitmap(i,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);o=e[0],s=e[1]}const c=new wn(o||new ImageData(2,2),Z,ne,ne,oe,ue,Ee,he,1,St);c.flipY=l,c.needsUpdate=!0;const u=new wn(s,Z,ne,ne,oe,ue,Ee,he,1,bt);u.flipY=l,u.needsUpdate=!0,e.width=s.width,e.height=s.height,e.material.gainMap=c,e.material.sdr=u,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class fv extends pv{load([e,t,n],r,i,a){const s=this.prepareQuadRenderer();let o,l,c;const u=async()=>{if(o&&l&&c){try{await this.render(s,c,o,l)}catch(i){return this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),"function"==typeof a&&a(i),void s.disposeOnDemandRenderer()}"function"==typeof r&&r(s),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),s.disposeOnDemandRenderer()}};let h=!0,d=0,p=0,f=!0,m=0,g=0,v=!0,y=0,_=0;const x=()=>{if("function"==typeof i){i(new ProgressEvent("progress",{lengthComputable:h&&f&&v,loaded:p+g+_,total:d+m+y}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const b=new rc(this._internalLoadingManager);b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(e,async e=>{if("string"==typeof e)throw new Error("Invalid sdr buffer");o=e,await u()},e=>{h=e.lengthComputable,p=e.loaded,d=e.total,x()},t=>{this.manager.itemError(e),"function"==typeof a&&a(t)});const S=new rc(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(t,async e=>{if("string"==typeof e)throw new Error("Invalid gainmap buffer");l=e,await u()},e=>{f=e.lengthComputable,g=e.loaded,m=e.total,x()},e=>{this.manager.itemError(t),"function"==typeof a&&a(e)});const M=new rc(this._internalLoadingManager);return M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(this.withCredentials),M.load(n,async e=>{if("string"!=typeof e)throw new Error("Invalid metadata string");c=JSON.parse(e),await u()},e=>{v=e.lengthComputable,_=e.loaded,y=e.total,x()},e=>{this.manager.itemError(n),"function"==typeof a&&a(e)}),s}}class mv extends pv{load(e,t,n,r){const i=this.prepareQuadRenderer(),a=new rc(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async n=>{if("string"==typeof n)throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const a=new Uint8Array(n);let s,o,l;try{const e=await hv(a);s=e.sdr,o=e.gainMap,l=e.metadata}catch(sb){if(!(sb instanceof lv||sb instanceof ov))throw sb;l={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},s=a}try{await this.render(i,l,s,o)}catch(c){return this.manager.itemError(e),"function"==typeof r&&r(c),void i.disposeOnDemandRenderer()}"function"==typeof t&&t(i),this.manager.itemEnd(e),i.disposeOnDemandRenderer()},n,t=>{this.manager.itemError(e),"function"==typeof r&&r(t)}),i}}const gv={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},vv="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",yv=e=>Array.isArray(e),_v=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function xv({files:e=_v,path:t="",preset:n,colorSpace:r,extensions:i}={}){n&&(Mv(n),e=gv[n],t=vv);const a=yv(e),{extension:o,isCubemap:l}=wv(e),c=Tv(o);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+e);const u=Xf(e=>e.gl);s.useLayoutEffect(()=>{"webp"!==o&&"jpg"!==o&&"jpeg"!==o||u.domElement.addEventListener("webglcontextlost",function(){Jf.clear(c,a?[e]:e)},{once:!0})},[e,u.domElement]);const h=Jf(c,a?[e]:e,e=>{"webp"!==o&&"jpg"!==o&&"jpeg"!==o||e.setRenderer(u),null==e.setPath||e.setPath(t),i&&i(e)});let d=a?h[0]:h;var p;"jpg"!==o&&"jpeg"!==o&&"webp"!==o||(d=null==(p=d.renderTarget)?void 0:p.texture);return d.mapping=l?J:K,d.colorSpace=null!=r?r:l?"srgb":"srgb-linear",d}const bv={files:_v,path:"",preset:void 0,extensions:void 0};xv.preload=e=>{const t={...bv,...e};let{files:n,path:r=""}=t;const{preset:i,extensions:a}=t;i&&(Mv(i),n=gv[i],r=vv);const{extension:s}=wv(n);if("webp"===s||"jpg"===s||"jpeg"===s)throw new Error("useEnvironment: Preloading gainmaps is not supported");const o=Tv(s);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+n);Jf.preload(o,yv(n)?[n]:n,e=>{null==e.setPath||e.setPath(r),a&&a(e)})};const Sv={files:_v,preset:void 0};function Mv(e){if(!(e in gv))throw new Error("Preset must be one of: "+Object.keys(gv).join(", "))}function wv(e){var t;const n=yv(e)&&6===e.length,r=yv(e)&&3===e.length&&e.some(e=>e.endsWith("json")),i=yv(e)?e[0]:e;return{extension:n?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":null==(t=i.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function Tv(e){return"cube"===e?sc:"hdr"===e?Gg:"exr"===e?Xg:"jpg"===e||"jpeg"===e?mv:"webp"===e?fv:null}xv.clear=e=>{const t={...Sv,...e};let{files:n}=t;const{preset:r}=t;r&&(Mv(r),n=gv[r]);const{extension:i}=wv(n),a=Tv(i);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+n);Jf.clear(a,yv(n)?[n]:n)};function Ev(e,t,n,r,i={}){var a,s,o,l;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const c=(e=>{return(t=e).current&&t.current.isScene?e.current:e;var t})(t||n),u=c.background,h=c.environment,d={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:null!==(a=null==(s=c.backgroundRotation)||null==s.clone?void 0:s.clone())&&void 0!==a?a:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:null!==(o=null==(l=c.environmentRotation)||null==l.clone?void 0:l.clone())&&void 0!==o?o:[0,0,0]};return"only"!==e&&(c.environment=r),e&&(c.background=r),Of(c,i),()=>{"only"!==e&&(c.environment=h),e&&(c.background=u),Of(c,d)}}function Av({scene:e,background:t=!1,map:n,...r}){const i=Xf(e=>e.scene);return s.useLayoutEffect(()=>{if(n)return Ev(t,e,i,n,r)}),null}function Cv({background:e=!1,scene:t,blur:n,backgroundBlurriness:r,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:o,environmentRotation:l,...c}){const u=xv(c),h=Xf(e=>e.scene);return s.useLayoutEffect(()=>Ev(e,t,h,u,{backgroundBlurriness:null!=n?n:r,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:o,environmentRotation:l})),s.useEffect(()=>()=>{u.dispose()},[u]),null}function Rv({children:e,near:t=.1,far:n=1e3,resolution:r=256,frames:i=1,map:a,background:o=!1,blur:c,backgroundBlurriness:u,backgroundIntensity:h,backgroundRotation:d,environmentIntensity:p,environmentRotation:f,scene:m,files:g,path:v,preset:y,extensions:_}){const x=Xf(e=>e.gl),b=Xf(e=>e.scene),S=s.useRef(null),[M]=s.useState(()=>new Qi),w=s.useMemo(()=>{const e=new qi(r);return e.texture.type=ye,e},[r]);s.useEffect(()=>()=>{w.dispose()},[w]),s.useLayoutEffect(()=>{if(1===i){const e=x.autoClear;x.autoClear=!0,S.current.update(x,M),x.autoClear=e}return Ev(o,m,b,w.texture,{backgroundBlurriness:null!=c?c:u,backgroundIntensity:h,backgroundRotation:d,environmentIntensity:p,environmentRotation:f})},[e,M,w.texture,m,b,o,i,x]);let T=1;return qf(()=>{if(i===1/0||T<i){const e=x.autoClear;x.autoClear=!0,S.current.update(x,M),x.autoClear=e,T++}}),s.createElement(s.Fragment,null,function(e,t,n){return l.jsx(bm,{children:e,container:t,state:n})}(s.createElement(s.Fragment,null,e,s.createElement("cubeCamera",{ref:S,args:[t,n,w]}),g||y?s.createElement(Cv,{background:!0,files:g,preset:y,path:v,extensions:_}):a?s.createElement(Av,{background:!0,map:a,extensions:_}):null),M))}function Pv(e){var t,n,r,i;const a=xv(e),o=e.map||a;s.useMemo(()=>nm({GroundProjectedEnvImpl:Ig}),[]),s.useEffect(()=>()=>{a.dispose()},[a]);const l=s.useMemo(()=>[o],[o]),u=null==(t=e.ground)?void 0:t.height,h=null==(n=e.ground)?void 0:n.radius,d=null!==(r=null==(i=e.ground)?void 0:i.scale)&&void 0!==r?r:1e3;return s.createElement(s.Fragment,null,s.createElement(Av,c({},e,{map:o})),s.createElement("groundProjectedEnvImpl",{args:l,scale:d,height:u,radius:h}))}function Iv(e){return e.ground?s.createElement(Pv,e):e.map?s.createElement(Av,e):e.children?s.createElement(Rv,e):s.createElement(Cv,e)}const Dv=s.forwardRef(({scale:e=10,frames:t=1/0,opacity:n=1,width:r=1,height:i=1,blur:a=1,near:o=0,far:l=10,resolution:u=512,smooth:h=!0,color:d="#000000",depthWrite:p=!1,renderOrder:f,...m},g)=>{const v=s.useRef(null),y=Xf(e=>e.scene),_=Xf(e=>e.gl),x=s.useRef(null);r*=Array.isArray(e)?e[0]:e||1,i*=Array.isArray(e)?e[1]:e||1;const[b,S,M,w,T,E,A]=s.useMemo(()=>{const e=new An(u,u),t=new An(u,u);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;const n=new cl(r,i).rotateX(Math.PI/2),a=new Ii(n),s=new Cl;s.depthTest=s.depthWrite=!1,s.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new Zr(d)}},e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const o=new ki(Hg),l=new ki(jg);return l.depthTest=o.depthTest=!1,[e,n,s,a,o,l,t]},[u,r,i,e,d]),C=e=>{w.visible=!0,w.material=T,T.uniforms.tDiffuse.value=b.texture,T.uniforms.h.value=1*e/256,_.setRenderTarget(A),_.render(w,x.current),w.material=E,E.uniforms.tDiffuse.value=A.texture,E.uniforms.v.value=1*e/256,_.setRenderTarget(b),_.render(w,x.current),w.visible=!1};let R,P,I=0;return qf(()=>{x.current&&(t===1/0||I<t)&&(I++,R=y.background,P=y.overrideMaterial,v.current.visible=!1,y.background=null,y.overrideMaterial=M,_.setRenderTarget(b),_.render(y,x.current),C(a),h&&C(.4*a),_.setRenderTarget(null),v.current.visible=!0,y.overrideMaterial=P,y.background=R)}),s.useImperativeHandle(g,()=>v.current,[]),s.createElement("group",c({"rotation-x":Math.PI/2},m,{ref:v}),s.createElement("mesh",{renderOrder:f,geometry:S,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},s.createElement("meshBasicMaterial",{transparent:!0,map:b.texture,opacity:n,depthWrite:p})),s.createElement("orthographicCamera",{ref:x,args:[-r/2,r/2,i/2,-i/2,o,l]}))});class Nv extends ki{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new Kt(0,0,0)},lightColor:{value:new Zr("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new Jt(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n        uniform vec3 spotPosition;\n        uniform float attenuation;\n\n        #include <common>\n        #include <logdepthbuf_pars_vertex>\n\n        void main() {\n          // compute intensity\n          vNormal = normalize(normalMatrix * normal);\n          vec4 worldPosition = modelMatrix * vec4(position, 1);\n          vec4 viewPosition = viewMatrix * worldPosition;\n          vViewZ = viewPosition.z;\n\n          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);\n\n          gl_Position = projectionMatrix * viewPosition;\n\n          #include <logdepthbuf_vertex>\n        }\n      ",fragmentShader:`\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n\n        uniform vec3 lightColor;\n        uniform float anglePower;\n        uniform sampler2D depth;\n        uniform vec2 resolution;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float opacity;\n\n        #include <packing>\n        #include <logdepthbuf_pars_fragment>\n\n        float readDepth(sampler2D depthSampler, vec2 uv) {\n          float fragCoordZ = texture(depthSampler, uv).r;\n\n          // https://github.com/mrdoob/three.js/issues/23072\n          #ifdef USE_LOGDEPTHBUF\n            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));\n          #else\n            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n          #endif\n\n          return viewZ;\n        }\n\n        void main() {\n          #include <logdepthbuf_fragment>\n\n          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);\n          float intensity = vIntensity * angleIntensity;\n\n          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n          if (isSoft) {\n            vec2 uv = gl_FragCoord.xy / resolution;\n            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));\n          }\n\n          gl_FragColor = vec4(lightColor, intensity * opacity);\n\n          #include <tonemapping_fragment>\n          #include <${qg>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}}function Lv({opacity:e=1,radiusTop:t,radiusBottom:n,depthBuffer:r,color:i="white",distance:a=5,angle:o=.15,attenuation:l=5,anglePower:c=5}){const u=s.useRef(null),h=Xf(e=>e.size),d=Xf(e=>e.camera),p=Xf(e=>e.viewport.dpr),[f]=s.useState(()=>new Nv),[m]=s.useState(()=>new Kt);t=void 0===t?.1:t,n=void 0===n?7*o:n,qf(()=>{f.uniforms.spotPosition.value.copy(u.current.getWorldPosition(m)),u.current.lookAt(u.current.parent.target.getWorldPosition(m))});const g=s.useMemo(()=>{const e=new Zs(t,n,a,128,64,!0);return e.applyMatrix4((new rr).makeTranslation(0,-a/2,0)),e.applyMatrix4((new rr).makeRotationX(-Math.PI/2)),e},[a,t,n]);return s.createElement(s.Fragment,null,s.createElement("mesh",{ref:u,geometry:g,raycast:()=>null},s.createElement("primitive",{object:f,attach:"material","uniforms-opacity-value":e,"uniforms-lightColor-value":i,"uniforms-attenuation-value":l,"uniforms-anglePower-value":c,"uniforms-depth-value":r,"uniforms-cameraNear-value":d.near,"uniforms-cameraFar-value":d.far,"uniforms-resolution-value":r?[h.width*p,h.height*p]:[0,0]})))}const Uv=s.forwardRef(({opacity:e=1,radiusTop:t,radiusBottom:n,depthBuffer:r,color:i="white",distance:a=5,angle:o=.15,attenuation:l=5,anglePower:u=5,volumetric:h=!0,debug:d=!1,children:p,...f},m)=>{const g=s.useRef(null);return s.useImperativeHandle(m,()=>g.current,[]),s.createElement("group",null,d&&g.current&&s.createElement("spotLightHelper",{args:[g.current]}),s.createElement("spotLight",c({ref:g,angle:o,color:i,distance:a,castShadow:!0},f),h&&s.createElement(Lv,{debug:d,opacity:e,radiusTop:t,radiusBottom:n,depthBuffer:r,color:i,distance:a,angle:o,attenuation:l,anglePower:u})),p&&s.cloneElement(p,{spotlightRef:g,debug:d}))});class Ov extends ki{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:`\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n\n        #include <tonemapping_fragment>\n\t      #include <${qg>=154?"colorspace_fragment":"encodings_fragment"}>\n      }`})}}const Fv=e=>(new Kt).setFromSpherical(new gu(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),kv=s.forwardRef(({radius:e=100,depth:t=50,count:n=5e3,saturation:r=0,factor:i=4,fade:a=!1,speed:o=1},l)=>{const c=s.useRef(null),[u,h,d]=s.useMemo(()=>{const a=[],s=[],o=Array.from({length:n},()=>(.5+.5*Math.random())*i),l=new Zr;let c=e+t;const u=t/n;for(let e=0;e<n;e++)c-=u*Math.random(),a.push(...Fv(c).toArray()),l.setHSL(e/n,r,.9),s.push(l.r,l.g,l.b);return[new Float32Array(a),new Float32Array(s),new Float32Array(o)]},[n,t,i,e,r]);qf(e=>c.current&&(c.current.uniforms.time.value=e.clock.elapsedTime*o));const[p]=s.useState(()=>new Ov);return s.createElement("points",{ref:l},s.createElement("bufferGeometry",null,s.createElement("bufferAttribute",{attach:"attributes-position",args:[u,3]}),s.createElement("bufferAttribute",{attach:"attributes-color",args:[h,3]}),s.createElement("bufferAttribute",{attach:"attributes-size",args:[d,1]})),s.createElement("primitive",{ref:c,object:p,attach:"material",blending:2,"uniforms-fade-value":a,depthWrite:!1,transparent:!0,vertexColors:!0}))});class zv extends ki{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:"\n        uniform float pixelRatio;\n        uniform float time;\n        attribute float size;  \n        attribute float speed;  \n        attribute float opacity;\n        attribute vec3 noise;\n        attribute vec3 color;\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        void main() {\n          vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;\n          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;\n          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;\n          vec4 viewPosition = viewMatrix * modelPosition;\n          vec4 projectionPostion = projectionMatrix * viewPosition;\n          gl_Position = projectionPostion;\n          gl_PointSize = size * 25. * pixelRatio;\n          gl_PointSize *= (1.0 / - viewPosition.z);\n          vColor = color;\n          vOpacity = opacity;\n        }\n      ",fragmentShader:`\n        varying vec3 vColor;\n        varying float vOpacity;\n        void main() {\n          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n          float strength = 0.05 / distanceToCenter - 0.1;\n          gl_FragColor = vec4(vColor, strength * vOpacity);\n          #include <tonemapping_fragment>\n          #include <${qg>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(e){this.uniforms.pixelRatio.value=e}}const Bv=e=>e&&e.constructor===Float32Array,Vv=e=>e instanceof Jt||e instanceof Kt||e instanceof Tn,Hv=e=>Array.isArray(e)?e:Vv(e)?e.toArray():[e,e,e];function jv(e,t,n){return s.useMemo(()=>{if(void 0!==t){if(Bv(t))return t;if(t instanceof Zr){const n=Array.from({length:3*e},()=>{return[(e=t).r,e.g,e.b];var e}).flat();return Float32Array.from(n)}if(Vv(t)||Array.isArray(t)){const n=Array.from({length:3*e},()=>Hv(t)).flat();return Float32Array.from(n)}return Float32Array.from({length:e},()=>t)}return Float32Array.from({length:e},n)},[t])}const Gv=s.forwardRef(({noise:e=1,count:t=100,speed:n=1,opacity:r=1,scale:i=1,size:a,color:o,children:l,...u},h)=>{s.useMemo(()=>nm({SparklesImplMaterial:zv}),[]);const d=s.useRef(null),p=Xf(e=>e.viewport.dpr),f=Hv(i),m=s.useMemo(()=>Float32Array.from(Array.from({length:t},()=>f.map(Zt.randFloatSpread)).flat()),[t,...f]),g=jv(t,a,Math.random),v=jv(t,r),y=jv(t,n),_=jv(3*t,e),x=jv(void 0===o?3*t:t,Bv(o)?o:new Zr(o),()=>1);return qf(e=>{d.current&&d.current.material&&(d.current.material.time=e.clock.elapsedTime)}),s.useImperativeHandle(h,()=>d.current,[]),s.createElement("points",c({key:`particle-${t}-${JSON.stringify(i)}`},u,{ref:d}),s.createElement("bufferGeometry",null,s.createElement("bufferAttribute",{attach:"attributes-position",args:[m,3]}),s.createElement("bufferAttribute",{attach:"attributes-size",args:[g,1]}),s.createElement("bufferAttribute",{attach:"attributes-opacity",args:[v,1]}),s.createElement("bufferAttribute",{attach:"attributes-speed",args:[y,1]}),s.createElement("bufferAttribute",{attach:"attributes-color",args:[x,3]}),s.createElement("bufferAttribute",{attach:"attributes-noise",args:[_,3]})),l||s.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:p,depthWrite:!1}))});var Wv=oy(),Xv=e=>ry(e,Wv),qv=oy();Xv.write=e=>ry(e,qv);var Yv=oy();Xv.onStart=e=>ry(e,Yv);var Zv=oy();Xv.onFrame=e=>ry(e,Zv);var Jv=oy();Xv.onFinish=e=>ry(e,Jv);var $v=[];Xv.setTimeout=(e,t)=>{const n=Xv.now()+t,r=()=>{const e=$v.findIndex(e=>e.cancel==r);~e&&$v.splice(e,1),ty-=~e?1:0},i={time:n,handler:e,cancel:r};return $v.splice(Kv(n),0,i),ty+=1,iy(),i};var Kv=e=>~(~$v.findIndex(t=>t.time>e)||~$v.length);Xv.cancel=e=>{Yv.delete(e),Zv.delete(e),Jv.delete(e),Wv.delete(e),qv.delete(e)},Xv.sync=e=>{ny=!0,Xv.batchedUpdates(e),ny=!1},Xv.throttle=e=>{let t;function n(){try{e(...t)}finally{t=null}}function r(...e){t=e,Xv.onStart(n)}return r.handler=e,r.cancel=()=>{Yv.delete(n),t=null},r};var Qv="undefined"!=typeof window?window.requestAnimationFrame:()=>{};Xv.use=e=>Qv=e,Xv.now="undefined"!=typeof performance?()=>performance.now():Date.now,Xv.batchedUpdates=e=>e(),Xv.catch=console.error,Xv.frameLoop="always",Xv.advance=()=>{"demand"!==Xv.frameLoop||sy()};var ey=-1,ty=0,ny=!1;function ry(e,t){ny?(t.delete(e),e(0)):(t.add(e),iy())}function iy(){ey<0&&(ey=0,"demand"!==Xv.frameLoop&&Qv(ay))}function ay(){~ey&&(Qv(ay),Xv.batchedUpdates(sy))}function sy(){const e=ey;ey=Xv.now();const t=Kv(ey);t&&(ly($v.splice(0,t),e=>e.handler()),ty-=t),ty?(Yv.flush(),Wv.flush(e?Math.min(64,ey-e):16.667),Zv.flush(),qv.flush(),Jv.flush()):ey=-1}function oy(){let e=new Set,t=e;return{add(n){ty+=t!=e||e.has(n)?0:1,e.add(n)},delete:n=>(ty-=t==e&&e.has(n)?1:0,e.delete(n)),flush(n){t.size&&(e=new Set,ty-=t.size,ly(t,t=>t(n)&&e.add(t)),ty+=e.size,t=e)}}}function ly(e,t){e.forEach(e=>{try{t(e)}catch(sb){Xv.catch(sb)}})}var cy=Object.defineProperty,uy={};function hy(){}((e,t)=>{for(var n in t)cy(e,n,{get:t[n],enumerable:!0})})(uy,{assign:()=>Ty,colors:()=>Sy,createStringInterpolator:()=>yy,skipAnimation:()=>My,to:()=>_y,willAdvance:()=>wy});var dy={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function py(e,t){if(dy.arr(e)){if(!dy.arr(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e===t}var fy=(e,t)=>e.forEach(t);function my(e,t,n){if(dy.arr(e))for(let r=0;r<e.length;r++)t.call(n,e[r],`${r}`);else for(const r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r)}var gy=e=>dy.und(e)?[]:dy.arr(e)?e:[e];function vy(e,t){if(e.size){const n=Array.from(e);e.clear(),fy(n,t)}}var yy,_y,xy=(e,...t)=>vy(e,e=>e(...t)),by=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Sy=null,My=!1,wy=hy,Ty=e=>{e.to&&(_y=e.to),e.now&&(Xv.now=e.now),void 0!==e.colors&&(Sy=e.colors),null!=e.skipAnimation&&(My=e.skipAnimation),e.createStringInterpolator&&(yy=e.createStringInterpolator),e.requestAnimationFrame&&Xv.use(e.requestAnimationFrame),e.batchedUpdates&&(Xv.batchedUpdates=e.batchedUpdates),e.willAdvance&&(wy=e.willAdvance),e.frameLoop&&(Xv.frameLoop=e.frameLoop)},Ey=new Set,Ay=[],Cy=[],Ry=0,Py={get idle(){return!Ey.size&&!Ay.length},start(e){Ry>e.priority?(Ey.add(e),Xv.onStart(Iy)):(Dy(e),Xv(Ly))},advance:Ly,sort(e){if(Ry)Xv.onFrame(()=>Py.sort(e));else{const t=Ay.indexOf(e);~t&&(Ay.splice(t,1),Ny(e))}},clear(){Ay=[],Ey.clear()}};function Iy(){Ey.forEach(Dy),Ey.clear(),Xv(Ly)}function Dy(e){Ay.includes(e)||Ny(e)}function Ny(e){Ay.splice(function(e,t){const n=e.findIndex(t);return n<0?e.length:n}(Ay,t=>t.priority>e.priority),0,e)}function Ly(e){const t=Cy;for(let n=0;n<Ay.length;n++){const r=Ay[n];Ry=r.priority,r.idle||(wy(r),r.advance(e),r.idle||t.push(r))}return Ry=0,(Cy=Ay).length=0,(Ay=t).length>0}var Uy="[-+]?\\d*\\.?\\d+",Oy=Uy+"%";function Fy(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var ky=new RegExp("rgb"+Fy(Uy,Uy,Uy)),zy=new RegExp("rgba"+Fy(Uy,Uy,Uy,Uy)),By=new RegExp("hsl"+Fy(Uy,Oy,Oy)),Vy=new RegExp("hsla"+Fy(Uy,Oy,Oy,Uy)),Hy=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,jy=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Gy=/^#([0-9a-fA-F]{6})$/,Wy=/^#([0-9a-fA-F]{8})$/;function Xy(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function qy(e,t,n){const r=n<.5?n*(1+t):n+t-n*t,i=2*n-r,a=Xy(i,r,e+1/3),s=Xy(i,r,e),o=Xy(i,r,e-1/3);return Math.round(255*a)<<24|Math.round(255*s)<<16|Math.round(255*o)<<8}function Yy(e){const t=parseInt(e,10);return t<0?0:t>255?255:t}function Zy(e){return(parseFloat(e)%360+360)%360/360}function Jy(e){const t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function $y(e){const t=parseFloat(e);return t<0?0:t>100?1:t/100}function Ky(e){let t=function(e){let t;return"number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=Gy.exec(e))?parseInt(t[1]+"ff",16)>>>0:Sy&&void 0!==Sy[e]?Sy[e]:(t=ky.exec(e))?(Yy(t[1])<<24|Yy(t[2])<<16|Yy(t[3])<<8|255)>>>0:(t=zy.exec(e))?(Yy(t[1])<<24|Yy(t[2])<<16|Yy(t[3])<<8|Jy(t[4]))>>>0:(t=Hy.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=Wy.exec(e))?parseInt(t[1],16)>>>0:(t=jy.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=By.exec(e))?(255|qy(Zy(t[1]),$y(t[2]),$y(t[3])))>>>0:(t=Vy.exec(e))?(qy(Zy(t[1]),$y(t[2]),$y(t[3]))|Jy(t[4]))>>>0:null}(e);if(null===t)return e;t=t||0;return`rgba(${(4278190080&t)>>>24}, ${(16711680&t)>>>16}, ${(65280&t)>>>8}, ${(255&t)/255})`}var Qy=(e,t,n)=>{if(dy.fun(e))return e;if(dy.arr(e))return Qy({range:e,output:t,extrapolate:n});if(dy.str(e.output[0]))return yy(e);const r=e,i=r.output,a=r.range||[0,1],s=r.extrapolateLeft||r.extrapolate||"extend",o=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(e=>e);return e=>{const t=function(e,t){for(var n=1;n<t.length-1&&!(t[n]>=e);++n);return n-1}(e,a);return function(e,t,n,r,i,a,s,o,l){let c=l?l(e):e;if(c<t){if("identity"===s)return c;"clamp"===s&&(c=t)}if(c>n){if("identity"===o)return c;"clamp"===o&&(c=n)}if(r===i)return r;if(t===n)return e<=t?r:i;t===-1/0?c=-c:n===1/0?c-=t:c=(c-t)/(n-t);c=a(c),r===-1/0?c=-c:i===1/0?c+=r:c=c*(i-r)+r;return c}(e,a[t],a[t+1],i[t],i[t+1],l,s,o,r.map)}};var e_=Symbol.for("FluidValue.get"),t_=Symbol.for("FluidValue.observers"),n_=e=>Boolean(e&&e[e_]),r_=e=>e&&e[e_]?e[e_]():e,i_=e=>e[t_]||null;function a_(e,t){const n=e[t_];n&&n.forEach(e=>{!function(e,t){e.eventObserved?e.eventObserved(t):e(t)}(e,t)})}var s_=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");o_(this,e)}},o_=(e,t)=>h_(e,e_,t);function l_(e,t){if(e[e_]){let n=e[t_];n||h_(e,t_,n=new Set),n.has(t)||(n.add(t),e.observerAdded&&e.observerAdded(n.size,t))}return t}function c_(e,t){const n=e[t_];if(n&&n.has(t)){const r=n.size-1;r?n.delete(t):e[t_]=null,e.observerRemoved&&e.observerRemoved(r,t)}}var u_,h_=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0}),d_=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p_=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,f_=new RegExp(`(${d_.source})(%|[a-z]+)`,"i"),m_=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,g_=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,v_=e=>{const[t,n]=y_(e);if(!t||by())return e;const r=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(r)return r.trim();if(n&&n.startsWith("--")){const t=window.getComputedStyle(document.documentElement).getPropertyValue(n);return t||e}return n&&g_.test(n)?v_(n):n||e},y_=e=>{const t=g_.exec(e);if(!t)return[,];const[,n,r]=t;return[n,r]},__=(e,t,n,r,i)=>`rgba(${Math.round(t)}, ${Math.round(n)}, ${Math.round(r)}, ${i})`,x_=e=>{u_||(u_=Sy?new RegExp(`(${Object.keys(Sy).join("|")})(?!\\w)`,"g"):/^\b$/);const t=e.output.map(e=>r_(e).replace(g_,v_).replace(p_,Ky).replace(u_,Ky)),n=t.map(e=>e.match(d_).map(Number)),r=n[0].map((e,t)=>n.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})),i=r.map(t=>Qy({...e,output:t}));return e=>{const n=!f_.test(t[0])&&t.find(e=>f_.test(e))?.replace(d_,"");let r=0;return t[0].replace(d_,()=>`${i[r++](e)}${n||""}`).replace(m_,__)}},b_="react-spring: ",S_=e=>{const t=e;let n=!1;if("function"!=typeof t)throw new TypeError(`${b_}once requires a function parameter`);return(...e)=>{n||(t(...e),n=!0)}},M_=S_(console.warn);var w_=S_(console.warn);function T_(e){return dy.str(e)&&("#"==e[0]||/\d/.test(e)||!by()&&g_.test(e)||e in(Sy||{}))}var E_=by()?s.useEffect:s.useLayoutEffect;function A_(){const e=s.useState()[1],t=(()=>{const e=s.useRef(!1);return E_(()=>(e.current=!0,()=>{e.current=!1}),[]),e})();return()=>{t.current&&e(Math.random())}}var C_=e=>s.useEffect(e,R_),R_=[];function P_(e){const t=s.useRef(void 0);return s.useEffect(()=>{t.current=e}),t.current}var I_=Symbol.for("Animated:node"),D_=e=>e&&e[I_],N_=(e,t)=>{return n=e,r=I_,i=t,Object.defineProperty(n,r,{value:i,writable:!0,configurable:!0});var n,r,i},L_=e=>e&&e[I_]&&e[I_].getPayload(),U_=class{constructor(){N_(this,this)}getPayload(){return this.payload||[]}},O_=class e extends U_{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,dy.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new e(t)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return dy.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,dy.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},F_=class e extends O_{constructor(e){super(0),this._string=null,this._toString=Qy({output:[e,e]})}static create(t){return new e(t)}getValue(){const e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(dy.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=Qy({output:[this.getValue(),e]})),this._value=0,super.reset()}},k_={dependencies:null},z_=class extends U_{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const t={};return my(this.source,(n,r)=>{var i;(i=n)&&i[I_]===i?t[r]=n.getValue(e):n_(n)?t[r]=r_(n):e||(t[r]=n)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&fy(this.payload,e=>e.reset())}_makePayload(e){if(e){const t=new Set;return my(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){k_.dependencies&&n_(e)&&k_.dependencies.add(e);const t=L_(e);t&&fy(t,e=>this.add(e))}},B_=class e extends z_{constructor(e){super(e)}static create(t){return new e(t)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const t=this.getPayload();return e.length==t.length?t.map((t,n)=>t.setValue(e[n])).some(Boolean):(super.setValue(e.map(V_)),!0)}};function V_(e){return(T_(e)?F_:O_).create(e)}function H_(e){const t=D_(e);return t?t.constructor:dy.arr(e)?B_:T_(e)?F_:O_}var j_=(e,t)=>{const n=!dy.fun(e)||e.prototype&&e.prototype.isReactComponent;return s.forwardRef((r,i)=>{const a=s.useRef(null),o=n&&s.useCallback(e=>{a.current=function(e,t){e&&(dy.fun(e)?e(t):e.current=t);return t}(i,e)},[i]),[l,c]=function(e,t){const n=new Set;k_.dependencies=n,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)});return e=new z_(e),k_.dependencies=null,[e,n]}(r,t),u=A_(),h=()=>{const e=a.current;if(n&&!e)return;!1===(!!e&&t.applyAnimatedValues(e,l.getValue(!0)))&&u()},d=new G_(h,c),p=s.useRef(void 0);E_(()=>(p.current=d,fy(c,e=>l_(e,d)),()=>{p.current&&(fy(p.current.deps,e=>c_(e,p.current)),Xv.cancel(p.current.update))})),s.useEffect(h,[]),C_(()=>()=>{const e=p.current;fy(e.deps,t=>c_(t,e))});const f=t.getComponentProps(l.getValue());return s.createElement(e,{...f,ref:o})})},G_=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&Xv.write(this.update)}};var W_=Symbol.for("AnimatedComponent"),X_=e=>dy.str(e)?e:e&&dy.str(e.displayName)?e.displayName:dy.fun(e)&&e.name||null;function q_(e,...t){return dy.fun(e)?e(...t):e}var Y_=(e,t)=>!0===e||!!(t&&e&&(dy.fun(e)?e(t):gy(e).includes(t))),Z_=(e,t)=>dy.obj(e)?t&&e[t]:e,J_=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,$_=e=>e,K_=(e,t=$_)=>{let n=Q_;e.default&&!0!==e.default&&(e=e.default,n=Object.keys(e));const r={};for(const i of n){const n=t(e[i],i);dy.und(n)||(r[i]=n)}return r},Q_=["config","onProps","onStart","onChange","onPause","onResume","onRest"],ex={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function tx(e){const t=function(e){const t={};let n=0;if(my(e,(e,r)=>{ex[r]||(t[r]=e,n++)}),n)return t}(e);if(t){const n={to:t};return my(e,(e,r)=>r in t||(n[r]=e)),n}return{...e}}function nx(e){return e=r_(e),dy.arr(e)?e.map(nx):T_(e)?uy.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function rx(e){return dy.fun(e)||dy.arr(e)&&dy.obj(e[0])}var ix={tension:170,friction:26,mass:1,damping:1,easing:e=>e,clamp:!1},ax=class{constructor(){this.velocity=0,Object.assign(this,ix)}};function sx(e,t){if(dy.und(t.decay)){const n=!dy.und(t.tension)||!dy.und(t.friction);!n&&dy.und(t.frequency)&&dy.und(t.damping)&&dy.und(t.mass)||(e.duration=void 0,e.decay=void 0),n&&(e.frequency=void 0)}else e.duration=void 0}var ox=[],lx=class{constructor(){this.changed=!1,this.values=ox,this.toValues=null,this.fromValues=ox,this.config=new ax,this.immediate=!1}};function cx(e,{key:t,props:n,defaultProps:r,state:i,actions:a}){return new Promise((s,o)=>{let l,c,u=Y_(n.cancel??r?.cancel,t);if(u)p();else{dy.und(n.pause)||(i.paused=Y_(n.pause,t));let e=r?.pause;!0!==e&&(e=i.paused||Y_(e,t)),l=q_(n.delay||0,t),e?(i.resumeQueue.add(d),a.pause()):(a.resume(),d())}function h(){i.resumeQueue.add(d),i.timeouts.delete(c),c.cancel(),l=c.time-Xv.now()}function d(){l>0&&!uy.skipAnimation?(i.delayed=!0,c=Xv.setTimeout(p,l),i.pauseQueue.add(h),i.timeouts.add(c)):p()}function p(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(h),i.timeouts.delete(c),e<=(i.cancelId||0)&&(u=!0);try{a.start({...n,callId:e,cancel:u},s)}catch(t){o(t)}}})}var ux=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?px(e.get()):t.every(e=>e.noop)?hx(e.get()):dx(e.get(),t.every(e=>e.finished)),hx=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),dx=(e,t,n=!1)=>({value:e,finished:t,cancelled:n}),px=e=>({value:e,cancelled:!0,finished:!1});function fx(e,t,n,r){const{callId:i,parentId:a,onRest:s}=t,{asyncTo:o,promise:l}=n;return a||e!==o||t.reset?n.promise=(async()=>{n.asyncId=i,n.asyncTo=e;const c=K_(t,(e,t)=>"onRest"===t?void 0:e);let u,h;const d=new Promise((e,t)=>(u=e,h=t)),p=e=>{const t=i<=(n.cancelId||0)&&px(r)||i!==n.asyncId&&dx(r,!1);if(t)throw e.result=t,h(e),e},f=(e,t)=>{const a=new gx,s=new vx;return(async()=>{if(uy.skipAnimation)throw mx(n),s.result=dx(r,!1),h(s),s;p(a);const o=dy.obj(e)?{...e}:{...t,to:e};o.parentId=i,my(c,(e,t)=>{dy.und(o[t])&&(o[t]=e)});const l=await r.start(o);return p(a),n.paused&&await new Promise(e=>{n.resumeQueue.add(e)}),l})()};let m;if(uy.skipAnimation)return mx(n),dx(r,!1);try{let t;t=dy.arr(e)?(async e=>{for(const t of e)await f(t)})(e):Promise.resolve(e(f,r.stop.bind(r))),await Promise.all([t.then(u),d]),m=dx(r.get(),!0,!1)}catch(g){if(g instanceof gx)m=g.result;else{if(!(g instanceof vx))throw g;m=g.result}}finally{i==n.asyncId&&(n.asyncId=a,n.asyncTo=a?o:void 0,n.promise=a?l:void 0)}return dy.fun(s)&&Xv.batchedUpdates(()=>{s(m,r,r.item)}),m})():l}function mx(e,t){vy(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var gx=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},vx=class extends Error{constructor(){super("SkipAnimationSignal")}},yx=e=>e instanceof xx,_x=1,xx=class extends s_{constructor(){super(...arguments),this.id=_x++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=D_(this);return e&&e.getValue()}to(...e){return uy.to(this,e)}interpolate(...e){return M_(`${b_}The "interpolate" function is deprecated in v9 (use "to" instead)`),uy.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){a_(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||Py.sort(this),a_(this,{type:"priority",parent:this,priority:e})}},bx=Symbol.for("SpringPhase"),Sx=e=>(1&e[bx])>0,Mx=e=>(2&e[bx])>0,wx=e=>(4&e[bx])>0,Tx=(e,t)=>t?e[bx]|=3:e[bx]&=-3,Ex=(e,t)=>t?e[bx]|=4:e[bx]&=-5,Ax=class extends xx{constructor(e,t){if(super(),this.animation=new lx,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!dy.und(e)||!dy.und(t)){const n=dy.obj(e)?{...e}:{...t,from:e};dy.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Mx(this)||this._state.asyncTo)||wx(this)}get goal(){return r_(this.animation.to)}get velocity(){const e=D_(this);return e instanceof O_?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return Sx(this)}get isAnimating(){return Mx(this)}get isPaused(){return wx(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,n=!1;const r=this.animation;let{toValues:i}=r;const{config:a}=r,s=L_(r.to);!s&&n_(r.to)&&(i=gy(r_(r.to))),r.values.forEach((o,l)=>{if(o.done)return;const c=o.constructor==F_?1:s?s[l].lastPosition:i[l];let u=r.immediate,h=c;if(!u){if(h=o.lastPosition,a.tension<=0)return void(o.done=!0);let t=o.elapsedTime+=e;const n=r.fromValues[l],i=null!=o.v0?o.v0:o.v0=dy.arr(a.velocity)?a.velocity[l]:a.velocity;let s;const d=a.precision||(n==c?.005:Math.min(1,.001*Math.abs(c-n)));if(dy.und(a.duration))if(a.decay){const e=!0===a.decay?.998:a.decay,r=Math.exp(-(1-e)*t);h=n+i/(1-e)*(1-r),u=Math.abs(o.lastPosition-h)<=d,s=i*r}else{s=null==o.lastVelocity?i:o.lastVelocity;const t=a.restVelocity||d/10,r=a.clamp?0:a.bounce,l=!dy.und(r),p=n==c?o.v0>0:n<c;let f,m=!1;const g=1,v=Math.ceil(e/g);for(let e=0;e<v&&(f=Math.abs(s)>t,f||(u=Math.abs(c-h)<=d,!u));++e){l&&(m=h==c||h>c==p,m&&(s=-s*r,h=c));s+=(1e-6*-a.tension*(h-c)+.001*-a.friction*s)/a.mass*g,h+=s*g}}else{let r=1;a.duration>0&&(this._memoizedDuration!==a.duration&&(this._memoizedDuration=a.duration,o.durationProgress>0&&(o.elapsedTime=a.duration*o.durationProgress,t=o.elapsedTime+=e)),r=(a.progress||0)+t/this._memoizedDuration,r=r>1?1:r<0?0:r,o.durationProgress=r),h=n+a.easing(r)*(c-n),s=(h-o.lastPosition)/e,u=1==r}o.lastVelocity=s,Number.isNaN(h)&&(u=!0)}s&&!s[l].done&&(u=!1),u?o.done=!0:t=!1,o.setValue(h,a.round)&&(n=!0)});const o=D_(this),l=o.getValue();if(t){const e=r_(r.to);l===e&&!n||a.decay?n&&a.decay&&this._onChange(l):(o.setValue(e),this._onChange(e)),this._stop()}else n&&this._onChange(l)}set(e){return Xv.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Mx(this)){const{to:e,config:t}=this.animation;Xv.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let n;return dy.und(e)?(n=this.queue||[],this.queue=[]):n=[dy.obj(e)?e:{...t,to:e}],Promise.all(n.map(e=>this._update(e))).then(e=>ux(this,e))}stop(e){const{to:t}=this.animation;return this._focus(this.get()),mx(this._state,e&&this._lastCallId),Xv.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){const t=this.key||"";let{to:n,from:r}=e;n=dy.obj(n)?n[t]:n,(null==n||rx(n))&&(n=void 0),r=dy.obj(r)?r[t]:r,null==r&&(r=void 0);const i={to:n,from:r};return Sx(this)||(e.reverse&&([n,r]=[r,n]),r=r_(r),dy.und(r)?D_(this)||this._set(n):this._set(r)),i}_update({...e},t){const{key:n,defaultProps:r}=this;e.default&&Object.assign(r,K_(e,(e,t)=>/^on/.test(t)?Z_(e,n):e)),Lx(this,e,"onProps"),Ux(this,"onProps",e,this);const i=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const a=this._state;return cx(++this._lastCallId,{key:n,props:e,defaultProps:r,state:a,actions:{pause:()=>{wx(this)||(Ex(this,!0),xy(a.pauseQueue),Ux(this,"onPause",dx(this,Cx(this,this.animation.to)),this))},resume:()=>{wx(this)&&(Ex(this,!1),Mx(this)&&this._resume(),xy(a.resumeQueue),Ux(this,"onResume",dx(this,Cx(this,this.animation.to)),this))},start:this._merge.bind(this,i)}}).then(n=>{if(e.loop&&n.finished&&(!t||!n.noop)){const t=Rx(e);if(t)return this._update(t,!0)}return n})}_merge(e,t,n){if(t.cancel)return this.stop(!0),n(px(this));const r=!dy.und(e.to),i=!dy.und(e.from);if(r||i){if(!(t.callId>this._lastToId))return n(px(this));this._lastToId=t.callId}const{key:a,defaultProps:s,animation:o}=this,{to:l,from:c}=o;let{to:u=l,from:h=c}=e;!i||r||t.default&&!dy.und(u)||(u=h),t.reverse&&([u,h]=[h,u]);const d=!py(h,c);d&&(o.from=h),h=r_(h);const p=!py(u,l);p&&this._focus(u);const f=rx(t.to),{config:m}=o,{decay:g,velocity:v}=m;(r||i)&&(m.velocity=0),t.config&&!f&&function(e,t,n){n&&(sx(n={...n},t),t={...n,...t}),sx(e,t),Object.assign(e,t);for(const s in ix)null==e[s]&&(e[s]=ix[s]);let{frequency:r,damping:i}=e;const{mass:a}=e;dy.und(r)||(r<.01&&(r=.01),i<0&&(i=0),e.tension=Math.pow(2*Math.PI/r,2)*a,e.friction=4*Math.PI*i*a/r)}(m,q_(t.config,a),t.config!==s.config?q_(s.config,a):void 0);let y=D_(this);if(!y||dy.und(u))return n(dx(this,!0));const _=dy.und(t.reset)?i&&!t.default:!dy.und(h)&&Y_(t.reset,a),x=_?h:this.get(),b=nx(u),S=dy.num(b)||dy.arr(b)||T_(b),M=!f&&(!S||Y_(s.immediate||t.immediate,a));if(p){const e=H_(u);if(e!==y.constructor){if(!M)throw Error(`Cannot animate between ${y.constructor.name} and ${e.name}, as the "to" prop suggests`);y=this._set(b)}}const w=y.constructor;let T=n_(u),E=!1;if(!T){const e=_||!Sx(this)&&d;(p||e)&&(E=py(nx(x),b),T=!E),(py(o.immediate,M)||M)&&py(m.decay,g)&&py(m.velocity,v)||(T=!0)}if(E&&Mx(this)&&(o.changed&&!_?T=!0:T||this._stop(l)),!f&&((T||n_(l))&&(o.values=y.getPayload(),o.toValues=n_(u)?null:w==F_?[1]:gy(b)),o.immediate!=M&&(o.immediate=M,M||_||this._set(l)),T)){const{onRest:e}=o;fy(Nx,e=>Lx(this,t,e));const r=dx(this,Cx(this,l));xy(this._pendingCalls,r),this._pendingCalls.add(n),o.changed&&Xv.batchedUpdates(()=>{o.changed=!_,e?.(r,this),_?q_(s.onRest,r):o.onStart?.(r,this)})}_&&this._set(x),f?n(fx(t.to,t,this._state,this)):T?this._start():Mx(this)&&!p?this._pendingCalls.add(n):n(hx(x))}_focus(e){const t=this.animation;e!==t.to&&(i_(this)&&this._detach(),t.to=e,i_(this)&&this._attach())}_attach(){let e=0;const{to:t}=this.animation;n_(t)&&(l_(t,this),yx(t)&&(e=t.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;n_(e)&&c_(e,this)}_set(e,t=!0){const n=r_(e);if(!dy.und(n)){const e=D_(this);if(!e||!py(n,e.getValue())){const r=H_(n);e&&e.constructor==r?e.setValue(n):N_(this,r.create(n)),e&&Xv.batchedUpdates(()=>{this._onChange(n,t)})}}return D_(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,Ux(this,"onStart",dx(this,Cx(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),q_(this.animation.onChange,e,this)),q_(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){const e=this.animation;D_(this).reset(r_(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),Mx(this)||(Tx(this,!0),wx(this)||this._resume())}_resume(){uy.skipAnimation?this.finish():Py.start(this)}_stop(e,t){if(Mx(this)){Tx(this,!1);const n=this.animation;fy(n.values,e=>{e.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),a_(this,{type:"idle",parent:this});const r=t?px(this.get()):dx(this.get(),Cx(this,e??n.to));xy(this._pendingCalls,r),n.changed&&(n.changed=!1,Ux(this,"onRest",r,this))}}};function Cx(e,t){const n=nx(t);return py(nx(e.get()),n)}function Rx(e,t=e.loop,n=e.to){const r=q_(t);if(r){const i=!0!==r&&tx(r),a=(i||e).reverse,s=!i||i.reset;return Px({...e,loop:t,default:!1,pause:void 0,to:!a||rx(n)?n:void 0,from:s?e.from:void 0,reset:s,...i})}}function Px(e){const{to:t,from:n}=e=tx(e),r=new Set;return dy.obj(t)&&Dx(t,r),dy.obj(n)&&Dx(n,r),e.keys=r.size?Array.from(r):null,e}function Ix(e){const t=Px(e);return dy.und(t.default)&&(t.default=K_(t)),t}function Dx(e,t){my(e,(e,n)=>null!=e&&t.add(n))}var Nx=["onStart","onRest","onChange","onPause","onResume"];function Lx(e,t,n){e.animation[n]=t[n]!==J_(t,n)?Z_(t[n],e.key):void 0}function Ux(e,t,...n){e.animation[t]?.(...n),e.defaultProps[t]?.(...n)}var Ox=["onStart","onChange","onRest"],Fx=1,kx=class{constructor(e,t){this.id=Fx++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((t,n)=>e[n]=t.get()),e}set(e){for(const t in e){const n=e[t];dy.und(n)||this.springs[t].set(n)}}update(e){return e&&this.queue.push(Px(e)),this}start(e){let{queue:t}=this;return e?t=gy(e).map(Px):this.queue=[],this._flush?this._flush(this,t):(Wx(this,t),zx(this,t))}stop(e,t){if(e!==!!e&&(t=e),t){const n=this.springs;fy(gy(t),t=>n[t].stop(!!e))}else mx(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(dy.und(e))this.start({pause:!0});else{const t=this.springs;fy(gy(e),e=>t[e].pause())}return this}resume(e){if(dy.und(e))this.start({pause:!1});else{const t=this.springs;fy(gy(e),e=>t[e].resume())}return this}each(e){my(this.springs,e)}_onFrame(){const{onStart:e,onChange:t,onRest:n}=this._events,r=this._active.size>0,i=this._changed.size>0;(r&&!this._started||i&&!this._started)&&(this._started=!0,vy(e,([e,t])=>{t.value=this.get(),e(t,this,this._item)}));const a=!r&&this._started,s=i||a&&n.size?this.get():null;i&&t.size&&vy(t,([e,t])=>{t.value=s,e(t,this,this._item)}),a&&(this._started=!1,vy(n,([e,t])=>{t.value=s,e(t,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}Xv.onFrame(this._onFrame)}};function zx(e,t){return Promise.all(t.map(t=>Bx(e,t))).then(t=>ux(e,t))}async function Bx(e,t,n){const{keys:r,to:i,from:a,loop:s,onRest:o,onResolve:l}=t,c=dy.obj(t.default)&&t.default;s&&(t.loop=!1),!1===i&&(t.to=null),!1===a&&(t.from=null);const u=dy.arr(i)||dy.fun(i)?i:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):fy(Ox,n=>{const r=t[n];if(dy.fun(r)){const i=e._events[n];t[n]=({finished:e,cancelled:t})=>{const n=i.get(r);n?(e||(n.finished=!1),t&&(n.cancelled=!0)):i.set(r,{value:null,finished:e||!1,cancelled:t||!1})},c&&(c[n]=t[n])}});const h=e._state;t.pause===!h.paused?(h.paused=t.pause,xy(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);const d=(r||Object.keys(e.springs)).map(n=>e.springs[n].start(t)),p=!0===t.cancel||!0===J_(t,"cancel");(u||p&&h.asyncId)&&d.push(cx(++e._lastAsyncId,{props:t,state:h,actions:{pause:hy,resume:hy,start(t,n){p?(mx(h,e._lastAsyncId),n(px(e))):(t.onRest=o,n(fx(u,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});const f=ux(e,await Promise.all(d));if(s&&f.finished&&(!n||!f.noop)){const n=Rx(t,s,i);if(n)return Wx(e,[n]),Bx(e,n,!0)}return l&&Xv.batchedUpdates(()=>l(f,e,e.item)),f}function Vx(e,t){const n={...e.springs};return t&&fy(gy(t),e=>{dy.und(e.keys)&&(e=Px(e)),dy.obj(e.to)||(e={...e,to:void 0}),Gx(n,e,e=>jx(e))}),Hx(e,n),n}function Hx(e,t){my(t,(t,n)=>{e.springs[n]||(e.springs[n]=t,l_(t,e))})}function jx(e,t){const n=new Ax;return n.key=e,t&&l_(n,t),n}function Gx(e,t,n){t.keys&&fy(t.keys,r=>{(e[r]||(e[r]=n(r)))._prepareNode(t)})}function Wx(e,t){fy(t,t=>{Gx(e.springs,t,t=>jx(t,e))})}var Xx=s.createContext({pause:!1,immediate:!1}),qx=()=>{const e=[],t=function(t){w_(`${b_}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);const r=[];return fy(e,(e,i)=>{if(dy.und(t))r.push(e.start());else{const a=n(t,e,i);a&&r.push(e.start(a))}}),r};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){const n=e.indexOf(t);~n&&e.splice(n,1)},t.pause=function(){return fy(e,e=>e.pause(...arguments)),this},t.resume=function(){return fy(e,e=>e.resume(...arguments)),this},t.set=function(t){fy(e,(e,n)=>{const r=dy.fun(t)?t(n,e):t;r&&e.set(r)})},t.start=function(t){const n=[];return fy(e,(e,r)=>{if(dy.und(t))n.push(e.start());else{const i=this._getProps(t,e,r);i&&n.push(e.start(i))}}),n},t.stop=function(){return fy(e,e=>e.stop(...arguments)),this},t.update=function(t){return fy(e,(e,n)=>e.update(this._getProps(t,e,n))),this};const n=function(e,t,n){return dy.fun(e)?e(n,t):e};return t._getProps=n,t};function Yx(e,t){const n=dy.fun(e),[[r],i]=function(e,t,n){const r=dy.fun(t)&&t;r&&!n&&(n=[]);const i=s.useMemo(()=>r||3==arguments.length?qx():void 0,[]),a=s.useRef(0),o=A_(),l=s.useMemo(()=>({ctrls:[],queue:[],flush(e,t){const n=Vx(e,t);return a.current>0&&!l.queue.length&&!Object.keys(n).some(t=>!e.springs[t])?zx(e,t):new Promise(r=>{Hx(e,n),l.queue.push(()=>{r(zx(e,t))}),o()})}}),[]),c=s.useRef([...l.ctrls]),u=s.useRef([]),h=P_(e)||0;function d(e,n){for(let i=e;i<n;i++){const e=c.current[i]||(c.current[i]=new kx(null,l.flush)),n=r?r(i,e):t[i];n&&(u.current[i]=Ix(n))}}s.useMemo(()=>{fy(c.current.slice(e,h),e=>{!function(e,t){e.ref?.delete(e),t?.delete(e)}(e,i),e.stop(!0)}),c.current.length=e,d(h,e)},[e]),s.useMemo(()=>{d(0,Math.min(h,e))},n);const p=c.current.map((e,t)=>Vx(e,u.current[t])),f=s.useContext(Xx),m=P_(f),g=f!==m&&function(e){for(const t in e)return!0;return!1}(f);E_(()=>{a.current++,l.ctrls=c.current;const{queue:e}=l;e.length&&(l.queue=[],fy(e,e=>e())),fy(c.current,(e,t)=>{i?.add(e),g&&e.start({default:f});const n=u.current[t];n&&(function(e,t){t&&e.ref!==t&&(e.ref?.delete(e),t.add(e),e.ref=t)}(e,n.ref),e.ref?e.queue.push(n):e.start(n))})}),C_(()=>()=>{fy(l.ctrls,e=>e.stop(!0))});const v=p.map(e=>({...e}));return i?[v,i]:v}(1,n?e:[e],n?[]:t);return n||2==arguments.length?[r,i]:r}var Zx=class extends xx{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=Qy(...t);const n=this._get(),r=H_(n);N_(this,r.create(n))}advance(e){const t=this._get();py(t,this.get())||(D_(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&$x(this._active)&&Kx(this)}_get(){const e=dy.arr(this.source)?this.source.map(r_):gy(r_(this.source));return this.calc(...e)}_start(){this.idle&&!$x(this._active)&&(this.idle=!1,fy(L_(this),e=>{e.done=!1}),uy.skipAnimation?(Xv.batchedUpdates(()=>this.advance()),Kx(this)):Py.start(this))}_attach(){let e=1;fy(gy(this.source),t=>{n_(t)&&l_(t,this),yx(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){fy(gy(this.source),e=>{n_(e)&&c_(e,this)}),this._active.clear(),Kx(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=gy(this.source).reduce((e,t)=>Math.max(e,(yx(t)?t.priority:0)+1),0))}};function Jx(e){return!1!==e.idle}function $x(e){return!e.size||Array.from(e).every(Jx)}function Kx(e){e.idle||(e.idle=!0,fy(L_(e),e=>{e.done=!0}),a_(e,{type:"idle",parent:e}))}uy.assign({createStringInterpolator:x_,to:(e,t)=>new Zx(e,t)});var Qx=["primitive"].concat(Object.keys(Cp).filter(e=>/^[A-Z]/.test(e)).map(e=>e[0].toLowerCase()+e.slice(1)));uy.assign({createStringInterpolator:x_,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),function(e,t){const n={callback:e};t.add(n)}(()=>{Xv.advance()},Sm);var eb=((e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:n=e=>new z_(e),getComponentProps:r=e=>e}={})=>{const i={applyAnimatedValues:t,createAnimatedStyle:n,getComponentProps:r},a=e=>{const t=X_(e)||"Anonymous";return(e=dy.str(e)?a[e]||(a[e]=j_(e,i)):e[W_]||(e[W_]=j_(e,i))).displayName=`Animated(${t})`,e};return my(e,(t,n)=>{dy.arr(e)&&(n=X_(t)),a[n]=a(t)}),{animated:a}})(Qx,{applyAnimatedValues:Of}).animated;function tb({position:e,status:t,productivity:r,temperature:i}){const a=s.useRef(),[o,l]=s.useState(!1),[c,u]=s.useState(!1);qf(e=>{if(a.current){a.current.rotation.y+=.01*r;const t=1+.05*Math.sin(2*e.clock.elapsedTime);a.current.scale.setScalar(t)}});const{scale:h}=Yx({scale:o?1.1:1,config:{mass:1,tension:280,friction:60}}),d=()=>{switch(t){case"running":return"#00ff00";case"warning":return"#ffaa00";case"error":return"#ff0000";default:return"#808080"}};return n.jsxDEV("group",{position:e,children:[n.jsxDEV(eb.mesh,{ref:a,scale:h,onPointerOver:()=>l(!0),onPointerOut:()=>l(!1),onClick:()=>u(!c),children:[n.jsxDEV(tv,{args:[2,3,4],children:n.jsxDEV("meshStandardMaterial",{color:d(),metalness:.8,roughness:.2,emissive:d(),emissiveIntensity:.2},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:80,columnNumber:11},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:79,columnNumber:9},this),n.jsxDEV("pointLight",{color:d(),intensity:2,distance:10,position:[0,2,0]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:90,columnNumber:9},this),c&&n.jsxDEV(ng,{distanceFactor:10,position:[0,4,0],children:n.jsxDEV("div",{className:"bg-black/90 text-green-400 p-4 rounded-lg backdrop-blur-lg border border-green-500 min-w-[200px]",children:[n.jsxDEV("h3",{className:"text-lg font-bold mb-2",children:"Production Line A1"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:101,columnNumber:15},this),n.jsxDEV("div",{className:"space-y-1 text-sm",children:[n.jsxDEV("p",{children:["Status: ",n.jsxDEV("span",{className:"text-yellow-400",children:t},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:103,columnNumber:28},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:103,columnNumber:17},this),n.jsxDEV("p",{children:["Productivity: ",n.jsxDEV("span",{className:"text-cyan-400",children:[(100*r).toFixed(1),"%"]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:104,columnNumber:34},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:104,columnNumber:17},this),n.jsxDEV("p",{children:["Temperature: ",n.jsxDEV("span",{className:"text-orange-400",children:[i,"C"]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:105,columnNumber:33},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:105,columnNumber:17},this),n.jsxDEV("p",{children:["Units/Hour: ",n.jsxDEV("span",{className:"text-white",children:"1,247"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:106,columnNumber:32},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:106,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:102,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:100,columnNumber:13},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:99,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:72,columnNumber:7},this),"running"===t&&n.jsxDEV(Gv,{count:50,scale:4,size:2,speed:.5,color:d()},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:115,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:71,columnNumber:5},this)}function nb({start:e,end:t}){const r=s.useRef([]);return qf(n=>{r.current.forEach((n,r)=>{n&&(n.position.x+=.02,n.position.x>t[0]&&(n.position.x=e[0]),n.rotation.y+=.05)})}),n.jsxDEV("group",{children:[n.jsxDEV("mesh",{position:[(e[0]+t[0])/2,0,0],children:n.jsxDEV(tv,{args:[t[0]-e[0],.1,1],children:n.jsxDEV("meshStandardMaterial",{color:"#333333",metalness:.5,roughness:.5},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:148,columnNumber:11},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:147,columnNumber:9},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:146,columnNumber:7},this),[...Array(5)].map((t,i)=>n.jsxDEV("mesh",{ref:e=>r.current[i]=e,position:[e[0]+3*i,.5,0],children:n.jsxDEV(tv,{args:[.5,.5,.5],children:n.jsxDEV("meshStandardMaterial",{color:"#4a90e2",metalness:.7,roughness:.3},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:160,columnNumber:13},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:159,columnNumber:11},this)},i,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:154,columnNumber:9},this))]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:144,columnNumber:5},this)}function rb({position:e}){const t=s.useRef(),[r,i]=s.useState(!0);return qf(e=>{if(t.current&&r){const n=e.clock.elapsedTime;t.current.rotation.y=.5*Math.sin(n),t.current.children[0].rotation.x=.3*Math.sin(2*n)}}),n.jsxDEV("group",{ref:t,position:e,children:[n.jsxDEV(nv,{args:[.3,.3,2],position:[0,1,0],children:n.jsxDEV("meshStandardMaterial",{color:"#ff6b6b",metalness:.9,roughness:.1},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:184,columnNumber:9},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:183,columnNumber:7},this),n.jsxDEV("group",{position:[0,2,0],children:n.jsxDEV(nv,{args:[.2,.2,1.5],rotation:[0,0,Math.PI/4],children:n.jsxDEV("meshStandardMaterial",{color:"#ff6b6b",metalness:.9,roughness:.1},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:188,columnNumber:11},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:187,columnNumber:9},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:186,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:182,columnNumber:5},this)}function ib(){const[e,t]=s.useState(new Date);return s.useEffect(()=>{const e=setInterval(()=>t(new Date),1e3);return()=>clearInterval(e)},[]),n.jsxDEV("div",{className:"absolute top-0 left-0 right-0 p-6 pointer-events-none",children:n.jsxDEV("div",{className:"flex justify-between items-start",children:[n.jsxDEV("div",{className:"bg-black/50 backdrop-blur-lg rounded-lg p-4 border border-cyan-500/50",children:[n.jsxDEV("h2",{className:"text-cyan-400 text-2xl font-bold mb-2",children:"FACTORY CONTROL"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:208,columnNumber:11},this),n.jsxDEV("p",{className:"text-green-400 font-mono",children:e.toLocaleTimeString()},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:209,columnNumber:11},this),n.jsxDEV("div",{className:"mt-2 space-y-1",children:[n.jsxDEV("p",{className:"text-white text-sm",children:["Production Rate: ",n.jsxDEV("span",{className:"text-yellow-400",children:"94.7%"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:211,columnNumber:64},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:211,columnNumber:13},this),n.jsxDEV("p",{className:"text-white text-sm",children:["Active Lines: ",n.jsxDEV("span",{className:"text-green-400",children:"12/14"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:212,columnNumber:61},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:212,columnNumber:13},this),n.jsxDEV("p",{className:"text-white text-sm",children:["System Health: ",n.jsxDEV("span",{className:"text-green-400",children:"OPTIMAL"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:213,columnNumber:62},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:213,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:210,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:207,columnNumber:9},this),n.jsxDEV("div",{className:"bg-black/50 backdrop-blur-lg rounded-lg p-4 border border-orange-500/50",children:[n.jsxDEV("h3",{className:"text-orange-400 font-bold mb-2",children:"ALERTS"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:218,columnNumber:11},this),n.jsxDEV("div",{className:"space-y-1 text-sm",children:[n.jsxDEV("p",{className:"text-yellow-300",children:" Line 7: Maintenance in 2 hours"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:220,columnNumber:13},this),n.jsxDEV("p",{className:"text-green-300",children:" Line 3: Efficiency improved 12%"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:221,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:219,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:217,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:206,columnNumber:7},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:205,columnNumber:5},this)}function ab(){const[e,t]=s.useState([20,15,20]);return s.useState(null),n.jsxDEV("div",{className:"relative w-full h-screen bg-gradient-to-b from-gray-900 to-black",children:[n.jsxDEV(ib,{},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:236,columnNumber:7},this),n.jsxDEV(Xm,{shadows:!0,dpr:[1,2],children:n.jsxDEV(s.Suspense,{fallback:null,children:[n.jsxDEV("ambientLight",{intensity:.2},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:241,columnNumber:11},this),n.jsxDEV("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize":[2048,2048]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:242,columnNumber:11},this),n.jsxDEV(Uv,{position:[0,20,0],angle:.3,penumbra:1,intensity:2,castShadow:!0,color:"#00ff00"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:248,columnNumber:11},this),n.jsxDEV(Iv,{preset:"warehouse"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:258,columnNumber:11},this),n.jsxDEV("fog",{attach:"fog",args:["#000000",10,100]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:259,columnNumber:11},this),n.jsxDEV(kv,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:260,columnNumber:11},this),n.jsxDEV("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.1,0],receiveShadow:!0,children:[n.jsxDEV("planeGeometry",{args:[100,100]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:264,columnNumber:13},this),n.jsxDEV(Qg,{blur:[300,100],resolution:2048,mixBlur:1,mixStrength:40,roughness:1,depthScale:1.2,minDepthThreshold:.4,maxDepthThreshold:1.4,color:"#101010",metalness:.5},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:265,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:263,columnNumber:11},this),n.jsxDEV(tb,{position:[-8,1.5,-5],status:"running",productivity:.95,temperature:72},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:280,columnNumber:11},this),n.jsxDEV(tb,{position:[0,1.5,-5],status:"running",productivity:.88,temperature:68},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:281,columnNumber:11},this),n.jsxDEV(tb,{position:[8,1.5,-5],status:"warning",productivity:.65,temperature:85},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:282,columnNumber:11},this),n.jsxDEV(tb,{position:[-8,1.5,5],status:"running",productivity:.92,temperature:70},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:283,columnNumber:11},this),n.jsxDEV(tb,{position:[0,1.5,5],status:"error",productivity:0,temperature:95},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:284,columnNumber:11},this),n.jsxDEV(tb,{position:[8,1.5,5],status:"running",productivity:.97,temperature:71},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:285,columnNumber:11},this),n.jsxDEV(nb,{start:[-15,.5,0],end:[15,.5,0]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:288,columnNumber:11},this),n.jsxDEV(rb,{position:[-5,0,0]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:291,columnNumber:11},this),n.jsxDEV(rb,{position:[5,0,0]},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:292,columnNumber:11},this),n.jsxDEV(Yg,{makeDefault:!0,position:e,fov:60},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:295,columnNumber:11},this),n.jsxDEV(Zg,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:5,maxDistance:50,maxPolarAngle:.45*Math.PI},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:296,columnNumber:11},this),n.jsxDEV(Dv,{"rotation-x":Math.PI/2,position:[0,-.08,0],opacity:.4,width:100,height:100,blur:2,far:50},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:314,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:239,columnNumber:9},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:238,columnNumber:7},this),n.jsxDEV("div",{className:"absolute bottom-0 left-0 right-0 p-6",children:n.jsxDEV("div",{className:"bg-black/70 backdrop-blur-lg rounded-lg p-4 border border-cyan-500/50",children:n.jsxDEV("div",{className:"flex justify-center space-x-4",children:[n.jsxDEV("button",{className:"px-6 py-2 bg-cyan-600 hover:bg-cyan-500 text-white rounded-lg transition-colors",children:"Overview"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:330,columnNumber:13},this),n.jsxDEV("button",{className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Production Lines"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:333,columnNumber:13},this),n.jsxDEV("button",{className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Quality Control"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:336,columnNumber:13},this),n.jsxDEV("button",{className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Maintenance"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:339,columnNumber:13},this),n.jsxDEV("button",{className:"px-6 py-2 bg-orange-600 hover:bg-orange-500 text-white rounded-lg transition-colors",children:"AI Insights"},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:342,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:329,columnNumber:11},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:328,columnNumber:9},this)},void 0,!1,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:327,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Projects/Sentia Manufacturing Dashboard/sentia-manufacturing-dashboard/src/components/3d/FactoryDigitalTwin.jsx",lineNumber:235,columnNumber:5},this)}export{ab as default};
