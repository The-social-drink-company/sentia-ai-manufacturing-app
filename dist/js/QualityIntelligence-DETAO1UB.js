import{r as e,j as t,l as s,b8 as a,ah as r,F as i}from"./chunk-CXAPUP0Z.js";import{u as l,a as n}from"./chunk-CKjaC5_Z.js";import{f as c}from"./index-VRpNwfdG.js";import"./chunk-CwR8AQSU.js";import"./chunk--CRELh3m.js";import"./chunk-VeJKilaK.js";import"./chunk-DELSdgG9.js";import"./chunk-l5C0fGLm.js";import"./chunk-Kk1dlRB6.js";import"./chunk-DJCy_cXY.js";import"./chunk-Dozjk7Op.js";const d=({className:d="",timeRange:o="24h",autoAnalysis:m=!0,...x})=>{l();const{subscribe:g,STREAM_TYPES:u}=n(),{resolvedTheme:p}=c(),[h,b]=e.useState({}),[y,f]=e.useState([]),[j,v]=e.useState([]),[N,w]=e.useState({}),[k,C]=e.useState([]),[R,$]=e.useState([]),[P,A]=e.useState({}),[S,D]=e.useState("overview"),[L,F]=e.useState(!1),Y={firstPassYield:{target:99.5,warning:98,critical:95},defectRate:{target:.5,warning:1,critical:2},cpk:{target:1.33,warning:1,critical:.67},scrapRate:{target:.5,warning:1,critical:2},reworkRate:{target:1,warning:2,critical:5},customerComplaints:{target:.1,warning:.5,critical:1}};e.useEffect(()=>g(u.QUALITY_DATA,e=>{q(e),m&&T(e)}),[g,u,m]);const q=e=>{b(t=>({...t,...e,timestamp:Date.now()})),v(t=>[...t,{timestamp:Date.now(),firstPassYield:e.firstPassYield,defectRate:e.defectRate,scrapRate:e.scrapRate}].slice(-100))},T=async(e=h)=>{F(!0);try{const t=await M(e);f(t.defectPatterns||[]),w(t.spcAnalysis||{}),C(t.alerts||[]),$(t.recommendations||[]),A(t.batchAnalysis||{})}catch(t){}finally{F(!1)}},M=async e=>{await new Promise(e=>setTimeout(e,1e3));return{defectPatterns:[{type:"dimensional",frequency:45,trend:"increasing",rootCause:"Tool wear on Station 3",severity:"high",affectedProducts:["Product A","Product B"]},{type:"surface_finish",frequency:28,trend:"stable",rootCause:"Coolant contamination",severity:"medium",affectedProducts:["Product C"]},{type:"assembly",frequency:12,trend:"decreasing",rootCause:"Improved training program",severity:"low",affectedProducts:["Product D"]}],spcAnalysis:{processCapability:{cp:1.25,cpk:1.18,pp:1.22,ppk:1.15},controlLimits:{ucl:2.5,lcl:.1,centerline:1.2},outOfControlPoints:[{timestamp:Date.now()-36e5,value:2.8,rule:"Point beyond UCL"},{timestamp:Date.now()-72e5,value:2.6,rule:"Two of three consecutive points"}]},alerts:[{id:"alert-001",type:"process_drift",severity:"high",message:"Process showing upward drift in defect rate",timestamp:Date.now(),actionRequired:!0},{id:"alert-002",type:"capability_warning",severity:"medium",message:"Process capability index below 1.33 threshold",timestamp:Date.now()-18e5,actionRequired:!1}],recommendations:[{id:"action-001",priority:"high",action:"Replace cutting tools on Station 3",impact:"Reduce dimensional defects by 60%",timeline:"2 hours",cost:"$450"},{id:"action-002",priority:"medium",action:"Schedule coolant system maintenance",impact:"Improve surface finish quality",timeline:"4 hours",cost:"$280"}],batchAnalysis:{batchesAnalyzed:24,conformingBatches:22,nonConformingBatches:2,averageYield:98.7,topDefects:["Dimensional tolerance","Surface roughness","Missing feature"]}}},U=e.useMemo(()=>N.controlLimits?{labels:j.map((e,t)=>`Point ${t+1}`),datasets:[{label:"Defect Rate",data:j.map(e=>e.defectRate),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.1},{label:"Upper Control Limit",data:new Array(j.length).fill(N.controlLimits.ucl),borderColor:"rgb(239, 68, 68)",borderDash:[5,5],pointRadius:0},{label:"Lower Control Limit",data:new Array(j.length).fill(N.controlLimits.lcl),borderColor:"rgb(239, 68, 68)",borderDash:[5,5],pointRadius:0},{label:"Center Line",data:new Array(j.length).fill(N.controlLimits.centerline),borderColor:"rgb(34, 197, 94)",borderDash:[10,5],pointRadius:0}]}:null,[j,N]),_=(e,t)=>{if("number"!=typeof e)return"N/A";switch(t){case"percentage":return`${e.toFixed(1)}%`;case"rate":return`${e.toFixed(2)}`;case"count":return Math.round(e);default:return e.toFixed(2)}},I=`\n    rounded-lg border shadow-sm\n    ${"dark"===p?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}\n  `,Q="dark"===p?"text-gray-100":"text-gray-900",z="dark"===p?"text-gray-300":"text-gray-600",B="dark"===p?"text-gray-400":"text-gray-500";return t.jsxs("div",{className:`space-y-6 ${d}`,...x,children:[t.jsx("div",{className:I,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(s,{className:"w-6 h-6 mr-3 text-green-600"}),t.jsx("h2",{className:`text-xl font-semibold ${Q}`,children:"Quality Intelligence System"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:(()=>{const e=.5*(h.firstPassYield||98.5)+.3*(100-(h.defectRate||1.2))+.2*(100-(h.scrapRate||.8));return Math.min(100,Math.max(0,e))})().toFixed(1)}),t.jsx("div",{className:`text-sm ${B}`,children:"Quality Score"})]}),t.jsx("button",{onClick:()=>T(),disabled:L,className:`\n                  px-4 py-2 rounded-lg font-medium transition-colors\n                  ${L?"bg-gray-200 text-gray-500 cursor-not-allowed dark:bg-gray-700":"bg-green-600 text-white hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600"}\n                `,children:L?"Analyzing...":"Run Analysis"})]})]}),t.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:["overview","spc","defects","batch","actions"].map(e=>t.jsx("button",{onClick:()=>D(e),className:`\n                  px-4 py-2 rounded-md text-sm font-medium transition-colors\n                  ${S===e?"bg-white shadow text-green-600 dark:bg-gray-800 dark:text-green-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}\n                `,children:e.toUpperCase()},e))})]})}),"overview"===S&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{key:"firstPassYield",label:"First Pass Yield",value:h.firstPassYield||98.5,format:"percentage"},{key:"defectRate",label:"Defect Rate",value:h.defectRate||1.2,format:"percentage"},{key:"scrapRate",label:"Scrap Rate",value:h.scrapRate||.8,format:"percentage"},{key:"reworkRate",label:"Rework Rate",value:h.reworkRate||2.1,format:"percentage"}].map(e=>{const s=((e,t)=>{const s=Y[e];return s?["defectRate","scrapRate","reworkRate","customerComplaints"].includes(e)?t<=s.target?"excellent":t<=s.warning?"good":t<=s.critical?"warning":"critical":t>=s.target?"excellent":t>=s.warning?"good":t>=s.critical?"warning":"critical":"unknown"})(e.key,e.value),a={excellent:"text-green-600 bg-green-100 dark:bg-green-900/30",good:"text-blue-600 bg-blue-100 dark:bg-blue-900/30",warning:"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30",critical:"text-red-600 bg-red-100 dark:bg-red-900/30"};return t.jsx("div",{className:I,children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:`text-sm font-medium ${z}`,children:e.label}),t.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${a[s]||a.critical}`,children:s.charAt(0).toUpperCase()+s.slice(1)})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:_(e.value,e.format)}),t.jsxs("div",{className:`text-xs mt-1 ${B}`,children:["Target: ",_(Y[e.key]?.target,e.format)]})]})},e.key)})}),"spc"===S&&U&&t.jsx("div",{className:I,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${Q}`,children:"Statistical Process Control"}),t.jsx("div",{className:"h-80",children:t.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50 dark:bg-gray-800 rounded-lg",children:t.jsxs("div",{className:"text-center",children:[t.jsx(a,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),t.jsx("p",{className:z,children:"SPC Chart Visualization"}),t.jsx("p",{className:`text-sm ${B}`,children:"Chart.js integration pending"})]})})}),N.processCapability&&t.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-6 pt-4 border-t border-gray-200 dark:border-slate-700",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:N.processCapability.cp.toFixed(2)}),t.jsx("div",{className:`text-sm ${B}`,children:"Cp"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:N.processCapability.cpk.toFixed(2)}),t.jsx("div",{className:`text-sm ${B}`,children:"Cpk"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:N.processCapability.pp.toFixed(2)}),t.jsx("div",{className:`text-sm ${B}`,children:"Pp"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:N.processCapability.ppk.toFixed(2)}),t.jsx("div",{className:`text-sm ${B}`,children:"Ppk"})]})]})]})}),"defects"===S&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx("div",{className:I,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${Q}`,children:"Defect Pattern Analysis"}),t.jsx("div",{className:"space-y-4",children:y.map((e,s)=>t.jsxs("div",{className:`\n                    p-4 rounded-lg border-l-4\n                    ${"high"===e.severity?"border-red-500 bg-red-50 dark:bg-red-900/20":"medium"===e.severity?"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"border-green-500 bg-green-50 dark:bg-green-900/20"}\n                  `,children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsxs("h4",{className:`font-medium ${Q}`,children:[e.type.replace("_"," ").toUpperCase()," Defects"]}),t.jsxs("div",{className:"flex items-center",children:["increasing"===e.trend?t.jsx(r,{className:"w-4 h-4 text-red-500 mr-1"}):"decreasing"===e.trend?t.jsx(r,{className:"w-4 h-4 text-green-500 mr-1 rotate-180"}):t.jsx("div",{className:"w-4 h-4 bg-gray-400 rounded mr-1"}),t.jsxs("span",{className:`text-sm ${z}`,children:[e.frequency," cases"]})]})]}),t.jsxs("p",{className:`text-sm mb-2 ${z}`,children:["Root Cause: ",e.rootCause]}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.affectedProducts.map(e=>t.jsx("span",{className:"\n                          text-xs px-2 py-1 rounded bg-blue-100 text-blue-800\n                          dark:bg-blue-900/30 dark:text-blue-400\n                        ",children:e},e))})]},s))})]})}),t.jsx("div",{className:I,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${Q}`,children:"Active Quality Alerts"}),t.jsx("div",{className:"space-y-3",children:k.map(e=>t.jsxs("div",{className:`\n                    p-3 rounded-lg flex items-start\n                    ${"high"===e.severity?"bg-red-50 dark:bg-red-900/20":"medium"===e.severity?"bg-yellow-50 dark:bg-yellow-900/20":"bg-blue-50 dark:bg-blue-900/20"}\n                  `,children:[t.jsx(i,{className:`\n                      w-5 h-5 mr-3 mt-0.5\n                      ${"high"===e.severity?"text-red-500":"medium"===e.severity?"text-yellow-500":"text-blue-500"}\n                    `}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:`font-medium ${Q}`,children:e.message}),t.jsx("p",{className:`text-sm ${B}`,children:new Date(e.timestamp).toLocaleString()}),e.actionRequired&&t.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded mt-2 inline-block dark:bg-red-900/30 dark:text-red-400",children:"Action Required"})]})]},e.id))})]})})]})]})};export{d as QualityIntelligence,d as default};
