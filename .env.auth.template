# Authentication & Security Configuration Template
# Copy this to your .env files and configure with your actual values

# === Core Authentication (Required) ===
VITE_CLERK_PUBLISHABLE_KEY=pk_test_Y2hhbXBpb24tYnVsbGRvZy05Mi5jbGVyay5hY2NvdW50cy5kZXYk
CLERK_SECRET_KEY=sk_test_EP6iF7prGbq73CscUPCOW8PAKol4pPaBG5iYdsDodq

# === Database Configuration ===
DATABASE_URL=postgresql://username:password@host:5432/database
DEV_DATABASE_URL=postgresql://username:password@host:5432/database_dev  
TEST_DATABASE_URL=postgresql://username:password@host:5432/database_test

# === Password & Session Security ===
# Password Policy Configuration
PASSWORD_MIN_LENGTH=12
PASSWORD_MAX_LENGTH=128
PASSWORD_COMPLEXITY_SCORE=8
PASSWORD_REUSE_PREVENTION=5
PASSWORD_MAX_AGE_DAYS=90

# Session Security
SESSION_TIMEOUT_MINUTES=30
REFRESH_TOKEN_EXPIRY_DAYS=7
MAX_SESSIONS_PER_USER=5

# Account Lockout Configuration
LOCKOUT_MAX_ATTEMPTS=5
LOCKOUT_BASE_MINUTES=15
LOCKOUT_MAX_MINUTES=1440

# === Multi-Entity & Global Readiness (Optional) ===
MULTI_ENTITY_ENABLED=false
MULTI_REGION_ENABLED=false
CROSS_ENTITY_ACCESS=false
REGION_SPECIFIC_DATA=false

# Default entity/region settings
DEFAULT_ENTITY_ID=
DEFAULT_REGION=UK
DEFAULT_CURRENCY=GBP
DEFAULT_TIMEZONE=Europe/London
DEFAULT_LOCALE=en-GB

# === SSO Configuration (Optional) ===
# Okta SSO
OKTA_ENABLED=false
OKTA_ISSUER=https://your-domain.okta.com
OKTA_CLIENT_ID=your-okta-client-id
OKTA_CLIENT_SECRET=your-okta-client-secret
OKTA_REDIRECT_URI=http://localhost:3000/auth/callback/okta

# Azure AD SSO
AZURE_AD_ENABLED=false
AZURE_AD_TENANT_ID=your-tenant-id
AZURE_AD_CLIENT_ID=your-client-id
AZURE_AD_CLIENT_SECRET=your-client-secret
AZURE_AD_AUTHORITY=https://login.microsoftonline.com/your-tenant-id

# Google Workspace SSO
GOOGLE_SSO_ENABLED=false
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/callback/google
GOOGLE_HOSTED_DOMAIN=your-domain.com

# === JIT (Just-In-Time) Provisioning ===
JIT_PROVISIONING_ENABLED=false
JIT_DEFAULT_ROLE=viewer
JIT_AUTO_APPROVE=false
JIT_DOMAIN_WHITELIST=company.com,subsidiary.com

# === Rate Limiting Configuration ===
RATE_LIMIT_GENERAL_REQUESTS=1000
RATE_LIMIT_GENERAL_WINDOW_MINUTES=15
RATE_LIMIT_AUTH_REQUESTS=20
RATE_LIMIT_AUTH_WINDOW_MINUTES=5
RATE_LIMIT_FAILED_LOGIN_REQUESTS=5
RATE_LIMIT_FAILED_LOGIN_WINDOW_MINUTES=15

# === Security Headers & CORS ===
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com
CSP_NONCE_ENABLED=true
HSTS_MAX_AGE_SECONDS=31536000

# === Audit & Monitoring ===
AUDIT_LOG_RETENTION_DAYS=90
SECURITY_ALERTS_ENABLED=true
FAILED_LOGIN_ALERT_THRESHOLD=3
SUSPICIOUS_ACTIVITY_DETECTION=true

# === Development & Testing ===
NODE_ENV=development
DEBUG_AUTH=false
SKIP_SSL_VERIFY=false
MOCK_SSO_RESPONSES=false

# === Optional: Redis for Session Storage ===
REDIS_URL=redis://localhost:6379
REDIS_SESSION_PREFIX=auth:session:
REDIS_CACHE_TTL_SECONDS=3600

# === Optional: Email Configuration for Password Reset ===
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=your-smtp-password
SMTP_FROM_NAME=Your App Name
SMTP_FROM_EMAIL=noreply@yourdomain.com

# === Logging Configuration ===
LOG_LEVEL=info
LOG_AUTH_EVENTS=true
LOG_AUDIT_TRAIL=true
LOG_SECURITY_EVENTS=true