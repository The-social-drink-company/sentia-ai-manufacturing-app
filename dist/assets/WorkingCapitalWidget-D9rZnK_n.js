import{a as e}from"./vendor-BPOA5ME_.js";import{j as t}from"./query-CJR12TOn.js";import{l as r}from"./index-BHgYpTK7.js";import"./auth-zWw5cpzK.js";class i extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){r.error(`Widget error in ${this.props.widgetName}:`,e,t)}render(){return this.state.hasError?t.jsxs("div",{style:{padding:"2rem",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb",minHeight:"200px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[t.jsxs("div",{style:{fontSize:"1.125rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:[this.props.widgetName||"Widget"," Loading..."]}),t.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280",textAlign:"center"},children:"Connecting to real-time data sources"}),t.jsx("div",{style:{marginTop:"1rem",width:"40px",height:"40px",border:"3px solid #e5e7eb",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}}),t.jsx("style",{children:"\n            @keyframes spin {\n              0% { transform: rotate(0deg); }\n              100% { transform: rotate(360deg); }\n            }\n          "})]}):this.props.children}}const s=({name:e})=>t.jsxs("div",{style:{padding:"2rem",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",minHeight:"200px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[t.jsx("div",{style:{width:"40px",height:"40px",border:"3px solid #e5e7eb",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"1rem"}}),t.jsxs("div",{style:{color:"#6b7280",fontSize:"0.875rem"},children:["Loading ",e,"..."]})]}),n=({name:e,message:r})=>t.jsxs("div",{style:{padding:"2rem",backgroundColor:"#fafafa",borderRadius:"8px",border:"1px dashed #d1d5db",minHeight:"200px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[t.jsx("svg",{style:{width:"48px",height:"48px",marginBottom:"1rem",color:"#9ca3af"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsxs("div",{style:{fontSize:"1rem",fontWeight:"500",color:"#6b7280",marginBottom:"0.5rem"},children:[e," - No Data Available"]}),t.jsx("div",{style:{fontSize:"0.875rem",color:"#9ca3af",textAlign:"center",maxWidth:"300px"},children:r||"Waiting for real-time data from external sources"})]}),a=({children:e,widgetName:r,loading:a=!1,hasData:o=!0,error:l=null,noDataMessage:d=null})=>a?t.jsx(s,{name:r}):o||l?l?t.jsx(n,{name:r,message:"Unable to connect to data source"}):t.jsx(i,{widgetName:r,children:e}):t.jsx(n,{name:r,message:d}),o=()=>{const[i,s]=e.useState(null),[n,o]=e.useState(!0);e.useEffect(()=>{(async()=>{try{const e=await fetch("/api/working-capital/current");if(e.ok){const t=await e.json();s(t)}}catch(e){r.log("Working capital data unavailable")}finally{o(!1)}})()},[]);const l=i||{arDays:0,apDays:0,cashCycle:0,workingCapital:0};return t.jsx(a,{widgetName:"Working Capital",loading:n,hasData:!n,children:t.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"white",borderRadius:"8px"},children:[t.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"600",marginBottom:"1rem"},children:"Working Capital Metrics"}),t.jsxs("div",{style:{display:"grid",gap:"0.75rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#6b7280"},children:"AR Days:"}),t.jsx("span",{style:{fontWeight:"600"},children:l.arDays||0})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#6b7280"},children:"AP Days:"}),t.jsx("span",{style:{fontWeight:"600"},children:l.apDays||0})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#6b7280"},children:"Cash Cycle:"}),t.jsxs("span",{style:{fontWeight:"600"},children:[l.cashCycle||0," days"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"0.75rem",borderTop:"1px solid #e5e7eb"},children:[t.jsx("span",{style:{color:"#6b7280"},children:"Working Capital:"}),t.jsxs("span",{style:{fontWeight:"bold",fontSize:"1.125rem"},children:["$",l.workingCapital||0]})]})]})]})})};export{o as default};
