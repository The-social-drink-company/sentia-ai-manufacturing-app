var t,e,n,i,r,s,a,o,l,c,h,u,d,p,f,m,g,v,y,_,x,b,M,w,S,T,E,A,C,R,P,O,I,D,L,N,U,F,k,B,z,V,H,W,j,G,X,q,Y,K,Z,$,J,Q,tt,et,nt,it,rt,st,at,ot,lt,ct,ht,ut,dt,pt,ft,mt,gt,vt,yt,_t,xt,bt,Mt,wt,St,Tt,Et,At,Ct=Object.defineProperty,Rt=t=>{throw TypeError(t)},Pt=(t,e,n)=>((t,e,n)=>e in t?Ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n),Ot=(t,e,n)=>e.has(t)||Rt("Cannot "+n),It=(t,e,n)=>(Ot(t,e,"read from private field"),n?n.call(t):e.get(t)),Dt=(t,e,n)=>e.has(t)?Rt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Lt=(t,e,n,i)=>(Ot(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Nt=(t,e,n)=>(Ot(t,e,"access private method"),n),Ut=(t,e,n,i)=>({set _(i){Lt(t,e,i,n)},get _(){return It(t,e,i)}});import{c as Ft,r as kt,R as Bt}from"./react-core-DlJGLw67.js";import{a as zt,g as Vt}from"./charts-C-BUlHpY.js";import{c as Ht}from"./vendor-utils-W0IPh-on.js";function Wt(){return Wt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Wt.apply(this,arguments)}(At=Et||(Et={})).Pop="POP",At.Push="PUSH",At.Replace="REPLACE";const jt="popstate";function Gt(t){return void 0===t&&(t={}),function(t,e,n,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o=Et.Pop,l=null,c=h();null==c&&(c=0,a.replaceState(Wt({},a.state,{idx:c}),""));function h(){return(a.state||{idx:null}).idx}function u(){o=Et.Pop;let t=h(),e=null==t?null:t-c;c=t,l&&l({action:o,location:m.location,delta:e})}function d(t,e){o=Et.Push;let n=Kt(m.location,t,e);c=h()+1;let i=Yt(n,c),u=m.createHref(n);try{a.pushState(i,"",u)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;r.location.assign(u)}s&&l&&l({action:o,location:m.location,delta:1})}function p(t,e){o=Et.Replace;let n=Kt(m.location,t,e);c=h();let i=Yt(n,c),r=m.createHref(n);a.replaceState(i,"",r),s&&l&&l({action:o,location:m.location,delta:0})}function f(t){let e="null"!==r.location.origin?r.location.origin:r.location.href,n="string"==typeof t?t:Zt(t);return n=n.replace(/ $/,"%20"),Xt(e,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,e)}let m={get action(){return o},get location(){return t(r,a)},listen(t){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(jt,u),l=t,()=>{r.removeEventListener(jt,u),l=null}},createHref:t=>e(r,t),createURL:f,encodeLocation(t){let e=f(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:d,replace:p,go:t=>a.go(t)};return m}(function(t,e){let{pathname:n,search:i,hash:r}=t.location;return Kt("",{pathname:n,search:i,hash:r},e.state&&e.state.usr||null,e.state&&e.state.key||"default")},function(t,e){return"string"==typeof e?e:Zt(e)},0,t)}function Xt(t,e){if(!1===t||null==t)throw new Error(e)}function qt(t,e){if(!t)try{throw new Error(e)}catch(n){}}function Yt(t,e){return{usr:t.state,key:t.key,idx:e}}function Kt(t,e,n,i){return void 0===n&&(n=null),Wt({pathname:"string"==typeof t?t:t.pathname,search:"",hash:""},"string"==typeof e?$t(e):e,{state:n,key:e&&e.key||i||Math.random().toString(36).substr(2,8)})}function Zt(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(e+="#"===i.charAt(0)?i:"#"+i),e}function $t(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}var Jt,Qt;function te(t,e,n){return void 0===n&&(n="/"),function(t,e,n){let i="string"==typeof e?$t(e):e,r=fe(i.pathname||"/",n);if(null==r)return null;let s=ee(t);!function(t){t.sort((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let n=t.length===e.length&&t.slice(0,-1).every((t,n)=>t===e[n]);return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map(t=>t.childrenIndex),e.routesMeta.map(t=>t.childrenIndex)))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let t=pe(r);a=ue(s[o],t)}return a}(t,e,n)}function ee(t,e,n,i){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(t,r,s)=>{let a={relativePath:void 0===s?t.path||"":s,caseSensitive:!0===t.caseSensitive,childrenIndex:r,route:t};a.relativePath.startsWith("/")&&(Xt(a.relativePath.startsWith(i),'Absolute route path "'+a.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(i.length));let o=ye([i,a.relativePath]),l=n.concat(a);t.children&&t.children.length>0&&(Xt(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),ee(t.children,e,l,o)),(null!=t.path||t.index)&&e.push({path:o,score:he(o,t.index),routesMeta:l})};return t.forEach((t,e)=>{var n;if(""!==t.path&&null!=(n=t.path)&&n.includes("?"))for(let i of ne(t.path))r(t,e,i);else r(t,e)}),e}function ne(t){let e=t.split("/");if(0===e.length)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let a=ne(i.join("/")),o=[];return o.push(...a.map(t=>""===t?s:[s,t].join("/"))),r&&o.push(...a),o.map(e=>t.startsWith("/")&&""===e?"/":e)}(Qt=Jt||(Jt={})).data="data",Qt.deferred="deferred",Qt.redirect="redirect",Qt.error="error";const ie=/^:[\w-]+$/,re=3,se=2,ae=1,oe=10,le=-2,ce=t=>"*"===t;function he(t,e){let n=t.split("/"),i=n.length;return n.some(ce)&&(i+=le),e&&(i+=se),n.filter(t=>!ce(t)).reduce((t,e)=>t+(ie.test(e)?re:""===e?ae:oe),i)}function ue(t,e,n){let{routesMeta:i}=t,r={},s="/",a=[];for(let o=0;o<i.length;++o){let t=i[o],n=o===i.length-1,l="/"===s?e:e.slice(s.length)||"/",c=de({path:t.relativePath,caseSensitive:t.caseSensitive,end:n},l),h=t.route;if(!c)return null;Object.assign(r,c.params),a.push({params:r,pathname:ye([s,c.pathname]),pathnameBase:_e(ye([s,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(s=ye([s,c.pathnameBase]))}return a}function de(t,e){"string"==typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);qt("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(t,e,n)=>(i.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));t.endsWith("*")?(i.push({paramName:"*"}),r+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==t&&"/"!==t&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,e?void 0:"i");return[s,i]}(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:i.reduce((t,e,n)=>{let{paramName:i,isOptional:r}=e;if("*"===i){let t=o[n]||"";a=s.slice(0,s.length-t.length).replace(/(.)\/+$/,"$1")}const l=o[n];return t[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),t},{}),pathname:s,pathnameBase:a,pattern:t}}function pe(t){try{return t.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(e){return qt(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function fe(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&"/"!==i?null:t.slice(n)||"/"}function me(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function ge(t,e){let n=function(t){return t.filter((t,e)=>0===e||t.route.path&&t.route.path.length>0)}(t);return e?n.map((t,e)=>e===n.length-1?t.pathname:t.pathnameBase):n.map(t=>t.pathnameBase)}function ve(t,e,n,i){let r;void 0===i&&(i=!1),"string"==typeof t?r=$t(t):(r=Wt({},t),Xt(!r.pathname||!r.pathname.includes("?"),me("?","pathname","search",r)),Xt(!r.pathname||!r.pathname.includes("#"),me("#","pathname","hash",r)),Xt(!r.search||!r.search.includes("#"),me("#","search","hash",r)));let s,a=""===t||""===r.pathname,o=a?"/":r.pathname;if(null==o)s=n;else{let t=e.length-1;if(!i&&o.startsWith("..")){let e=o.split("/");for(;".."===e[0];)e.shift(),t-=1;r.pathname=e.join("/")}s=t>=0?e[t]:"/"}let l=function(t,e){void 0===e&&(e="/");let{pathname:n,search:i="",hash:r=""}="string"==typeof t?$t(t):t,s=n?n.startsWith("/")?n:function(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)}),n.length>1?n.join("/"):"/"}(n,e):e;return{pathname:s,search:xe(i),hash:be(r)}}(r,s),c=o&&"/"!==o&&o.endsWith("/"),h=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!h||(l.pathname+="/"),l}const ye=t=>t.join("/").replace(/\/\/+/g,"/"),_e=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),xe=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",be=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";function Me(t){return null!=t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"boolean"==typeof t.internal&&"data"in t}const we=["post","put","patch","delete"];new Set(we);const Se=["get",...we];new Set(Se);var Te,Ee,Ae={exports:{}},Ce={};function Re(){return Ee||(Ee=1,Ae.exports=function(){if(Te)return Ce;Te=1;var t=Ft(),e="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},n=t.useState,i=t.useEffect,r=t.useLayoutEffect,s=t.useDebugValue;function a(t){var n=t.getSnapshot;t=t.value;try{var i=n();return!e(t,i)}catch(r){return!0}}var o="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var o=e(),l=n({inst:{value:o,getSnapshot:e}}),c=l[0].inst,h=l[1];return r(function(){c.value=o,c.getSnapshot=e,a(c)&&h({inst:c})},[t,o,e]),i(function(){return a(c)&&h({inst:c}),t(function(){a(c)&&h({inst:c})})},[t]),s(o),o};return Ce.useSyncExternalStore=void 0!==t.useSyncExternalStore?t.useSyncExternalStore:o,Ce}()),Ae.exports}var Pe=Re();var Oe=Object.prototype.hasOwnProperty;const Ie=new WeakMap,De=()=>{},Le=De(),Ne=Object,Ue=t=>t===Le,Fe=t=>"function"==typeof t,ke=(t,e)=>({...t,...e}),Be=t=>Fe(t.then),ze={},Ve={},He="undefined",We=typeof window!=He,je=typeof document!=He,Ge=We&&"Deno"in window,Xe=(t,e)=>{const n=Ie.get(t);return[()=>!Ue(e)&&t.get(e)||ze,i=>{if(!Ue(e)){const r=t.get(e);e in Ve||(Ve[e]=r),n[5](e,ke(r,i),r||ze)}},n[6],()=>!Ue(e)&&e in Ve?Ve[e]:!Ue(e)&&t.get(e)||ze]};let qe=!0;const[Ye,Ke]=We&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[De,De],Ze={isOnline:()=>qe,isVisible:()=>{const t=je&&document.visibilityState;return Ue(t)||"hidden"!==t}},$e={initFocus:t=>(je&&document.addEventListener("visibilitychange",t),Ye("focus",t),()=>{je&&document.removeEventListener("visibilitychange",t),Ke("focus",t)}),initReconnect:t=>{const e=()=>{qe=!0,t()},n=()=>{qe=!1};return Ye("online",e),Ye("offline",n),()=>{Ke("online",e),Ke("offline",n)}}},Je=!Bt.useId,Qe=!We||Ge,tn=t=>We&&typeof window.requestAnimationFrame!=He?window.requestAnimationFrame(t):setTimeout(t,1),en=Qe?kt.useEffect:kt.useLayoutEffect,nn="undefined"!=typeof navigator&&navigator.connection,rn=!Qe&&nn&&(["slow-2g","2g"].includes(nn.effectiveType)||nn.saveData),sn=new WeakMap,an=(t,e)=>t===`[object ${e}]`;let on=0;const ln=t=>{const e=typeof t,n=(i=t,Ne.prototype.toString.call(i));var i;const r=an(n,"Date"),s=an(n,"RegExp"),a=an(n,"Object");let o,l;if(Ne(t)!==t||r||s)o=r?t.toJSON():"symbol"==e?t.toString():"string"==e?JSON.stringify(t):""+t;else{if(o=sn.get(t),o)return o;if(o=++on+"~",sn.set(t,o),Array.isArray(t)){for(o="@",l=0;l<t.length;l++)o+=ln(t[l])+",";sn.set(t,o)}if(a){o="#";const e=Ne.keys(t).sort();for(;!Ue(l=e.pop());)Ue(t[l])||(o+=l+":"+ln(t[l])+",");sn.set(t,o)}}return o},cn=t=>{if(Fe(t))try{t=t()}catch(n){t=""}const e=t;return[t="string"==typeof t?t:(Array.isArray(t)?t.length:t)?ln(t):"",e]};let hn=0;const un=()=>++hn;async function dn(...t){const[e,n,i,r]=t,s=ke({populateCache:!0,throwOnError:!0},"boolean"==typeof r?{revalidate:r}:r||{});let a=s.populateCache;const o=s.rollbackOnError;let l=s.optimisticData;const c=s.throwOnError;if(Fe(n)){const t=n,i=[],r=e.keys();for(const n of r)!/^\$(inf|sub)\$/.test(n)&&t(e.get(n)._k)&&i.push(n);return Promise.all(i.map(h))}return h(n);async function h(n){const[r]=cn(n);if(!r)return;const[h,u]=Xe(e,r),[d,p,f,m]=Ie.get(e),g=()=>{const t=d[r];return(Fe(s.revalidate)?s.revalidate(h().data,n):!1!==s.revalidate)&&(delete f[r],delete m[r],t&&t[0])?t[0](2).then(()=>h().data):h().data};if(t.length<3)return g();let v,y=i,_=!1;const x=un();p[r]=[x,0];const b=!Ue(l),M=h(),w=M.data,S=M._c,T=Ue(S)?w:S;if(b&&(l=Fe(l)?l(T,w):l,u({data:l,_c:T})),Fe(y))try{y=y(T)}catch(E){v=E,_=!0}if(y&&Be(y)){if(y=await y.catch(t=>{v=t,_=!0}),x!==p[r][0]){if(_)throw v;return y}_&&b&&(t=>"function"==typeof o?o(t):!1!==o)(v)&&(a=!0,u({data:T,_c:Le}))}if(a&&!_)if(Fe(a)){const t=a(y,T);u({data:t,error:Le,_c:Le})}else u({data:y,error:Le,_c:Le});if(p[r][1]=un(),Promise.resolve(g()).then(()=>{u({_c:Le})}),!_)return y;if(c)throw v}}const pn=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},fn=(t,e)=>{if(!Ie.has(t)){const n=ke($e,e),i=Object.create(null),r=dn.bind(Le,t);let s=De;const a=Object.create(null),o=(t,e)=>{const n=a[t]||[];return a[t]=n,n.push(e),()=>n.splice(n.indexOf(e),1)},l=(e,n,i)=>{t.set(e,n);const r=a[e];if(r)for(const t of r)t(n,i)},c=()=>{if(!Ie.has(t)&&(Ie.set(t,[i,Object.create(null),Object.create(null),Object.create(null),r,l,o]),!Qe)){const e=n.initFocus(setTimeout.bind(Le,pn.bind(Le,i,0))),r=n.initReconnect(setTimeout.bind(Le,pn.bind(Le,i,1)));s=()=>{e&&e(),r&&r(),Ie.delete(t)}}};return c(),[t,r,c,s]}return[t,Ie.get(t)[4]]},mn=function t(e,n){var i,r;if(e===n)return!0;if(e&&n&&(i=e.constructor)===n.constructor){if(i===Date)return e.getTime()===n.getTime();if(i===RegExp)return e.toString()===n.toString();if(i===Array){if((r=e.length)===n.length)for(;r--&&t(e[r],n[r]););return-1===r}if(!i||"object"==typeof e){for(i in r=0,e){if(Oe.call(e,i)&&++r&&!Oe.call(n,i))return!1;if(!(i in n)||!t(e[i],n[i]))return!1}return Object.keys(n).length===r}}return e!=e&&n!=n},[gn,vn]=fn(new Map),yn=ke({onLoadingSlow:De,onSuccess:De,onError:De,onErrorRetry:(t,e,n,i,r)=>{const s=n.errorRetryCount,a=r.retryCount,o=~~((Math.random()+.5)*(1<<(a<8?a:8)))*n.errorRetryInterval;!Ue(s)&&a>s||setTimeout(i,o,r)},onDiscarded:De,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:rn?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:rn?5e3:3e3,compare:mn,isPaused:()=>!1,cache:gn,mutate:vn,fallback:{}},Ze),_n=(t,e)=>{const n=ke(t,e);if(e){const{use:i,fallback:r}=t,{use:s,fallback:a}=e;i&&s&&(n.use=i.concat(s)),r&&a&&(n.fallback=ke(r,a))}return n},xn=kt.createContext({}),bn="$inf$",Mn=We&&window.__SWR_DEVTOOLS_USE__,wn=Mn?window.__SWR_DEVTOOLS_USE__:[],Sn=t=>Fe(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(null===t[1]?t[2]:t[1])||{}],Tn=()=>ke(yn,kt.useContext(xn)),En=wn.concat(t=>(e,n,i)=>t(e,n&&((...t)=>{const[i]=cn(e),[,,,r]=Ie.get(gn);if(i.startsWith(bn))return n(...t);const s=r[i];return Ue(s)?n(...t):(delete r[i],s)}),i));Mn&&(window.__SWR_DEVTOOLS_REACT__=Bt);const An=()=>{},Cn=An(),Rn=Object,Pn=t=>t===Cn,On=new WeakMap,In=(t,e)=>t===`[object ${e}]`;let Dn=0;const Ln=t=>{const e=typeof t,n=(i=t,Rn.prototype.toString.call(i));var i;const r=In(n,"Date"),s=In(n,"RegExp"),a=In(n,"Object");let o,l;if(Rn(t)!==t||r||s)o=r?t.toJSON():"symbol"==e?t.toString():"string"==e?JSON.stringify(t):""+t;else{if(o=On.get(t),o)return o;if(o=++Dn+"~",On.set(t,o),Array.isArray(t)){for(o="@",l=0;l<t.length;l++)o+=Ln(t[l])+",";On.set(t,o)}if(a){o="#";const e=Rn.keys(t).sort();for(;!Pn(l=e.pop());)Pn(t[l])||(o+=l+":"+Ln(t[l])+",");On.set(t,o)}}return o},Nn=Bt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Un={dedupe:!0},Fn=Ne.defineProperty(t=>{const{value:e}=t,n=kt.useContext(xn),i=Fe(e),r=kt.useMemo(()=>i?e(n):e,[i,n,e]),s=kt.useMemo(()=>i?r:_n(n,r),[i,n,r]),a=r&&r.provider,o=kt.useRef(Le);a&&!o.current&&(o.current=fn(a(s.cache||gn),r));const l=o.current;return l&&(s.cache=l[0],s.mutate=l[1]),en(()=>{if(l)return l[2]&&l[2](),l[3]},[]),kt.createElement(xn.Provider,ke(t,{value:s}))},"defaultValue",{value:yn}),kn=(Bn=(t,e,n)=>{const{cache:i,compare:r,suspense:s,fallbackData:a,revalidateOnMount:o,revalidateIfStale:l,refreshInterval:c,refreshWhenHidden:h,refreshWhenOffline:u,keepPreviousData:d}=n,[p,f,m,g]=Ie.get(i),[v,y]=cn(t),_=kt.useRef(!1),x=kt.useRef(!1),b=kt.useRef(v),M=kt.useRef(e),w=kt.useRef(n),S=()=>w.current,T=()=>S().isVisible()&&S().isOnline(),[E,A,C,R]=Xe(i,v),P=kt.useRef({}).current,O=Ue(a)?Ue(n.fallback)?Le:n.fallback[v]:a,I=(t,e)=>{for(const n in P){const i=n;if("data"===i){if(!r(t[i],e[i])){if(!Ue(t[i]))return!1;if(!r(V,e[i]))return!1}}else if(e[i]!==t[i])return!1}return!0},D=kt.useMemo(()=>{const t=!!v&&!!e&&(Ue(o)?!S().isPaused()&&!s&&!1!==l:o),n=e=>{const n=ke(e);return delete n._k,t?{isValidating:!0,isLoading:!0,...n}:n},i=E(),r=R(),a=n(i),c=i===r?a:n(r);let h=a;return[()=>{const t=n(E());return I(t,h)?(h.data=t.data,h.isLoading=t.isLoading,h.isValidating=t.isValidating,h.error=t.error,h):(h=t,t)},()=>c]},[i,v]),L=Pe.useSyncExternalStore(kt.useCallback(t=>C(v,(e,n)=>{I(n,e)||t()}),[i,v]),D[0],D[1]),N=!_.current,U=p[v]&&p[v].length>0,F=L.data,k=Ue(F)?O&&Be(O)?Nn(O):O:F,B=L.error,z=kt.useRef(k),V=d?Ue(F)?Ue(z.current)?k:z.current:F:k,H=!(U&&!Ue(B))&&(N&&!Ue(o)?o:!S().isPaused()&&(s?!Ue(k)&&l:Ue(k)||l)),W=!!(v&&e&&N&&H),j=Ue(L.isValidating)?W:L.isValidating,G=Ue(L.isLoading)?W:L.isLoading,X=kt.useCallback(async t=>{const e=M.current;if(!v||!e||x.current||S().isPaused())return!1;let i,s,a=!0;const o=t||{},l=!m[v]||!o.dedupe,c=()=>Je?!x.current&&v===b.current&&_.current:v===b.current,h={isValidating:!1,isLoading:!1},u=()=>{A(h)},d=()=>{const t=m[v];t&&t[1]===s&&delete m[v]},g={isValidating:!0};Ue(E().data)&&(g.isLoading=!0);try{if(l&&(A(g),n.loadingTimeout&&Ue(E().data)&&setTimeout(()=>{a&&c()&&S().onLoadingSlow(v,n)},n.loadingTimeout),m[v]=[e(y),un()]),[i,s]=m[v],i=await i,l&&setTimeout(d,n.dedupingInterval),!m[v]||m[v][1]!==s)return l&&c()&&S().onDiscarded(v),!1;h.error=Le;const t=f[v];if(!Ue(t)&&(s<=t[0]||s<=t[1]||0===t[1]))return u(),l&&c()&&S().onDiscarded(v),!1;const o=E().data;h.data=r(o,i)?o:i,l&&c()&&S().onSuccess(i,v,n)}catch(w){d();const t=S(),{shouldRetryOnError:e}=t;t.isPaused()||(h.error=w,l&&c()&&(t.onError(w,v,t),(!0===e||Fe(e)&&e(w))&&(S().revalidateOnFocus&&S().revalidateOnReconnect&&!T()||t.onErrorRetry(w,v,t,t=>{const e=p[v];e&&e[0]&&e[0](3,t)},{retryCount:(o.retryCount||0)+1,dedupe:!0}))))}return a=!1,u(),!0},[v,i]),q=kt.useCallback((...t)=>dn(i,b.current,...t),[]);if(en(()=>{M.current=e,w.current=n,Ue(F)||(z.current=F)}),en(()=>{if(!v)return;const t=X.bind(Le,Un);let e=0;if(S().revalidateOnFocus){const t=Date.now();e=t+S().focusThrottleInterval}const n=((t,e,n)=>{const i=e[t]||(e[t]=[]);return i.push(n),()=>{const t=i.indexOf(n);t>=0&&(i[t]=i[i.length-1],i.pop())}})(v,p,(n,i={})=>{if(0==n){const n=Date.now();S().revalidateOnFocus&&n>e&&T()&&(e=n+S().focusThrottleInterval,t())}else if(1==n)S().revalidateOnReconnect&&T()&&t();else{if(2==n)return X();if(3==n)return X(i)}});return x.current=!1,b.current=v,_.current=!0,A({_k:y}),H&&(m[v]||(Ue(k)||Qe?t():tn(t))),()=>{x.current=!0,n()}},[v]),en(()=>{let t;function e(){const e=Fe(c)?c(E().data):c;e&&-1!==t&&(t=setTimeout(n,e))}function n(){E().error||!h&&!S().isVisible()||!u&&!S().isOnline()?e():X(Un).then(e)}return e(),()=>{t&&(clearTimeout(t),t=-1)}},[c,h,u,v]),kt.useDebugValue(V),s&&Ue(k)&&v){if(!Je&&Qe)throw new Error("Fallback data is required when using Suspense in SSR.");M.current=e,w.current=n,x.current=!1;const t=g[v];if(!Ue(t)){const e=q(t);Nn(e)}if(!Ue(B))throw B;{const t=X(Un);Ue(V)||(t.status="fulfilled",t.value=!0),Nn(t)}}return{mutate:q,get data(){return P.data=!0,V},get error(){return P.error=!0,B},get isValidating(){return P.isValidating=!0,j},get isLoading(){return P.isLoading=!0,G}}},function(...t){const e=Tn(),[n,i,r]=Sn(t),s=_n(e,r);let a=Bn;const{use:o}=s,l=(o||[]).concat(En);for(let c=l.length;c--;)a=l[c](a);return a(n,i||s.fetcher||null,s)});var Bn;const zn=Object.freeze(Object.defineProperty({__proto__:null,SWRConfig:Fn,default:kn,mutate:vn,preload:(t,e)=>{const[n,i]=cn(t),[,,,r]=Ie.get(gn);if(r[n])return r[n];const s=e(i);return r[n]=s,s},unstable_serialize:t=>(t=>{if("function"==typeof t)try{t=t()}catch(n){t=""}const e=t;return[t="string"==typeof t?t:(Array.isArray(t)?t.length:t)?Ln(t):"",e]})(t)[0],useSWRConfig:Tn},Symbol.toStringTag,{value:"Module"})),Vn=()=>{},Hn=Vn(),Wn=Object,jn=t=>t===Hn,Gn=new WeakMap,Xn=(t,e)=>t===`[object ${e}]`;let qn=0;const Yn=t=>{const e=typeof t,n=(i=t,Wn.prototype.toString.call(i));var i;const r=Xn(n,"Date"),s=Xn(n,"RegExp"),a=Xn(n,"Object");let o,l;if(Wn(t)!==t||r||s)o=r?t.toJSON():"symbol"==e?t.toString():"string"==e?JSON.stringify(t):""+t;else{if(o=Gn.get(t),o)return o;if(o=++qn+"~",Gn.set(t,o),Array.isArray(t)){for(o="@",l=0;l<t.length;l++)o+=Yn(t[l])+",";Gn.set(t,o)}if(a){o="#";const e=Wn.keys(t).sort();for(;!jn(l=e.pop());)jn(t[l])||(o+=l+":"+Yn(t[l])+",");Gn.set(t,o)}}return o},Kn=t=>(t=>{if("function"==typeof t)try{t=t()}catch(n){t=""}const e=t;return[t="string"==typeof t?t:(Array.isArray(t)?t.length:t)?Yn(t):"",e]})(t?t(0,null):null)[0],Zn=Promise.resolve(),$n=(Jn=kn,Qn=t=>(e,n,i)=>{const r=kt.useRef(!1),{cache:s,initialSize:a=1,revalidateAll:o=!1,persistSize:l=!1,revalidateFirstPage:c=!0,revalidateOnMount:h=!1,parallel:u=!1}=i,[,,,d]=Ie.get(gn);let p;try{p=Kn(e),p&&(p=bn+p)}catch(S){}const[f,m,g]=Xe(s,p),v=kt.useCallback(()=>Ue(f()._l)?a:f()._l,[s,p,a]);Pe.useSyncExternalStore(kt.useCallback(t=>p?g(p,()=>{t()}):()=>{},[s,p]),v,v);const y=kt.useCallback(()=>{const t=f()._l;return Ue(t)?a:t},[p,a]),_=kt.useRef(y());en(()=>{r.current?p&&m({_l:l?_.current:y()}):r.current=!0},[p,s]);const x=h&&!r.current,b=t(p,async t=>{const r=f()._i,a=f()._r;m({_r:Le});const l=[],h=y(),[p]=Xe(s,t),g=p().data,v=[];let _=null;for(let f=0;f<h;++f){const[t,h]=cn(e(f,u?null:_));if(!t)break;const[p,m]=Xe(s,t);let y=p().data;const b=o||r||Ue(y)||c&&!f&&!Ue(g)||x||g&&!Ue(g[f])&&!i.compare(g[f],y);if(n&&("function"==typeof a?a(y,h):b)){const e=async()=>{if(t in d){const e=d[t];delete d[t],y=await e}else y=await n(h);m({data:y,_k:h}),l[f]=y};u?v.push(e):await e()}else l[f]=y;u||(_=y)}return u&&await Promise.all(v.map(t=>t())),m({_i:Le}),l},i),M=kt.useCallback(function(t,e){const n="boolean"==typeof e?{revalidate:e}:e||{},i=!1!==n.revalidate;return p?(i&&(Ue(t)?m({_i:!0,_r:n.revalidate}):m({_i:!1,_r:n.revalidate})),arguments.length?b.mutate(t,{...n,revalidate:i}):b.mutate()):Zn},[p,s]),w=kt.useCallback(t=>{if(!p)return Zn;const[,n]=Xe(s,p);let i;if(Fe(t)?i=t(y()):"number"==typeof t&&(i=t),"number"!=typeof i)return Zn;n({_l:i}),_.current=i;const r=[],[a]=Xe(s,p);let o=null;for(let l=0;l<i;++l){const[t]=cn(e(l,o)),[n]=Xe(s,t),i=t?n().data:Le;if(Ue(i))return M(a().data);r.push(i),o=i}return M(r)},[p,s,M,y]);return{size:y(),setSize:w,mutate:M,get data(){return b.data},get error(){return b.error},get isValidating(){return b.isValidating},get isLoading(){return b.isLoading}}},(...t)=>{const[e,n,i]=Sn(t),r=(i.use||[]).concat(Qn);return Jn(e,n,{...i,use:r})});var Jn,Qn,ti=Object.prototype.hasOwnProperty;function ei(t,e,n){for(n of t.keys())if(ni(n,e))return n}function ni(t,e){var n,i,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((i=t.length)===e.length)for(;i--&&ni(t[i],e[i]););return-1===i}if(n===Set){if(t.size!==e.size)return!1;for(i of t){if((r=i)&&"object"==typeof r&&!(r=ei(e,r)))return!1;if(!e.has(r))return!1}return!0}if(n===Map){if(t.size!==e.size)return!1;for(i of t){if((r=i[0])&&"object"==typeof r&&!(r=ei(e,r)))return!1;if(!ni(i[1],e.get(r)))return!1}return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((i=t.byteLength)===e.byteLength)for(;i--&&t.getInt8(i)===e.getInt8(i););return-1===i}if(ArrayBuffer.isView(t)){if((i=t.byteLength)===e.byteLength)for(;i--&&t[i]===e[i];);return-1===i}if(!n||"object"==typeof t){for(n in i=0,t){if(ti.call(t,n)&&++i&&!ti.call(e,n))return!1;if(!(n in e)||!ni(t[n],e[n]))return!1}return Object.keys(e).length===i}}return t!=t&&e!=e}var ii=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ri={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},si=new(n=class{constructor(){Dt(this,t,ri),Dt(this,e,!1)}setTimeoutProvider(e){Lt(this,t,e)}setTimeout(e,n){return It(this,t).setTimeout(e,n)}clearTimeout(e){It(this,t).clearTimeout(e)}setInterval(e,n){return It(this,t).setInterval(e,n)}clearInterval(e){It(this,t).clearInterval(e)}},t=new WeakMap,e=new WeakMap,n);var ai="undefined"==typeof window||"Deno"in globalThis;function oi(){}function li(t){return"number"==typeof t&&t>=0&&t!==1/0}function ci(t,e){return Math.max(t+(e||0)-Date.now(),0)}function hi(t,e){return"function"==typeof t?t(e):t}function ui(t,e){return"function"==typeof t?t(e):t}function di(t,e){const{type:n="all",exact:i,fetchStatus:r,predicate:s,queryKey:a,stale:o}=t;if(a)if(i){if(e.queryHash!==fi(a,e.options))return!1}else if(!gi(e.queryKey,a))return!1;if("all"!==n){const t=e.isActive();if("active"===n&&!t)return!1;if("inactive"===n&&t)return!1}return("boolean"!=typeof o||e.isStale()===o)&&((!r||r===e.state.fetchStatus)&&!(s&&!s(e)))}function pi(t,e){const{exact:n,status:i,predicate:r,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(mi(e.options.mutationKey)!==mi(s))return!1}else if(!gi(e.options.mutationKey,s))return!1}return(!i||e.state.status===i)&&!(r&&!r(e))}function fi(t,e){return(e?.queryKeyHashFn||mi)(t)}function mi(t){return JSON.stringify(t,(t,e)=>bi(e)?Object.keys(e).sort().reduce((t,n)=>(t[n]=e[n],t),{}):e)}function gi(t,e){return t===e||typeof t==typeof e&&(!(!t||!e||"object"!=typeof t||"object"!=typeof e)&&Object.keys(e).every(n=>gi(t[n],e[n])))}var vi=Object.prototype.hasOwnProperty;function yi(t,e){if(t===e)return t;const n=xi(t)&&xi(e);if(!(n||bi(t)&&bi(e)))return e;const i=(n?t:Object.keys(t)).length,r=n?e:Object.keys(e),s=r.length,a=n?new Array(s):{};let o=0;for(let l=0;l<s;l++){const s=n?l:r[l],c=t[s],h=e[s];if(c===h){a[s]=c,(n?l<i:vi.call(t,s))&&o++;continue}if(null===c||null===h||"object"!=typeof c||"object"!=typeof h){a[s]=h;continue}const u=yi(c,h);a[s]=u,u===c&&o++}return i===s&&o===i?t:a}function _i(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function xi(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function bi(t){if(!Mi(t))return!1;const e=t.constructor;if(void 0===e)return!0;const n=e.prototype;return!!Mi(n)&&(!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(t)===Object.prototype)}function Mi(t){return"[object Object]"===Object.prototype.toString.call(t)}function wi(t,e,n){return"function"==typeof n.structuralSharing?n.structuralSharing(t,e):!1!==n.structuralSharing?yi(t,e):e}function Si(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function Ti(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Ei=Symbol();function Ai(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:t.queryFn&&t.queryFn!==Ei?t.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`))}function Ci(t,e){return"function"==typeof t?t(...e):!!t}var Ri=new(a=class extends ii{constructor(){super(),Dt(this,i),Dt(this,r),Dt(this,s),Lt(this,s,t=>{if(!ai&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}})}onSubscribe(){It(this,r)||this.setEventListener(It(this,s))}onUnsubscribe(){var t;this.hasListeners()||(null==(t=It(this,r))||t.call(this),Lt(this,r,void 0))}setEventListener(t){var e;Lt(this,s,t),null==(e=It(this,r))||e.call(this),Lt(this,r,t(t=>{"boolean"==typeof t?this.setFocused(t):this.onFocus()}))}setFocused(t){It(this,i)!==t&&(Lt(this,i,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return"boolean"==typeof It(this,i)?It(this,i):"hidden"!==globalThis.document?.visibilityState}},i=new WeakMap,r=new WeakMap,s=new WeakMap,a);function Pi(){let t,e;const n=new Promise((n,i)=>{t=n,e=i});function i(t){Object.assign(n,t),delete n.resolve,delete n.reject}return n.status="pending",n.catch(()=>{}),n.resolve=e=>{i({status:"fulfilled",value:e}),t(e)},n.reject=t=>{i({status:"rejected",reason:t}),e(t)},n}var Oi=function(t){setTimeout(t,0)};var Ii=function(){let t=[],e=0,n=t=>{t()},i=t=>{t()},r=Oi;const s=i=>{e?t.push(i):r(()=>{n(i)})};return{batch:s=>{let a;e++;try{a=s()}finally{e--,e||(()=>{const e=t;t=[],e.length&&r(()=>{i(()=>{e.forEach(t=>{n(t)})})})})()}return a},batchCalls:t=>(...e)=>{s(()=>{t(...e)})},schedule:s,setNotifyFunction:t=>{n=t},setBatchNotifyFunction:t=>{i=t},setScheduler:t=>{r=t}}}(),Di=new(h=class extends ii{constructor(){super(),Dt(this,o,!0),Dt(this,l),Dt(this,c),Lt(this,c,t=>{if(!ai&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}})}onSubscribe(){It(this,l)||this.setEventListener(It(this,c))}onUnsubscribe(){var t;this.hasListeners()||(null==(t=It(this,l))||t.call(this),Lt(this,l,void 0))}setEventListener(t){var e;Lt(this,c,t),null==(e=It(this,l))||e.call(this),Lt(this,l,t(this.setOnline.bind(this)))}setOnline(t){It(this,o)!==t&&(Lt(this,o,t),this.listeners.forEach(e=>{e(t)}))}isOnline(){return It(this,o)}},o=new WeakMap,l=new WeakMap,c=new WeakMap,h);function Li(t){return Math.min(1e3*2**t,3e4)}function Ni(t){return"online"!==(t??"online")||Di.isOnline()}var Ui=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function Fi(t){let e,n=!1,i=0;const r=Pi(),s=()=>"pending"!==r.status,a=()=>Ri.isFocused()&&("always"===t.networkMode||Di.isOnline())&&t.canRun(),o=()=>Ni(t.networkMode)&&t.canRun(),l=t=>{s()||(e?.(),r.resolve(t))},c=t=>{s()||(e?.(),r.reject(t))},h=()=>new Promise(n=>{e=t=>{(s()||a())&&n(t)},t.onPause?.()}).then(()=>{e=void 0,s()||t.onContinue?.()}),u=()=>{if(s())return;let e;const r=0===i?t.initialPromise:void 0;try{e=r??t.fn()}catch(o){e=Promise.reject(o)}Promise.resolve(e).then(l).catch(e=>{if(s())return;const r=t.retry??(ai?0:3),o=t.retryDelay??Li,l="function"==typeof o?o(i,e):o,d=!0===r||"number"==typeof r&&i<r||"function"==typeof r&&r(i,e);var p;!n&&d?(i++,t.onFail?.(i,e),(p=l,new Promise(t=>{si.setTimeout(t,p)})).then(()=>a()?void 0:h()).then(()=>{n?c(e):u()})):c(e)})};return{promise:r,status:()=>r.status,cancel:e=>{if(!s()){const n=new Ui(e);c(n),t.onCancel?.(n)}},continue:()=>(e?.(),r),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1},canStart:o,start:()=>(o()?u():h().then(u),r)}}var ki=(d=class{constructor(){Dt(this,u)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),li(this.gcTime)&&Lt(this,u,si.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ai?1/0:3e5))}clearGcTimeout(){It(this,u)&&(si.clearTimeout(It(this,u)),Lt(this,u,void 0))}},u=new WeakMap,d),Bi=(M=class extends ki{constructor(t){super(),Dt(this,x),Dt(this,p),Dt(this,f),Dt(this,m),Dt(this,g),Dt(this,v),Dt(this,y),Dt(this,_),Lt(this,_,!1),Lt(this,y,t.defaultOptions),this.setOptions(t.options),this.observers=[],Lt(this,g,t.client),Lt(this,m,It(this,g).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Lt(this,p,Vi(this.options)),this.state=t.state??It(this,p),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return It(this,v)?.promise}setOptions(t){if(this.options={...It(this,y),...t},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const t=Vi(this.options);void 0!==t.data&&(this.setData(t.data,{updatedAt:t.dataUpdatedAt,manual:!0}),Lt(this,p,t))}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||It(this,m).remove(this)}setData(t,e){const n=wi(this.state.data,t,this.options);return Nt(this,x,b).call(this,{data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){Nt(this,x,b).call(this,{type:"setState",state:t,setStateOptions:e})}cancel(t){const e=It(this,v)?.promise;return It(this,v)?.cancel(t),e?e.then(oi).catch(oi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(It(this,p))}isActive(){return this.observers.some(t=>!1!==ui(t.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ei||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(t=>"static"===hi(t.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(t=0){return void 0===this.state.data||"static"!==t&&(!!this.state.isInvalidated||!ci(this.state.dataUpdatedAt,t))}onFocus(){const t=this.observers.find(t=>t.shouldFetchOnWindowFocus());t?.refetch({cancelRefetch:!1}),It(this,v)?.continue()}onOnline(){const t=this.observers.find(t=>t.shouldFetchOnReconnect());t?.refetch({cancelRefetch:!1}),It(this,v)?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),It(this,m).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(It(this,v)&&(It(this,_)?It(this,v).cancel({revert:!0}):It(this,v).cancelRetry()),this.scheduleGc()),It(this,m).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nt(this,x,b).call(this,{type:"invalidate"})}async fetch(t,e){if("idle"!==this.state.fetchStatus&&"rejected"!==It(this,v)?.status())if(void 0!==this.state.data&&e?.cancelRefetch)this.cancel({silent:!0});else if(It(this,v))return It(this,v).continueRetry(),It(this,v).promise;if(t&&this.setOptions(t),!this.options.queryFn){const t=this.observers.find(t=>t.options.queryFn);t&&this.setOptions(t.options)}const n=new AbortController,i=t=>{Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(Lt(this,_,!0),n.signal)})},r=()=>{const t=Ai(this.options,e),n=(()=>{const t={client:It(this,g),queryKey:this.queryKey,meta:this.meta};return i(t),t})();return Lt(this,_,!1),this.options.persister?this.options.persister(t,n,this):t(n)},s=(()=>{const t={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:It(this,g),state:this.state,fetchFn:r};return i(t),t})();this.options.behavior?.onFetch(s,this),Lt(this,f,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===s.fetchOptions?.meta||Nt(this,x,b).call(this,{type:"fetch",meta:s.fetchOptions?.meta}),Lt(this,v,Fi({initialPromise:e?.initialPromise,fn:s.fetchFn,onCancel:t=>{t instanceof Ui&&t.revert&&this.setState({...It(this,f),fetchStatus:"idle"}),n.abort()},onFail:(t,e)=>{Nt(this,x,b).call(this,{type:"failed",failureCount:t,error:e})},onPause:()=>{Nt(this,x,b).call(this,{type:"pause"})},onContinue:()=>{Nt(this,x,b).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0}));try{const t=await It(this,v).start();if(void 0===t)throw new Error(`${this.queryHash} data is undefined`);return this.setData(t),It(this,m).config.onSuccess?.(t,this),It(this,m).config.onSettled?.(t,this.state.error,this),t}catch(a){if(a instanceof Ui){if(a.silent)return It(this,v).promise;if(a.revert){if(void 0===this.state.data)throw a;return this.state.data}}throw Nt(this,x,b).call(this,{type:"error",error:a}),It(this,m).config.onError?.(a,this),It(this,m).config.onSettled?.(this.state.data,a,this),a}finally{this.scheduleGc()}}},p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,y=new WeakMap,_=new WeakMap,x=new WeakSet,b=function(t){this.state=(e=>{switch(t.type){case"failed":return{...e,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...zi(e.data,this.options),fetchMeta:t.meta??null};case"success":const n={...e,data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Lt(this,f,t.manual?n:void 0),n;case"error":const i=t.error;return{...e,error:i,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...t.state}}})(this.state),Ii.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),It(this,m).notify({query:this,type:"updated",action:t})})},M);function zi(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ni(e.networkMode)?"fetching":"paused",...void 0===t&&{error:null,status:"pending"}}}function Vi(t){const e="function"==typeof t.initialData?t.initialData():t.initialData,n=void 0!==e,i=n?"function"==typeof t.initialDataUpdatedAt?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Hi=(Y=class extends ii{constructor(t,e){super(),Dt(this,k),Dt(this,w),Dt(this,S),Dt(this,T),Dt(this,E),Dt(this,A),Dt(this,C),Dt(this,R),Dt(this,P),Dt(this,O),Dt(this,I),Dt(this,D),Dt(this,L),Dt(this,N),Dt(this,U),Dt(this,F,new Set),this.options=e,Lt(this,w,t),Lt(this,P,null),Lt(this,R,Pi()),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(It(this,S).addObserver(this),Wi(It(this,S),this.options)?Nt(this,k,B).call(this):this.updateResult(),Nt(this,k,W).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ji(It(this,S),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ji(It(this,S),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Nt(this,k,j).call(this),Nt(this,k,G).call(this),It(this,S).removeObserver(this)}setOptions(t){const e=this.options,n=It(this,S);if(this.options=It(this,w).defaultQueryOptions(t),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof ui(this.options.enabled,It(this,S)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Nt(this,k,X).call(this),It(this,S).setOptions(this.options),e._defaulted&&!_i(this.options,e)&&It(this,w).getQueryCache().notify({type:"observerOptionsUpdated",query:It(this,S),observer:this});const i=this.hasListeners();i&&Gi(It(this,S),n,this.options,e)&&Nt(this,k,B).call(this),this.updateResult(),!i||It(this,S)===n&&ui(this.options.enabled,It(this,S))===ui(e.enabled,It(this,S))&&hi(this.options.staleTime,It(this,S))===hi(e.staleTime,It(this,S))||Nt(this,k,z).call(this);const r=Nt(this,k,V).call(this);!i||It(this,S)===n&&ui(this.options.enabled,It(this,S))===ui(e.enabled,It(this,S))&&r===It(this,U)||Nt(this,k,H).call(this,r)}getOptimisticResult(t){const e=It(this,w).getQueryCache().build(It(this,w),t),n=this.createResult(e,t);return function(t,e){if(!_i(t.getCurrentResult(),e))return!0;return!1}(this,n)&&(Lt(this,E,n),Lt(this,C,this.options),Lt(this,A,It(this,S).state)),n}getCurrentResult(){return It(this,E)}trackResult(t,e){return new Proxy(t,{get:(t,n)=>(this.trackProp(n),e?.(n),"promise"!==n||this.options.experimental_prefetchInRender||"pending"!==It(this,R).status||It(this,R).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(t,n))})}trackProp(t){It(this,F).add(t)}getCurrentQuery(){return It(this,S)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=It(this,w).defaultQueryOptions(t),n=It(this,w).getQueryCache().build(It(this,w),e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return Nt(this,k,B).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),It(this,E)))}createResult(t,e){const n=It(this,S),i=this.options,r=It(this,E),s=It(this,A),a=It(this,C),o=t!==n?t.state:It(this,T),{state:l}=t;let c,h={...l},u=!1;if(e._optimisticResults){const r=this.hasListeners(),s=!r&&Wi(t,e),a=r&&Gi(t,n,e,i);(s||a)&&(h={...h,...zi(l.data,t.options)}),"isRestoring"===e._optimisticResults&&(h.fetchStatus="idle")}let{error:d,errorUpdatedAt:p,status:f}=h;c=h.data;let m=!1;if(void 0!==e.placeholderData&&void 0===c&&"pending"===f){let t;r?.isPlaceholderData&&e.placeholderData===a?.placeholderData?(t=r.data,m=!0):t="function"==typeof e.placeholderData?e.placeholderData(It(this,D)?.state.data,It(this,D)):e.placeholderData,void 0!==t&&(f="success",c=wi(r?.data,t,e),u=!0)}if(e.select&&void 0!==c&&!m)if(r&&c===s?.data&&e.select===It(this,O))c=It(this,I);else try{Lt(this,O,e.select),c=e.select(c),c=wi(r?.data,c,e),Lt(this,I,c),Lt(this,P,null)}catch(M){Lt(this,P,M)}It(this,P)&&(d=It(this,P),c=It(this,I),p=Date.now(),f="error");const g="fetching"===h.fetchStatus,v="pending"===f,y="error"===f,_=v&&g,x=void 0!==c,b={status:f,fetchStatus:h.fetchStatus,isPending:v,isSuccess:"success"===f,isError:y,isInitialLoading:_,isLoading:_,data:c,dataUpdatedAt:h.dataUpdatedAt,error:d,errorUpdatedAt:p,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>o.dataUpdateCount||h.errorUpdateCount>o.errorUpdateCount,isFetching:g,isRefetching:g&&!v,isLoadingError:y&&!x,isPaused:"paused"===h.fetchStatus,isPlaceholderData:u,isRefetchError:y&&x,isStale:Xi(t,e),refetch:this.refetch,promise:It(this,R),isEnabled:!1!==ui(e.enabled,t)};if(this.options.experimental_prefetchInRender){const e=t=>{"error"===b.status?t.reject(b.error):void 0!==b.data&&t.resolve(b.data)},i=()=>{const t=Lt(this,R,b.promise=Pi());e(t)},r=It(this,R);switch(r.status){case"pending":t.queryHash===n.queryHash&&e(r);break;case"fulfilled":"error"!==b.status&&b.data===r.value||i();break;case"rejected":"error"===b.status&&b.error===r.reason||i()}}return b}updateResult(){const t=It(this,E),e=this.createResult(It(this,S),this.options);if(Lt(this,A,It(this,S).state),Lt(this,C,this.options),void 0!==It(this,A).data&&Lt(this,D,It(this,S)),_i(e,t))return;Lt(this,E,e);Nt(this,k,q).call(this,{listeners:(()=>{if(!t)return!0;const{notifyOnChangeProps:e}=this.options,n="function"==typeof e?e():e;if("all"===n||!n&&!It(this,F).size)return!0;const i=new Set(n??It(this,F));return this.options.throwOnError&&i.add("error"),Object.keys(It(this,E)).some(e=>{const n=e;return It(this,E)[n]!==t[n]&&i.has(n)})})()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Nt(this,k,W).call(this)}},w=new WeakMap,S=new WeakMap,T=new WeakMap,E=new WeakMap,A=new WeakMap,C=new WeakMap,R=new WeakMap,P=new WeakMap,O=new WeakMap,I=new WeakMap,D=new WeakMap,L=new WeakMap,N=new WeakMap,U=new WeakMap,F=new WeakMap,k=new WeakSet,B=function(t){Nt(this,k,X).call(this);let e=It(this,S).fetch(this.options,t);return t?.throwOnError||(e=e.catch(oi)),e},z=function(){Nt(this,k,j).call(this);const t=hi(this.options.staleTime,It(this,S));if(ai||It(this,E).isStale||!li(t))return;const e=ci(It(this,E).dataUpdatedAt,t)+1;Lt(this,L,si.setTimeout(()=>{It(this,E).isStale||this.updateResult()},e))},V=function(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(It(this,S)):this.options.refetchInterval)??!1},H=function(t){Nt(this,k,G).call(this),Lt(this,U,t),!ai&&!1!==ui(this.options.enabled,It(this,S))&&li(It(this,U))&&0!==It(this,U)&&Lt(this,N,si.setInterval(()=>{(this.options.refetchIntervalInBackground||Ri.isFocused())&&Nt(this,k,B).call(this)},It(this,U)))},W=function(){Nt(this,k,z).call(this),Nt(this,k,H).call(this,Nt(this,k,V).call(this))},j=function(){It(this,L)&&(si.clearTimeout(It(this,L)),Lt(this,L,void 0))},G=function(){It(this,N)&&(si.clearInterval(It(this,N)),Lt(this,N,void 0))},X=function(){const t=It(this,w).getQueryCache().build(It(this,w),this.options);if(t===It(this,S))return;const e=It(this,S);Lt(this,S,t),Lt(this,T,t.state),this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))},q=function(t){Ii.batch(()=>{t.listeners&&this.listeners.forEach(t=>{t(It(this,E))}),It(this,w).getQueryCache().notify({query:It(this,S),type:"observerResultsUpdated"})})},Y);function Wi(t,e){return function(t,e){return!1!==ui(e.enabled,t)&&void 0===t.state.data&&!("error"===t.state.status&&!1===e.retryOnMount)}(t,e)||void 0!==t.state.data&&ji(t,e,e.refetchOnMount)}function ji(t,e,n){if(!1!==ui(e.enabled,t)&&"static"!==hi(e.staleTime,t)){const i="function"==typeof n?n(t):n;return"always"===i||!1!==i&&Xi(t,e)}return!1}function Gi(t,e,n,i){return(t!==e||!1===ui(i.enabled,t))&&(!n.suspense||"error"!==t.state.status)&&Xi(t,n)}function Xi(t,e){return!1!==ui(e.enabled,t)&&t.isStaleByTime(hi(e.staleTime,t))}function qi(t){return{onFetch:(e,n)=>{const i=e.options,r=e.fetchOptions?.meta?.fetchMore?.direction,s=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let n=!1;const c=Ai(e.options,e.fetchOptions),h=async(t,i,r)=>{if(n)return Promise.reject();if(null==i&&t.pages.length)return Promise.resolve(t);const s=(()=>{const t={client:e.client,queryKey:e.queryKey,pageParam:i,direction:r?"backward":"forward",meta:e.options.meta};var s;return s=t,Object.defineProperty(s,"signal",{enumerable:!0,get:()=>(e.signal.aborted?n=!0:e.signal.addEventListener("abort",()=>{n=!0}),e.signal)}),t})(),a=await c(s),{maxPages:o}=e.options,l=r?Ti:Si;return{pages:l(t.pages,a,o),pageParams:l(t.pageParams,i,o)}};if(r&&s.length){const t="backward"===r,e={pages:s,pageParams:a},n=(t?Ki:Yi)(i,e);o=await h(e,n,t)}else{const e=t??s.length;do{const t=0===l?a[0]??i.initialPageParam:Yi(i,o);if(l>0&&null==t)break;o=await h(o,t),l++}while(l<e)}return o};e.options.persister?e.fetchFn=()=>e.options.persister?.(c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=c}}}function Yi(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function Ki(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var Zi=(et=class extends ki{constructor(t){super(),Dt(this,Q),Dt(this,K),Dt(this,Z),Dt(this,$),Dt(this,J),Lt(this,K,t.client),this.mutationId=t.mutationId,Lt(this,$,t.mutationCache),Lt(this,Z,[]),this.state=t.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){It(this,Z).includes(t)||(It(this,Z).push(t),this.clearGcTimeout(),It(this,$).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Lt(this,Z,It(this,Z).filter(e=>e!==t)),this.scheduleGc(),It(this,$).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){It(this,Z).length||("pending"===this.state.status?this.scheduleGc():It(this,$).remove(this))}continue(){return It(this,J)?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{Nt(this,Q,tt).call(this,{type:"continue"})},n={client:It(this,K),meta:this.options.meta,mutationKey:this.options.mutationKey};Lt(this,J,Fi({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(t,e)=>{Nt(this,Q,tt).call(this,{type:"failed",failureCount:t,error:e})},onPause:()=>{Nt(this,Q,tt).call(this,{type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>It(this,$).canRun(this)}));const i="pending"===this.state.status,r=!It(this,J).canStart();try{if(i)e();else{Nt(this,Q,tt).call(this,{type:"pending",variables:t,isPaused:r}),await(It(this,$).config.onMutate?.(t,this,n));const e=await(this.options.onMutate?.(t,n));e!==this.state.context&&Nt(this,Q,tt).call(this,{type:"pending",context:e,variables:t,isPaused:r})}const s=await It(this,J).start();return await(It(this,$).config.onSuccess?.(s,t,this.state.context,this,n)),await(this.options.onSuccess?.(s,t,this.state.context,n)),await(It(this,$).config.onSettled?.(s,null,this.state.variables,this.state.context,this,n)),await(this.options.onSettled?.(s,null,t,this.state.context,n)),Nt(this,Q,tt).call(this,{type:"success",data:s}),s}catch(s){try{throw await(It(this,$).config.onError?.(s,t,this.state.context,this,n)),await(this.options.onError?.(s,t,this.state.context,n)),await(It(this,$).config.onSettled?.(void 0,s,this.state.variables,this.state.context,this,n)),await(this.options.onSettled?.(void 0,s,t,this.state.context,n)),s}finally{Nt(this,Q,tt).call(this,{type:"error",error:s})}}finally{It(this,$).runNext(this)}}},K=new WeakMap,Z=new WeakMap,$=new WeakMap,J=new WeakMap,Q=new WeakSet,tt=function(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),Ii.batch(()=>{It(this,Z).forEach(e=>{e.onMutationUpdate(t)}),It(this,$).notify({mutation:this,type:"updated",action:t})})},et);var $i=(st=class extends ii{constructor(t={}){super(),Dt(this,nt),Dt(this,it),Dt(this,rt),this.config=t,Lt(this,nt,new Set),Lt(this,it,new Map),Lt(this,rt,0)}build(t,e,n){const i=new Zi({client:t,mutationCache:this,mutationId:++Ut(this,rt)._,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){It(this,nt).add(t);const e=Ji(t);if("string"==typeof e){const n=It(this,it).get(e);n?n.push(t):It(this,it).set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(It(this,nt).delete(t)){const e=Ji(t);if("string"==typeof e){const n=It(this,it).get(e);if(n)if(n.length>1){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n[0]===t&&It(this,it).delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Ji(t);if("string"==typeof e){const n=It(this,it).get(e),i=n?.find(t=>"pending"===t.state.status);return!i||i===t}return!0}runNext(t){const e=Ji(t);if("string"==typeof e){const n=It(this,it).get(e)?.find(e=>e!==t&&e.state.isPaused);return n?.continue()??Promise.resolve()}return Promise.resolve()}clear(){Ii.batch(()=>{It(this,nt).forEach(t=>{this.notify({type:"removed",mutation:t})}),It(this,nt).clear(),It(this,it).clear()})}getAll(){return Array.from(It(this,nt))}find(t){const e={exact:!0,...t};return this.getAll().find(t=>pi(e,t))}findAll(t={}){return this.getAll().filter(e=>pi(t,e))}notify(t){Ii.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(t=>t.state.isPaused);return Ii.batch(()=>Promise.all(t.map(t=>t.continue().catch(oi))))}},nt=new WeakMap,it=new WeakMap,rt=new WeakMap,st);function Ji(t){return t.options.scope?.id}var Qi=(pt=class extends ii{constructor(t,e){super(),Dt(this,ht),Dt(this,at),Dt(this,ot),Dt(this,lt),Dt(this,ct),Lt(this,at,t),this.setOptions(e),this.bindMethods(),Nt(this,ht,ut).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=It(this,at).defaultMutationOptions(t),_i(this.options,e)||It(this,at).getMutationCache().notify({type:"observerOptionsUpdated",mutation:It(this,lt),observer:this}),e?.mutationKey&&this.options.mutationKey&&mi(e.mutationKey)!==mi(this.options.mutationKey)?this.reset():"pending"===It(this,lt)?.state.status&&It(this,lt).setOptions(this.options)}onUnsubscribe(){this.hasListeners()||It(this,lt)?.removeObserver(this)}onMutationUpdate(t){Nt(this,ht,ut).call(this),Nt(this,ht,dt).call(this,t)}getCurrentResult(){return It(this,ot)}reset(){It(this,lt)?.removeObserver(this),Lt(this,lt,void 0),Nt(this,ht,ut).call(this),Nt(this,ht,dt).call(this)}mutate(t,e){return Lt(this,ct,e),It(this,lt)?.removeObserver(this),Lt(this,lt,It(this,at).getMutationCache().build(It(this,at),this.options)),It(this,lt).addObserver(this),It(this,lt).execute(t)}},at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ht=new WeakSet,ut=function(){const t=It(this,lt)?.state??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};Lt(this,ot,{...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset})},dt=function(t){Ii.batch(()=>{if(It(this,ct)&&this.hasListeners()){const e=It(this,ot).variables,n=It(this,ot).context,i={client:It(this,at),meta:this.options.meta,mutationKey:this.options.mutationKey};"success"===t?.type?(It(this,ct).onSuccess?.(t.data,e,n,i),It(this,ct).onSettled?.(t.data,null,e,n,i)):"error"===t?.type&&(It(this,ct).onError?.(t.error,e,n,i),It(this,ct).onSettled?.(void 0,t.error,e,n,i))}this.listeners.forEach(t=>{t(It(this,ot))})})},pt),tr=(mt=class extends ii{constructor(t={}){super(),Dt(this,ft),this.config=t,Lt(this,ft,new Map)}build(t,e,n){const i=e.queryKey,r=e.queryHash??fi(i,e);let s=this.get(r);return s||(s=new Bi({client:t,queryKey:i,queryHash:r,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(s)),s}add(t){It(this,ft).has(t.queryHash)||(It(this,ft).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=It(this,ft).get(t.queryHash);e&&(t.destroy(),e===t&&It(this,ft).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ii.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return It(this,ft).get(t)}getAll(){return[...It(this,ft).values()]}find(t){const e={exact:!0,...t};return this.getAll().find(t=>di(e,t))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(e=>di(t,e)):e}notify(t){Ii.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Ii.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ii.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ft=new WeakMap,mt),er=(St=class{constructor(t={}){Dt(this,gt),Dt(this,vt),Dt(this,yt),Dt(this,_t),Dt(this,xt),Dt(this,bt),Dt(this,Mt),Dt(this,wt),Lt(this,gt,t.queryCache||new tr),Lt(this,vt,t.mutationCache||new $i),Lt(this,yt,t.defaultOptions||{}),Lt(this,_t,new Map),Lt(this,xt,new Map),Lt(this,bt,0)}mount(){Ut(this,bt)._++,1===It(this,bt)&&(Lt(this,Mt,Ri.subscribe(async t=>{t&&(await this.resumePausedMutations(),It(this,gt).onFocus())})),Lt(this,wt,Di.subscribe(async t=>{t&&(await this.resumePausedMutations(),It(this,gt).onOnline())})))}unmount(){var t,e;Ut(this,bt)._--,0===It(this,bt)&&(null==(t=It(this,Mt))||t.call(this),Lt(this,Mt,void 0),null==(e=It(this,wt))||e.call(this),Lt(this,wt,void 0))}isFetching(t){return It(this,gt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return It(this,vt).findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return It(this,gt).get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=It(this,gt).build(this,e),i=n.state.data;return void 0===i?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(hi(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return It(this,gt).findAll(t).map(({queryKey:t,state:e})=>[t,e.data])}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),r=It(this,gt).get(i.queryHash),s=r?.state.data,a=function(t,e){return"function"==typeof t?t(e):t}(e,s);if(void 0!==a)return It(this,gt).build(this,i).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return Ii.batch(()=>It(this,gt).findAll(t).map(({queryKey:t})=>[t,this.setQueryData(t,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return It(this,gt).get(e.queryHash)?.state}removeQueries(t){const e=It(this,gt);Ii.batch(()=>{e.findAll(t).forEach(t=>{e.remove(t)})})}resetQueries(t,e){const n=It(this,gt);return Ii.batch(()=>(n.findAll(t).forEach(t=>{t.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=Ii.batch(()=>It(this,gt).findAll(t).map(t=>t.cancel(n)));return Promise.all(i).then(oi).catch(oi)}invalidateQueries(t,e={}){return Ii.batch(()=>(It(this,gt).findAll(t).forEach(t=>{t.invalidate()}),"none"===t?.refetchType?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=Ii.batch(()=>It(this,gt).findAll(t).filter(t=>!t.isDisabled()&&!t.isStatic()).map(t=>{let e=t.fetch(void 0,n);return n.throwOnError||(e=e.catch(oi)),"paused"===t.state.fetchStatus?Promise.resolve():e}));return Promise.all(i).then(oi)}fetchQuery(t){const e=this.defaultQueryOptions(t);void 0===e.retry&&(e.retry=!1);const n=It(this,gt).build(this,e);return n.isStaleByTime(hi(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(oi).catch(oi)}fetchInfiniteQuery(t){return t.behavior=qi(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(oi).catch(oi)}ensureInfiniteQueryData(t){return t.behavior=qi(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Di.isOnline()?It(this,vt).resumePausedMutations():Promise.resolve()}getQueryCache(){return It(this,gt)}getMutationCache(){return It(this,vt)}getDefaultOptions(){return It(this,yt)}setDefaultOptions(t){Lt(this,yt,t)}setQueryDefaults(t,e){It(this,_t).set(mi(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...It(this,_t).values()],n={};return e.forEach(e=>{gi(t,e.queryKey)&&Object.assign(n,e.defaultOptions)}),n}setMutationDefaults(t,e){It(this,xt).set(mi(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...It(this,xt).values()],n={};return e.forEach(e=>{gi(t,e.mutationKey)&&Object.assign(n,e.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...It(this,yt).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=fi(e.queryKey,e)),void 0===e.refetchOnReconnect&&(e.refetchOnReconnect="always"!==e.networkMode),void 0===e.throwOnError&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ei&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...It(this,yt).mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){It(this,gt).clear(),It(this,vt).clear()}},gt=new WeakMap,vt=new WeakMap,yt=new WeakMap,_t=new WeakMap,xt=new WeakMap,bt=new WeakMap,Mt=new WeakMap,wt=new WeakMap,St);let nr,ir,rr,sr={data:""},ar=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,or=/\/\*[^]*?\*\/|  +/g,lr=/\n+/g,cr=(t,e)=>{let n="",i="",r="";for(let s in t){let a=t[s];"@"==s[0]?"i"==s[1]?n=s+" "+a+";":i+="f"==s[1]?cr(a,s):s+"{"+cr(a,"k"==s[1]?"":e)+"}":"object"==typeof a?i+=cr(a,e?e.replace(/([^,])+/g,t=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,e=>/&/.test(e)?e.replace(/&/g,t):t?t+" "+e:e)):s):null!=a&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=cr.p?cr.p(s,a):s+":"+a+";")}return n+(e&&r?e+"{"+r+"}":r)+i},hr={},ur=t=>{if("object"==typeof t){let e="";for(let n in t)e+=n+ur(t[n]);return e}return t};function dr(t){let e=this||{},n=t.call?t(e.p):t;return((t,e,n,i,r)=>{let s=ur(t),a=hr[s]||(hr[s]=(t=>{let e=0,n=11;for(;e<t.length;)n=101*n+t.charCodeAt(e++)>>>0;return"go"+n})(s));if(!hr[a]){let e=s!==t?t:(t=>{let e,n,i=[{}];for(;e=ar.exec(t.replace(or,""));)e[4]?i.shift():e[3]?(n=e[3].replace(lr," ").trim(),i.unshift(i[0][n]=i[0][n]||{})):i[0][e[1]]=e[2].replace(lr," ").trim();return i[0]})(t);hr[a]=cr(r?{["@keyframes "+a]:e}:e,n?"":"."+a)}let o=n&&hr.g?hr.g:null;return n&&(hr.g=hr[a]),l=hr[a],c=e,h=i,(u=o)?c.data=c.data.replace(u,l):-1===c.data.indexOf(l)&&(c.data=h?l+c.data:c.data+l),a;var l,c,h,u})(n.unshift?n.raw?((t,e,n)=>t.reduce((t,i,r)=>{let s=e[r];if(s&&s.call){let t=s(n),e=t&&t.props&&t.props.className||/^go/.test(t)&&t;s=e?"."+e:t&&"object"==typeof t?t.props?"":cr(t,""):!1===t?"":t}return t+i+(null==s?"":s)},""))(n,[].slice.call(arguments,1),e.p):n.reduce((t,n)=>Object.assign(t,n&&n.call?n(e.p):n),{}):n,(i=e.target,"object"==typeof window?((i?i.querySelector("#_goober"):window._goober)||Object.assign((i||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:i||sr),e.g,e.o,e.k);var i}dr.bind({g:1});let pr=dr.bind({k:1});function fr(t,e,n,i){cr.p=e,nr=t,ir=n,rr=i}function mr(t,e){let n=this||{};return function(){let e=arguments;return function i(r,s){let a=Object.assign({},r),o=a.className||i.className;n.p=Object.assign({theme:ir&&ir()},a),n.o=/ *go\d+/.test(o),a.className=dr.apply(n,e)+(o?" "+o:"");let l=t;return t[0]&&(l=a.as||t,delete a.as),rr&&l[0]&&rr(a),nr(l,a)}}}function gr(t){return t+.5|0}const vr=(t,e,n)=>Math.max(Math.min(t,n),e);function yr(t){return vr(gr(2.55*t),0,255)}function _r(t){return vr(gr(255*t),0,255)}function xr(t){return vr(gr(t/2.55)/100,0,1)}function br(t){return vr(gr(100*t),0,100)}const Mr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},wr=[..."0123456789ABCDEF"],Sr=t=>wr[15&t],Tr=t=>wr[(240&t)>>4]+wr[15&t],Er=t=>(240&t)>>4==(15&t);function Ar(t){var e=(t=>Er(t.r)&&Er(t.g)&&Er(t.b)&&Er(t.a))(t)?Sr:Tr;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}const Cr=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Rr(t,e,n){const i=e*Math.min(n,1-n),r=(e,r=(e+t/30)%12)=>n-i*Math.max(Math.min(r-3,9-r,1),-1);return[r(0),r(8),r(4)]}function Pr(t,e,n){const i=(i,r=(i+t/60)%6)=>n-n*e*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function Or(t,e,n){const i=Rr(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)i[r]*=1-e-n,i[r]+=e;return i}function Ir(t){const e=t.r/255,n=t.g/255,i=t.b/255,r=Math.max(e,n,i),s=Math.min(e,n,i),a=(r+s)/2;let o,l,c;return r!==s&&(c=r-s,l=a>.5?c/(2-r-s):c/(r+s),o=function(t,e,n,i,r){return t===r?(e-n)/i+(e<n?6:0):e===r?(n-t)/i+2:(t-e)/i+4}(e,n,i,c,r),o=60*o+.5),[0|o,l||0,a]}function Dr(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(_r)}function Lr(t,e,n){return Dr(Rr,t,e,n)}function Nr(t){return(t%360+360)%360}function Ur(t){const e=Cr.exec(t);let n,i=255;if(!e)return;e[5]!==n&&(i=e[6]?yr(+e[5]):_r(+e[5]));const r=Nr(+e[2]),s=+e[3]/100,a=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return Dr(Or,t,e,n)}(r,s,a):"hsv"===e[1]?function(t,e,n){return Dr(Pr,t,e,n)}(r,s,a):Lr(r,s,a),{r:n[0],g:n[1],b:n[2],a:i}}const Fr={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},kr={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Br;function zr(t){Br||(Br=function(){const t={},e=Object.keys(kr),n=Object.keys(Fr);let i,r,s,a,o;for(i=0;i<e.length;i++){for(a=o=e[i],r=0;r<n.length;r++)s=n[r],o=o.replace(s,Fr[s]);s=parseInt(kr[a],16),t[o]=[s>>16&255,s>>8&255,255&s]}return t}(),Br.transparent=[0,0,0,0]);const e=Br[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}const Vr=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Hr=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Wr=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function jr(t,e,n){if(t){let i=Ir(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,0===e?360:1)),i=Lr(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function Gr(t,e){return t?Object.assign(e||{},t):t}function Xr(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=_r(t[3]))):(e=Gr(t,{r:0,g:0,b:0,a:1})).a=_r(e.a),e}function qr(t){return"r"===t.charAt(0)?function(t){const e=Vr.exec(t);let n,i,r,s=255;if(e){if(e[7]!==n){const t=+e[7];s=e[8]?yr(t):vr(255*t,0,255)}return n=+e[1],i=+e[3],r=+e[5],n=255&(e[2]?yr(n):vr(n,0,255)),i=255&(e[4]?yr(i):vr(i,0,255)),r=255&(e[6]?yr(r):vr(r,0,255)),{r:n,g:i,b:r,a:s}}}(t):Ur(t)}let Yr=class t{constructor(e){if(e instanceof t)return e;const n=typeof e;let i;var r,s,a;"object"===n?i=Xr(e):"string"===n&&(a=(r=e).length,"#"===r[0]&&(4===a||5===a?s={r:255&17*Mr[r[1]],g:255&17*Mr[r[2]],b:255&17*Mr[r[3]],a:5===a?17*Mr[r[4]]:255}:7!==a&&9!==a||(s={r:Mr[r[1]]<<4|Mr[r[2]],g:Mr[r[3]]<<4|Mr[r[4]],b:Mr[r[5]]<<4|Mr[r[6]],a:9===a?Mr[r[7]]<<4|Mr[r[8]]:255})),i=s||zr(e)||qr(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Gr(this._rgb);return t&&(t.a=xr(t.a)),t}set rgb(t){this._rgb=Xr(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${xr(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?Ar(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=Ir(t),n=e[0],i=br(e[1]),r=br(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${r}%, ${xr(t.a)})`:`hsl(${n}, ${i}%, ${r}%)`}(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let r;const s=e===r?.5:e,a=2*s-1,o=n.a-i.a,l=((a*o===-1?a:(a+o)/(1+a*o))+1)/2;r=1-l,n.r=255&l*n.r+r*i.r+.5,n.g=255&l*n.g+r*i.g+.5,n.b=255&l*n.b+r*i.b+.5,n.a=s*n.a+(1-s)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,n){const i=Wr(xr(t.r)),r=Wr(xr(t.g)),s=Wr(xr(t.b));return{r:_r(Hr(i+n*(Wr(xr(e.r))-i))),g:_r(Hr(r+n*(Wr(xr(e.g))-r))),b:_r(Hr(s+n*(Wr(xr(e.b))-s))),a:t.a+n*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new t(this.rgb)}alpha(t){return this._rgb.a=_r(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=gr(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return jr(this._rgb,2,t),this}darken(t){return jr(this._rgb,2,-t),this}saturate(t){return jr(this._rgb,1,t),this}desaturate(t){return jr(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=Ir(t);n[0]=Nr(n[0]+e),n=Lr(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}};function Kr(){}const Zr=(()=>{let t=0;return()=>t++})();function $r(t){return null==t}function Jr(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function Qr(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function ts(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function es(t,e){return ts(t)?t:e}function ns(t,e){return void 0===t?e:t}const is=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function rs(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)}function ss(t,e,n,i){let r,s,a;if(Jr(t))for(s=t.length,r=0;r<s;r++)e.call(n,t[r],r);else if(Qr(t))for(a=Object.keys(t),s=a.length,r=0;r<s;r++)e.call(n,t[a[r]],a[r])}function as(t,e){let n,i,r,s;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(r=t[n],s=e[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function os(t){if(Jr(t))return t.map(os);if(Qr(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let r=0;for(;r<i;++r)e[n[r]]=os(t[n[r]]);return e}return t}function ls(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function cs(t,e,n,i){if(!ls(t))return;const r=e[t],s=n[t];Qr(r)&&Qr(s)?hs(r,s,i):e[t]=os(s)}function hs(t,e,n){const i=Jr(e)?e:[e],r=i.length;if(!Qr(t))return t;const s=(n=n||{}).merger||cs;let a;for(let o=0;o<r;++o){if(a=i[o],!Qr(a))continue;const e=Object.keys(a);for(let i=0,r=e.length;i<r;++i)s(e[i],t,a,n)}return t}function us(t,e){return hs(t,e,{merger:ds})}function ds(t,e,n){if(!ls(t))return;const i=e[t],r=n[t];Qr(i)&&Qr(r)?us(i,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=os(r))}const ps={"":t=>t,x:t=>t.x,y:t=>t.y};function fs(t,e){const n=ps[e]||(ps[e]=function(t){const e=function(t){const e=t.split("."),n=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}(t);return t=>{for(const n of e){if(""===n)break;t=t&&t[n]}return t}}(e));return n(t)}function ms(t){return t.charAt(0).toUpperCase()+t.slice(1)}const gs=t=>void 0!==t,vs=t=>"function"==typeof t,ys=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};const _s=Math.PI,xs=2*_s,bs=xs+_s,Ms=Number.POSITIVE_INFINITY,ws=_s/180,Ss=_s/2,Ts=_s/4,Es=2*_s/3,As=Math.log10,Cs=Math.sign;function Rs(t,e,n){return Math.abs(t-e)<n}function Ps(t){const e=Math.round(t);t=Rs(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(As(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Os(t){return!function(t){return"symbol"==typeof t||"object"==typeof t&&null!==t&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Is(t){return t*(_s/180)}function Ds(t){if(!ts(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Ls(t,e){const n=e.x-t.x,i=e.y-t.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*_s&&(s+=xs),{angle:s,distance:r}}function Ns(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Us(t,e){return(t-e+bs)%xs-_s}function Fs(t){return(t%xs+xs)%xs}function ks(t,e,n,i){const r=Fs(t),s=Fs(e),a=Fs(n),o=Fs(s-r),l=Fs(a-r),c=Fs(r-s),h=Fs(r-a);return r===s||r===a||i&&s===a||o>l&&c<h}function Bs(t,e,n){return Math.max(e,Math.min(n,t))}function zs(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function Vs(t,e,n){n=n||(n=>t[n]<e);let i,r=t.length-1,s=0;for(;r-s>1;)i=s+r>>1,n(i)?s=i:r=i;return{lo:s,hi:r}}const Hs=(t,e,n,i)=>Vs(t,n,i?i=>{const r=t[i][e];return r<n||r===n&&t[i+1][e]===n}:i=>t[i][e]<n),Ws=(t,e,n)=>Vs(t,n,i=>t[i][e]>=n);const js=["push","pop","shift","splice","unshift"];function Gs(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(e);-1!==r&&i.splice(r,1),i.length>0||(js.forEach(e=>{delete t[e]}),delete t._chartjs)}function Xs(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const qs="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function Ys(t,e){let n=[],i=!1;return function(...r){n=r,i||(i=!0,qs.call(window,()=>{i=!1,t.apply(e,n)}))}}const Ks=t=>"start"===t?"left":"end"===t?"right":"center",Zs=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2;function $s(t,e,n){const i=e.length;let r=0,s=i;if(t._sorted){const{iScale:a,vScale:o,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,h=a.axis,{min:u,max:d,minDefined:p,maxDefined:f}=a.getUserBounds();if(p){if(r=Math.min(Hs(l,h,u).lo,n?i:Hs(e,h,a.getPixelForValue(u)).lo),c){const t=l.slice(0,r+1).reverse().findIndex(t=>!$r(t[o.axis]));r-=Math.max(0,t)}r=Bs(r,0,i-1)}if(f){let t=Math.max(Hs(l,a.axis,d,!0).hi+1,n?0:Hs(e,h,a.getPixelForValue(d),!0).hi+1);if(c){const e=l.slice(t-1).findIndex(t=>!$r(t[o.axis]));t+=Math.max(0,e)}s=Bs(t,r,i)-r}else s=i-r}return{start:r,count:s}}function Js(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=r,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Qs=t=>0===t||1===t,ta=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*xs/n),ea=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*xs/n)+1,na={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Ss),easeOutSine:t=>Math.sin(t*Ss),easeInOutSine:t=>-.5*(Math.cos(_s*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>Qs(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Qs(t)?t:ta(t,.075,.3),easeOutElastic:t=>Qs(t)?t:ea(t,.075,.3),easeInOutElastic(t){const e=.1125;return Qs(t)?t:t<.5?.5*ta(2*t,e,.45):.5+.5*ea(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-na.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*na.easeInBounce(2*t):.5*na.easeOutBounce(2*t-1)+.5};function ia(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function ra(t){return ia(t)?t:new Yr(t)}function sa(t){return ia(t)?t:new Yr(t).saturate(.5).darken(.1).hexString()}const aa=["x","y","borderWidth","radius","tension"],oa=["color","borderColor","backgroundColor"];const la=new Map;function ca(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let i=la.get(n);return i||(i=new Intl.NumberFormat(t,e),la.set(n,i)),i}(e,n).format(t)}var ha={formatters:{values:t=>Jr(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const i=this.chart.options.locale;let r,s=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(r="scientific"),s=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t));return n}(t,n)}const a=As(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),ca(t,i,l)}}};const ua=Object.create(null),da=Object.create(null);function pa(t,e){if(!e)return t;const n=e.split(".");for(let i=0,r=n.length;i<r;++i){const e=n[i];t=t[e]||(t[e]=Object.create(null))}return t}function fa(t,e,n){return"string"==typeof e?hs(pa(t,e),n):hs(pa(t,""),e)}class ma{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>sa(e.backgroundColor),this.hoverBorderColor=(t,e)=>sa(e.borderColor),this.hoverColor=(t,e)=>sa(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return fa(this,t,e)}get(t){return pa(this,t)}describe(t,e){return fa(da,t,e)}override(t,e){return fa(ua,t,e)}route(t,e,n,i){const r=pa(this,t),s=pa(this,n),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[a],e=s[i];return Qr(t)?Object.assign({},e,t):ns(t,e)},set(t){this[a]=t}}})}apply(t){t.forEach(t=>t(this))}}var ga=new ma({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:oa},numbers:{type:"number",properties:aa}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ha.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function va(t,e,n,i,r){let s=e[r];return s||(s=e[r]=t.measureText(r).width,n.push(r)),s>i&&(i=s),i}function ya(t,e,n){const i=t.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((e-r)*i)/i+r}function _a(t,e){(e||t)&&((e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function xa(t,e,n,i){ba(t,e,n,i,null)}function ba(t,e,n,i,r){let s,a,o,l,c,h,u,d;const p=e.pointStyle,f=e.rotation,m=e.radius;let g=(f||0)*ws;if(p&&"object"==typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return t.save(),t.translate(n,i),t.rotate(g),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(m)||m<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,i,r/2,m,0,0,xs):t.arc(n,i,m,0,xs),t.closePath();break;case"triangle":h=r?r/2:m,t.moveTo(n+Math.sin(g)*h,i-Math.cos(g)*m),g+=Es,t.lineTo(n+Math.sin(g)*h,i-Math.cos(g)*m),g+=Es,t.lineTo(n+Math.sin(g)*h,i-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=.516*m,l=m-c,a=Math.cos(g+Ts)*l,u=Math.cos(g+Ts)*(r?r/2-c:l),o=Math.sin(g+Ts)*l,d=Math.sin(g+Ts)*(r?r/2-c:l),t.arc(n-u,i-o,c,g-_s,g-Ss),t.arc(n+d,i-a,c,g-Ss,g),t.arc(n+u,i+o,c,g,g+Ss),t.arc(n-d,i+a,c,g+Ss,g+_s),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,h=r?r/2:l,t.rect(n-h,i-l,2*h,2*l);break}g+=Ts;case"rectRot":u=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(n-u,i-o),t.lineTo(n+d,i-a),t.lineTo(n+u,i+o),t.lineTo(n-d,i+a),t.closePath();break;case"crossRot":g+=Ts;case"cross":u=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(n-u,i-o),t.lineTo(n+u,i+o),t.moveTo(n+d,i-a),t.lineTo(n-d,i+a);break;case"star":u=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(n-u,i-o),t.lineTo(n+u,i+o),t.moveTo(n+d,i-a),t.lineTo(n-d,i+a),g+=Ts,u=Math.cos(g)*(r?r/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),t.moveTo(n-u,i-o),t.lineTo(n+u,i+o),t.moveTo(n+d,i-a),t.lineTo(n-d,i+a);break;case"line":a=r?r/2:Math.cos(g)*m,o=Math.sin(g)*m,t.moveTo(n-a,i-o),t.lineTo(n+a,i+o);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(g)*(r?r/2:m),i+Math.sin(g)*m);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function Ma(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function wa(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Sa(t){t.restore()}function Ta(t,e,n,i,r){if(!e)return t.lineTo(n.x,n.y);if("middle"===r){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else"after"===r!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function Ea(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function Aa(t,e,n,i,r){if(r.strikethrough||r.underline){const s=t.measureText(i),a=e-s.actualBoundingBoxLeft,o=e+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,h=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(a,h),t.lineTo(o,h),t.stroke()}}function Ca(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Ra(t,e,n,i,r,s={}){const a=Jr(e)?e:[e],o=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(t.save(),t.font=r.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),$r(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,s),l=0;l<a.length;++l)c=a[l],s.backdrop&&Ca(t,s.backdrop),o&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),$r(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,n,i,s.maxWidth)),t.fillText(c,n,i,s.maxWidth),Aa(t,n,i,c,s),i+=Number(r.lineHeight);t.restore()}function Pa(t,e){const{x:n,y:i,w:r,h:s,radius:a}=e;t.arc(n+a.topLeft,i+a.topLeft,a.topLeft,1.5*_s,_s,!0),t.lineTo(n,i+s-a.bottomLeft),t.arc(n+a.bottomLeft,i+s-a.bottomLeft,a.bottomLeft,_s,Ss,!0),t.lineTo(n+r-a.bottomRight,i+s),t.arc(n+r-a.bottomRight,i+s-a.bottomRight,a.bottomRight,Ss,0,!0),t.lineTo(n+r,i+a.topRight),t.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-Ss,!0),t.lineTo(n+a.topLeft,i)}const Oa=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ia=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Da(t,e){const n=(""+t).match(Oa);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}const La=t=>+t||0;function Na(t,e){const n={},i=Qr(e),r=i?Object.keys(e):e,s=Qr(t)?i?n=>ns(t[n],t[e[n]]):e=>t[e]:()=>t;for(const a of r)n[a]=La(s(a));return n}function Ua(t){return Na(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Fa(t){return Na(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ka(t){const e=Ua(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ba(t,e){t=t||{},e=e||ga.font;let n=ns(t.size,e.size);"string"==typeof n&&(n=parseInt(n,10));let i=ns(t.style,e.style);i&&!(""+i).match(Ia)&&(i=void 0);const r={family:ns(t.family,e.family),lineHeight:Da(ns(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:ns(t.weight,e.weight),string:""};return r.string=function(t){return!t||$r(t.size)||$r(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(r),r}function za(t,e,n,i){let r,s,a;for(r=0,s=t.length;r<s;++r)if(a=t[r],void 0!==a&&void 0!==a)return a}function Va(t,e){return Object.assign(Object.create(t),e)}function Ha(t,e=[""],n,i,r=()=>t[0]){const s=n||t;void 0===i&&(i=Qa("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:i,_getTarget:r,override:n=>Ha([n,...t],e,s,i)};return new Proxy(a,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,i)=>qa(n,i,()=>function(t,e,n,i){let r;for(const s of e)if(r=Qa(Ga(s,t),n),void 0!==r)return Xa(t,r)?$a(n,i,t,r):r}(i,e,t,n)),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>to(t).includes(e),ownKeys:t=>to(t),set(t,e,n){const i=t._storage||(t._storage=r());return t[e]=i[e]=n,delete t._keys,!0}})}function Wa(t,e,n,i){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:ja(t,i),setContext:e=>Wa(t,e,n,i),override:r=>Wa(t.override(r),e,n,i)};return new Proxy(r,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>qa(t,e,()=>function(t,e,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:a}=t;let o=i[e];vs(o)&&a.isScriptable(e)&&(o=function(t,e,n,i){const{_proxy:r,_context:s,_subProxy:a,_stack:o}=n;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=e(s,a||i);o.delete(t),Xa(t,l)&&(l=$a(r._scopes,r,t,l));return l}(e,o,t,n));Jr(o)&&o.length&&(o=function(t,e,n,i){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;if(void 0!==s.index&&i(t))return e[s.index%e.length];if(Qr(e[0])){const n=e,i=r._scopes.filter(t=>t!==n);e=[];for(const l of n){const n=$a(i,r,t,l);e.push(Wa(n,s,a&&a[t],o))}}return e}(e,o,t,a.isIndexable));Xa(e,o)&&(o=Wa(o,r,s&&s[e],a));return o}(t,e,n)),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,i)=>(t[n]=i,delete e[n],!0)})}function ja(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:i,isScriptable:vs(n)?n:()=>n,isIndexable:vs(i)?i:()=>i}}const Ga=(t,e)=>t?t+ms(e):e,Xa=(t,e)=>Qr(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function qa(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||"constructor"===e)return t[e];const i=n();return t[e]=i,i}function Ya(t,e,n){return vs(t)?t(e,n):t}const Ka=(t,e)=>!0===t?e:"string"==typeof t?fs(e,t):void 0;function Za(t,e,n,i,r){for(const s of e){const e=Ka(n,s);if(e){t.add(e);const s=Ya(e._fallback,n,r);if(void 0!==s&&s!==n&&s!==i)return s}else if(!1===e&&void 0!==i&&n!==i)return null}return!1}function $a(t,e,n,i){const r=e._rootScopes,s=Ya(e._fallback,n,i),a=[...t,...r],o=new Set;o.add(i);let l=Ja(o,a,n,s||n,i);return null!==l&&((void 0===s||s===n||(l=Ja(o,a,s,l,i),null!==l))&&Ha(Array.from(o),[""],r,s,()=>function(t,e,n){const i=t._getTarget();e in i||(i[e]={});const r=i[e];if(Jr(r)&&Qr(n))return n;return r||{}}(e,n,i)))}function Ja(t,e,n,i,r){for(;n;)n=Za(t,e,n,i,r);return n}function Qa(t,e){for(const n of e){if(!n)continue;const e=n[t];if(void 0!==e)return e}}function to(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter(t=>!t.startsWith("_")))e.add(t);return Array.from(e)}(t._scopes)),e}const eo=Number.EPSILON||1e-14,no=(t,e)=>e<t.length&&!t[e].skip&&t[e],io=t=>"x"===t?"y":"x";function ro(t,e,n,i){const r=t.skip?e:t,s=e,a=n.skip?e:n,o=Ns(s,r),l=Ns(a,s);let c=o/(o+l),h=l/(o+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const u=i*c,d=i*h;return{previous:{x:s.x-u*(a.x-r.x),y:s.y-u*(a.y-r.y)},next:{x:s.x+d*(a.x-r.x),y:s.y+d*(a.y-r.y)}}}function so(t,e="x"){const n=io(e),i=t.length,r=Array(i).fill(0),s=Array(i);let a,o,l,c=no(t,0);for(a=0;a<i;++a)if(o=l,l=c,c=no(t,a+1),l){if(c){const t=c[e]-l[e];r[a]=0!==t?(c[n]-l[n])/t:0}s[a]=o?c?Cs(r[a-1])!==Cs(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}!function(t,e,n){const i=t.length;let r,s,a,o,l,c=no(t,0);for(let h=0;h<i-1;++h)l=c,c=no(t,h+1),l&&c&&(Rs(e[h],0,eo)?n[h]=n[h+1]=0:(r=n[h]/e[h],s=n[h+1]/e[h],o=Math.pow(r,2)+Math.pow(s,2),o<=9||(a=3/Math.sqrt(o),n[h]=r*a*e[h],n[h+1]=s*a*e[h])))}(t,r,s),function(t,e,n="x"){const i=io(n),r=t.length;let s,a,o,l=no(t,0);for(let c=0;c<r;++c){if(a=o,o=l,l=no(t,c+1),!o)continue;const r=o[n],h=o[i];a&&(s=(r-a[n])/3,o[`cp1${n}`]=r-s,o[`cp1${i}`]=h-s*e[c]),l&&(s=(l[n]-r)/3,o[`cp2${n}`]=r+s,o[`cp2${i}`]=h+s*e[c])}}(t,s,e)}function ao(t,e,n){return Math.max(Math.min(t,n),e)}function oo(t,e,n,i,r){let s,a,o,l;if(e.spanGaps&&(t=t.filter(t=>!t.skip)),"monotone"===e.cubicInterpolationMode)so(t,r);else{let n=i?t[t.length-1]:t[0];for(s=0,a=t.length;s<a;++s)o=t[s],l=ro(n,o,t[Math.min(s+1,a-(i?0:1))%a],e.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,n=o}e.capBezierPoints&&function(t,e){let n,i,r,s,a,o=Ma(t[0],e);for(n=0,i=t.length;n<i;++n)a=s,s=o,o=n<i-1&&Ma(t[n+1],e),s&&(r=t[n],a&&(r.cp1x=ao(r.cp1x,e.left,e.right),r.cp1y=ao(r.cp1y,e.top,e.bottom)),o&&(r.cp2x=ao(r.cp2x,e.left,e.right),r.cp2y=ao(r.cp2y,e.top,e.bottom)))}(t,n)}function lo(){return"undefined"!=typeof window&&"undefined"!=typeof document}function co(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function ho(t,e,n){let i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}const uo=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);const po=["top","right","bottom","left"];function fo(t,e,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=po[r];i[s]=parseFloat(t[e+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function mo(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,r=uo(n),s="border-box"===r.boxSizing,a=fo(r,"padding"),o=fo(r,"border","width"),{x:l,y:c,box:h}=function(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:r,offsetY:s}=i;let a,o,l=!1;if(((t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot))(r,s,t.target))a=r,o=s;else{const t=e.getBoundingClientRect();a=i.clientX-t.left,o=i.clientY-t.top,l=!0}return{x:a,y:o,box:l}}(t,n),u=a.left+(h&&o.left),d=a.top+(h&&o.top);let{width:p,height:f}=e;return s&&(p-=a.width+o.width,f-=a.height+o.height),{x:Math.round((l-u)/p*n.width/i),y:Math.round((c-d)/f*n.height/i)}}const go=t=>Math.round(10*t)/10;function vo(t,e,n,i){const r=uo(t),s=fo(r,"margin"),a=ho(r.maxWidth,t,"clientWidth")||Ms,o=ho(r.maxHeight,t,"clientHeight")||Ms,l=function(t,e,n){let i,r;if(void 0===e||void 0===n){const s=t&&co(t);if(s){const t=s.getBoundingClientRect(),a=uo(s),o=fo(a,"border","width"),l=fo(a,"padding");e=t.width-l.width-o.width,n=t.height-l.height-o.height,i=ho(a.maxWidth,s,"clientWidth"),r=ho(a.maxHeight,s,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:i||Ms,maxHeight:r||Ms}}(t,e,n);let{width:c,height:h}=l;if("content-box"===r.boxSizing){const t=fo(r,"border","width"),e=fo(r,"padding");c-=e.width+t.width,h-=e.height+t.height}c=Math.max(0,c-s.width),h=Math.max(0,i?c/i:h-s.height),c=go(Math.min(c,a,l.maxWidth)),h=go(Math.min(h,o,l.maxHeight)),c&&!h&&(h=go(c/2));return(void 0!==e||void 0!==n)&&i&&l.height&&h>l.height&&(h=l.height,c=go(Math.floor(h*i))),{width:c,height:h}}function yo(t,e,n){const i=e||1,r=Math.floor(t.height*i),s=Math.floor(t.width*i);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const a=t.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==i||a.height!==r||a.width!==s)&&(t.currentDevicePixelRatio=i,a.height=r,a.width=s,t.ctx.setTransform(i,0,0,i,0,0),!0)}const _o=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};lo()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(e){}return t}();function xo(t,e){const n=function(t,e){return uo(t).getPropertyValue(e)}(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function bo(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function Mo(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:"middle"===i?n<.5?t.y:e.y:"after"===i?n<1?t.y:e.y:n>0?e.y:t.y}}function wo(t,e,n,i){const r={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},a=bo(t,r,n),o=bo(r,s,n),l=bo(s,e,n),c=bo(a,o,n),h=bo(o,l,n);return bo(c,h,n)}function So(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function To(t,e){let n,i;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function Eo(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Ao(t){return"angle"===t?{between:ks,compare:Us,normalize:Fs}:{between:zs,compare:(t,e)=>t-e,normalize:t=>t}}function Co({start:t,end:e,count:n,loop:i,style:r}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n==0,style:r}}function Ro(t,e,n){if(!n)return[t];const{property:i,start:r,end:s}=n,a=e.length,{compare:o,between:l,normalize:c}=Ao(i),{start:h,end:u,loop:d,style:p}=function(t,e,n){const{property:i,start:r,end:s}=n,{between:a,normalize:o}=Ao(i),l=e.length;let c,h,{start:u,end:d,loop:p}=t;if(p){for(u+=l,d+=l,c=0,h=l;c<h&&a(o(e[u%l][i]),r,s);++c)u--,d--;u%=l,d%=l}return d<u&&(d+=l),{start:u,end:d,loop:p,style:t.style}}(t,e,n),f=[];let m,g,v,y=!1,_=null;const x=()=>y||l(r,v,m)&&0!==o(r,v),b=()=>!y||0===o(s,m)||l(s,v,m);for(let M=h,w=h;M<=u;++M)g=e[M%a],g.skip||(m=c(g[i]),m!==v&&(y=l(m,r,s),null===_&&x()&&(_=0===o(m,r)?M:w),null!==_&&b()&&(f.push(Co({start:_,end:M,loop:d,count:a,style:p})),_=null),w=M,v=m));return null!==_&&f.push(Co({start:_,end:u,loop:d,count:a,style:p})),f}function Po(t,e){const n=[],i=t.segments;for(let r=0;r<i.length;r++){const s=Ro(i[r],t.points,e);s.length&&n.push(...s)}return n}function Oo(t,e,n,i){return i&&i.setContext&&n?function(t,e,n,i){const r=t._chart.getContext(),s=Io(t.options),{_datasetIndex:a,options:{spanGaps:o}}=t,l=n.length,c=[];let h=s,u=e[0].start,d=u;function p(t,e,i,r){const s=o?-1:1;if(t!==e){for(t+=l;n[t%l].skip;)t-=s;for(;n[e%l].skip;)e+=s;t%l!==e%l&&(c.push({start:t%l,end:e%l,loop:i,style:r}),h=r,u=e%l)}}for(const f of e){u=o?u:f.start;let t,e=n[u%l];for(d=u+1;d<=f.end;d++){const s=n[d%l];t=Io(i.setContext(Va(r,{type:"segment",p0:e,p1:s,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:a}))),Do(t,h)&&p(u,d-1,f.loop,h),e=s,h=t}u<d-1&&p(u,d-1,f.loop,h)}return c}(t,e,n,i):e}function Io(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Do(t,e){if(!e)return!1;const n=[],i=function(t,e){return ia(e)?(n.includes(e)||n.push(e),n.indexOf(e)):e};return JSON.stringify(t,i)!==JSON.stringify(e,i)}function Lo(t,e,n){return t.options.clip?t[n]:e[n]}function No(t,e){const n=e._clip;if(n.disabled)return!1;const i=function(t,e){const{xScale:n,yScale:i}=t;return n&&i?{left:Lo(n,e,"left"),right:Lo(n,e,"right"),top:Lo(i,e,"top"),bottom:Lo(i,e,"bottom")}:e}(e,t.chartArea);return{left:!1===n.left?0:i.left-(!0===n.left?0:n.left),right:!1===n.right?t.width:i.right+(!0===n.right?0:n.right),top:!1===n.top?0:i.top-(!0===n.top?0:n.top),bottom:!1===n.bottom?t.height:i.bottom+(!0===n.bottom?0:n.bottom)}}class Uo{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const r=e.listeners[i],s=e.duration;r.forEach(i=>i({chart:t,initial:e.initial,numSteps:s,currentStep:Math.min(n-e.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=qs.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const r=n.items;let s,a=r.length-1,o=!1;for(;a>=0;--a)s=r[a],s._active?(s._total>n.duration&&(n.duration=s._total),s.tick(t),o=!0):(r[a]=r[r.length-1],r.pop());o&&(i.draw(),this._notify(i,n,t,"progress")),r.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=r.length}),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((t,e)=>Math.max(t,e._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Fo=new Uo;const ko="transparent",Bo={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const i=ra(t||ko),r=i.valid&&ra(e||ko);return r&&r.valid?r.mix(i,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class zo{constructor(t,e,n,i){const r=e[n];i=za([t.to,i,r,t.from]);const s=za([t.from,r,i]);this._active=!0,this._fn=t.fn||Bo[t.type||typeof s],this._easing=na[t.easing]||na.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=s,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],r=n-this._start,s=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(s,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=za([t.to,e,i,t.from]),this._from=za([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,r=this._from,s=this._loop,a=this._to;let o;if(this._active=r!==a&&(s||e<n),!this._active)return this._target[i]=a,void this._notify(!0);e<0?this._target[i]=r:(o=e/n%2,o=s&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[i]=this._fn(r,a,o))}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,n)=>{t.push({res:e,rej:n})})}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][e]()}}class Vo{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Qr(t))return;const e=Object.keys(ga.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const r=t[i];if(!Qr(r))return;const s={};for(const t of e)s[t]=r[t];(Jr(r.properties)&&r.properties||[i]).forEach(t=>{t!==i&&n.has(t)||n.set(t,s)})})}_animateOptions(t,e){const n=e.options,i=function(t,e){if(!e)return;let n=t.options;if(!n)return void(t.options=e);n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(t,n);if(!i)return[];const r=this._createAnimations(i,n);return n.$shared&&function(t,e){const n=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const e=t[i[r]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}(t.options.$animations,n).then(()=>{t.options=n},()=>{}),r}_createAnimations(t,e){const n=this._properties,i=[],r=t.$animations||(t.$animations={}),s=Object.keys(e),a=Date.now();let o;for(o=s.length-1;o>=0;--o){const l=s[o];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(t,e));continue}const c=e[l];let h=r[l];const u=n.get(l);if(h){if(u&&h.active()){h.update(u,c,a);continue}h.cancel()}u&&u.duration?(r[l]=h=new zo(u,t,l,c),i.push(h)):t[l]=c}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(Fo.add(this._chart,n),!0):void 0}}function Ho(t,e){const n=t&&t.options||{},i=n.reverse,r=void 0===n.min?e:0,s=void 0===n.max?e:0;return{start:i?s:r,end:i?r:s}}function Wo(t,e){const n=[],i=t._getSortedDatasetMetas(e);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function jo(t,e,n,i={}){const r=t.keys,s="single"===i.mode;let a,o,l,c;if(null===e)return;let h=!1;for(a=0,o=r.length;a<o;++a){if(l=+r[a],l===n){if(h=!0,i.all)continue;break}c=t.values[l],ts(c)&&(s||0===e||Cs(e)===Cs(c))&&(e+=c)}return h||i.all?e:0}function Go(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function Xo(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function qo(t,e,n,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const e=t[r.index];if(n&&e>0||!n&&e<0)return r.index}return null}function Yo(t,e){const{chart:n,_cachedMeta:i}=t,r=n._stacks||(n._stacks={}),{iScale:s,vScale:a,index:o}=i,l=s.axis,c=a.axis,h=function(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}(s,a,i),u=e.length;let d;for(let p=0;p<u;++p){const t=e[p],{[l]:n,[c]:s}=t;d=(t._stacks||(t._stacks={}))[c]=Xo(r,h,n),d[o]=s,d._top=qo(d,a,!0,i.type),d._bottom=qo(d,a,!1,i.type);(d._visualValues||(d._visualValues={}))[o]=s}}function Ko(t,e){const n=t.scales;return Object.keys(n).filter(t=>n[t].axis===e).shift()}function Zo(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][n])return;delete e[i][n],void 0!==e[i]._visualValues&&void 0!==e[i]._visualValues[n]&&delete e[i]._visualValues[n]}}}const $o=t=>"reset"===t||"none"===t,Jo=(t,e)=>e?t:Object.assign({},t);class Qo{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Go(t.vScale,t),this.addElements(),this.options.fill&&this.chart.isPluginEnabled("filler")}updateIndex(t){this.index!==t&&Zo(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(t,e,n,i)=>"x"===t?e:"r"===t?i:n,r=e.xAxisID=ns(n.xAxisID,Ko(t,"x")),s=e.yAxisID=ns(n.yAxisID,Ko(t,"y")),a=e.rAxisID=ns(n.rAxisID,Ko(t,"r")),o=e.indexAxis,l=e.iAxisID=i(o,r,s,a),c=e.vAxisID=i(o,s,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(s),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Gs(this._data,this),t._stacked&&Zo(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(Qr(e)){const t=this._cachedMeta;this._data=function(t,e){const{iScale:n,vScale:i}=e,r="x"===n.axis?"x":"y",s="x"===i.axis?"x":"y",a=Object.keys(t),o=new Array(a.length);let l,c,h;for(l=0,c=a.length;l<c;++l)h=a[l],o[l]={[r]:h,[s]:t[h]};return o}(e,t)}else if(n!==e){if(n){Gs(n,this);const t=this._cachedMeta;Zo(t),t._parsed=[]}e&&Object.isExtensible(e)&&(r=this,(i=e)._chartjs?i._chartjs.listeners.push(r):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),js.forEach(t=>{const e="_onData"+ms(t),n=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(...t){const r=n.apply(this,t);return i._chartjs.listeners.forEach(n=>{"function"==typeof n[e]&&n[e](...t)}),r}})}))),this._syncList=[],this._data=e}var i,r}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const r=e._stacked;e._stacked=Go(e.vScale,e),e.stack!==n.stack&&(i=!0,Zo(e),e.stack=n.stack),this._resyncElements(t),(i||r!==e._stacked)&&(Yo(this,e._parsed),e._stacked=Go(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:r,_stacked:s}=n,a=r.axis;let o,l,c,h=0===t&&e===i.length||n._sorted,u=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,c=i;else{c=Jr(i[t])?this.parseArrayData(n,i,t,e):Qr(i[t])?this.parseObjectData(n,i,t,e):this.parsePrimitiveData(n,i,t,e);const r=()=>null===l[a]||u&&l[a]<u[a];for(o=0;o<e;++o)n._parsed[o+t]=l=c[o],h&&(r()&&(h=!1),u=l);n._sorted=h}s&&Yo(this,c)}parsePrimitiveData(t,e,n,i){const{iScale:r,vScale:s}=t,a=r.axis,o=s.axis,l=r.getLabels(),c=r===s,h=new Array(i);let u,d,p;for(u=0,d=i;u<d;++u)p=u+n,h[u]={[a]:c||r.parse(l[p],p),[o]:s.parse(e[p],p)};return h}parseArrayData(t,e,n,i){const{xScale:r,yScale:s}=t,a=new Array(i);let o,l,c,h;for(o=0,l=i;o<l;++o)c=o+n,h=e[c],a[o]={x:r.parse(h[0],c),y:s.parse(h[1],c)};return a}parseObjectData(t,e,n,i){const{xScale:r,yScale:s}=t,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l=new Array(i);let c,h,u,d;for(c=0,h=i;c<h;++c)u=c+n,d=e[u],l[c]={x:r.parse(fs(d,a),u),y:s.parse(fs(d,o),u)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,r=this._cachedMeta,s=e[t.axis];return jo({keys:Wo(i,!0),values:e._stacks[t.axis]._visualValues},s,r.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const r=n[e.axis];let s=null===r?NaN:r;const a=i&&n._stacks[e.axis];i&&a&&(i.values=a,s=jo(i,r,this._cachedMeta.index)),t.min=Math.min(t.min,s),t.max=Math.max(t.max,s)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,r=n._sorted&&t===n.iScale,s=i.length,a=this._getOtherScale(t),o=((t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Wo(n,!0),values:null})(e,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:h}=function(t){const{min:e,max:n,minDefined:i,maxDefined:r}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}(a);let u,d;function p(){d=i[u];const e=d[a.axis];return!ts(d[t.axis])||c>e||h<e}for(u=0;u<s&&(p()||(this.updateRangeFromParsed(l,t,d,o),!r));++u);if(r)for(u=s-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(l,t,d,o);break}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,r,s;for(i=0,r=e.length;i<r;++i)s=e[i][t.axis],ts(s)&&n.push(s);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,r=this.getParsed(t);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,n,i,r;return Qr(t)?(e=t.top,n=t.right,i=t.bottom,r=t.left):e=n=i=r=t,{top:e,right:n,bottom:i,left:r,disabled:!1===t}}(ns(this.options.clip,function(t,e,n){if(!1===n)return!1;const i=Ho(t,n),r=Ho(e,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],r=e.chartArea,s=[],a=this._drawStart||0,o=this._drawCount||i.length-a,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(t,r,a,o),c=a;c<a+o;++c){const e=i[c];e.hidden||(e.active&&l?s.push(e):e.draw(t,r))}for(c=0;c<s.length;++c)s[c].draw(t,r)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];r=e.$context||(e.$context=function(t,e,n){return Va(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),r.parsed=this.getParsed(t),r.raw=i.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=function(t,e){return Va(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=n,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const i="active"===e,r=this._cachedDataOpts,s=t+"-"+e,a=r[s],o=this.enableOptionSharing&&gs(n);if(a)return Jo(a,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),h=i?[`${t}Hover`,"hover",t,""]:[t,""],u=l.getOptionScopes(this.getDataset(),c),d=Object.keys(ga.elements[t]),p=l.resolveNamedOptions(u,d,()=>this.getContext(n,i,e),h);return p.$shared&&(p.$shared=o,r[s]=Object.freeze(Jo(p,o))),p}_resolveAnimations(t,e,n){const i=this.chart,r=this._cachedDataOpts,s=`animation-${e}`,a=r[s];if(a)return a;let o;if(!1!==i.options.animation){const i=this.chart.config,r=i.datasetAnimationScopeKeys(this._type,e),s=i.getOptionScopes(this.getDataset(),r);o=i.createResolver(s,this.getContext(t,n,e))}const l=new Vo(i,o&&o.animations);return o&&o._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||$o(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),i=this._sharedOptions,r=this.getSharedOptions(n),s=this.includeOptions(e,r)||r!==i;return this.updateSharedOptions(r,e,n),{sharedOptions:r,includeOptions:s}}updateElement(t,e,n,i){$o(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!$o(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const r=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[a,o,l]of this._syncList)this[a](o,l);this._syncList=[];const i=n.length,r=e.length,s=Math.min(r,i);s&&this.parse(0,s),r>i?this._insertElements(i,r-i,t):r<i&&this._removeElements(r,i-r)}_insertElements(t,e,n=!0){const i=this._cachedMeta,r=i.data,s=t+e;let a;const o=t=>{for(t.length+=e,a=t.length-1;a>=s;a--)t[a]=t[a-e]};for(o(r),a=t;a<s;++a)r[a]=new this.dataElementType;this._parsing&&o(i._parsed),this.parse(t,e),n&&this.updateElements(r,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&Zo(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function tl(t){const e=t.iScale,n=function(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let e=0,r=n.length;e<r;e++)i=i.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=Xs(i.sort((t,e)=>t-e))}return t._cache.$bar}(e,t.type);let i,r,s,a,o=e._length;const l=()=>{32767!==s&&-32768!==s&&(gs(a)&&(o=Math.min(o,Math.abs(s-a)||o)),a=s)};for(i=0,r=n.length;i<r;++i)s=e.getPixelForValue(n[i]),l();for(a=void 0,i=0,r=e.ticks.length;i<r;++i)s=e.getPixelForTick(i),l();return o}function el(t,e,n,i){return Jr(t)?function(t,e,n,i){const r=n.parse(t[0],i),s=n.parse(t[1],i),a=Math.min(r,s),o=Math.max(r,s);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:s,min:a,max:o}}(t,e,n,i):e[n.axis]=n.parse(t,i),e}function nl(t,e,n,i){const r=t.iScale,s=t.vScale,a=r.getLabels(),o=r===s,l=[];let c,h,u,d;for(c=n,h=n+i;c<h;++c)d=e[c],u={},u[r.axis]=o||r.parse(a[c],c),l.push(el(d,u,s,c));return l}function il(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function rl(t,e,n,i){let r=e.borderSkipped;const s={};if(!r)return void(t.borderSkipped=s);if(!0===r)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:a,end:o,reverse:l,top:c,bottom:h}=function(t){let e,n,i,r,s;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:e,top:r,bottom:s}}(t);"middle"===r&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?r=c:(n._bottom||0)===i?r=h:(s[sl(h,a,o,l)]=!0,r=c)),s[sl(r,a,o,l)]=!0,t.borderSkipped=s}function sl(t,e,n,i){var r,s,a;return i?(a=n,t=al(t=(r=t)===(s=e)?a:r===a?s:r,n,e)):t=al(t,e,n),t}function al(t,e,n){return"start"===t?e:"end"===t?n:t}function ol(t,{inflateAmount:e},n){t.inflateAmount="auto"===e?1===n?.33:0:e}Pt(Qo,"defaults",{}),Pt(Qo,"datasetElementType",null),Pt(Qo,"dataElementType",null);class ll extends Qo{parsePrimitiveData(t,e,n,i){return nl(t,e,n,i)}parseArrayData(t,e,n,i){return nl(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:r,vScale:s}=t,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l="x"===r.axis?a:o,c="x"===s.axis?a:o,h=[];let u,d,p,f;for(u=n,d=n+i;u<d;++u)f=e[u],p={},p[r.axis]=r.parse(fs(f,l),u),h.push(el(fs(f,c),p,s,u));return h}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const r=n._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,r=this.getParsed(t),s=r._custom,a=il(s)?"["+s.start+", "+s.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,i){const r="reset"===i,{index:s,_cachedMeta:{vScale:a}}=this,o=a.getBasePixel(),l=a.isHorizontal(),c=this._getRuler(),{sharedOptions:h,includeOptions:u}=this._getSharedOptions(e,i);for(let d=e;d<e+n;d++){const e=this.getParsed(d),n=r||$r(e[a.axis])?{base:o,head:o}:this._calculateBarValuePixels(d),p=this._calculateBarIndexPixels(d,c),f=(e._stacks||{})[a.axis],m={horizontal:l,base:n.base,enableBorderRadius:!f||il(e._custom)||s===f._top||s===f._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};u&&(m.options=h||this.resolveDataElementOptions(d,t[d].active?"active":i));const g=m.options||t[d].options;rl(m,g,f,s),ol(m,g,c.ratio),this.updateElement(t[d],d,m,i)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(t=>t.controller.options.grouped),r=n.options.stacked,s=[],a=this._cachedMeta.controller.getParsed(e),o=a&&a[n.axis],l=t=>{const e=t._parsed.find(t=>t[n.axis]===o),i=e&&e[t.vScale.axis];if($r(i)||isNaN(i))return!0};for(const c of i)if((void 0===e||!l(c))&&((!1===r||-1===s.indexOf(c.stack)||void 0===r&&void 0===c.stack)&&s.push(c.stack),c.index===t))break;return s.length||s.push(void 0),s}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[ns("x"===this.chart.options.indexAxis?n.xAxisID:n.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,n){const i=this._getStacks(t,n),r=void 0!==e?i.indexOf(e):-1;return-1===r?i.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let r,s;for(r=0,s=e.data.length;r<s;++r)i.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const a=t.barThickness;return{min:a||tl(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:i},options:{base:r,minBarLength:s}}=this,a=r||0,o=this.getParsed(t),l=o._custom,c=il(l);let h,u,d=o[e.axis],p=0,f=n?this.applyStack(e,o,n):d;f!==d&&(p=f-d,f=d),c&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&Cs(d)!==Cs(l.barEnd)&&(p=0),p+=d);const m=$r(r)||c?p:r;let g=e.getPixelForValue(m);if(h=this.chart.getDataVisibility(t)?e.getPixelForValue(p+f):g,u=h-g,Math.abs(u)<s){u=function(t,e,n){return 0!==t?Cs(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}(u,e,a)*s,d===a&&(g-=u/2);const t=e.getPixelForDecimal(0),r=e.getPixelForDecimal(1),l=Math.min(t,r),p=Math.max(t,r);g=Math.max(Math.min(g,p),l),h=g+u,n&&!c&&(o._stacks[e.axis]._visualValues[i]=e.getValueForPixel(h)-e.getValueForPixel(g))}if(g===e.getPixelForValue(a)){const t=Cs(u)*e.getLineWidthForValue(a)/2;g+=t,u-=t}return{size:u,base:g,head:h,center:h+u/2}}_calculateBarIndexPixels(t,e){const n=e.scale,i=this.options,r=i.skipNull,s=ns(i.maxBarThickness,1/0);let a,o;const l=this._getAxisCount();if(e.grouped){const n=r?this._getStackCount(t):e.stackCount,c="flex"===i.barThickness?function(t,e,n,i){const r=e.pixels,s=r[t];let a=t>0?r[t-1]:null,o=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;null===a&&(a=s-(null===o?e.end-e.start:o-s)),null===o&&(o=s+s-a);const c=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/i,ratio:n.barPercentage,start:c}}(t,e,i,n*l):function(t,e,n,i){const r=n.barThickness;let s,a;return $r(r)?(s=e.min*n.categoryPercentage,a=n.barPercentage):(s=r*i,a=1),{chunk:s/i,ratio:a,start:e.pixels[t]-s/2}}(t,e,i,n*l),h="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,u=this._getAxis().indexOf(ns(h,this.getFirstScaleIdForIndexAxis())),d=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+u;a=c.start+c.chunk*d+c.chunk/2,o=Math.min(s,c.chunk*c.ratio)}else a=n.getPixelForValue(this.getParsed(t)[n.axis],t),o=Math.min(s,e.min*e.ratio);return{base:a-o/2,head:a+o/2,center:a,size:o}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let r=0;for(;r<i;++r)null===this.getParsed(r)[e.axis]||n[r].hidden||n[r].draw(this._ctx)}}Pt(ll,"id","bar"),Pt(ll,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Pt(ll,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class cl extends Qo{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let r,s,a=t=>+n[t];if(Qr(n[t])){const{key:t="value"}=this._parsing;a=e=>+fs(n[e],t)}for(r=t,s=t+e;r<s;++r)i._parsed[r]=a(r)}}_getRotation(){return Is(this.options.rotation-90)}_getCircumference(){return Is(this.options.circumference)}_getRotationExtents(){let t=xs,e=-xs;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,r=i._getRotation(),s=i._getCircumference();t=Math.min(t,r),e=Math.max(e,r+s)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,i=this._cachedMeta,r=i.data,s=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-s)/2,0),o=Math.min((l=this.options.cutout,c=a,"string"==typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const h=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:p,ratioY:f,offsetX:m,offsetY:g}=function(t,e,n){let i=1,r=1,s=0,a=0;if(e<xs){const o=t,l=o+e,c=Math.cos(o),h=Math.sin(o),u=Math.cos(l),d=Math.sin(l),p=(t,e,i)=>ks(t,o,l,!0)?1:Math.max(e,e*n,i,i*n),f=(t,e,i)=>ks(t,o,l,!0)?-1:Math.min(e,e*n,i,i*n),m=p(0,c,u),g=p(Ss,h,d),v=f(_s,c,u),y=f(_s+Ss,h,d);i=(m-v)/2,r=(g-y)/2,s=-(m+v)/2,a=-(g+y)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:a}}(d,u,o),v=(n.width-s)/p,y=(n.height-s)/f,_=Math.max(Math.min(v,y)/2,0),x=is(this.options.radius,_),b=(x-Math.max(x*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*x,this.offsetY=g*x,i.total=this.calculateTotal(),this.outerRadius=x-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*h,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const n=this.options,i=this._cachedMeta,r=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||null===i._parsed[t]||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*r/xs)}updateElements(t,e,n,i){const r="reset"===i,s=this.chart,a=s.chartArea,o=s.options.animation,l=(a.left+a.right)/2,c=(a.top+a.bottom)/2,h=r&&o.animateScale,u=h?0:this.innerRadius,d=h?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(e,i);let m,g=this._getRotation();for(m=0;m<e;++m)g+=this._circumference(m,r);for(m=e;m<e+n;++m){const e=this._circumference(m,r),n=t[m],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+e,circumference:e,outerRadius:d,innerRadius:u};f&&(s.options=p||this.resolveDataElementOptions(m,n.active?"active":i)),g+=e,this.updateElement(n,m,s,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,i=0;for(n=0;n<e.length;n++){const r=t._parsed[n];null===r||isNaN(r)||!this.chart.getDataVisibility(n)||e[n].hidden||(i+=Math.abs(r))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?xs*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=ca(e._parsed[t],n.options.locale);return{label:i[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const n=this.chart;let i,r,s,a,o;if(!t)for(i=0,r=n.data.datasets.length;i<r;++i)if(n.isDatasetVisible(i)){s=n.getDatasetMeta(i),t=s.data,a=s.controller;break}if(!t)return 0;for(i=0,r=t.length;i<r;++i)o=a.resolveDataElementOptions(i),"inner"!==o.borderAlign&&(e=Math.max(e,o.borderWidth||0,o.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,i=t.length;n<i;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(ns(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Pt(cl,"id","doughnut"),Pt(cl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Pt(cl,"descriptors",{_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Pt(cl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:i}}=t.legend.options;return e.labels.map((e,r)=>{const s=t.getDatasetMeta(0).controller.getStyle(r);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:i,lineWidth:s.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}}});class hl extends Qo{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:i=[],_dataset:r}=e,s=this.chart._animationsDisabled;let{start:a,count:o}=$s(e,i,s);this._drawStart=a,this._drawCount=o,Js(e)&&(a=0,o=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=i;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!s,options:l},t),this.updateElements(i,a,o,t)}updateElements(t,e,n,i){const r="reset"===i,{iScale:s,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:h}=this._getSharedOptions(e,i),u=s.axis,d=a.axis,{spanGaps:p,segment:f}=this.options,m=Os(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||r||"none"===i,v=e+n,y=t.length;let _=e>0&&this.getParsed(e-1);for(let x=0;x<y;++x){const n=t[x],p=g?n:{};if(x<e||x>=v){p.skip=!0;continue}const y=this.getParsed(x),b=$r(y[d]),M=p[u]=s.getPixelForValue(y[u],x),w=p[d]=r||b?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,y,o):y[d],x);p.skip=isNaN(M)||isNaN(w)||b,p.stop=x>0&&Math.abs(y[u]-_[u])>m,f&&(p.parsed=y,p.raw=l.data[x]),h&&(p.options=c||this.resolveDataElementOptions(x,n.active?"active":i)),g||this.updateElement(n,x,p,i),_=y}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),s=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,s)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Pt(hl,"id","line"),Pt(hl,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Pt(hl,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ul extends Qo{getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=e,s=this.getParsed(t),a=i.getLabelForValue(s.x),o=r.getLabelForValue(s.y);return{label:n[t]||"",value:"("+a+", "+o+")"}}update(t){const e=this._cachedMeta,{data:n=[]}=e,i=this.chart._animationsDisabled;let{start:r,count:s}=$s(e,n,i);if(this._drawStart=r,this._drawCount=s,Js(e)&&(r=0,s=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:r,_dataset:s}=e;r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=n;const a=this.resolveDatasetElementOptions(t);a.segment=this.options.segment,this.updateElement(r,void 0,{animated:!i,options:a},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(n,r,s,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,n,i){const r="reset"===i,{iScale:s,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(e,i),h=this.getSharedOptions(c),u=this.includeOptions(i,h),d=s.axis,p=a.axis,{spanGaps:f,segment:m}=this.options,g=Os(f)?f:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||r||"none"===i;let y=e>0&&this.getParsed(e-1);for(let _=e;_<e+n;++_){const e=t[_],n=this.getParsed(_),c=v?e:{},f=$r(n[p]),x=c[d]=s.getPixelForValue(n[d],_),b=c[p]=r||f?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,n,o):n[p],_);c.skip=isNaN(x)||isNaN(b)||f,c.stop=_>0&&Math.abs(n[d]-y[d])>g,m&&(c.parsed=n,c.raw=l.data[_]),u&&(c.options=h||this.resolveDataElementOptions(_,e.active?"active":i)),v||this.updateElement(e,_,c,i),y=n}this.updateSharedOptions(h,i,c)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}const n=t.dataset,i=n.options&&n.options.borderWidth||0;if(!e.length)return i;const r=e[0].size(this.resolveDataElementOptions(0)),s=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,r,s)/2}}function dl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}Pt(ul,"id","scatter"),Pt(ul,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Pt(ul,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});class pl{constructor(t){Pt(this,"options"),this.options=t||{}}static override(t){Object.assign(pl.prototype,t)}init(){}formats(){return dl()}parse(){return dl()}format(){return dl()}add(){return dl()}diff(){return dl()}startOf(){return dl()}endOf(){return dl()}}var fl=pl;function ml(t,e,n,i){const{controller:r,data:s,_sorted:a}=t,o=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&"r"!==e&&a&&s.length){const a=o._reversePixels?Ws:Hs;if(!i){const i=a(s,e,n);if(l){const{vScale:e}=r._cachedMeta,{_parsed:n}=t,s=n.slice(0,i.lo+1).reverse().findIndex(t=>!$r(t[e.axis]));i.lo-=Math.max(0,s);const a=n.slice(i.hi).findIndex(t=>!$r(t[e.axis]));i.hi+=Math.max(0,a)}return i}if(r._sharedOptions){const t=s[0],i="function"==typeof t.getRange&&t.getRange(e);if(i){const t=a(s,e,n-i),r=a(s,e,n+i);return{lo:t.lo,hi:r.hi}}}}return{lo:0,hi:s.length-1}}function gl(t,e,n,i,r){const s=t.getSortedVisibleDatasetMetas(),a=n[e];for(let o=0,l=s.length;o<l;++o){const{index:t,data:n}=s[o],{lo:l,hi:c}=ml(s[o],e,a,r);for(let e=l;e<=c;++e){const r=n[e];r.skip||i(r,t,e)}}}function vl(t,e,n,i,r){const s=[];if(!r&&!t.isPointInArea(e))return s;return gl(t,n,e,function(n,a,o){(r||Ma(n,t.chartArea,0))&&n.inRange(e.x,e.y,i)&&s.push({element:n,datasetIndex:a,index:o})},!0),s}function yl(t,e,n,i,r,s){let a=[];const o=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){const r=e?Math.abs(t.x-i.x):0,s=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(s,2))}}(n);let l=Number.POSITIVE_INFINITY;return gl(t,n,e,function(n,c,h){const u=n.inRange(e.x,e.y,r);if(i&&!u)return;const d=n.getCenterPoint(r);if(!(!!s||t.isPointInArea(d))&&!u)return;const p=o(e,d);p<l?(a=[{element:n,datasetIndex:c,index:h}],l=p):p===l&&a.push({element:n,datasetIndex:c,index:h})}),a}function _l(t,e,n,i,r,s){return s||t.isPointInArea(e)?"r"!==n||i?yl(t,e,n,i,r,s):function(t,e,n,i){let r=[];return gl(t,n,e,function(t,n,s){const{startAngle:a,endAngle:o}=t.getProps(["startAngle","endAngle"],i),{angle:l}=Ls(t,{x:e.x,y:e.y});ks(l,a,o)&&r.push({element:t,datasetIndex:n,index:s})}),r}(t,e,n,r):[]}function xl(t,e,n,i,r){const s=[],a="x"===n?"inXRange":"inYRange";let o=!1;return gl(t,n,e,(t,i,l)=>{t[a]&&t[a](e[n],r)&&(s.push({element:t,datasetIndex:i,index:l}),o=o||t.inRange(e.x,e.y,r))}),i&&!o?[]:s}var bl={modes:{index(t,e,n,i){const r=mo(e,t),s=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?vl(t,r,s,i,a):_l(t,r,s,!1,i,a),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(t=>{const e=o[0].index,n=t.data[e];n&&!n.skip&&l.push({element:n,datasetIndex:t.index,index:e})}),l):[]},dataset(t,e,n,i){const r=mo(e,t),s=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?vl(t,r,s,i,a):_l(t,r,s,!1,i,a);if(o.length>0){const e=o[0].datasetIndex,n=t.getDatasetMeta(e).data;o=[];for(let t=0;t<n.length;++t)o.push({element:n[t],datasetIndex:e,index:t})}return o},point:(t,e,n,i)=>vl(t,mo(e,t),n.axis||"xy",i,n.includeInvisible||!1),nearest(t,e,n,i){const r=mo(e,t),s=n.axis||"xy",a=n.includeInvisible||!1;return _l(t,r,s,n.intersect,i,a)},x:(t,e,n,i)=>xl(t,mo(e,t),"x",n.intersect,i),y:(t,e,n,i)=>xl(t,mo(e,t),"y",n.intersect,i)}};const Ml=["left","top","right","bottom"];function wl(t,e){return t.filter(t=>t.pos===e)}function Sl(t,e){return t.filter(t=>-1===Ml.indexOf(t.pos)&&t.box.axis===e)}function Tl(t,e){return t.sort((t,n)=>{const i=e?n:t,r=e?t:n;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function El(t,e){const n=function(t){const e={};for(const n of t){const{stack:t,pos:i,stackWeight:r}=n;if(!t||!Ml.includes(i))continue;const s=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=r}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let s,a,o;for(s=0,a=t.length;s<a;++s){o=t[s];const{fullSize:a}=o.box,l=n[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*i:a&&e.availableWidth,o.height=r):(o.width=i,o.height=c?c*r:a&&e.availableHeight)}return n}function Al(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function Cl(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Rl(t,e,n,i){const{pos:r,box:s}=n,a=t.maxPadding;if(!Qr(r)){n.size&&(t[r]-=n.size);const e=i[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?s.height:s.width),n.size=e.size/e.count,t[r]+=n.size}s.getPadding&&Cl(a,s.getPadding());const o=Math.max(0,e.outerWidth-Al(a,t,"left","right")),l=Math.max(0,e.outerHeight-Al(a,t,"top","bottom")),c=o!==t.w,h=l!==t.h;return t.w=o,t.h=l,n.horizontal?{same:c,other:h}:{same:h,other:c}}function Pl(t,e){const n=e.maxPadding;function i(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach(t=>{i[t]=Math.max(e[t],n[t])}),i}return i(t?["left","right"]:["top","bottom"])}function Ol(t,e,n,i){const r=[];let s,a,o,l,c,h;for(s=0,a=t.length,c=0;s<a;++s){o=t[s],l=o.box,l.update(o.width||e.w,o.height||e.h,Pl(o.horizontal,e));const{same:a,other:u}=Rl(e,n,o,i);c|=a&&r.length,h=h||u,l.fullSize||r.push(o)}return c&&Ol(r,e,n,i)||h}function Il(t,e,n,i,r){t.top=n,t.left=e,t.right=e+i,t.bottom=n+r,t.width=i,t.height=r}function Dl(t,e,n,i){const r=n.padding;let{x:s,y:a}=e;for(const o of t){const t=o.box,l=i[o.stack]||{placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const i=e.w*c,s=l.size||t.height;gs(l.start)&&(a=l.start),t.fullSize?Il(t,r.left,a,n.outerWidth-r.right-r.left,s):Il(t,e.left+l.placed,a,i,s),l.start=a,l.placed+=i,a=t.bottom}else{const i=e.h*c,a=l.size||t.width;gs(l.start)&&(s=l.start),t.fullSize?Il(t,s,r.top,a,n.outerHeight-r.bottom-r.top):Il(t,s,e.top+l.placed,a,i),l.start=s,l.placed+=i,s=t.right}}e.x=s,e.y=a}var Ll={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const r=ka(t.options.layout.padding),s=Math.max(e-r.width,0),a=Math.max(n-r.height,0),o=function(t){const e=function(t){const e=[];let n,i,r,s,a,o;for(n=0,i=(t||[]).length;n<i;++n)r=t[n],({position:s,options:{stack:a,stackWeight:o=1}}=r),e.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&s+a,stackWeight:o});return e}(t),n=Tl(e.filter(t=>t.box.fullSize),!0),i=Tl(wl(e,"left"),!0),r=Tl(wl(e,"right")),s=Tl(wl(e,"top"),!0),a=Tl(wl(e,"bottom")),o=Sl(e,"x"),l=Sl(e,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(a).concat(o),chartArea:wl(e,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(a).concat(o)}}(t.boxes),l=o.vertical,c=o.horizontal;ss(t.boxes,t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()});const h=l.reduce((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1,0)||1,u=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/h,hBoxMaxHeight:a/2}),d=Object.assign({},r);Cl(d,ka(i));const p=Object.assign({maxPadding:d,w:s,h:a,x:r.left,y:r.top},r),f=El(l.concat(c),u);Ol(o.fullSize,p,u,f),Ol(l,p,u,f),Ol(c,p,u,f)&&Ol(l,p,u,f),function(t){const e=t.maxPadding;function n(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(p),Dl(o.leftAndTop,p,u,f),p.x+=p.w,p.y+=p.h,Dl(o.rightAndBottom,p,u,f),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},ss(o.chartArea,e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class Nl{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class Ul extends Nl{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Fl="$chartjs",kl={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Bl=t=>null===t||""===t;const zl=!!_o&&{passive:!0};function Vl(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,zl)}function Hl(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function Wl(t,e,n){const i=t.canvas,r=new MutationObserver(t=>{let e=!1;for(const n of t)e=e||Hl(n.addedNodes,i),e=e&&!Hl(n.removedNodes,i);e&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function jl(t,e,n){const i=t.canvas,r=new MutationObserver(t=>{let e=!1;for(const n of t)e=e||Hl(n.removedNodes,i),e=e&&!Hl(n.addedNodes,i);e&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Gl=new Map;let Xl=0;function ql(){const t=window.devicePixelRatio;t!==Xl&&(Xl=t,Gl.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function Yl(t,e,n){const i=t.canvas,r=i&&co(i);if(!r)return;const s=Ys((t,e)=>{const i=r.clientWidth;n(t,e),i<r.clientWidth&&n()},window),a=new ResizeObserver(t=>{const e=t[0],n=e.contentRect.width,i=e.contentRect.height;0===n&&0===i||s(n,i)});return a.observe(r),function(t,e){Gl.size||window.addEventListener("resize",ql),Gl.set(t,e)}(t,s),a}function Kl(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){Gl.delete(t),Gl.size||window.removeEventListener("resize",ql)}(t)}function Zl(t,e,n){const i=t.canvas,r=Ys(e=>{null!==t.ctx&&n(function(t,e){const n=kl[t.type]||t.type,{x:i,y:r}=mo(t,e);return{type:n,chart:e,native:t,x:void 0!==i?i:null,y:void 0!==r?r:null}}(e,t))},t);return function(t,e,n){t&&t.addEventListener(e,n,zl)}(i,e,r),r}class $l extends Nl{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,i=t.getAttribute("height"),r=t.getAttribute("width");if(t[Fl]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Bl(r)){const e=xo(t,"width");void 0!==e&&(t.width=e)}if(Bl(i))if(""===t.style.height)t.height=t.width/(e||2);else{const e=xo(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e[Fl])return!1;const n=e[Fl].initial;["height","width"].forEach(t=>{const i=n[t];$r(i)?e.removeAttribute(t):e.setAttribute(t,i)});const i=n.style||{};return Object.keys(i).forEach(t=>{e.style[t]=i[t]}),e.width=e.width,delete e[Fl],!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),r={attach:Wl,detach:jl,resize:Yl}[e]||Zl;i[e]=r(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];if(!i)return;({attach:Kl,detach:Kl,resize:Kl}[e]||Vl)(t,e,i),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return vo(t,e,n,i)}isAttached(t){const e=t&&co(t);return!(!e||!e.isConnected)}}let Jl=(Tt=class{constructor(){Pt(this,"x"),Pt(this,"y"),Pt(this,"active",!1),Pt(this,"options"),Pt(this,"$animations")}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return Os(this.x)&&Os(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach(t=>{i[t]=n[t]&&n[t].active()?n[t]._to:this[t]}),i}},Pt(Tt,"defaults",{}),Pt(Tt,"defaultRoutes"),Tt);function Ql(t,e){const n=t.options.ticks,i=function(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(i,r))}(t),r=Math.min(n.maxTicksLimit||i,i),s=n.major.enabled?function(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}(e):[],a=s.length,o=s[0],l=s[a-1],c=[];if(a>r)return function(t,e,n,i){let r,s=0,a=n[0];for(i=Math.ceil(i),r=0;r<t.length;r++)r===a&&(e.push(t[r]),s++,a=n[s*i])}(e,c,s,a/r),c;const h=function(t,e,n){const i=function(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}(t),r=e.length/n;if(!i)return Math.max(r,1);const s=function(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i===0&&(e.push(i),e.push(t/i));return n===(0|n)&&e.push(n),e.sort((t,e)=>t-e).pop(),e}(i);for(let a=0,o=s.length-1;a<o;a++){const t=s[a];if(t>r)return t}return Math.max(r,1)}(s,e,r);if(a>0){let t,n;const i=a>1?Math.round((l-o)/(a-1)):null;for(tc(e,c,h,$r(i)?0:o-i,o),t=0,n=a-1;t<n;t++)tc(e,c,h,s[t],s[t+1]);return tc(e,c,h,l,$r(i)?e.length:l+i),c}return tc(e,c,h),c}function tc(t,e,n,i,r){const s=ns(i,0),a=Math.min(ns(r,t.length),t.length);let o,l,c,h=0;for(n=Math.ceil(n),r&&(o=r-i,n=o/Math.floor(o/n)),c=s;c<0;)h++,c=Math.round(s+h*n);for(l=Math.max(s,0);l<a;l++)l===c&&(e.push(t[l]),h++,c=Math.round(s+h*n))}const ec=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n,nc=(t,e)=>Math.min(e||t,t);function ic(t,e){const n=[],i=t.length/e,r=t.length;let s=0;for(;s<r;s+=i)n.push(t[Math.floor(s)]);return n}function rc(t,e,n){const i=t.ticks.length,r=Math.min(e,i-1),s=t._startPixel,a=t._endPixel,o=1e-6;let l,c=t.getPixelForTick(r);if(!(n&&(l=1===i?Math.max(c-s,a-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(r-1))/2,c+=r<e?l:-l,c<s-o||c>a+o)))return c}function sc(t){return t.drawTicks?t.tickLength:0}function ac(t,e){if(!t.display)return 0;const n=Ba(t.font,e),i=ka(t.padding);return(Jr(t.text)?t.text.length:1)*n.lineHeight+i.height}function oc(t,e,n){let i=Ks(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class lc extends Jl{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=es(t,Number.POSITIVE_INFINITY),e=es(e,Number.NEGATIVE_INFINITY),n=es(n,Number.POSITIVE_INFINITY),i=es(i,Number.NEGATIVE_INFINITY),{min:es(t,n),max:es(e,i),minDefined:ts(t),maxDefined:ts(e)}}getMinMax(t){let e,{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:n,max:i};const a=this.getMatchingVisibleMetas();for(let o=0,l=a.length;o<l;++o)e=a[o].controller.getMinMax(this,t),r||(n=Math.min(n,e.min)),s||(i=Math.max(i,e.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:es(n,es(i,n)),max:es(i,es(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){rs(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:r,ticks:s}=this.options,a=s.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,n){const{min:i,max:r}=t,s=is(e,(r-i)/2),a=(t,e)=>n&&0===t?0:t+e;return{min:a(i,-Math.abs(s)),max:a(r,s)}}(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=a<this.ticks.length;this._convertTicksToLabels(o?ic(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=Ql(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){rs(this.options.afterUpdate,[this])}beforeSetDimensions(){rs(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){rs(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),rs(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){rs(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,r;for(n=0,i=t.length;n<i;n++)r=t[n],r.label=rs(e.callback,[r.value,n,t],this)}afterTickToLabelConversion(){rs(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){rs(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=nc(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,r=e.maxRotation;let s,a,o,l=i;if(!this._isVisible()||!e.display||i>=r||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),h=c.widest.width,u=c.highest.height,d=Bs(this.chart.width-h,0,this.maxWidth);s=t.offset?this.maxWidth/n:d/(n-1),h+6>s&&(s=d/(n-(t.offset?.5:1)),a=this.maxHeight-sc(t.grid)-e.padding-ac(t.title,this.chart.options.font),o=Math.sqrt(h*h+u*u),l=Math.min(Math.asin(Bs((c.highest.height+6)/s,-1,1)),Math.asin(Bs(a/o,-1,1))-Math.asin(Bs(u/o,-1,1)))*(180/_s),l=Math.max(i,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){rs(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){rs(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:r}}=this,s=this._isVisible(),a=this.isHorizontal();if(s){const s=ac(i,e.options.font);if(a?(t.width=this.maxWidth,t.height=sc(r)+s):(t.height=this.maxHeight,t.width=sc(r)+s),n.display&&this.ticks.length){const{first:e,last:i,widest:r,highest:s}=this._getLabelSizes(),o=2*n.padding,l=Is(this.labelRotation),c=Math.cos(l),h=Math.sin(l);if(a){const e=n.mirror?0:h*r.width+c*s.height;t.height=Math.min(this.maxHeight,t.height+e+o)}else{const e=n.mirror?0:c*r.width+h*s.height;t.width=Math.min(this.maxWidth,t.width+e+o)}this._calculatePadding(e,i,h,c)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:r,padding:s},position:a}=this.options,o=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,u=0;o?l?(h=i*t.width,u=n*e.height):(h=n*t.height,u=i*e.width):"start"===r?u=e.width:"end"===r?h=t.width:"inner"!==r&&(h=t.width/2,u=e.width/2),this.paddingLeft=Math.max((h-a+s)*this.width/(this.width-a),0),this.paddingRight=Math.max((u-c+s)*this.width/(this.width-c),0)}else{let n=e.height/2,i=t.height/2;"start"===r?(n=0,i=t.height):"end"===r&&(n=e.height,i=0),this.paddingTop=n+s,this.paddingBottom=i+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){rs(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)$r(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=ic(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:i,_longestTextCache:r}=this,s=[],a=[],o=Math.floor(e/nc(e,n));let l,c,h,u,d,p,f,m,g,v,y,_=0,x=0;for(l=0;l<e;l+=o){if(u=t[l].label,d=this._resolveTickFontOptions(l),i.font=p=d.string,f=r[p]=r[p]||{data:{},gc:[]},m=d.lineHeight,g=v=0,$r(u)||Jr(u)){if(Jr(u))for(c=0,h=u.length;c<h;++c)y=u[c],$r(y)||Jr(y)||(g=va(i,f.data,f.gc,g,y),v+=m)}else g=va(i,f.data,f.gc,g,u),v=m;s.push(g),a.push(v),_=Math.max(g,_),x=Math.max(v,x)}!function(t,e){ss(t,t=>{const n=t.gc,i=n.length/2;let r;if(i>e){for(r=0;r<i;++r)delete t.data[n[r]];n.splice(0,i)}})}(r,e);const b=s.indexOf(_),M=a.indexOf(x),w=t=>({width:s[t]||0,height:a[t]||0});return{first:w(0),last:w(e-1),widest:w(b),highest:w(M),widths:s,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Bs(this._alignToPixels?ya(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=function(t,e,n){return Va(t,{tick:n,index:e,type:"tick"})}(this.getContext(),t,n))}return this.$context||(this.$context=Va(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=Is(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),r=this._getLabelSizes(),s=t.autoSkipPadding||0,a=r?r.widest.width+s:0,o=r?r.highest.height+s:0;return this.isHorizontal()?o*n>a*i?a/n:o/i:o*i<a*n?o/n:a/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:r,position:s,border:a}=i,o=r.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),h=sc(r),u=[],d=a.setContext(this.getContext()),p=d.display?d.width:0,f=p/2,m=function(t){return ya(n,t,p)};let g,v,y,_,x,b,M,w,S,T,E,A;if("top"===s)g=m(this.bottom),b=this.bottom-h,w=g-f,T=m(t.top)+f,A=t.bottom;else if("bottom"===s)g=m(this.top),T=t.top,A=m(t.bottom)-f,b=g+f,w=this.top+h;else if("left"===s)g=m(this.right),x=this.right-h,M=g-f,S=m(t.left)+f,E=t.right;else if("right"===s)g=m(this.left),S=t.left,E=m(t.right)-f,x=g+f,M=this.left+h;else if("x"===e){if("center"===s)g=m((t.top+t.bottom)/2+.5);else if(Qr(s)){const t=Object.keys(s)[0],e=s[t];g=m(this.chart.scales[t].getPixelForValue(e))}T=t.top,A=t.bottom,b=g+f,w=b+h}else if("y"===e){if("center"===s)g=m((t.left+t.right)/2);else if(Qr(s)){const t=Object.keys(s)[0],e=s[t];g=m(this.chart.scales[t].getPixelForValue(e))}x=g-f,M=x-h,S=t.left,E=t.right}const C=ns(i.ticks.maxTicksLimit,c),R=Math.max(1,Math.ceil(c/C));for(v=0;v<c;v+=R){const t=this.getContext(v),e=r.setContext(t),i=a.setContext(t),s=e.lineWidth,c=e.color,h=i.dash||[],d=i.dashOffset,p=e.tickWidth,f=e.tickColor,m=e.tickBorderDash||[],g=e.tickBorderDashOffset;y=rc(this,v,o),void 0!==y&&(_=ya(n,y,s),l?x=M=S=E=_:b=w=T=A=_,u.push({tx1:x,ty1:b,tx2:M,ty2:w,x1:S,y1:T,x2:E,y2:A,width:s,color:c,borderDash:h,borderDashOffset:d,tickWidth:p,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,u}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:r}=n,s=this.isHorizontal(),a=this.ticks,{align:o,crossAlign:l,padding:c,mirror:h}=r,u=sc(n.grid),d=u+c,p=h?-c:d,f=-Is(this.labelRotation),m=[];let g,v,y,_,x,b,M,w,S,T,E,A,C="middle";if("top"===i)b=this.bottom-p,M=this._getXAxisLabelAlignment();else if("bottom"===i)b=this.top+p,M=this._getXAxisLabelAlignment();else if("left"===i){const t=this._getYAxisLabelAlignment(u);M=t.textAlign,x=t.x}else if("right"===i){const t=this._getYAxisLabelAlignment(u);M=t.textAlign,x=t.x}else if("x"===e){if("center"===i)b=(t.top+t.bottom)/2+d;else if(Qr(i)){const t=Object.keys(i)[0],e=i[t];b=this.chart.scales[t].getPixelForValue(e)+d}M=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===i)x=(t.left+t.right)/2-d;else if(Qr(i)){const t=Object.keys(i)[0],e=i[t];x=this.chart.scales[t].getPixelForValue(e)}M=this._getYAxisLabelAlignment(u).textAlign}"y"===e&&("start"===o?C="top":"end"===o&&(C="bottom"));const R=this._getLabelSizes();for(g=0,v=a.length;g<v;++g){y=a[g],_=y.label;const t=r.setContext(this.getContext(g));w=this.getPixelForTick(g)+r.labelOffset,S=this._resolveTickFontOptions(g),T=S.lineHeight,E=Jr(_)?_.length:1;const e=E/2,n=t.color,o=t.textStrokeColor,c=t.textStrokeWidth;let u,d=M;if(s?(x=w,"inner"===M&&(d=g===v-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),A="top"===i?"near"===l||0!==f?-E*T+T/2:"center"===l?-R.highest.height/2-e*T+T:-R.highest.height+T/2:"near"===l||0!==f?T/2:"center"===l?R.highest.height/2-e*T:R.highest.height-E*T,h&&(A*=-1),0===f||t.showLabelBackdrop||(x+=T/2*Math.sin(f))):(b=w,A=(1-E)*T/2),t.showLabelBackdrop){const e=ka(t.backdropPadding),n=R.heights[g],i=R.widths[g];let r=A-e.top,s=0-e.left;switch(C){case"middle":r-=n/2;break;case"bottom":r-=n}switch(M){case"center":s-=i/2;break;case"right":s-=i;break;case"inner":g===v-1?s-=i:g>0&&(s-=i/2)}u={left:s,top:r,width:i+e.width,height:n+e.height,color:t.backdropColor}}m.push({label:_,font:S,textOffset:A,options:{rotation:f,color:n,strokeColor:o,strokeWidth:c,textAlign:d,textBaseline:C,translation:[x,b],backdrop:u}})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Is(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align?n="right":"inner"===e.align&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:r}}=this.options,s=t+r,a=this._getLabelSizes().widest.width;let o,l;return"left"===e?i?(l=this.right+r,"near"===n?o="left":"center"===n?(o="center",l+=a/2):(o="right",l+=a)):(l=this.right-s,"near"===n?o="right":"center"===n?(o="center",l-=a/2):(o="left",l=this.left)):"right"===e?i?(l=this.left+r,"near"===n?o="right":"center"===n?(o="center",l-=a/2):(o="left",l-=a)):(l=this.left+s,"near"===n?o="left":"center"===n?(o="center",l+=a/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:r,height:s}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,r,s),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex(e=>e.value===t);if(n>=0){return e.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,s;const a=(t,e,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(r=0,s=i.length;r<s;++r){const t=i[r];e.drawOnChartArea&&a({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&a({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:i}}=this,r=n.setContext(this.getContext()),s=n.display?r.width:0;if(!s)return;const a=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,h,u;this.isHorizontal()?(l=ya(t,this.left,s)-s/2,c=ya(t,this.right,a)+a/2,h=u=o):(h=ya(t,this.top,s)-s/2,u=ya(t,this.bottom,a)+a/2,l=c=o),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(l,h),e.lineTo(c,u),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,n=this._computeLabelArea();n&&wa(e,n);const i=this.getLabelItems(t);for(const r of i){const t=r.options,n=r.font;Ra(e,r.label,0,r.textOffset,n,t)}n&&Sa(e)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const r=Ba(n.font),s=ka(n.padding),a=n.align;let o=r.lineHeight/2;"bottom"===e||"center"===e||Qr(e)?(o+=s.bottom,Jr(n.text)&&(o+=r.lineHeight*(n.text.length-1))):o+=s.top;const{titleX:l,titleY:c,maxWidth:h,rotation:u}=function(t,e,n,i){const{top:r,left:s,bottom:a,right:o,chart:l}=t,{chartArea:c,scales:h}=l;let u,d,p,f=0;const m=a-r,g=o-s;if(t.isHorizontal()){if(d=Zs(i,s,o),Qr(n)){const t=Object.keys(n)[0],i=n[t];p=h[t].getPixelForValue(i)+m-e}else p="center"===n?(c.bottom+c.top)/2+m-e:ec(t,n,e);u=o-s}else{if(Qr(n)){const t=Object.keys(n)[0],i=n[t];d=h[t].getPixelForValue(i)-g+e}else d="center"===n?(c.left+c.right)/2-g+e:ec(t,n,e);p=Zs(i,a,r),f="left"===n?-Ss:Ss}return{titleX:d,titleY:p,maxWidth:u,rotation:f}}(this,o,e,a);Ra(t,n.text,0,0,r,{color:n.color,maxWidth:h,rotation:u,textAlign:oc(a,e,i),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=ns(t.grid&&t.grid.z,-1),i=ns(t.border&&t.border.z,0);return this._isVisible()&&this.draw===lc.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let r,s;for(r=0,s=e.length;r<s;++r){const s=e[r];s[n]!==this.id||t&&s.type!==t||i.push(s)}return i}_resolveTickFontOptions(t){return Ba(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class cc{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;(function(t){return"id"in t&&"defaults"in t})(e)&&(n=this.register(e));const i=this.items,r=t.id,s=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in i||(i[r]=t,function(t,e,n){const i=hs(Object.create(null),[n?ga.get(n):{},ga.get(e),t.defaults]);ga.set(e,i),t.defaultRoutes&&function(t,e){Object.keys(e).forEach(n=>{const i=n.split("."),r=i.pop(),s=[t].concat(i).join("."),a=e[n].split("."),o=a.pop(),l=a.join(".");ga.route(s,r,l,o)})}(e,t.defaultRoutes);t.descriptors&&ga.describe(e,t.descriptors)}(t,s,n),this.override&&ga.override(t.id,t.overrides)),s}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in ga[i]&&(delete ga[i][n],this.override&&delete ua[n])}}class hc{constructor(){this.controllers=new cc(Qo,"datasets",!0),this.elements=new cc(Jl,"elements"),this.plugins=new cc(Object,"plugins"),this.scales=new cc(lc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach(e=>{const i=n||this._getRegistryForType(e);n||i.isForType(e)||i===this.plugins&&e.id?this._exec(t,i,e):ss(e,e=>{const i=n||this._getRegistryForType(e);this._exec(t,i,e)})})}_exec(t,e,n){const i=ms(t);rs(n["before"+i],[],n),e[t](n),rs(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var uc=new hc;class dc{constructor(){this._init=[]}notify(t,e,n,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=i?this._descriptors(t).filter(i):this._descriptors(t),s=this._notify(r,t,e,n);return"afterDestroy"===e&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),s}_notify(t,e,n,i){i=i||{};for(const r of t){const t=r.plugin;if(!1===rs(t[n],[e,i,r.options],t)&&i.cancelable)return!1}return!0}invalidate(){$r(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=ns(n.options&&n.options.plugins,{}),r=function(t){const e={},n=[],i=Object.keys(uc.plugins.items);for(let s=0;s<i.length;s++)n.push(uc.getPlugin(i[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const t=r[s];-1===n.indexOf(t)&&(n.push(t),e[t.id]=!0)}return{plugins:n,localIds:e}}(n);return!1!==i||e?function(t,{plugins:e,localIds:n},i,r){const s=[],a=t.getContext();for(const o of e){const e=o.id,l=pc(i[e],r);null!==l&&s.push({plugin:o,options:fc(t.config,{plugin:o,local:n[e]},l,a)})}return s}(t,r,i,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(t,e)=>t.filter(t=>!e.some(e=>t.plugin.id===e.plugin.id));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function pc(t,e){return e||!1!==t?!0===t?{}:t:null}function fc(t,{plugin:e,local:n},i,r){const s=t.pluginScopeKeys(e),a=t.getOptionScopes(i,s);return n&&e.defaults&&a.push(e.defaults),t.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function mc(t,e){const n=ga.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function gc(t){if("x"===t||"y"===t||"r"===t)return t}function vc(t){return"top"===t||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0}function yc(t,...e){if(gc(t))return t;for(const n of e){const e=n.axis||vc(n.position)||t.length>1&&gc(t[0].toLowerCase());if(e)return e}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function _c(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function xc(t,e){const n=ua[t.type]||{scales:{}},i=e.scales||{},r=mc(t.type,e),s=Object.create(null);return Object.keys(i).forEach(e=>{const a=i[e];if(!Qr(a))return;if(a._proxy)return;const o=yc(e,a,function(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(e=>e.xAxisID===t||e.yAxisID===t);if(n.length)return _c(t,"x",n[0])||_c(t,"y",n[0])}return{}}(e,t),ga.scales[a.type]),l=function(t,e){return t===e?"_index_":"_value_"}(o,r),c=n.scales||{};s[e]=us(Object.create(null),[{axis:o},a,c[o],c[l]])}),t.data.datasets.forEach(n=>{const r=n.type||t.type,a=n.indexAxis||mc(r,e),o=(ua[r]||{}).scales||{};Object.keys(o).forEach(t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,a),r=n[e+"AxisID"]||e;s[r]=s[r]||Object.create(null),us(s[r],[{axis:e},i[r],o[t]])})}),Object.keys(s).forEach(t=>{const e=s[t];us(e,[ga.scales[e.type],ga.scale])}),s}function bc(t){const e=t.options||(t.options={});e.plugins=ns(e.plugins,{}),e.scales=xc(t,e)}function Mc(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const wc=new Map,Sc=new Set;function Tc(t,e){let n=wc.get(t);return n||(n=e(),wc.set(t,n),Sc.add(n)),n}const Ec=(t,e,n)=>{const i=fs(e,n);void 0!==i&&t.add(i)};class Ac{constructor(t){this._config=function(t){return(t=t||{}).data=Mc(t.data),bc(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Mc(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),bc(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Tc(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Tc(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Tc(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id;return Tc(`${this.type}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return i&&!e||(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:r}=this,s=this._cachedScopes(t,n),a=s.get(e);if(a)return a;const o=new Set;e.forEach(e=>{t&&(o.add(t),e.forEach(e=>Ec(o,t,e))),e.forEach(t=>Ec(o,i,t)),e.forEach(t=>Ec(o,ua[r]||{},t)),e.forEach(t=>Ec(o,ga,t)),e.forEach(t=>Ec(o,da,t))});const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),Sc.has(e)&&s.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,ua[e]||{},ga.datasets[e]||{},{type:e},ga,da]}resolveNamedOptions(t,e,n,i=[""]){const r={$shared:!0},{resolver:s,subPrefixes:a}=Cc(this._resolverCache,t,i);let o=s;if(function(t,e){const{isScriptable:n,isIndexable:i}=ja(t);for(const r of e){const e=n(r),s=i(r),a=(s||e)&&t[r];if(e&&(vs(a)||Rc(a))||s&&Jr(a))return!0}return!1}(s,e)){r.$shared=!1;o=Wa(s,n=vs(n)?n():n,this.createResolver(t,n,a))}for(const l of e)r[l]=o[l];return r}createResolver(t,e,n=[""],i){const{resolver:r}=Cc(this._resolverCache,t,n);return Qr(e)?Wa(r,e,void 0,i):r}}function Cc(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const r=n.join();let s=i.get(r);if(!s){s={resolver:Ha(e,n),subPrefixes:n.filter(t=>!t.toLowerCase().includes("hover"))},i.set(r,s)}return s}const Rc=t=>Qr(t)&&Object.getOwnPropertyNames(t).some(e=>vs(t[e]));const Pc=["top","bottom","left","right","chartArea"];function Oc(t,e){return"top"===t||"bottom"===t||-1===Pc.indexOf(t)&&"x"===e}function Ic(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function Dc(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),rs(n&&n.onComplete,[t],e)}function Lc(t){const e=t.chart,n=e.options.animation;rs(n&&n.onProgress,[t],e)}function Nc(t){return lo()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Uc={},Fc=t=>{const e=Nc(t);return Object.values(Uc).filter(t=>t.canvas===e).pop()};function kc(t,e,n){const i=Object.keys(t);for(const r of i){const i=+r;if(i>=e){const s=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=s)}}}class Bc{static register(...t){uc.add(...t),zc()}static unregister(...t){uc.remove(...t),zc()}constructor(t,e){const n=this.config=new Ac(e),i=Nc(t),r=Fc(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const s=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(t){return!lo()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?Ul:$l}(i)),this.platform.updateConfig(n);const a=this.platform.acquireContext(i,s.aspectRatio),o=a&&a.canvas,l=o&&o.height,c=o&&o.width;this.id=Zr(),this.ctx=a,this.canvas=o,this.width=c,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new dc,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}(t=>this.update(t),s.resizeDelay||0),this._dataChanges=[],Uc[this.id]=this,a&&o&&(Fo.listen(this,"complete",Dc),Fo.listen(this,"progress",Lc),this._initialize(),this.attached&&this.update())}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:i,_aspectRatio:r}=this;return $r(t)?e&&r?r:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return uc}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():yo(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return _a(this.canvas,this.ctx),this}stop(){return Fo.stop(this),this}resize(t,e){Fo.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(i,t,e,r),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,yo(this,a,!0)&&(this.notifyPlugins("resize",{size:s}),rs(n.onResize,[this,s],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){ss(this.options.scales||{},(t,e)=>{t.id=e})}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce((t,e)=>(t[e]=!1,t),{});let r=[];e&&(r=r.concat(Object.keys(e).map(t=>{const n=e[t],i=yc(t,n),r="r"===i,s="x"===i;return{options:n,dposition:r?"chartArea":s?"bottom":"left",dtype:r?"radialLinear":s?"category":"linear"}}))),ss(r,e=>{const r=e.options,s=r.id,a=yc(s,r),o=ns(r.type,e.dtype);void 0!==r.position&&Oc(r.position,a)===Oc(e.dposition)||(r.position=e.dposition),i[s]=!0;let l=null;if(s in n&&n[s].type===o)l=n[s];else{l=new(uc.getScale(o))({id:s,type:o,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(r,t)}),ss(i,(t,e)=>{t||delete n[e]}),ss(n,t=>{Ll.configure(this,t,t.options),Ll.addBox(this,t)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort((t,e)=>t.index-e.index),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(Ic("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((t,n)=>{0===e.filter(e=>e===t._dataset).length&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const i=e[n];let r=this.getDatasetMeta(n);const s=i.type||this.config.type;if(r.type&&r.type!==s&&(this._destroyDatasetMeta(n),r=this.getDatasetMeta(n)),r.type=s,r.indexAxis=i.indexAxis||mc(s,this.options),r.order=i.order||0,r.index=n,r.label=""+i.label,r.visible=this.isDatasetVisible(n),r.controller)r.controller.updateIndex(n),r.controller.linkScales();else{const e=uc.getController(s),{datasetElementType:i,dataElementType:a}=ga.datasets[s];Object.assign(e,{dataElementType:uc.getElement(a),datasetElementType:i&&uc.getElement(i)}),r.controller=new e(this,n),t.push(r.controller)}}return this._updateMetasets(),t}_resetElements(){ss(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:t}=this.getDatasetMeta(l),e=!i&&-1===r.indexOf(t);t.buildOrUpdateElements(e),s=Math.max(+t.getMaxOverflow(),s)}s=this._minPadding=n.layout.autoPadding?s:0,this._updateLayout(s),i||ss(r,t=>{t.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Ic("z","_idx"));const{_active:a,_lastEvent:o}=this;o?this._eventHandler(o,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){ss(this.scales,t=>{Ll.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);ys(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:r}of e){kc(t,i,"_removeElements"===n?-r:r)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter(t=>t[0]===e).map((t,e)=>e+","+t.splice(1).join(","))),i=n(0);for(let r=1;r<e;r++)if(!ys(i,n(r)))return;return Array.from(i).map(t=>t.split(",")).map(t=>({method:t[1],start:+t[2],count:+t[3]}))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Ll.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],ss(this.boxes,t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))},this),this._layers.forEach((t,e)=>{t._idx=e}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,vs(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Fo.has(this)?this.attached&&!Fo.running(this)&&Fo.start(this):(this.draw(),Dc({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(t,e)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,r;for(i=0,r=e.length;i<r;++i){const r=e[i];t&&!r.visible||n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n={meta:t,index:t.index,cancelable:!0},i=No(this,t);!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(i&&wa(e,i),t.controller.draw(),i&&Sa(e),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return Ma(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,i){const r=bl.modes[e];return"function"==typeof r?r(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter(t=>t&&t._dataset===e).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=Va(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"==typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",r=this.getDatasetMeta(t),s=r.controller._resolveAnimations(void 0,i);gs(e)?(r.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),s.update(r,{visible:n}),this.update(e=>e.datasetIndex===t?i:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Fo.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),_a(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Uc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};ss(this.options.events,t=>n(t,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(n,i)=>{t[n]&&(e.removeEventListener(this,n,i),delete t[n])},r=(t,e)=>{this.canvas&&this.resize(t,e)};let s;const a=()=>{i("attach",a),this.attached=!0,this.resize(),n("resize",r),n("detach",s)};s=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),n("attach",a)},e.isAttached(this.canvas)?a():s()}unbindEvents(){ss(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},ss(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let r,s,a,o;for("dataset"===e&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,o=t.length;a<o;++a){s=t[a];const e=s&&this.getDatasetMeta(s.datasetIndex).controller;e&&e[i+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map(({datasetIndex:t,index:e})=>{const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[e],index:e}});!as(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return 1===this._plugins._cache.filter(e=>e.plugin.id===t).length}_updateHoverStyles(t,e,n){const i=this.options.hover,r=(t,e)=>t.filter(t=>!e.some(e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)),s=r(e,t),a=n?t:r(t,e);s.length&&this.updateHoverStyle(s,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const r=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(r||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:r}=this,s=e,a=this._getActiveElements(t,i,n,s),o=function(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(t),l=function(t,e,n,i){return n&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,n,o);n&&(this._lastEvent=null,rs(r.onHover,[t,a,this],this),o&&rs(r.onClick,[t,a,this],this));const c=!as(a,i);return(c||e)&&(this._active=a,this._updateHoverStyles(a,i,e)),this._lastEvent=l,c}_getActiveElements(t,e,n,i){if("mouseout"===t.type)return[];if(!n)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,i)}}function zc(){return ss(Bc.instances,t=>t._plugins.invalidate())}function Vc(t,e,n,i){const r=Na(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const s=(n-e)/2,a=Math.min(s,i*e/2),o=t=>{const e=(n-Math.min(s,t))*i/2;return Bs(t,0,Math.min(s,e))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:Bs(r.innerStart,0,a),innerEnd:Bs(r.innerEnd,0,a)}}function Hc(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function Wc(t,e,n,i,r,s){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:h}=e,u=Math.max(e.outerRadius+i+n-c,0),d=h>0?h+i+n+c:0;let p=0;const f=r-l;if(i){const t=((h>0?h-i:0)+(u>0?u-i:0))/2;p=(f-(0!==t?f*t/(t+i):f))/2}const m=(f-Math.max(.001,f*u-n/_s)/u)/2,g=l+m+p,v=r-m-p,{outerStart:y,outerEnd:_,innerStart:x,innerEnd:b}=Vc(e,d,u,v-g),M=u-y,w=u-_,S=g+y/M,T=v-_/w,E=d+x,A=d+b,C=g+x/E,R=v-b/A;if(t.beginPath(),s){const e=(S+T)/2;if(t.arc(a,o,u,S,e),t.arc(a,o,u,e,T),_>0){const e=Hc(w,T,a,o);t.arc(e.x,e.y,_,T,v+Ss)}const n=Hc(A,v,a,o);if(t.lineTo(n.x,n.y),b>0){const e=Hc(A,R,a,o);t.arc(e.x,e.y,b,v+Ss,R+Math.PI)}const i=(v-b/d+(g+x/d))/2;if(t.arc(a,o,d,v-b/d,i,!0),t.arc(a,o,d,i,g+x/d,!0),x>0){const e=Hc(E,C,a,o);t.arc(e.x,e.y,x,C+Math.PI,g-Ss)}const r=Hc(M,g,a,o);if(t.lineTo(r.x,r.y),y>0){const e=Hc(M,S,a,o);t.arc(e.x,e.y,y,g-Ss,S)}}else{t.moveTo(a,o);const e=Math.cos(S)*u+a,n=Math.sin(S)*u+o;t.lineTo(e,n);const i=Math.cos(T)*u+a,r=Math.sin(T)*u+o;t.lineTo(i,r)}t.closePath()}function jc(t,e,n,i,r){const{fullCircles:s,startAngle:a,circumference:o,options:l}=e,{borderWidth:c,borderJoinStyle:h,borderDash:u,borderDashOffset:d,borderRadius:p}=l,f="inner"===l.borderAlign;if(!c)return;t.setLineDash(u||[]),t.lineDashOffset=d,f?(t.lineWidth=2*c,t.lineJoin=h||"round"):(t.lineWidth=c,t.lineJoin=h||"bevel");let m=e.endAngle;if(s){Wc(t,e,n,i,m,r);for(let e=0;e<s;++e)t.stroke();isNaN(o)||(m=a+(o%xs||xs))}f&&function(t,e,n){const{startAngle:i,pixelMargin:r,x:s,y:a,outerRadius:o,innerRadius:l}=e;let c=r/o;t.beginPath(),t.arc(s,a,o,i-c,n+c),l>r?(c=r/l,t.arc(s,a,l,n+c,i-c,!0)):t.arc(s,a,r,n+Ss,i-Ss),t.closePath(),t.clip()}(t,e,m),l.selfJoin&&m-a>=_s&&0===p&&"miter"!==h&&function(t,e,n){const{startAngle:i,x:r,y:s,outerRadius:a,innerRadius:o,options:l}=e,{borderWidth:c,borderJoinStyle:h}=l,u=Math.min(c/a,Fs(i-n));if(t.beginPath(),t.arc(r,s,a-c/2,i+u/2,n-u/2),o>0){const e=Math.min(c/o,Fs(i-n));t.arc(r,s,o+c/2,n-e/2,i+e/2,!0)}else{const e=Math.min(c/2,a*Fs(i-n));if("round"===h)t.arc(r,s,e,n-_s/2,i+_s/2,!0);else if("bevel"===h){const a=2*e*e,o=-a*Math.cos(n+_s/2)+r,l=-a*Math.sin(n+_s/2)+s,c=a*Math.cos(i+_s/2)+r,h=a*Math.sin(i+_s/2)+s;t.lineTo(o,l),t.lineTo(c,h)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}(t,e,m),s||(Wc(t,e,n,i,m,r),t.stroke())}Pt(Bc,"defaults",ga),Pt(Bc,"instances",Uc),Pt(Bc,"overrides",ua),Pt(Bc,"registry",uc),Pt(Bc,"version","4.5.0"),Pt(Bc,"getChart",Fc);class Gc extends Jl{constructor(t){super(),Pt(this,"circumference"),Pt(this,"endAngle"),Pt(this,"fullCircles"),Pt(this,"innerRadius"),Pt(this,"outerRadius"),Pt(this,"pixelMargin"),Pt(this,"startAngle"),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.getProps(["x","y"],n),{angle:r,distance:s}=Ls(i,{x:t,y:e}),{startAngle:a,endAngle:o,innerRadius:l,outerRadius:c,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=(this.options.spacing+this.options.borderWidth)/2,d=ns(h,o-a),p=ks(r,a,o)&&a!==o,f=d>=xs||p,m=zs(s,l+u,c+u);return f&&m}getCenterPoint(t){const{x:e,y:n,startAngle:i,endAngle:r,innerRadius:s,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:o,spacing:l}=this.options,c=(i+r)/2,h=(s+a+l+o)/2;return{x:e+Math.cos(c)*h,y:n+Math.sin(c)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:n}=this,i=(e.offset||0)/4,r=(e.spacing||0)/2,s=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=n>xs?Math.floor(n/xs):0,0===n||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*i,Math.sin(a)*i);const o=i*(1-Math.sin(Math.min(_s,n||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function(t,e,n,i,r){const{fullCircles:s,startAngle:a,circumference:o}=e;let l=e.endAngle;if(s){Wc(t,e,n,i,l,r);for(let e=0;e<s;++e)t.fill();isNaN(o)||(l=a+(o%xs||xs))}Wc(t,e,n,i,l,r),t.fill()}(t,this,o,r,s),jc(t,this,o,r,s),t.restore()}}function Xc(t,e,n=e){t.lineCap=ns(n.borderCapStyle,e.borderCapStyle),t.setLineDash(ns(n.borderDash,e.borderDash)),t.lineDashOffset=ns(n.borderDashOffset,e.borderDashOffset),t.lineJoin=ns(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=ns(n.borderWidth,e.borderWidth),t.strokeStyle=ns(n.borderColor,e.borderColor)}function qc(t,e,n){t.lineTo(n.x,n.y)}function Yc(t,e,n={}){const i=t.length,{start:r=0,end:s=i-1}=n,{start:a,end:o}=e,l=Math.max(r,a),c=Math.min(s,o),h=r<a&&s<a||r>o&&s>o;return{count:i,start:l,loop:e.loop,ilen:c<l&&!h?i+c-l:c-l}}function Kc(t,e,n,i){const{points:r,options:s}=e,{count:a,start:o,loop:l,ilen:c}=Yc(r,n,i),h=function(t){return t.stepped?Ta:t.tension||"monotone"===t.cubicInterpolationMode?Ea:qc}(s);let u,d,p,{move:f=!0,reverse:m}=i||{};for(u=0;u<=c;++u)d=r[(o+(m?c-u:u))%a],d.skip||(f?(t.moveTo(d.x,d.y),f=!1):h(t,p,d,m,s.stepped),p=d);return l&&(d=r[(o+(m?c:0))%a],h(t,p,d,m,s.stepped)),!!l}function Zc(t,e,n,i){const r=e.points,{count:s,start:a,ilen:o}=Yc(r,n,i),{move:l=!0,reverse:c}=i||{};let h,u,d,p,f,m,g=0,v=0;const y=t=>(a+(c?o-t:t))%s,_=()=>{p!==f&&(t.lineTo(g,f),t.lineTo(g,p),t.lineTo(g,m))};for(l&&(u=r[y(0)],t.moveTo(u.x,u.y)),h=0;h<=o;++h){if(u=r[y(h)],u.skip)continue;const e=u.x,n=u.y,i=0|e;i===d?(n<p?p=n:n>f&&(f=n),g=(v*g+e)/++v):(_(),t.lineTo(e,n),d=i,v=0,p=f=n),m=n}_()}function $c(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!(t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||n)?Zc:Kc}Pt(Gc,"id","arc"),Pt(Gc,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Pt(Gc,"defaultRoutes",{backgroundColor:"backgroundColor"}),Pt(Gc,"descriptors",{_scriptable:!0,_indexable:t=>"borderDash"!==t});const Jc="function"==typeof Path2D;function Qc(t,e,n,i){Jc&&!e.options.segment?function(t,e,n,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,i)&&r.closePath()),Xc(t,e.options),t.stroke(r)}(t,e,n,i):function(t,e,n,i){const{segments:r,options:s}=e,a=$c(e);for(const o of r)Xc(t,s,o.style),t.beginPath(),a(t,e,o,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}(t,e,n,i)}class th extends Jl{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;oo(this._points,n,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(t,e){const n=t.points,i=t.options.spanGaps,r=n.length;if(!r)return[];const s=!!t._loop,{start:a,end:o}=function(t,e,n,i){let r=0,s=e-1;if(n&&!i)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(s+=r);s>r&&t[s%e].skip;)s--;return s%=e,{start:r,end:s}}(n,r,s,i);return Oo(t,!0===i?[{start:a,end:o,loop:s}]:function(t,e,n,i){const r=t.length,s=[];let a,o=e,l=t[e];for(a=e+1;a<=n;++a){const n=t[a%r];n.skip||n.stop?l.skip||(i=!1,s.push({start:e%r,end:(a-1)%r,loop:i}),e=o=n.stop?a:null):(o=a,l.skip&&(e=a)),l=n}return null!==o&&s.push({start:e%r,end:o%r,loop:i}),s}(n,a,o<a?o+r:o,!!t._fullLoop&&0===a&&o===r-1),n,e)}(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,i=t[e],r=this.points,s=Po(this,{property:e,start:i,end:i});if(!s.length)return;const a=[],o=function(t){return t.stepped?Mo:t.tension||"monotone"===t.cubicInterpolationMode?wo:bo}(n);let l,c;for(l=0,c=s.length;l<c;++l){const{start:c,end:h}=s[l],u=r[c],d=r[h];if(u===d){a.push(u);continue}const p=o(u,d,Math.abs((i-u[e])/(d[e]-u[e])),n.stepped);p[e]=t[e],a.push(p)}return 1===a.length?a[0]:a}pathSegment(t,e,n){return $c(this)(t,this,e,n)}path(t,e,n){const i=this.segments,r=$c(this);let s=this._loop;e=e||0,n=n||this.points.length-e;for(const a of i)s&=r(t,this,a,{start:e,end:e+n-1});return!!s}draw(t,e,n,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),Qc(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function eh(t,e,n,i){const r=t.options,{[n]:s}=t.getProps([n],i);return Math.abs(e-s)<r.radius+r.hitRadius}Pt(th,"id","line"),Pt(th,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Pt(th,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Pt(th,"descriptors",{_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t});class nh extends Jl{constructor(t){super(),Pt(this,"parsed"),Pt(this,"skip"),Pt(this,"stop"),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.options,{x:r,y:s}=this.getProps(["x","y"],n);return Math.pow(t-r,2)+Math.pow(e-s,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return eh(this,t,"x",e)}inYRange(t,e){return eh(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){let e=(t=t||this.options||{}).radius||0;e=Math.max(e,e&&t.hoverRadius||0);return 2*(e+(e&&t.borderWidth||0))}draw(t,e){const n=this.options;this.skip||n.radius<.1||!Ma(this,e,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,xa(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function ih(t,e){const{x:n,y:i,base:r,width:s,height:a}=t.getProps(["x","y","base","width","height"],e);let o,l,c,h,u;return t.horizontal?(u=a/2,o=Math.min(n,r),l=Math.max(n,r),c=i-u,h=i+u):(u=s/2,o=n-u,l=n+u,c=Math.min(i,r),h=Math.max(i,r)),{left:o,top:c,right:l,bottom:h}}function rh(t,e,n,i){return t?0:Bs(e,n,i)}function sh(t){const e=ih(t),n=e.right-e.left,i=e.bottom-e.top,r=function(t,e,n){const i=t.options.borderWidth,r=t.borderSkipped,s=Ua(i);return{t:rh(r.top,s.top,0,n),r:rh(r.right,s.right,0,e),b:rh(r.bottom,s.bottom,0,n),l:rh(r.left,s.left,0,e)}}(t,n/2,i/2),s=function(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,s=Fa(r),a=Math.min(e,n),o=t.borderSkipped,l=i||Qr(r);return{topLeft:rh(!l||o.top||o.left,s.topLeft,0,a),topRight:rh(!l||o.top||o.right,s.topRight,0,a),bottomLeft:rh(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:rh(!l||o.bottom||o.right,s.bottomRight,0,a)}}(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function ah(t,e,n,i){const r=null===e,s=null===n,a=t&&!(r&&s)&&ih(t,i);return a&&(r||zs(e,a.left,a.right))&&(s||zs(n,a.top,a.bottom))}function oh(t,e){t.rect(e.x,e.y,e.w,e.h)}function lh(t,e,n={}){const i=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,s=(t.x+t.w!==n.x+n.w?e:0)-i,a=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+i,y:t.y+r,w:t.w+s,h:t.h+a,radius:t.radius}}Pt(nh,"id","point"),Pt(nh,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Pt(nh,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class ch extends Jl{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:r,outer:s}=sh(this),a=(o=s.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?Pa:oh;var o;t.save(),s.w===r.w&&s.h===r.h||(t.beginPath(),a(t,lh(s,e,r)),t.clip(),a(t,lh(r,-e,s)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),a(t,lh(r,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return ah(this,t,e,n)}inXRange(t,e){return ah(this,t,null,e)}inYRange(t,e){return ah(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+i)/2:e,y:r?n:(n+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}function hh(t,e,n,i){if(i)return;let r=e[t],s=n[t];return"angle"===t&&(r=Fs(r),s=Fs(s)),{property:t,start:r,end:s}}function uh(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function dh(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function ph(t,e){let n=[],i=!1;return Jr(t)?(i=!0,n=t):n=function(t,e){const{x:n=null,y:i=null}=t||{},r=e.points,s=[];return e.segments.forEach(({start:t,end:e})=>{e=uh(t,e,r);const a=r[t],o=r[e];null!==i?(s.push({x:a.x,y:i}),s.push({x:o.x,y:i})):null!==n&&(s.push({x:n,y:a.y}),s.push({x:n,y:o.y}))}),s}(t,e),n.length?new th({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function fh(t){return t&&!1!==t.fill}function mh(t,e,n){let i=t[e].fill;const r=[e];let s;if(!n)return i;for(;!1!==i&&-1===r.indexOf(i);){if(!ts(i))return i;if(s=t[i],!s)return!1;if(s.visible)return i;r.push(i),i=s.fill}return!1}function gh(t,e,n){const i=function(t){const e=t.options,n=e.fill;let i=ns(n&&n.target,n);void 0===i&&(i=!!e.backgroundColor);if(!1===i||null===i)return!1;if(!0===i)return"origin";return i}(t);if(Qr(i))return!isNaN(i.value)&&i;let r=parseFloat(i);return ts(r)&&Math.floor(r)===r?function(t,e,n,i){"-"!==t&&"+"!==t||(n=e+n);if(n===e||n<0||n>=i)return!1;return n}(i[0],e,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function vh(t,e,n){const i=[];for(let r=0;r<n.length;r++){const s=n[r],{first:a,last:o,point:l}=yh(s,e,"x");if(!(!l||a&&o))if(a)i.unshift(l);else if(t.push(l),!o)break}t.push(...i)}function yh(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const r=i[n],s=t.segments,a=t.points;let o=!1,l=!1;for(let c=0;c<s.length;c++){const t=s[c],e=a[t.start][n],i=a[t.end][n];if(zs(r,e,i)){o=r===e,l=r===i;break}}return{first:o,last:l,point:i}}Pt(ch,"id","bar"),Pt(ch,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Pt(ch,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class _h{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:i,y:r,radius:s}=this;return e=e||{start:0,end:xs},t.arc(i,r,s,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:i}=this,r=t.angle;return{x:e+Math.cos(r)*i,y:n+Math.sin(r)*i,angle:r}}}function xh(t){const{chart:e,fill:n,line:i}=t;if(ts(n))return function(t,e){const n=t.getDatasetMeta(e),i=n&&t.isDatasetVisible(e);return i?n.dataset:null}(e,n);if("stack"===n)return function(t){const{scale:e,index:n,line:i}=t,r=[],s=i.segments,a=i.points,o=function(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const t=i[r];if(t.index===e)break;t.hidden||n.unshift(t.dataset)}return n}(e,n);o.push(ph({x:null,y:e.bottom},i));for(let l=0;l<s.length;l++){const t=s[l];for(let e=t.start;e<=t.end;e++)vh(r,a[e],o)}return new th({points:r,options:{}})}(t);if("shape"===n)return!0;const r=function(t){const e=t.scale||{};if(e.getPointPositionForValue)return function(t){const{scale:e,fill:n}=t,i=e.options,r=e.getLabels().length,s=i.reverse?e.max:e.min,a=function(t,e,n){let i;return i="start"===t?n:"end"===t?e.options.reverse?e.min:e.max:Qr(t)?t.value:e.getBaseValue(),i}(n,e,s),o=[];if(i.grid.circular){const t=e.getPointPositionForValue(0,s);return new _h({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(a)})}for(let l=0;l<r;++l)o.push(e.getPointPositionForValue(l,a));return o}(t);return function(t){const{scale:e={},fill:n}=t,i=function(t,e){let n=null;return"start"===t?n=e.bottom:"end"===t?n=e.top:Qr(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}(n,e);if(ts(i)){const t=e.isHorizontal();return{x:t?i:null,y:t?null:i}}return null}(t)}(t);return r instanceof _h?r:ph(r,i)}function bh(t,e,n){const i=xh(e),{chart:r,index:s,line:a,scale:o,axis:l}=e,c=a.options,h=c.fill,u=c.backgroundColor,{above:d=u,below:p=u}=h||{},f=r.getDatasetMeta(s),m=No(r,f);i&&a.points.length&&(wa(t,n),function(t,e){const{line:n,target:i,above:r,below:s,area:a,scale:o,clip:l}=e,c=n._loop?"angle":e.axis;t.save();let h=s;s!==r&&("x"===c?(Mh(t,i,a.top),Sh(t,{line:n,target:i,color:r,scale:o,property:c,clip:l}),t.restore(),t.save(),Mh(t,i,a.bottom)):"y"===c&&(wh(t,i,a.left),Sh(t,{line:n,target:i,color:s,scale:o,property:c,clip:l}),t.restore(),t.save(),wh(t,i,a.right),h=r));Sh(t,{line:n,target:i,color:h,scale:o,property:c,clip:l}),t.restore()}(t,{line:a,target:i,above:d,below:p,area:n,scale:o,axis:l,clip:m}),Sa(t))}function Mh(t,e,n){const{segments:i,points:r}=e;let s=!0,a=!1;t.beginPath();for(const o of i){const{start:i,end:l}=o,c=r[i],h=r[uh(i,l,r)];s?(t.moveTo(c.x,c.y),s=!1):(t.lineTo(c.x,n),t.lineTo(c.x,c.y)),a=!!e.pathSegment(t,o,{move:a}),a?t.closePath():t.lineTo(h.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function wh(t,e,n){const{segments:i,points:r}=e;let s=!0,a=!1;t.beginPath();for(const o of i){const{start:i,end:l}=o,c=r[i],h=r[uh(i,l,r)];s?(t.moveTo(c.x,c.y),s=!1):(t.lineTo(n,c.y),t.lineTo(c.x,c.y)),a=!!e.pathSegment(t,o,{move:a}),a?t.closePath():t.lineTo(n,h.y)}t.lineTo(n,e.first().y),t.closePath(),t.clip()}function Sh(t,e){const{line:n,target:i,property:r,color:s,scale:a,clip:o}=e,l=function(t,e,n){const i=t.segments,r=t.points,s=e.points,a=[];for(const o of i){let{start:t,end:i}=o;i=uh(t,i,r);const l=hh(n,r[t],r[i],o.loop);if(!e.segments){a.push({source:o,target:l,start:r[t],end:r[i]});continue}const c=Po(e,l);for(const e of c){const t=hh(n,s[e.start],s[e.end],e.loop),i=Ro(o,r,t);for(const r of i)a.push({source:r,target:e,start:{[n]:dh(l,t,"start",Math.max)},end:{[n]:dh(l,t,"end",Math.min)}})}}return a}(n,i,r);for(const{source:c,target:h,start:u,end:d}of l){const{style:{backgroundColor:e=s}={}}=c,l=!0!==i;t.save(),t.fillStyle=e,Th(t,a,o,l&&hh(r,u,d)),t.beginPath();const p=!!n.pathSegment(t,c);let f;if(l){p?t.closePath():Eh(t,i,d,r);const e=!!i.pathSegment(t,h,{move:p,reverse:!0});f=p&&e,f||Eh(t,i,u,r)}t.closePath(),t.fill(f?"evenodd":"nonzero"),t.restore()}}function Th(t,e,n,i){const r=e.chart.chartArea,{property:s,start:a,end:o}=i||{};if("x"===s||"y"===s){let e,i,l,c;"x"===s?(e=a,i=r.top,l=o,c=r.bottom):(e=r.left,i=a,l=r.right,c=o),t.beginPath(),n&&(e=Math.max(e,n.left),l=Math.min(l,n.right),i=Math.max(i,n.top),c=Math.min(c,n.bottom)),t.rect(e,i,l-e,c-i),t.clip()}}function Eh(t,e,n,i){const r=e.interpolate(n,i);r&&t.lineTo(r.x,r.y)}var Ah={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,r=[];let s,a,o,l;for(a=0;a<i;++a)s=t.getDatasetMeta(a),o=s.dataset,l=null,o&&o.options&&o instanceof th&&(l={visible:t.isDatasetVisible(a),index:a,fill:gh(o,a,i),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,r.push(l);for(a=0;a<i;++a)l=r[a],l&&!1!==l.fill&&(l.fill=mh(r,a,n.propagate))},beforeDraw(t,e,n){const i="beforeDraw"===n.drawTime,r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let a=r.length-1;a>=0;--a){const e=r[a].$filler;e&&(e.line.updateControlPoints(s,e.axis),i&&e.fill&&bh(t.ctx,e,s))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=t.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const e=i[r].$filler;fh(e)&&bh(t.ctx,e,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;fh(i)&&"beforeDatasetDraw"===n.drawTime&&bh(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Ch=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}};class Rh extends Jl{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=rs(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(e=>t.filter(e,this.chart.data))),t.sort&&(e=e.sort((e,n)=>t.sort(e,n,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const n=t.labels,i=Ba(n.font),r=i.size,s=this._computeTitleHeight(),{boxWidth:a,itemHeight:o}=Ch(n,r);let l,c;e.font=i.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,r,a,o)+10):(c=this.maxHeight,l=this._fitCols(s,i,a,o)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,i){const{ctx:r,maxWidth:s,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+a;let h=t;r.textAlign="left",r.textBaseline="middle";let u=-1,d=-c;return this.legendItems.forEach((t,p)=>{const f=n+e/2+r.measureText(t.text).width;(0===p||l[l.length-1]+f+2*a>s)&&(h+=c,l[l.length-(p>0?0:1)]=0,d+=c,u++),o[p]={left:0,top:d,row:u,width:f,height:i},l[l.length-1]+=f+a}),h}_fitCols(t,e,n,i){const{ctx:r,maxHeight:s,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-t;let h=a,u=0,d=0,p=0,f=0;return this.legendItems.forEach((t,s)=>{const{itemWidth:m,itemHeight:g}=function(t,e,n,i,r){const s=function(t,e,n,i){let r=t.text;r&&"string"!=typeof r&&(r=r.reduce((t,e)=>t.length>e.length?t:e));return e+n.size/2+i.measureText(r).width}(i,t,e,n),a=function(t,e,n){let i=t;"string"!=typeof e.text&&(i=Ph(e,n));return i}(r,i,e.lineHeight);return{itemWidth:s,itemHeight:a}}(n,e,r,t,i);s>0&&d+g+2*a>c&&(h+=u+a,l.push({width:u,height:d}),p+=u+a,f++,u=d=0),o[s]={left:p,top:d,col:f,width:m,height:g},u=Math.max(u,m),d+=g+a}),h+=u,l.push({width:u,height:d}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:i},rtl:r}}=this,s=So(r,this.left,this.width);if(this.isHorizontal()){let r=0,a=Zs(n,this.left+i,this.right-this.lineWidths[r]);for(const o of e)r!==o.row&&(r=o.row,a=Zs(n,this.left+i,this.right-this.lineWidths[r])),o.top+=this.top+t+i,o.left=s.leftForLtr(s.x(a),o.width),a+=o.width+i}else{let r=0,a=Zs(n,this.top+t+i,this.bottom-this.columnSizes[r].height);for(const o of e)o.col!==r&&(r=o.col,a=Zs(n,this.top+t+i,this.bottom-this.columnSizes[r].height)),o.top=a,o.left+=this.left+i,o.left=s.leftForLtr(s.x(o.left),o.width),a+=o.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;wa(t,this),this._draw(),Sa(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:i}=this,{align:r,labels:s}=t,a=ga.color,o=So(t.rtl,this.left,this.width),l=Ba(s.font),{padding:c}=s,h=l.size,u=h/2;let d;this.drawTitle(),i.textAlign=o.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:p,boxHeight:f,itemHeight:m}=Ch(s,h),g=this.isHorizontal(),v=this._computeTitleHeight();d=g?{x:Zs(r,this.left+c,this.right-n[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:Zs(r,this.top+v+c,this.bottom-e[0].height),line:0},To(this.ctx,t.textDirection);const y=m+c;this.legendItems.forEach((_,x)=>{i.strokeStyle=_.fontColor,i.fillStyle=_.fontColor;const b=i.measureText(_.text).width,M=o.textAlign(_.textAlign||(_.textAlign=s.textAlign)),w=p+u+b;let S=d.x,T=d.y;o.setWidth(this.width),g?x>0&&S+w+c>this.right&&(T=d.y+=y,d.line++,S=d.x=Zs(r,this.left+c,this.right-n[d.line])):x>0&&T+y>this.bottom&&(S=d.x=S+e[d.line].width+c,d.line++,T=d.y=Zs(r,this.top+v+c,this.bottom-e[d.line].height));if(function(t,e,n){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;i.save();const r=ns(n.lineWidth,1);if(i.fillStyle=ns(n.fillStyle,a),i.lineCap=ns(n.lineCap,"butt"),i.lineDashOffset=ns(n.lineDashOffset,0),i.lineJoin=ns(n.lineJoin,"miter"),i.lineWidth=r,i.strokeStyle=ns(n.strokeStyle,a),i.setLineDash(ns(n.lineDash,[])),s.usePointStyle){const a={radius:f*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},l=o.xPlus(t,p/2);ba(i,a,l,e+u,s.pointStyleWidth&&p)}else{const s=e+Math.max((h-f)/2,0),a=o.leftForLtr(t,p),l=Fa(n.borderRadius);i.beginPath(),Object.values(l).some(t=>0!==t)?Pa(i,{x:a,y:s,w:p,h:f,radius:l}):i.rect(a,s,p,f),i.fill(),0!==r&&i.stroke()}i.restore()}(o.x(S),T,_),S=((t,e,n,i)=>t===(i?"left":"right")?n:"center"===t?(e+n)/2:e)(M,S+p+u,g?S+w:this.right,t.rtl),function(t,e,n){Ra(i,n.text,t,e+m/2,l,{strikethrough:n.hidden,textAlign:o.textAlign(n.textAlign)})}(o.x(S),T,_),g)d.x+=w+c;else if("string"!=typeof _.text){const t=l.lineHeight;d.y+=Ph(_,t)+c}else d.y+=y}),Eo(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=Ba(e.font),i=ka(e.padding);if(!e.display)return;const r=So(t.rtl,this.left,this.width),s=this.ctx,a=e.position,o=n.size/2,l=i.top+o;let c,h=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,h=Zs(t.align,h,this.right-u);else{const e=this.columnSizes.reduce((t,e)=>Math.max(t,e.height),0);c=l+Zs(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const d=Zs(a,h,h+u);s.textAlign=r.textAlign(Ks(a)),s.textBaseline="middle",s.strokeStyle=e.color,s.fillStyle=e.color,s.font=n.string,Ra(s,e.text,d,c,n)}_computeTitleHeight(){const t=this.options.title,e=Ba(t.font),n=ka(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,i,r;if(zs(t,this.left,this.right)&&zs(e,this.top,this.bottom))for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(i=r[n],zs(t,i.left,i.left+i.width)&&zs(e,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(t){const e=this.options;if(!function(t,e){if(("mousemove"===t||"mouseout"===t)&&(e.onHover||e.onLeave))return!0;if(e.onClick&&("click"===t||"mouseup"===t))return!0;return!1}(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const s=this._hoveredItem,a=(r=n,null!==(i=s)&&null!==r&&i.datasetIndex===r.datasetIndex&&i.index===r.index);s&&!a&&rs(e.onLeave,[t,s,this],this),this._hoveredItem=n,n&&!a&&rs(e.onHover,[t,n,this],this)}else n&&rs(e.onClick,[t,n,this],this);var i,r}}function Ph(t,e){return e*(t.text?t.text.length:0)}var Oh={id:"legend",_element:Rh,start(t,e,n){const i=t.legend=new Rh({ctx:t.ctx,options:n,chart:t});Ll.configure(t,i,n),Ll.addBox(t,i)},stop(t){Ll.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;Ll.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(t=>{const l=t.controller.getStyle(n?0:void 0),c=ka(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:a&&(o||l.borderRadius),datasetIndex:t.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Ih extends Jl{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const i=Jr(n.text)?n.text.length:1;this._padding=ka(n.padding);const r=i*Ba(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:i,right:r,options:s}=this,a=s.align;let o,l,c,h=0;return this.isHorizontal()?(l=Zs(a,n,r),c=e+t,o=r-n):("left"===s.position?(l=n+t,c=Zs(a,i,e),h=-.5*_s):(l=r-t,c=Zs(a,e,i),h=.5*_s),o=i-e),{titleX:l,titleY:c,maxWidth:o,rotation:h}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=Ba(e.font),i=n.lineHeight/2+this._padding.top,{titleX:r,titleY:s,maxWidth:a,rotation:o}=this._drawArgs(i);Ra(t,e.text,0,0,n,{color:e.color,maxWidth:a,rotation:o,textAlign:Ks(e.align),textBaseline:"middle",translation:[r,s]})}}var Dh={id:"title",_element:Ih,start(t,e,n){!function(t,e){const n=new Ih({ctx:t.ctx,options:e,chart:t});Ll.configure(t,n,e),Ll.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){const e=t.titleBlock;Ll.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;Ll.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Lh={average(t){if(!t.length)return!1;let e,n,i=new Set,r=0,s=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();i.add(t.x),r+=t.y,++s}}if(0===s||0===i.size)return!1;return{x:[...i].reduce((t,e)=>t+e)/i.size,y:r/s}},nearest(t,e){if(!t.length)return!1;let n,i,r,s=e.x,a=e.y,o=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){const i=t[n].element;if(i&&i.hasValue()){const t=Ns(e,i.getCenterPoint());t<o&&(o=t,r=i)}}if(r){const t=r.tooltipPosition();s=t.x,a=t.y}return{x:s,y:a}}};function Nh(t,e){return e&&(Jr(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Uh(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function Fh(t,e){const{element:n,datasetIndex:i,index:r}=e,s=t.getDatasetMeta(i).controller,{label:a,value:o}=s.getLabelAndValue(r);return{chart:t,label:a,parsed:s.getParsed(r),raw:t.data.datasets[i].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function kh(t,e){const n=t.chart.ctx,{body:i,footer:r,title:s}=t,{boxWidth:a,boxHeight:o}=e,l=Ba(e.bodyFont),c=Ba(e.titleFont),h=Ba(e.footerFont),u=s.length,d=r.length,p=i.length,f=ka(e.padding);let m=f.height,g=0,v=i.reduce((t,e)=>t+e.before.length+e.lines.length+e.after.length,0);if(v+=t.beforeBody.length+t.afterBody.length,u&&(m+=u*c.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),v){m+=p*(e.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*e.bodySpacing}d&&(m+=e.footerMarginTop+d*h.lineHeight+(d-1)*e.footerSpacing);let y=0;const _=function(t){g=Math.max(g,n.measureText(t).width+y)};return n.save(),n.font=c.string,ss(t.title,_),n.font=l.string,ss(t.beforeBody.concat(t.afterBody),_),y=e.displayColors?a+2+e.boxPadding:0,ss(i,t=>{ss(t.before,_),ss(t.lines,_),ss(t.after,_)}),y=0,n.font=h.string,ss(t.footer,_),n.restore(),g+=f.width,{width:g,height:m}}function Bh(t,e,n,i){const{x:r,width:s}=n,{width:a,chartArea:{left:o,right:l}}=t;let c="center";return"center"===i?c=r<=(o+l)/2?"left":"right":r<=s/2?c="left":r>=a-s/2&&(c="right"),function(t,e,n,i){const{x:r,width:s}=i,a=n.caretSize+n.caretPadding;return"left"===t&&r+s+a>e.width||"right"===t&&r-s-a<0||void 0}(c,t,e,n)&&(c="center"),c}function zh(t,e,n){const i=n.yAlign||e.yAlign||function(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}(t,n);return{xAlign:n.xAlign||e.xAlign||Bh(t,e,n,i),yAlign:i}}function Vh(t,e,n,i){const{caretSize:r,caretPadding:s,cornerRadius:a}=t,{xAlign:o,yAlign:l}=n,c=r+s,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:p}=Fa(a);let f=function(t,e){let{x:n,width:i}=t;return"right"===e?n-=i:"center"===e&&(n-=i/2),n}(e,o);const m=function(t,e,n){let{y:i,height:r}=t;return"top"===e?i+=n:i-="bottom"===e?r+n:r/2,i}(e,l,c);return"center"===l?"left"===o?f+=c:"right"===o&&(f-=c):"left"===o?f-=Math.max(h,d)+r:"right"===o&&(f+=Math.max(u,p)+r),{x:Bs(f,0,i.width-e.width),y:Bs(m,0,i.height-e.height)}}function Hh(t,e,n){const i=ka(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-i.right:t.x+i.left}function Wh(t){return Nh([],Uh(t))}function jh(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Gh={beforeTitle:Kr,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:Kr,beforeBody:Kr,beforeLabel:Kr,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return $r(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Kr,afterBody:Kr,beforeFooter:Kr,footer:Kr,afterFooter:Kr};function Xh(t,e,n,i){const r=t[e].call(n,i);return void 0===r?Gh[e].call(n,i):r}class qh extends Jl{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,r=new Vo(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(t=this.chart.getContext(),e=this,n=this._tooltipItems,Va(t,{tooltip:e,tooltipItems:n,type:"tooltip"})));var t,e,n}getTitle(t,e){const{callbacks:n}=e,i=Xh(n,"beforeTitle",this,t),r=Xh(n,"title",this,t),s=Xh(n,"afterTitle",this,t);let a=[];return a=Nh(a,Uh(i)),a=Nh(a,Uh(r)),a=Nh(a,Uh(s)),a}getBeforeBody(t,e){return Wh(Xh(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,i=[];return ss(t,t=>{const e={before:[],lines:[],after:[]},r=jh(n,t);Nh(e.before,Uh(Xh(r,"beforeLabel",this,t))),Nh(e.lines,Xh(r,"label",this,t)),Nh(e.after,Uh(Xh(r,"afterLabel",this,t))),i.push(e)}),i}getAfterBody(t,e){return Wh(Xh(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,i=Xh(n,"beforeFooter",this,t),r=Xh(n,"footer",this,t),s=Xh(n,"afterFooter",this,t);let a=[];return a=Nh(a,Uh(i)),a=Nh(a,Uh(r)),a=Nh(a,Uh(s)),a}_createItems(t){const e=this._active,n=this.chart.data,i=[],r=[],s=[];let a,o,l=[];for(a=0,o=e.length;a<o;++a)l.push(Fh(this.chart,e[a]));return t.filter&&(l=l.filter((e,i,r)=>t.filter(e,i,r,n))),t.itemSort&&(l=l.sort((e,i)=>t.itemSort(e,i,n))),ss(l,e=>{const n=jh(t.callbacks,e);i.push(Xh(n,"labelColor",this,e)),r.push(Xh(n,"labelPointStyle",this,e)),s.push(Xh(n,"labelTextColor",this,e))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=s,this.dataPoints=l,l}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let r,s=[];if(i.length){const t=Lh[n.position].call(this,i,this._eventPosition);s=this._createItems(n),this.title=this.getTitle(s,n),this.beforeBody=this.getBeforeBody(s,n),this.body=this.getBody(s,n),this.afterBody=this.getAfterBody(s,n),this.footer=this.getFooter(s,n);const e=this._size=kh(this,n),a=Object.assign({},t,e),o=zh(this.chart,n,a),l=Vh(n,a,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,r={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=s,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const r=this.getCaretPosition(t,n,i);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:r}=this,{caretSize:s,cornerRadius:a}=n,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:h}=Fa(a),{x:u,y:d}=t,{width:p,height:f}=e;let m,g,v,y,_,x;return"center"===r?(_=d+f/2,"left"===i?(m=u,g=m-s,y=_+s,x=_-s):(m=u+p,g=m+s,y=_-s,x=_+s),v=m):(g="left"===i?u+Math.max(o,c)+s:"right"===i?u+p-Math.max(l,h)-s:this.caretX,"top"===r?(y=d,_=y-s,m=g-s,v=g+s):(y=d+f,_=y+s,m=g+s,v=g-s),x=y),{x1:m,x2:g,x3:v,y1:y,y2:_,y3:x}}drawTitle(t,e,n){const i=this.title,r=i.length;let s,a,o;if(r){const l=So(n.rtl,this.x,this.width);for(t.x=Hh(this,n.titleAlign,n),e.textAlign=l.textAlign(n.titleAlign),e.textBaseline="middle",s=Ba(n.titleFont),a=n.titleSpacing,e.fillStyle=n.titleColor,e.font=s.string,o=0;o<r;++o)e.fillText(i[o],l.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+a,o+1===r&&(t.y+=n.titleMarginBottom-a)}}_drawColorBox(t,e,n,i,r){const s=this.labelColors[n],a=this.labelPointStyles[n],{boxHeight:o,boxWidth:l}=r,c=Ba(r.bodyFont),h=Hh(this,"left",r),u=i.x(h),d=o<c.lineHeight?(c.lineHeight-o)/2:0,p=e.y+d;if(r.usePointStyle){const e={radius:Math.min(l,o)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},n=i.leftForLtr(u,l)+l/2,c=p+o/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,xa(t,e,n,c),t.strokeStyle=s.borderColor,t.fillStyle=s.backgroundColor,xa(t,e,n,c)}else{t.lineWidth=Qr(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,t.strokeStyle=s.borderColor,t.setLineDash(s.borderDash||[]),t.lineDashOffset=s.borderDashOffset||0;const e=i.leftForLtr(u,l),n=i.leftForLtr(i.xPlus(u,1),l-2),a=Fa(s.borderRadius);Object.values(a).some(t=>0!==t)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,Pa(t,{x:e,y:p,w:l,h:o,radius:a}),t.fill(),t.stroke(),t.fillStyle=s.backgroundColor,t.beginPath(),Pa(t,{x:n,y:p+1,w:l-2,h:o-2,radius:a}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(e,p,l,o),t.strokeRect(e,p,l,o),t.fillStyle=s.backgroundColor,t.fillRect(n,p+1,l-2,o-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:r,bodyAlign:s,displayColors:a,boxHeight:o,boxWidth:l,boxPadding:c}=n,h=Ba(n.bodyFont);let u=h.lineHeight,d=0;const p=So(n.rtl,this.x,this.width),f=function(n){e.fillText(n,p.x(t.x+d),t.y+u/2),t.y+=u+r},m=p.textAlign(s);let g,v,y,_,x,b,M;for(e.textAlign=s,e.textBaseline="middle",e.font=h.string,t.x=Hh(this,m,n),e.fillStyle=n.bodyColor,ss(this.beforeBody,f),d=a&&"right"!==m?"center"===s?l/2+c:l+2+c:0,_=0,b=i.length;_<b;++_){for(g=i[_],v=this.labelTextColors[_],e.fillStyle=v,ss(g.before,f),y=g.lines,a&&y.length&&(this._drawColorBox(e,t,_,p,n),u=Math.max(h.lineHeight,o)),x=0,M=y.length;x<M;++x)f(y[x]),u=h.lineHeight;ss(g.after,f)}d=0,u=h.lineHeight,ss(this.afterBody,f),t.y-=r}drawFooter(t,e,n){const i=this.footer,r=i.length;let s,a;if(r){const o=So(n.rtl,this.x,this.width);for(t.x=Hh(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=o.textAlign(n.footerAlign),e.textBaseline="middle",s=Ba(n.footerFont),e.fillStyle=n.footerColor,e.font=s.string,a=0;a<r;++a)e.fillText(i[a],o.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:r,yAlign:s}=this,{x:a,y:o}=t,{width:l,height:c}=n,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:p}=Fa(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(a+h,o),"top"===s&&this.drawCaret(t,e,n,i),e.lineTo(a+l-u,o),e.quadraticCurveTo(a+l,o,a+l,o+u),"center"===s&&"right"===r&&this.drawCaret(t,e,n,i),e.lineTo(a+l,o+c-p),e.quadraticCurveTo(a+l,o+c,a+l-p,o+c),"bottom"===s&&this.drawCaret(t,e,n,i),e.lineTo(a+d,o+c),e.quadraticCurveTo(a,o+c,a,o+c-d),"center"===s&&"left"===r&&this.drawCaret(t,e,n,i),e.lineTo(a,o+h),e.quadraticCurveTo(a,o,a+h,o),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,r=n&&n.y;if(i||r){const n=Lh[t.position].call(this,this._active,this._eventPosition);if(!n)return;const s=this._size=kh(this,t),a=Object.assign({},n,this._size),o=zh(e,t,a),l=Vh(t,a,o,e);i._to===l.x&&r._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=s.width,this.height=s.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const s=ka(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=n,this.drawBackground(r,t,i,e),To(t,e.textDirection),r.y+=s.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),Eo(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map(({datasetIndex:t,index:e})=>{const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[e],index:e}}),r=!as(n,i),s=this._positionChanged(i,e);(r||s)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],s=this._getActiveElements(t,r,e,n),a=this._positionChanged(s,t),o=e||!as(s,r)||a;return o&&(this._active=s,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),o}_getActiveElements(t,e,n,i){const r=this.options;if("mouseout"===t.type)return[];if(!i)return e.filter(t=>this.chart.data.datasets[t.datasetIndex]&&void 0!==this.chart.getDatasetMeta(t.datasetIndex).controller.getParsed(t.index));const s=this.chart.getElementsAtEventForMode(t,r.mode,r,n);return r.reverse&&s.reverse(),s}_positionChanged(t,e){const{caretX:n,caretY:i,options:r}=this,s=Lh[r.position].call(this,t,e);return!1!==s&&(n!==s.x||i!==s.y)}}Pt(qh,"positioners",Lh);var Yh={id:"tooltip",_element:qh,positioners:Lh,afterInit(t,e,n){n&&(t.tooltip=new qh({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Gh},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function Kh(t,e,n,i){const r=t.indexOf(e);if(-1===r)return((t,e,n,i)=>("string"==typeof e?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n))(t,e,n,i);return r!==t.lastIndexOf(e)?n:r}function Zh(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class $h extends lc{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:i}of e)t[n]===i&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if($r(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:Bs(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:Kh(n,t,ns(e,t),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let r=this.getLabels();r=0===t&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let s=t;s<=e;s++)i.push({value:s});return i}getLabelForValue(t){return Zh.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function Jh(t,e){const n=[],{bounds:i,step:r,min:s,max:a,precision:o,count:l,maxTicks:c,maxDigits:h,includeBounds:u}=t,d=r||1,p=c-1,{min:f,max:m}=e,g=!$r(s),v=!$r(a),y=!$r(l),_=(m-f)/(h+1);let x,b,M,w,S=Ps((m-f)/p/d)*d;if(S<1e-14&&!g&&!v)return[{value:f},{value:m}];w=Math.ceil(m/S)-Math.floor(f/S),w>p&&(S=Ps(w*S/p/d)*d),$r(o)||(x=Math.pow(10,o),S=Math.ceil(S*x)/x),"ticks"===i?(b=Math.floor(f/S)*S,M=Math.ceil(m/S)*S):(b=f,M=m),g&&v&&r&&function(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}((a-s)/r,S/1e3)?(w=Math.round(Math.min((a-s)/S,c)),S=(a-s)/w,b=s,M=a):y?(b=g?s:b,M=v?a:M,w=l-1,S=(M-b)/w):(w=(M-b)/S,w=Rs(w,Math.round(w),S/1e3)?Math.round(w):Math.ceil(w));const T=Math.max(Ds(S),Ds(b));x=Math.pow(10,$r(o)?T:o),b=Math.round(b*x)/x,M=Math.round(M*x)/x;let E=0;for(g&&(u&&b!==s?(n.push({value:s}),b<s&&E++,Rs(Math.round((b+E*S)*x)/x,s,Qh(s,_,t))&&E++):b<s&&E++);E<w;++E){const t=Math.round((b+E*S)*x)/x;if(v&&t>a)break;n.push({value:t})}return v&&u&&M!==a?n.length&&Rs(n[n.length-1].value,a,Qh(a,_,t))?n[n.length-1].value=a:n.push({value:a}):v&&M!==a||n.push({value:M}),n}function Qh(t,e,{horizontal:n,minRotation:i}){const r=Is(i),s=(n?Math.sin(r):Math.cos(r))||.001,a=.75*e*(""+t).length;return Math.min(e/s,a)}Pt($h,"id","category"),Pt($h,"defaults",{ticks:{callback:Zh}});class tu extends lc{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return $r(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this;const s=t=>i=e?i:t,a=t=>r=n?r:t;if(t){const t=Cs(i),e=Cs(r);t<0&&e<0?a(0):t>0&&e>0&&s(0)}if(i===r){let e=0===r?1:Math.abs(.05*r);a(r+e),t||s(i-e)}this.min=i,this.max=r}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=Jh({maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&function(t,e,n){let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i][n],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return ca(t,this.chart.options.locale,this.options.ticks.format)}}class eu extends tu{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=ts(t)?t:0,this.max=ts(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=Is(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Pt(eu,"id","linear"),Pt(eu,"defaults",{ticks:{callback:ha.formatters.numeric}});const nu={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},iu=Object.keys(nu);function ru(t,e){return t-e}function su(t,e){if($r(e))return null;const n=t._adapter,{parser:i,round:r,isoWeekday:s}=t._parseOpts;let a=e;return"function"==typeof i&&(a=i(a)),ts(a)||(a="string"==typeof i?n.parse(a,i):n.parse(a)),null===a?null:(r&&(a="week"!==r||!Os(s)&&!0!==s?n.startOf(a,r):n.startOf(a,"isoWeek",s)),+a)}function au(t,e,n,i){const r=iu.length;for(let s=iu.indexOf(t);s<r-1;++s){const t=nu[iu[s]],r=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(r*t.size))<=i)return iu[s]}return iu[r-1]}function ou(t,e,n){if(n){if(n.length){const{lo:i,hi:r}=Vs(n,e);t[n[i]>=e?n[i]:n[r]]=!0}}else t[e]=!0}function lu(t,e,n){const i=[],r={},s=e.length;let a,o;for(a=0;a<s;++a)o=e[a],r[o]=a,i.push({value:o,major:!1});return 0!==s&&n?function(t,e,n,i){const r=t._adapter,s=+r.startOf(e[0].value,i),a=e[e.length-1].value;let o,l;for(o=s;o<=a;o=+r.add(o,1,i))l=n[o],l>=0&&(e[l].major=!0);return e}(t,i,r,n):i}class cu extends lc{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),i=this._adapter=new fl(t.adapters.date);i.init(e),us(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:su(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:r,minDefined:s,maxDefined:a}=this.getUserBounds();function o(t){s||isNaN(t.min)||(i=Math.min(i,t.min)),a||isNaN(t.max)||(r=Math.max(r,t.max))}s&&a||(o(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||o(this.getMinMax(!1))),i=ts(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),r=ts(r)&&!isNaN(r)?r:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,s=function(t,e,n){let i=0,r=t.length;for(;i<r&&t[i]<e;)i++;for(;r>i&&t[r-1]>n;)r--;return i>0||r<t.length?t.slice(i,r):t}(i,r,this.max);return this._unit=e.unit||(n.autoSkip?au(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(t,e,n,i,r){for(let s=iu.length-1;s>=iu.indexOf(n);s--){const n=iu[s];if(nu[n].common&&t._adapter.diff(r,i,n)>=e-1)return n}return iu[n?iu.indexOf(n):0]}(this,s.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(t){for(let e=iu.indexOf(t)+1,n=iu.length;e<n;++e)if(nu[iu[e]].common)return iu[e]}(this._unit):void 0,this.initOffsets(i),t.reverse&&s.reverse(),lu(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e,n,i=0,r=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),i=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),r=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const s=t.length<3?.5:.25;i=Bs(i,0,s),r=Bs(r,0,s),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,r=i.time,s=r.unit||au(r.minUnit,e,n,this._getLabelCapacity(e)),a=ns(i.ticks.stepSize,1),o="week"===s&&r.isoWeekday,l=Os(o)||!0===o,c={};let h,u,d=e;if(l&&(d=+t.startOf(d,"isoWeek",o)),d=+t.startOf(d,l?"day":s),t.diff(n,e,s)>1e5*a)throw new Error(e+" and "+n+" are too far apart with stepSize of "+a+" "+s);const p="data"===i.ticks.source&&this.getDataTimestamps();for(h=d,u=0;h<n;h=+t.add(h,a,s),u++)ou(c,h,p);return h!==n&&"ticks"!==i.bounds&&1!==u||ou(c,h,p),Object.keys(c).sort(ru).map(t=>+t)}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const n=this.options.time.displayFormats,i=this._unit,r=e||n[i];return this._adapter.format(t,r)}_tickFormatFunction(t,e,n,i){const r=this.options,s=r.ticks.callback;if(s)return rs(s,[t,e,n],this);const a=r.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&a[o],h=l&&a[l],u=n[e],d=l&&h&&u&&u.major;return this._adapter.format(t,i||(d?h:c))}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=Is(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(i),s=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:n*r+a*s,h:n*s+a*r}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,r=this._tickFormatFunction(t,0,lu(this,[t],this._majorUnit),i),s=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return a>0?a:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)n=n.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(su(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Xs(t.sort(ru))}}function hu(t,e,n){let i,r,s,a,o=0,l=t.length-1;n?(e>=t[o].pos&&e<=t[l].pos&&({lo:o,hi:l}=Hs(t,"pos",e)),({pos:i,time:s}=t[o]),({pos:r,time:a}=t[l])):(e>=t[o].time&&e<=t[l].time&&({lo:o,hi:l}=Hs(t,"time",e)),({time:i,pos:s}=t[o]),({time:r,pos:a}=t[l]));const c=r-i;return c?s+(a-s)*(e-i)/c:s}Pt(cu,"id","time"),Pt(cu,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class uu extends cu{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=hu(e,this.min),this._tableRange=hu(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,i=[],r=[];let s,a,o,l,c;for(s=0,a=t.length;s<a;++s)l=t[s],l>=e&&l<=n&&i.push(l);if(i.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(s=0,a=i.length;s<a;++s)c=i[s+1],o=i[s-1],l=i[s],Math.round((c+o)/2)!==l&&r.push({time:l,pos:s/(a-1)});return r}_generate(){const t=this.min,e=this.max;let n=super.getDataTimestamps();return n.includes(t)&&n.length||n.splice(0,0,t),n.includes(e)&&1!==n.length||n.push(e),n.sort((t,e)=>t-e)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return t=e.length&&n.length?this.normalize(e.concat(n)):e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(hu(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return hu(this._table,n*this._tableRange+this._minPos,!0)}}function du(t,e){-1===t.indexOf(e)&&t.push(e)}function pu(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}Pt(uu,"id","timeseries"),Pt(uu,"defaults",cu.defaults);const fu=(t,e,n)=>n>e?e:n<t?t:n;const mu={},gu=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function vu(t){return"object"==typeof t&&null!==t}const yu=t=>/^0[^.\s]+$/u.test(t);function _u(t){let e;return()=>(void 0===e&&(e=t()),e)}const xu=t=>t,bu=(t,e)=>n=>e(t(n)),Mu=(...t)=>t.reduce(bu),wu=(t,e,n)=>{const i=e-t;return 0===i?1:(n-t)/i};class Su{constructor(){this.subscriptions=[]}add(t){return du(this.subscriptions,t),()=>pu(this.subscriptions,t)}notify(t,e,n){const i=this.subscriptions.length;if(i)if(1===i)this.subscriptions[0](t,e,n);else for(let r=0;r<i;r++){const i=this.subscriptions[r];i&&i(t,e,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Tu=t=>1e3*t,Eu=t=>t/1e3;function Au(t,e){return e?t*(1e3/e):0}const Cu=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t;function Ru(t,e,n,i){if(t===e&&n===i)return xu;const r=e=>function(t,e,n,i,r){let s,a,o=0;do{a=e+(n-e)/2,s=Cu(a,i,r)-t,s>0?n=a:e=a}while(Math.abs(s)>1e-7&&++o<12);return a}(e,0,1,t,n);return t=>0===t||1===t?t:Cu(r(t),e,i)}const Pu=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Ou=t=>e=>1-t(1-e),Iu=Ru(.33,1.53,.69,.99),Du=Ou(Iu),Lu=Pu(Du),Nu=t=>(t*=2)<1?.5*Du(t):.5*(2-Math.pow(2,-10*(t-1))),Uu=t=>1-Math.sin(Math.acos(t)),Fu=Ou(Uu),ku=Pu(Uu),Bu=Ru(.42,0,1,1),zu=Ru(0,0,.58,1),Vu=Ru(.42,0,.58,1),Hu=t=>Array.isArray(t)&&"number"==typeof t[0],Wu={linear:xu,easeIn:Bu,easeInOut:Vu,easeOut:zu,circIn:Uu,circInOut:ku,circOut:Fu,backIn:Du,backInOut:Lu,backOut:Iu,anticipate:Nu},ju=t=>{if(Hu(t)){t.length;const[e,n,i,r]=t;return Ru(e,n,i,r)}return"string"==typeof t?Wu[t]:t},Gu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Xu(t,e){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,a=Gu.reduce((t,e)=>(t[e]=function(t){let e=new Set,n=new Set,i=!1,r=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(e){s.has(e)&&(l.schedule(e),t()),e(a)}const l={schedule:(t,r=!1,a=!1)=>{const o=a&&i?e:n;return r&&s.add(t),o.has(t)||o.add(t),t},cancel:t=>{n.delete(t),s.delete(t)},process:t=>{a=t,i?r=!0:(i=!0,[e,n]=[n,e],e.forEach(o),e.clear(),i=!1,r&&(r=!1,l.process(t)))}};return l}(s),t),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:h,update:u,preRender:d,render:p,postRender:f}=a,m=()=>{const s=mu.useManualTiming?r.timestamp:performance.now();n=!1,mu.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(s-r.timestamp,40),1)),r.timestamp=s,r.isProcessing=!0,o.process(r),l.process(r),c.process(r),h.process(r),u.process(r),d.process(r),p.process(r),f.process(r),r.isProcessing=!1,n&&e&&(i=!1,t(m))};return{schedule:Gu.reduce((e,s)=>{const o=a[s];return e[s]=(e,s=!1,a=!1)=>(n||(n=!0,i=!0,r.isProcessing||t(m)),o.schedule(e,s,a)),e},{}),cancel:t=>{for(let e=0;e<Gu.length;e++)a[Gu[e]].cancel(t)},state:r,steps:a}}const{schedule:qu,cancel:Yu,state:Ku,steps:Zu}=Xu("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:xu,!0);let $u;function Ju(){$u=void 0}const Qu={now:()=>(void 0===$u&&Qu.set(Ku.isProcessing||mu.useManualTiming?Ku.timestamp:performance.now()),$u),set:t=>{$u=t,queueMicrotask(Ju)}},td=t=>e=>"string"==typeof e&&e.startsWith(t),ed=td("--"),nd=td("var(--"),id=t=>!!nd(t)&&rd.test(t.split("/*")[0].trim()),rd=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,sd={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},ad={...sd,transform:t=>fu(0,1,t)},od={...sd,default:1},ld=t=>Math.round(1e5*t)/1e5,cd=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const hd=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ud=(t,e)=>n=>Boolean("string"==typeof n&&hd.test(n)&&n.startsWith(t)||e&&!function(t){return null==t}(n)&&Object.prototype.hasOwnProperty.call(n,e)),dd=(t,e,n)=>i=>{if("string"!=typeof i)return i;const[r,s,a,o]=i.match(cd);return{[t]:parseFloat(r),[e]:parseFloat(s),[n]:parseFloat(a),alpha:void 0!==o?parseFloat(o):1}},pd={...sd,transform:t=>Math.round((t=>fu(0,255,t))(t))},fd={test:ud("rgb","red"),parse:dd("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:i=1})=>"rgba("+pd.transform(t)+", "+pd.transform(e)+", "+pd.transform(n)+", "+ld(ad.transform(i))+")"};const md={test:ud("#"),parse:function(t){let e="",n="",i="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}},transform:fd.transform},gd=t=>({test:e=>"string"==typeof e&&e.endsWith(t)&&1===e.split(" ").length,parse:parseFloat,transform:e=>`${e}${t}`}),vd=gd("deg"),yd=gd("%"),_d=gd("px"),xd=gd("vh"),bd=gd("vw"),Md=(()=>({...yd,parse:t=>yd.parse(t)/100,transform:t=>yd.transform(100*t)}))(),wd={test:ud("hsl","hue"),parse:dd("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+yd.transform(ld(e))+", "+yd.transform(ld(n))+", "+ld(ad.transform(i))+")"},Sd={test:t=>fd.test(t)||md.test(t)||wd.test(t),parse:t=>fd.test(t)?fd.parse(t):wd.test(t)?wd.parse(t):md.parse(t),transform:t=>"string"==typeof t?t:t.hasOwnProperty("red")?fd.transform(t):wd.transform(t),getAnimatableNone:t=>{const e=Sd.parse(t);return e.alpha=0,Sd.transform(e)}},Td=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const Ed="number",Ad="color",Cd=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Rd(t){const e=t.toString(),n=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(Cd,t=>(Sd.test(t)?(i.color.push(s),r.push(Ad),n.push(Sd.parse(t))):t.startsWith("var(")?(i.var.push(s),r.push("var"),n.push(t)):(i.number.push(s),r.push(Ed),n.push(parseFloat(t))),++s,"${}")).split("${}");return{values:n,split:a,indexes:i,types:r}}function Pd(t){return Rd(t).values}function Od(t){const{split:e,types:n}=Rd(t),i=e.length;return t=>{let r="";for(let s=0;s<i;s++)if(r+=e[s],void 0!==t[s]){const e=n[s];r+=e===Ed?ld(t[s]):e===Ad?Sd.transform(t[s]):t[s]}return r}}const Id=t=>"number"==typeof t?0:Sd.test(t)?Sd.getAnimatableNone(t):t;const Dd={test:function(t){return isNaN(t)&&"string"==typeof t&&(t.match(cd)?.length||0)+(t.match(Td)?.length||0)>0},parse:Pd,createTransformer:Od,getAnimatableNone:function(t){const e=Pd(t);return Od(t)(e.map(Id))}};function Ld(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Nd(t,e){return n=>n>0?e:t}const Ud=(t,e,n)=>t+(e-t)*n,Fd=(t,e,n)=>{const i=t*t,r=n*(e*e-i)+i;return r<0?0:Math.sqrt(r)},kd=[md,fd,wd];function Bd(t){const e=(n=t,kd.find(t=>t.test(n)));var n;if(!Boolean(e))return!1;let i=e.parse(t);return e===wd&&(i=function({hue:t,saturation:e,lightness:n,alpha:i}){t/=360,n/=100;let r=0,s=0,a=0;if(e/=100){const i=n<.5?n*(1+e):n+e-n*e,o=2*n-i;r=Ld(o,i,t+1/3),s=Ld(o,i,t),a=Ld(o,i,t-1/3)}else r=s=a=n;return{red:Math.round(255*r),green:Math.round(255*s),blue:Math.round(255*a),alpha:i}}(i)),i}const zd=(t,e)=>{const n=Bd(t),i=Bd(e);if(!n||!i)return Nd(t,e);const r={...n};return t=>(r.red=Fd(n.red,i.red,t),r.green=Fd(n.green,i.green,t),r.blue=Fd(n.blue,i.blue,t),r.alpha=Ud(n.alpha,i.alpha,t),fd.transform(r))},Vd=new Set(["none","hidden"]);function Hd(t,e){return n=>Ud(t,e,n)}function Wd(t){return"number"==typeof t?Hd:"string"==typeof t?id(t)?Nd:Sd.test(t)?zd:Xd:Array.isArray(t)?jd:"object"==typeof t?Sd.test(t)?zd:Gd:Nd}function jd(t,e){const n=[...t],i=n.length,r=t.map((t,n)=>Wd(t)(t,e[n]));return t=>{for(let e=0;e<i;e++)n[e]=r[e](t);return n}}function Gd(t,e){const n={...t,...e},i={};for(const r in n)void 0!==t[r]&&void 0!==e[r]&&(i[r]=Wd(t[r])(t[r],e[r]));return t=>{for(const e in i)n[e]=i[e](t);return n}}const Xd=(t,e)=>{const n=Dd.createTransformer(e),i=Rd(t),r=Rd(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?Vd.has(t)&&!r.values.length||Vd.has(e)&&!i.values.length?function(t,e){return Vd.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}(t,e):Mu(jd(function(t,e){const n=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const s=e.types[r],a=t.indexes[s][i[s]],o=t.values[a]??0;n[r]=o,i[s]++}return n}(i,r),r.values),n):Nd(t,e)};function qd(t,e,n){if("number"==typeof t&&"number"==typeof e&&"number"==typeof n)return Ud(t,e,n);return Wd(t)(t,e)}const Yd=t=>{const e=({timestamp:e})=>t(e);return{start:(t=!0)=>qu.update(e,t),stop:()=>Yu(e),now:()=>Ku.isProcessing?Ku.timestamp:Qu.now()}},Kd=(t,e,n=10)=>{let i="";const r=Math.max(Math.round(e/n),2);for(let s=0;s<r;s++)i+=Math.round(1e4*t(s/(r-1)))/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},Zd=2e4;function $d(t){let e=0;let n=t.next(e);for(;!n.done&&e<Zd;)e+=50,n=t.next(e);return e>=Zd?1/0:e}function Jd(t,e,n){const i=Math.max(e-5,0);return Au(n-t(i),e-i)}const Qd=100,tp=10,ep=1,np=0,ip=800,rp=.3,sp=.3,ap={granular:.01,default:2},op={granular:.005,default:.5},lp=.01,cp=10,hp=.05,up=1,dp=.001;function pp({duration:t=ip,bounce:e=rp,velocity:n=np,mass:i=ep}){let r,s,a=1-e;a=fu(hp,up,a),t=fu(lp,cp,Eu(t)),a<1?(r=e=>{const i=e*a,r=i*t,s=i-n,o=mp(e,a),l=Math.exp(-r);return dp-s/o*l},s=e=>{const i=e*a*t,s=i*n+n,o=Math.pow(a,2)*Math.pow(e,2)*t,l=Math.exp(-i),c=mp(Math.pow(e,2),a);return(-r(e)+dp>0?-1:1)*((s-o)*l)/c}):(r=e=>Math.exp(-e*t)*((e-n)*t+1)-.001,s=e=>Math.exp(-e*t)*(t*t*(n-e)));const o=function(t,e,n){let i=n;for(let r=1;r<fp;r++)i-=t(i)/e(i);return i}(r,s,5/t);if(t=Tu(t),isNaN(o))return{stiffness:Qd,damping:tp,duration:t};{const e=Math.pow(o,2)*i;return{stiffness:e,damping:2*a*Math.sqrt(i*e),duration:t}}}const fp=12;function mp(t,e){return t*Math.sqrt(1-e*e)}const gp=["duration","bounce"],vp=["stiffness","damping","mass"];function yp(t,e){return e.some(e=>void 0!==t[e])}function _p(t=sp,e=rp){const n="object"!=typeof t?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:i,restDelta:r}=n;const s=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:h,duration:u,velocity:d,isResolvedFromDuration:p}=function(t){let e={velocity:np,stiffness:Qd,damping:tp,mass:ep,isResolvedFromDuration:!1,...t};if(!yp(t,vp)&&yp(t,gp))if(t.visualDuration){const n=t.visualDuration,i=2*Math.PI/(1.2*n),r=i*i,s=2*fu(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:ep,stiffness:r,damping:s}}else{const n=pp(t);e={...e,...n,mass:ep},e.isResolvedFromDuration=!0}return e}({...n,velocity:-Eu(n.velocity||0)}),f=d||0,m=c/(2*Math.sqrt(l*h)),g=a-s,v=Eu(Math.sqrt(l/h)),y=Math.abs(g)<5;let _;if(i||(i=y?ap.granular:ap.default),r||(r=y?op.granular:op.default),m<1){const t=mp(v,m);_=e=>{const n=Math.exp(-m*v*e);return a-n*((f+m*v*g)/t*Math.sin(t*e)+g*Math.cos(t*e))}}else if(1===m)_=t=>a-Math.exp(-v*t)*(g+(f+v*g)*t);else{const t=v*Math.sqrt(m*m-1);_=e=>{const n=Math.exp(-m*v*e),i=Math.min(t*e,300);return a-n*((f+m*v*g)*Math.sinh(i)+t*g*Math.cosh(i))/t}}const x={calculatedDuration:p&&u||null,next:t=>{const e=_(t);if(p)o.done=t>=u;else{let n=0===t?f:0;m<1&&(n=0===t?Tu(f):Jd(_,t,e));const s=Math.abs(n)<=i,l=Math.abs(a-e)<=r;o.done=s&&l}return o.value=o.done?a:e,o},toString:()=>{const t=Math.min($d(x),Zd),e=Kd(e=>x.next(t*e).value,t,30);return t+"ms "+e},toTransition:()=>{}};return x}function xp({keyframes:t,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:h}){const u=t[0],d={done:!1,value:u},p=t=>void 0===o?l:void 0===l||Math.abs(o-t)<Math.abs(l-t)?o:l;let f=n*e;const m=u+f,g=void 0===a?m:a(m);g!==m&&(f=g-u);const v=t=>-f*Math.exp(-t/i),y=t=>g+v(t),_=t=>{const e=v(t),n=y(t);d.done=Math.abs(e)<=c,d.value=d.done?g:n};let x,b;const M=t=>{var e;(e=d.value,void 0!==o&&e<o||void 0!==l&&e>l)&&(x=t,b=_p({keyframes:[d.value,p(d.value)],velocity:Jd(y,t,d.value),damping:r,stiffness:s,restDelta:c,restSpeed:h}))};return M(0),{calculatedDuration:null,next:t=>{let e=!1;return b||void 0!==x||(e=!0,_(t),M(t)),void 0!==x&&t>=x?b.next(t-x):(!e&&_(t),d)}}}function bp(t,e,{clamp:n=!0,ease:i,mixer:r}={}){const s=t.length;if(e.length,1===s)return()=>e[0];if(2===s&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=function(t,e,n){const i=[],r=n||mu.mix||qd,s=t.length-1;for(let a=0;a<s;a++){let n=r(t[a],t[a+1]);if(e){const t=Array.isArray(e)?e[a]||xu:e;n=Mu(t,n)}i.push(n)}return i}(e,i,r),l=o.length,c=n=>{if(a&&n<t[0])return e[0];let i=0;if(l>1)for(;i<t.length-2&&!(n<t[i+1]);i++);const r=wu(t[i],t[i+1],n);return o[i](r)};return n?e=>c(fu(t[0],t[s-1],e)):c}function Mp(t){const e=[0];return function(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=wu(0,e,i);t.push(Ud(n,1,r))}}(e,t.length-1),e}function wp({duration:t=300,keyframes:e,times:n,ease:i="easeInOut"}){const r=(t=>Array.isArray(t)&&"number"!=typeof t[0])(i)?i.map(ju):ju(i),s={done:!1,value:e[0]},a=function(t,e){return t.map(t=>t*e)}(n&&n.length===e.length?n:Mp(e),t),o=bp(a,e,{ease:Array.isArray(r)?r:(l=e,c=r,l.map(()=>c||Vu).splice(0,l.length-1))});var l,c;return{calculatedDuration:t,next:e=>(s.value=o(e),s.done=e>=t,s)}}_p.applyToOptions=t=>{const e=function(t,e=100,n){const i=n({...t,keyframes:[0,e]}),r=Math.min($d(i),Zd);return{type:"keyframes",ease:t=>i.next(r*t).value/e,duration:Eu(r)}}(t,100,_p);return t.ease=e.ease,t.duration=Tu(e.duration),t.type="keyframes",t};const Sp=t=>null!==t;function Tp(t,{repeat:e,repeatType:n="loop"},i,r=1){const s=t.filter(Sp),a=r<0||e&&"loop"!==n&&e%2==1?0:s.length-1;return a&&void 0!==i?i:s[a]}const Ep={decay:xp,inertia:xp,tween:wp,keyframes:wp,spring:_p};function Ap(t){"string"==typeof t.type&&(t.type=Ep[t.type])}class Cp{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const Rp=t=>t/100;class Pp extends Cp{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==Qu.now()&&this.tick(Qu.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),!1===t.autoplay&&this.pause()}initAnimation(){const{options:t}=this;Ap(t);const{type:e=wp,repeat:n=0,repeatDelay:i=0,repeatType:r,velocity:s=0}=t;let{keyframes:a}=t;const o=e||wp;o!==wp&&"number"!=typeof a[0]&&(this.mixKeyframes=Mu(Rp,qd(a[0],a[1])),a=[0,100]);const l=o({...t,keyframes:a});"mirror"===r&&(this.mirroredGenerator=o({...t,keyframes:[...a].reverse(),velocity:-s})),null===l.calculatedDuration&&(l.calculatedDuration=$d(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=l}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:n,totalDuration:i,mixKeyframes:r,mirroredGenerator:s,resolvedDuration:a,calculatedDuration:o}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:c,repeat:h,repeatType:u,repeatDelay:d,type:p,onUpdate:f,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?g<0:g>i;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=i);let y=this.currentTime,_=n;if(h){const t=Math.min(this.currentTime,i)/a;let e=Math.floor(t),n=t%1;!n&&t>=1&&(n=1),1===n&&e--,e=Math.min(e,h+1);Boolean(e%2)&&("reverse"===u?(n=1-n,d&&(n-=d/a)):"mirror"===u&&(_=s)),y=fu(0,1,n)*a}const x=v?{done:!1,value:c[0]}:_.next(y);r&&(x.value=r(x.value));let{done:b}=x;v||null===o||(b=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const M=null===this.holdTime&&("finished"===this.state||"running"===this.state&&b);return M&&p!==xp&&(x.value=Tp(c,this.options,m,this.speed)),f&&f(x.value),M&&this.finish(),x}then(t,e){return this.finished.then(t,e)}get duration(){return Eu(this.calculatedDuration)}get time(){return Eu(this.currentTime)}set time(t){t=Tu(t),this.currentTime=t,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Qu.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=Eu(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Yd,startTime:e}=this.options;this.driver||(this.driver=t(t=>this.tick(t))),this.options.onPlay?.();const n=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=n):null!==this.holdTime?this.startTime=n-this.holdTime:this.startTime||(this.startTime=e??n),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Qu.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}const Op=t=>180*t/Math.PI,Ip=t=>{const e=Op(Math.atan2(t[1],t[0]));return Lp(e)},Dp={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Ip,rotateZ:Ip,skewX:t=>Op(Math.atan(t[1])),skewY:t=>Op(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Lp=t=>((t%=360)<0&&(t+=360),t),Np=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Up=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Fp={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Np,scaleY:Up,scale:t=>(Np(t)+Up(t))/2,rotateX:t=>Lp(Op(Math.atan2(t[6],t[5]))),rotateY:t=>Lp(Op(Math.atan2(-t[2],t[0]))),rotateZ:Ip,rotate:Ip,skewX:t=>Op(Math.atan(t[4])),skewY:t=>Op(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function kp(t){return t.includes("scale")?1:0}function Bp(t,e){if(!t||"none"===t)return kp(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=Fp,r=n;else{const e=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=Dp,r=e}if(!r)return kp(e);const s=i[e],a=r[1].split(",").map(Vp);return"function"==typeof s?s(a):a[s]}const zp=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return Bp(n,e)};function Vp(t){return parseFloat(t.trim())}const Hp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Wp=(()=>new Set(Hp))(),jp=t=>t===sd||t===_d,Gp=new Set(["x","y","z"]),Xp=Hp.filter(t=>!Gp.has(t));const qp={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Bp(e,"x"),y:(t,{transform:e})=>Bp(e,"y")};qp.translateX=qp.x,qp.translateY=qp.y;const Yp=new Set;let Kp=!1,Zp=!1,$p=!1;function Jp(){if(Zp){const t=Array.from(Yp).filter(t=>t.needsMeasurement),e=new Set(t.map(t=>t.element)),n=new Map;e.forEach(t=>{const e=function(t){const e=[];return Xp.forEach(n=>{const i=t.getValue(n);void 0!==i&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e}(t);e.length&&(n.set(t,e),t.render())}),t.forEach(t=>t.measureInitialState()),e.forEach(t=>{t.render();const e=n.get(t);e&&e.forEach(([e,n])=>{t.getValue(e)?.set(n)})}),t.forEach(t=>t.measureEndState()),t.forEach(t=>{void 0!==t.suspendedScrollY&&window.scrollTo(0,t.suspendedScrollY)})}Zp=!1,Kp=!1,Yp.forEach(t=>t.complete($p)),Yp.clear()}function Qp(){Yp.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Zp=!0)})}class tf{constructor(t,e,n,i,r,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=n,this.motionValue=i,this.element=r,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(Yp.add(this),Kp||(Kp=!0,qu.read(Qp),qu.resolveKeyframes(Jp))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:n,motionValue:i}=this;if(null===t[0]){const r=i?.get(),s=t[t.length-1];if(void 0!==r)t[0]=r;else if(n&&e){const i=n.readValue(e,s);null!=i&&(t[0]=i)}void 0===t[0]&&(t[0]=s),i&&void 0===r&&i.set(t[0])}!function(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Yp.delete(this)}cancel(){"scheduled"===this.state&&(Yp.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const ef=_u(()=>void 0!==window.ScrollTimeline),nf={};function rf(t,e){const n=_u(t);return()=>nf[e]??n()}const sf=rf(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0},"linearEasing"),af=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,of={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:af([0,.65,.55,1]),circOut:af([.55,0,1,.45]),backIn:af([.31,.01,.66,-.59]),backOut:af([.33,1.53,.69,.99])};function lf(t,e){return t?"function"==typeof t?sf()?Kd(t,e):"ease-out":Hu(t)?af(t):Array.isArray(t)?t.map(t=>lf(t,e)||of.easeOut):of[t]:void 0}function cf(t,e,n,{delay:i=0,duration:r=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const h={[e]:n};l&&(h.offset=l);const u=lf(o,r);Array.isArray(u)&&(h.easing=u);const d={delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===a?"alternate":"normal"};c&&(d.pseudoElement=c);return t.animate(h,d)}function hf(t){return"function"==typeof t&&"applyToOptions"in t}class uf extends Cp{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:e,name:n,keyframes:i,pseudoElement:r,allowFlatten:s=!1,finalKeyframe:a,onComplete:o}=t;this.isPseudoElement=Boolean(r),this.allowFlatten=s,this.options=t,t.type;const l=function({type:t,...e}){return hf(t)&&sf()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}(t);this.animation=cf(e,n,i,l,r),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const t=Tp(i,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(t):function(t,e,n){(t=>t.startsWith("--"))(e)?t.style.setProperty(e,n):t.style[e]=n}(e,n,t),this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(t){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;"idle"!==t&&"finished"!==t&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Eu(Number(t))}get time(){return Eu(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Tu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&ef()?(this.animation.timeline=t,xu):e(this)}}const df={anticipate:Nu,backInOut:Lu,circInOut:ku};function pf(t){"string"==typeof t.ease&&t.ease in df&&(t.ease=df[t.ease])}class ff extends uf{constructor(t){pf(t),Ap(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:n,onComplete:i,element:r,...s}=this.options;if(!e)return;if(void 0!==t)return void e.set(t);const a=new Pp({...s,autoplay:!1}),o=Tu(this.finishedTime??this.time);e.setWithVelocity(a.sample(o-10).value,a.sample(o).value,10),a.stop()}}const mf=(t,e)=>"zIndex"!==e&&(!("number"!=typeof t&&!Array.isArray(t))||!("string"!=typeof t||!Dd.test(t)&&"0"!==t||t.startsWith("url(")));function gf(t){t.duration=0,t.type}const vf=new Set(["opacity","clipPath","filter","transform"]),yf=_u(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class _f extends Cp{constructor({autoplay:t=!0,delay:e=0,type:n="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:s="loop",keyframes:a,name:o,motionValue:l,element:c,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Qu.now();const u={autoplay:t,delay:e,type:n,repeat:i,repeatDelay:r,repeatType:s,name:o,motionValue:l,element:c,...h},d=c?.KeyframeResolver||tf;this.keyframeResolver=new d(a,(t,e,n)=>this.onKeyframesResolved(t,e,u,!n),o,l,c),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,e,n,i){this.keyframeResolver=void 0;const{name:r,type:s,velocity:a,delay:o,isHandoff:l,onUpdate:c}=n;this.resolvedAt=Qu.now(),function(t,e,n,i){const r=t[0];if(null===r)return!1;if("display"===e||"visibility"===e)return!0;const s=t[t.length-1],a=mf(r,e),o=mf(s,e);return!(!a||!o)&&(function(t){const e=t[0];if(1===t.length)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}(t)||("spring"===n||hf(n))&&i)}(t,r,s,a)||(!mu.instantAnimations&&o||c?.(Tp(t,n,e)),t[0]=t[t.length-1],gf(n),n.repeat=0);const h={startTime:i?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:e,...n,keyframes:t},u=!l&&function(t){const{motionValue:e,name:n,repeatDelay:i,repeatType:r,damping:s,type:a}=t,o=e?.owner?.current;if(!(o instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return yf()&&n&&vf.has(n)&&("transform"!==n||!c)&&!l&&!i&&"mirror"!==r&&0!==s&&"inertia"!==a}(h)?new ff({...h,element:h.motionValue.owner.current}):new Pp(h);u.finished.then(()=>this.notifyFinished()).catch(xu),this.pendingTimeline&&(this.stopTimeline=u.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=u}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),$p=!0,Qp(),Jp(),$p=!1),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const xf=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function bf(t,e,n=1){const[i,r]=function(t){const e=xf.exec(t);if(!e)return[,];const[,n,i,r]=e;return[`--${n??i}`,r]}(t);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const t=s.trim();return gu(t)?parseFloat(t):t}return id(r)?bf(r,e,n+1):r}function Mf(t,e){return t?.[e]??t?.default??t}const wf=new Set(["width","height","top","left","right","bottom",...Hp]),Sf=t=>e=>e.test(t),Tf=[sd,_d,yd,vd,bd,xd,{test:t=>"auto"===t,parse:t=>t}],Ef=t=>Tf.find(Sf(t));function Af(t){return"number"==typeof t?0===t:null===t||("none"===t||"0"===t||yu(t))}const Cf=new Set(["brightness","contrast","saturate","opacity"]);function Rf(t){const[e,n]=t.slice(0,-1).split("(");if("drop-shadow"===e)return t;const[i]=n.match(cd)||[];if(!i)return t;const r=n.replace(i,"");let s=Cf.has(e)?1:0;return i!==n&&(s*=100),e+"("+s+r+")"}const Pf=/\b([a-z-]*)\(.*?\)/gu,Of={...Dd,getAnimatableNone:t=>{const e=t.match(Pf);return e?e.map(Rf).join(" "):t}},If={...sd,transform:Math.round},Df={borderWidth:_d,borderTopWidth:_d,borderRightWidth:_d,borderBottomWidth:_d,borderLeftWidth:_d,borderRadius:_d,radius:_d,borderTopLeftRadius:_d,borderTopRightRadius:_d,borderBottomRightRadius:_d,borderBottomLeftRadius:_d,width:_d,maxWidth:_d,height:_d,maxHeight:_d,top:_d,right:_d,bottom:_d,left:_d,padding:_d,paddingTop:_d,paddingRight:_d,paddingBottom:_d,paddingLeft:_d,margin:_d,marginTop:_d,marginRight:_d,marginBottom:_d,marginLeft:_d,backgroundPositionX:_d,backgroundPositionY:_d,...{rotate:vd,rotateX:vd,rotateY:vd,rotateZ:vd,scale:od,scaleX:od,scaleY:od,scaleZ:od,skew:vd,skewX:vd,skewY:vd,distance:_d,translateX:_d,translateY:_d,translateZ:_d,x:_d,y:_d,z:_d,perspective:_d,transformPerspective:_d,opacity:ad,originX:Md,originY:Md,originZ:_d},zIndex:If,fillOpacity:ad,strokeOpacity:ad,numOctaves:If},Lf={...Df,color:Sd,backgroundColor:Sd,outlineColor:Sd,fill:Sd,stroke:Sd,borderColor:Sd,borderTopColor:Sd,borderRightColor:Sd,borderBottomColor:Sd,borderLeftColor:Sd,filter:Of,WebkitFilter:Of},Nf=t=>Lf[t];function Uf(t,e){let n=Nf(t);return n!==Of&&(n=Dd),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Ff=new Set(["auto","none","0"]);class kf extends tf{constructor(t,e,n,i,r){super(t,e,n,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:n}=this;if(!e||!e.current)return;super.readKeyframes();for(let o=0;o<t.length;o++){let n=t[o];if("string"==typeof n&&(n=n.trim(),id(n))){const i=bf(n,e.current);void 0!==i&&(t[o]=i),o===t.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!wf.has(n)||2!==t.length)return;const[i,r]=t,s=Ef(i),a=Ef(r);if(s!==a)if(jp(s)&&jp(a))for(let o=0;o<t.length;o++){const e=t[o];"string"==typeof e&&(t[o]=parseFloat(e))}else qp[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,n=[];for(let i=0;i<t.length;i++)(null===t[i]||Af(t[i]))&&n.push(i);n.length&&function(t,e,n){let i,r=0;for(;r<t.length&&!i;){const e=t[r];"string"==typeof e&&!Ff.has(e)&&Rd(e).values.length&&(i=t[r]),r++}if(i&&n)for(const s of e)t[s]=Uf(n,i)}(t,n,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:n}=this;if(!t||!t.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qp[n](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const i=e[e.length-1];void 0!==i&&t.getValue(n,i).jump(i,!1)}measureEndState(){const{element:t,name:e,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const i=t.getValue(e);i&&i.jump(this.measuredOrigin,!1);const r=n.length-1,s=n[r];n[r]=qp[e](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==s&&void 0===this.finalKeyframe&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([e,n])=>{t.getValue(e).set(n)}),this.resolveNoneKeyframes()}}const Bf=(t,e)=>e&&"number"==typeof t?e.transform(t):t;function zf(t){return vu(t)&&"offsetHeight"in t}const Vf={current:void 0};class Hf{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=t=>{const e=Qu.now();if(this.updatedAt!==e&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(t),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const n of this.dependents)n.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){var e;this.current=t,this.updatedAt=Qu.now(),null===this.canTrackVelocity&&void 0!==t&&(this.canTrackVelocity=(e=this.current,!isNaN(parseFloat(e))))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new Su);const n=this.events[t].add(e);return"change"===t?()=>{n(),qu.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,e,n){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return Vf.current&&Vf.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=Qu.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,30);return Au(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Wf(t,e){return new Hf(t,e)}const{schedule:jf}=Xu(queueMicrotask,!1),Gf={x:!1,y:!1};function Xf(){return Gf.x||Gf.y}function qf(t){return"x"===t||"y"===t?Gf[t]?null:(Gf[t]=!0,()=>{Gf[t]=!1}):Gf.x||Gf.y?null:(Gf.x=Gf.y=!0,()=>{Gf.x=Gf.y=!1})}function Yf(t,e){const n=function(t,e,n){if(t instanceof EventTarget)return[t];if("string"==typeof t){let e=document;const i=n?.[t]??e.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}(t),i=new AbortController;return[n,{passive:!0,...e,signal:i.signal},()=>i.abort()]}function Kf(t){return!("touch"===t.pointerType||Xf())}function Zf(t,e,n={}){const[i,r,s]=Yf(t,n),a=t=>{if(!Kf(t))return;const{target:n}=t,i=e(n,t);if("function"!=typeof i||!n)return;const s=t=>{Kf(t)&&(i(t),n.removeEventListener("pointerleave",s))};n.addEventListener("pointerleave",s,r)};return i.forEach(t=>{t.addEventListener("pointerenter",a,r)}),s}const $f=(t,e)=>!!e&&(t===e||$f(t,e.parentElement)),Jf=t=>"mouse"===t.pointerType?"number"!=typeof t.button||t.button<=0:!1!==t.isPrimary,Qf=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const tm=new WeakSet;function em(t){return e=>{"Enter"===e.key&&t(e)}}function nm(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}function im(t){return Jf(t)&&!Xf()}function rm(t,e,n={}){const[i,r,s]=Yf(t,n),a=t=>{const i=t.currentTarget;if(!im(t))return;tm.add(i);const s=e(i,t),a=(t,e)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),tm.has(i)&&tm.delete(i),im(t)&&"function"==typeof s&&s(t,{success:e})},o=t=>{a(t,i===window||i===document||n.useGlobalTarget||$f(i,t.target))},l=t=>{a(t,!1)};window.addEventListener("pointerup",o,r),window.addEventListener("pointercancel",l,r)};return i.forEach(t=>{var e;(n.useGlobalTarget?window:t).addEventListener("pointerdown",a,r),zf(t)&&(t.addEventListener("focus",t=>((t,e)=>{const n=t.currentTarget;if(!n)return;const i=em(()=>{if(tm.has(n))return;nm(n,"down");const t=em(()=>{nm(n,"up")});n.addEventListener("keyup",t,e),n.addEventListener("blur",()=>nm(n,"cancel"),e)});n.addEventListener("keydown",i,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),e)})(t,r)),e=t,Qf.has(e.tagName)||-1!==e.tabIndex||t.hasAttribute("tabindex")||(t.tabIndex=0))}),s}function sm(t){return vu(t)&&"ownerSVGElement"in t}function am(t){return sm(t)&&"svg"===t.tagName}function om(...t){const e=!Array.isArray(t[0]),n=e?0:-1,i=t[0+n],r=bp(t[1+n],t[2+n],t[3+n]);return e?r(i):r}const lm=t=>Boolean(t&&t.getVelocity);function cm(t,e,n){const i=t.get();let r,s=null,a=i;const o="string"==typeof i?i.replace(/[\d.-]/g,""):void 0,l=()=>{s&&(s.stop(),s=null)},c=()=>{l(),s=new Pp({keyframes:[um(t.get()),um(a)],velocity:t.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...n,onUpdate:r})};if(t.attach((e,n)=>(a=e,r=t=>n(hm(t,o)),qu.postRender(c),t.get()),l),lm(e)){const n=e.on("change",e=>t.set(hm(e,o))),i=t.on("destroy",n);return()=>{n(),i()}}return l}function hm(t,e){return e?t+e:t}function um(t){return"number"==typeof t?t:parseFloat(t)}const dm=[...Tf,Sd,Dd],pm=t=>dm.find(Sf(t)),fm=t=>{let e;const n=new Set,i=(t,i)=>{const r="function"==typeof t?t(e):t;if(!Object.is(r,e)){const t=e;e=(null!=i?i:"object"!=typeof r||null===r)?r:Object.assign({},e,r),n.forEach(n=>n(e,t))}},r=()=>e,s={setState:i,getState:r,getInitialState:()=>a,subscribe:t=>(n.add(t),()=>n.delete(t))},a=e=t(i,r,s);return s},mm=t=>t?fm(t):fm;function gm(t,e){let n;try{n=t()}catch(i){return}return{getItem:t=>{var e;const i=t=>null===t?null:JSON.parse(t,void 0),r=null!=(e=n.getItem(t))?e:null;return r instanceof Promise?r.then(i):i(r)},setItem:(t,e)=>n.setItem(t,JSON.stringify(e,void 0)),removeItem:t=>n.removeItem(t)}}const vm=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then:t=>vm(t)(n),catch(t){return this}}}catch(n){return{then(t){return this},catch:t=>vm(t)(n)}}},ym=(t,e)=>(n,i,r)=>{let s={storage:gm(()=>localStorage),partialize:t=>t,version:0,merge:(t,e)=>({...e,...t}),...e},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return t((...t)=>{n(...t)},i,r);const h=()=>{const t=s.partialize({...i()});return c.setItem(s.name,{state:t,version:s.version})},u=r.setState;r.setState=(t,e)=>(u(t,e),h());const d=t((...t)=>(n(...t),h()),i,r);let p;r.getInitialState=()=>d;const f=()=>{var t,e;if(!c)return;a=!1,o.forEach(t=>{var e;return t(null!=(e=i())?e:d)});const r=(null==(e=s.onRehydrateStorage)?void 0:e.call(s,null!=(t=i())?t:d))||void 0;return vm(c.getItem.bind(c))(s.name).then(t=>{if(t){if("number"!=typeof t.version||t.version===s.version)return[!1,t.state];if(s.migrate){const e=s.migrate(t.state,t.version);return e instanceof Promise?e.then(t=>[!0,t]):[!0,e]}}return[!1,void 0]}).then(t=>{var e;const[r,a]=t;if(p=s.merge(a,null!=(e=i())?e:d),n(p,!0),r)return h()}).then(()=>{null==r||r(p,void 0),p=i(),a=!0,l.forEach(t=>t(p))}).catch(t=>{null==r||r(void 0,t)})};return r.persist={setOptions:t=>{s={...s,...t},t.storage&&(c=t.storage)},clearStorage:()=>{null==c||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>f(),hasHydrated:()=>a,onHydrate:t=>(o.add(t),()=>{o.delete(t)}),onFinishHydration:t=>(l.add(t),()=>{l.delete(t)})},s.skipHydration||f(),p||d};var _m,xm={exports:{}};function bm(){return _m||(_m=1,function(t){function e(t){return function(e,n,i,r,s,a,o){return t(e,n,o)}}function n(t){return function(e,n,i,r){if(!e||!n||"object"!=typeof e||"object"!=typeof n)return t(e,n,i,r);var s=r.get(e),a=r.get(n);if(s&&a)return s===n&&a===e;r.set(e,n),r.set(n,e);var o=t(e,n,i,r);return r.delete(e),r.delete(n),o}}function i(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n}function r(t){return t.constructor===Object||null==t.constructor}function s(t){return"function"==typeof t.then}function a(t,e){return t===e||t!=t&&e!=e}var o="[object Arguments]",l="[object Boolean]",c="[object Date]",h="[object RegExp]",u="[object Map]",d="[object Number]",p="[object Object]",f="[object Set]",m="[object String]",g=Object.prototype.toString;function v(t){var e=t.areArraysEqual,n=t.areDatesEqual,i=t.areMapsEqual,v=t.areObjectsEqual,y=t.areRegExpsEqual,_=t.areSetsEqual,x=(0,t.createIsNestedEqual)(b);function b(t,b,M){if(t===b)return!0;if(!t||!b||"object"!=typeof t||"object"!=typeof b)return t!=t&&b!=b;if(r(t)&&r(b))return v(t,b,x,M);var w=Array.isArray(t),S=Array.isArray(b);if(w||S)return w===S&&e(t,b,x,M);var T=g.call(t);return T===g.call(b)&&(T===c?n(t,b,x,M):T===h?y(t,b,x,M):T===u?i(t,b,x,M):T===f?_(t,b,x,M):T===p||T===o?!s(t)&&!s(b)&&v(t,b,x,M):(T===l||T===d||T===m)&&a(t.valueOf(),b.valueOf()))}return b}function y(t,e,n,i){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n(t[r],e[r],r,r,t,e,i))return!1;return!0}var _=n(y);function x(t,e){return a(t.valueOf(),e.valueOf())}function b(t,e,n,i){var r=t.size===e.size;if(!r)return!1;if(!t.size)return!0;var s={},a=0;return t.forEach(function(o,l){if(r){var c=!1,h=0;e.forEach(function(r,u){c||s[h]||!(c=n(l,u,a,h,t,e,i)&&n(o,r,l,u,t,e,i))||(s[h]=!0),h++}),a++,r=c}}),r}var M=n(b),w="_owner",S=Object.prototype.hasOwnProperty;function T(t,e,n,i){var r,s=Object.keys(t),a=s.length;if(Object.keys(e).length!==a)return!1;for(;a-- >0;){if((r=s[a])===w){var o=!!t.$$typeof,l=!!e.$$typeof;if((o||l)&&o!==l)return!1}if(!S.call(e,r)||!n(t[r],e[r],r,r,t,e,i))return!1}return!0}var E=n(T);function A(t,e){return t.source===e.source&&t.flags===e.flags}function C(t,e,n,i){var r=t.size===e.size;if(!r)return!1;if(!t.size)return!0;var s={};return t.forEach(function(a,o){if(r){var l=!1,c=0;e.forEach(function(r,h){l||s[c]||!(l=n(a,r,o,h,t,e,i))||(s[c]=!0),c++}),r=l}}),r}var R=n(C),P=Object.freeze({areArraysEqual:y,areDatesEqual:x,areMapsEqual:b,areObjectsEqual:T,areRegExpsEqual:A,areSetsEqual:C,createIsNestedEqual:e}),O=Object.freeze({areArraysEqual:_,areDatesEqual:x,areMapsEqual:M,areObjectsEqual:E,areRegExpsEqual:A,areSetsEqual:R,createIsNestedEqual:e}),I=v(P);function D(t,e){return I(t,e,void 0)}var L=v(i(P,{createIsNestedEqual:function(){return a}}));function N(t,e){return L(t,e,void 0)}var U=v(O);function F(t,e){return U(t,e,new WeakMap)}var k=v(i(O,{createIsNestedEqual:function(){return a}}));function B(t,e){return k(t,e,new WeakMap)}function z(t){return v(i(P,t(P)))}function V(t){var e=v(i(O,t(O)));return function(t,n,i){return void 0===i&&(i=new WeakMap),e(t,n,i)}}t.circularDeepEqual=F,t.circularShallowEqual=B,t.createCustomCircularEqual=V,t.createCustomEqual=z,t.deepEqual=D,t.sameValueZeroEqual=a,t.shallowEqual=N,Object.defineProperty(t,"__esModule",{value:!0})}(xm.exports)),xm.exports}var Mm,wm,Sm,Tm,Em,Am={exports:{}};function Cm(){if(wm)return Mm;wm=1;return Mm="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function Rm(){if(Tm)return Sm;Tm=1;var t=Cm();function e(){}function n(){}return n.resetWarningCache=e,Sm=function(){function i(e,n,i,r,s,a){if(a!==t){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function r(){return i}i.isRequired=i;var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:r,element:i,elementType:i,instanceOf:r,node:i,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s}}function Pm(){return Em||(Em=1,Am.exports=Rm()()),Am.exports}var Om=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some(function(t,i){return t[0]===e&&(n=i,!0)}),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n++){var r=i[n];t.call(e,r[1],r[0])}},e}()}(),Im="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Dm="undefined"!=typeof globalThis&&globalThis.Math===Math?globalThis:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Lm="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Dm):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)};var Nm=["top","right","bottom","left","width","height","size","weight"],Um="undefined"!=typeof MutationObserver,Fm=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,i=!1,r=0;function s(){n&&(n=!1,t()),i&&o()}function a(){Lm(s)}function o(){var t=Date.now();if(n){if(t-r<2)return;i=!0}else n=!0,i=!1,setTimeout(a,e);r=t}return o}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},t.prototype.connect_=function(){Im&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Um?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Im&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;Nm.some(function(t){return!!~n.indexOf(t)})&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),km=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},Bm=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Dm},zm=Xm(0,0,0,0);function Vm(t){return parseFloat(t)||0}function Hm(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(e,n){return e+Vm(t["border-"+n+"-width"])},0)}function Wm(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return zm;var i=Bm(t).getComputedStyle(t),r=function(t){for(var e={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var r=i[n],s=t["padding-"+r];e[r]=Vm(s)}return e}(i),s=r.left+r.right,a=r.top+r.bottom,o=Vm(i.width),l=Vm(i.height);if("border-box"===i.boxSizing&&(Math.round(o+s)!==e&&(o-=Hm(i,"left","right")+s),Math.round(l+a)!==n&&(l-=Hm(i,"top","bottom")+a)),!function(t){return t===Bm(t).document.documentElement}(t)){var c=Math.round(o+s)-e,h=Math.round(l+a)-n;1!==Math.abs(c)&&(o-=c),1!==Math.abs(h)&&(l-=h)}return Xm(r.left,r.top,o,l)}var jm="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof Bm(t).SVGGraphicsElement}:function(t){return t instanceof Bm(t).SVGElement&&"function"==typeof t.getBBox};function Gm(t){return Im?jm(t)?function(t){var e=t.getBBox();return Xm(0,0,e.width,e.height)}(t):Wm(t):zm}function Xm(t,e,n,i){return{x:t,y:e,width:n,height:i}}var qm=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Xm(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=Gm(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Ym=function(){return function(t,e){var n=function(t){var e=t.x,n=t.y,i=t.width,r=t.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(s.prototype);return km(a,{x:e,y:n,width:i,height:r,top:n,right:e+i,bottom:r+n,left:e}),a}(e);km(this,{target:t,contentRect:n})}}(),Km=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new Om,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Bm(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new qm(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Bm(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(t){return new Ym(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Zm="undefined"!=typeof WeakMap?new WeakMap:new Om,$m=function(){return function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Fm.getInstance(),i=new Km(e,n,this);Zm.set(this,i)}}();["observe","unobserve","disconnect"].forEach(function(t){$m.prototype[t]=function(){var e;return(e=Zm.get(this))[t].apply(e,arguments)}});var Jm=void 0!==Dm.ResizeObserver?Dm.ResizeObserver:$m;const Qm=zt(Object.freeze(Object.defineProperty({__proto__:null,default:Jm},Symbol.toStringTag,{value:"Module"})));function tg(){for(var t,e,n=0,i="";n<arguments.length;)(t=arguments[n++])&&(e=eg(t))&&(i&&(i+=" "),i+=e);return i}function eg(t){if("string"==typeof t)return t;for(var e,n="",i=0;i<t.length;i++)t[i]&&(e=eg(t[i]))&&(n&&(n+=" "),n+=e);return n}function ng(t){var e=function(t){var e=t.theme,n=t.prefix,i={nextPart:new Map,validators:[]},r=function(t,e){if(!e)return t;return t.map(function(t){return[t[0],t[1].map(function(t){return"string"==typeof t?e+t:"object"==typeof t?Object.fromEntries(Object.entries(t).map(function(t){var n=t[0],i=t[1];return[e+n,i]})):t})]})}(Object.entries(t.classGroups),n);return r.forEach(function(t){var n=t[0];sg(t[1],i,n,e)}),i}(t),n=t.conflictingClassGroups,i=t.conflictingClassGroupModifiers,r=void 0===i?{}:i;return{getClassGroupId:function(t){var n=t.split("-");return""===n[0]&&1!==n.length&&n.shift(),ig(n,e)||function(t){if(rg.test(t)){var e=rg.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}(t)},getConflictingClassGroupIds:function(t,e){var i=n[t]||[];return e&&r[t]?[].concat(i,r[t]):i}}}function ig(t,e){if(0===t.length)return e.classGroupId;var n=t[0],i=e.nextPart.get(n),r=i?ig(t.slice(1),i):void 0;if(r)return r;if(0!==e.validators.length){var s=t.join("-");return e.validators.find(function(t){return(0,t.validator)(s)})?.classGroupId}}var rg=/^\[(.+)\]$/;function sg(t,e,n,i){t.forEach(function(t){if("string"!=typeof t){if("function"==typeof t)return t.isThemeGetter?void sg(t(i),e,n,i):void e.validators.push({validator:t,classGroupId:n});Object.entries(t).forEach(function(t){var r=t[0];sg(t[1],ag(e,r),n,i)})}else{(""===t?e:ag(e,t)).classGroupId=n}})}function ag(t,e){var n=t;return e.split("-").forEach(function(t){n.nextPart.has(t)||n.nextPart.set(t,{nextPart:new Map,validators:[]}),n=n.nextPart.get(t)}),n}function og(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,i=new Map;function r(r,s){n.set(r,s),++e>t&&(e=0,i=n,n=new Map)}return{get:function(t){var e=n.get(t);return void 0!==e?e:void 0!==(e=i.get(t))?(r(t,e),e):void 0},set:function(t,e){n.has(t)?n.set(t,e):r(t,e)}}}function lg(t){var e=t.separator||":",n=1===e.length,i=e[0],r=e.length;return function(t){for(var s,a=[],o=0,l=0,c=0;c<t.length;c++){var h=t[c];if(0===o){if(h===i&&(n||t.slice(c,c+r)===e)){a.push(t.slice(l,c)),l=c+r;continue}if("/"===h){s=c;continue}}"["===h?o++:"]"===h&&o--}var u=0===a.length?t:t.substring(l),d=u.startsWith("!");return{modifiers:a,hasImportantModifier:d,baseClassName:d?u.substring(1):u,maybePostfixModifierPosition:s&&s>l?s-l:void 0}}}var cg=/\s+/;function hg(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i,r,s,a=function(t){var n=e[0],l=e.slice(1).reduce(function(t,e){return e(t)},n());return i=function(t){return{cache:og(t.cacheSize),splitModifiers:lg(t),...ng(t)}}(l),r=i.cache.get,s=i.cache.set,a=o,o(t)};function o(t){var e=r(t);if(e)return e;var n=function(t,e){var n=e.splitModifiers,i=e.getClassGroupId,r=e.getConflictingClassGroupIds,s=new Set;return t.trim().split(cg).map(function(t){var e=n(t),r=e.modifiers,s=e.hasImportantModifier,a=e.baseClassName,o=e.maybePostfixModifierPosition,l=i(o?a.substring(0,o):a),c=Boolean(o);if(!l){if(!o)return{isTailwindClass:!1,originalClassName:t};if(!(l=i(a)))return{isTailwindClass:!1,originalClassName:t};c=!1}var h=function(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(t){"["===t[0]?(e.push.apply(e,n.sort().concat([t])),n=[]):n.push(t)}),e.push.apply(e,n.sort()),e}(r).join(":");return{isTailwindClass:!0,modifierId:s?h+"!":h,classGroupId:l,originalClassName:t,hasPostfixModifier:c}}).reverse().filter(function(t){if(!t.isTailwindClass)return!0;var e=t.modifierId,n=t.classGroupId,i=t.hasPostfixModifier,a=e+n;return!s.has(a)&&(s.add(a),r(n,i).forEach(function(t){return s.add(e+t)}),!0)}).reverse().map(function(t){return t.originalClassName}).join(" ")}(t,i);return s(t,n),n}return function(){return a(tg.apply(null,arguments))}}function ug(t){var e=function(e){return e[t]||[]};return e.isThemeGetter=!0,e}var dg=/^\[(?:([a-z-]+):)?(.+)\]$/i,pg=/^\d+\/\d+$/,fg=new Set(["px","full","screen"]),mg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gg=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,vg=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function yg(t){return Sg(t)||fg.has(t)||pg.test(t)||_g(t)}function _g(t){return Og(t,"length",Ig)}function xg(t){return Og(t,"size",Dg)}function bg(t){return Og(t,"position",Dg)}function Mg(t){return Og(t,"url",Lg)}function wg(t){return Og(t,"number",Sg)}function Sg(t){return!Number.isNaN(Number(t))}function Tg(t){return t.endsWith("%")&&Sg(t.slice(0,-1))}function Eg(t){return Ng(t)||Og(t,"number",Ng)}function Ag(t){return dg.test(t)}function Cg(){return!0}function Rg(t){return mg.test(t)}function Pg(t){return Og(t,"",Ug)}function Og(t,e,n){var i=dg.exec(t);return!!i&&(i[1]?i[1]===e:n(i[2]))}function Ig(t){return gg.test(t)}function Dg(){return!1}function Lg(t){return t.startsWith("url(")}function Ng(t){return Number.isInteger(Number(t))}function Ug(t){return vg.test(t)}function Fg(){var t=ug("colors"),e=ug("spacing"),n=ug("blur"),i=ug("brightness"),r=ug("borderColor"),s=ug("borderRadius"),a=ug("borderSpacing"),o=ug("borderWidth"),l=ug("contrast"),c=ug("grayscale"),h=ug("hueRotate"),u=ug("invert"),d=ug("gap"),p=ug("gradientColorStops"),f=ug("gradientColorStopPositions"),m=ug("inset"),g=ug("margin"),v=ug("opacity"),y=ug("padding"),_=ug("saturate"),x=ug("scale"),b=ug("sepia"),M=ug("skew"),w=ug("space"),S=ug("translate"),T=function(){return["auto",Ag,e]},E=function(){return[Ag,e]},A=function(){return["",yg]},C=function(){return["auto",Sg,Ag]},R=function(){return["","0",Ag]},P=function(){return[Sg,wg]},O=function(){return[Sg,Ag]};return{cacheSize:500,theme:{colors:[Cg],spacing:[yg],blur:["none","",Rg,Ag],brightness:P(),borderColor:[t],borderRadius:["none","","full",Rg,Ag],borderSpacing:E(),borderWidth:A(),contrast:P(),grayscale:R(),hueRotate:O(),invert:R(),gap:E(),gradientColorStops:[t],gradientColorStopPositions:[Tg,_g],inset:T(),margin:T(),opacity:P(),padding:E(),saturate:P(),scale:P(),sepia:R(),skew:O(),space:E(),translate:E()},classGroups:{aspect:[{aspect:["auto","square","video",Ag]}],container:["container"],columns:[{columns:[Rg]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[Ag])}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Eg]}],basis:[{basis:T()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ag]}],grow:[{grow:R()}],shrink:[{shrink:R()}],order:[{order:["first","last","none",Eg]}],"grid-cols":[{"grid-cols":[Cg]}],"col-start-end":[{col:["auto",{span:["full",Eg]},Ag]}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":[Cg]}],"row-start-end":[{row:["auto",{span:[Eg]},Ag]}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ag]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ag]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal"].concat(["start","end","center","between","around","evenly","stretch"])}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[w]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[w]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Ag,e]}],"min-w":[{"min-w":["min","max","fit",Ag,yg]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Rg]},Rg,Ag]}],h:[{h:[Ag,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Ag,yg]}],"max-h":[{"max-h":[Ag,e,"min","max","fit"]}],"font-size":[{text:["base",Rg,_g]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",wg]}],"font-family":[{font:[Cg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ag]}],"line-clamp":[{"line-clamp":["none",Sg,wg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ag,yg]}],"list-image":[{"list-image":["none",Ag]}],"list-style-type":[{list:["none","disc","decimal",Ag]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(["solid","dashed","dotted","double","none"],["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",yg]}],"underline-offset":[{"underline-offset":["auto",Ag,yg]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ag]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ag]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[bg])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",xg]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Mg]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(["solid","dashed","dotted","double","none"],["hidden"])}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:[""].concat(["solid","dashed","dotted","double","none"])}],"outline-offset":[{"outline-offset":[Ag,yg]}],"outline-w":[{outline:[yg]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:A()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[yg]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Rg,Pg]}],"shadow-color":[{shadow:[Cg]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Rg,Ag]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[u]}],saturate:[{saturate:[_]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ag]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",Ag]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ag]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[Eg,Ag]}],"translate-x":[{"translate-x":[S]}],"translate-y":[{"translate-y":[S]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ag]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ag]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ag]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[yg,wg]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var kg=hg(Fg);function Bg(t,e){return function(){return t.apply(e,arguments)}}const{toString:zg}=Object.prototype,{getPrototypeOf:Vg}=Object,{iterator:Hg,toStringTag:Wg}=Symbol,jg=(t=>e=>{const n=zg.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Gg=t=>(t=t.toLowerCase(),e=>jg(e)===t),Xg=t=>e=>typeof e===t,{isArray:qg}=Array,Yg=Xg("undefined");function Kg(t){return null!==t&&!Yg(t)&&null!==t.constructor&&!Yg(t.constructor)&&Jg(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Zg=Gg("ArrayBuffer");const $g=Xg("string"),Jg=Xg("function"),Qg=Xg("number"),tv=t=>null!==t&&"object"==typeof t,ev=t=>{if("object"!==jg(t))return!1;const e=Vg(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Wg in t||Hg in t)},nv=Gg("Date"),iv=Gg("File"),rv=Gg("Blob"),sv=Gg("FileList"),av=Gg("URLSearchParams"),[ov,lv,cv,hv]=["ReadableStream","Request","Response","Headers"].map(Gg);function uv(t,e,{allOwnKeys:n=!1}={}){if(null==t)return;let i,r;if("object"!=typeof t&&(t=[t]),qg(t))for(i=0,r=t.length;i<r;i++)e.call(null,t[i],i,t);else{if(Kg(t))return;const r=n?Object.getOwnPropertyNames(t):Object.keys(t),s=r.length;let a;for(i=0;i<s;i++)a=r[i],e.call(null,t[a],a,t)}}function dv(t,e){if(Kg(t))return null;e=e.toLowerCase();const n=Object.keys(t);let i,r=n.length;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const pv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:globalThis,fv=t=>!Yg(t)&&t!==pv;const mv=(t=>e=>t&&e instanceof t)("undefined"!=typeof Uint8Array&&Vg(Uint8Array)),gv=Gg("HTMLFormElement"),vv=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),yv=Gg("RegExp"),_v=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};uv(n,(n,r)=>{let s;!1!==(s=e(n,r,t))&&(i[r]=s||n)}),Object.defineProperties(t,i)};const xv=Gg("AsyncFunction"),bv=(Mv="function"==typeof setImmediate,wv=Jg(pv.postMessage),Mv?setImmediate:wv?(Sv=`axios@${Math.random()}`,Tv=[],pv.addEventListener("message",({source:t,data:e})=>{t===pv&&e===Sv&&Tv.length&&Tv.shift()()},!1),t=>{Tv.push(t),pv.postMessage(Sv,"*")}):t=>setTimeout(t));var Mv,wv,Sv,Tv;const Ev="undefined"!=typeof queueMicrotask?queueMicrotask.bind(pv):"undefined"!=typeof process&&process.nextTick||bv,Av={isArray:qg,isArrayBuffer:Zg,isBuffer:Kg,isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||Jg(t.append)&&("formdata"===(e=jg(t))||"object"===e&&Jg(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&Zg(t.buffer),e},isString:$g,isNumber:Qg,isBoolean:t=>!0===t||!1===t,isObject:tv,isPlainObject:ev,isEmptyObject:t=>{if(!tv(t)||Kg(t))return!1;try{return 0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype}catch(e){return!1}},isReadableStream:ov,isRequest:lv,isResponse:cv,isHeaders:hv,isUndefined:Yg,isDate:nv,isFile:iv,isBlob:rv,isRegExp:yv,isFunction:Jg,isStream:t=>tv(t)&&Jg(t.pipe),isURLSearchParams:av,isTypedArray:mv,isFileList:sv,forEach:uv,merge:function t(){const{caseless:e,skipUndefined:n}=fv(this)&&this||{},i={},r=(r,s)=>{const a=e&&dv(i,s)||s;ev(i[a])&&ev(r)?i[a]=t(i[a],r):ev(r)?i[a]=t({},r):qg(r)?i[a]=r.slice():n&&Yg(r)||(i[a]=r)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&uv(arguments[s],r);return i},extend:(t,e,n,{allOwnKeys:i}={})=>(uv(e,(e,i)=>{n&&Jg(e)?t[i]=Bg(e,n):t[i]=e},{allOwnKeys:i}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,i)=>{let r,s,a;const o={};if(e=e||{},null==t)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)a=r[s],i&&!i(a,t,e)||o[a]||(e[a]=t[a],o[a]=!0);t=!1!==n&&Vg(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:jg,kindOfTest:Gg,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return-1!==i&&i===n},toArray:t=>{if(!t)return null;if(qg(t))return t;let e=t.length;if(!Qg(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[Hg]).call(t);let i;for(;(i=n.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const i=[];for(;null!==(n=t.exec(e));)i.push(n);return i},isHTMLForm:gv,hasOwnProperty:vv,hasOwnProp:vv,reduceDescriptors:_v,freezeMethods:t=>{_v(t,(e,n)=>{if(Jg(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=t[n];Jg(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(t,e)=>{const n={},i=t=>{t.forEach(t=>{n[t]=!0})};return qg(t)?i(t):i(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,n){return e.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:dv,global:pv,isContextDefined:fv,isSpecCompliantForm:function(t){return!!(t&&Jg(t.append)&&"FormData"===t[Wg]&&t[Hg])},toJSONObject:t=>{const e=new Array(10),n=(t,i)=>{if(tv(t)){if(e.indexOf(t)>=0)return;if(Kg(t))return t;if(!("toJSON"in t)){e[i]=t;const r=qg(t)?[]:{};return uv(t,(t,e)=>{const s=n(t,i+1);!Yg(s)&&(r[e]=s)}),e[i]=void 0,r}}return t};return n(t,0)},isAsyncFn:xv,isThenable:t=>t&&(tv(t)||Jg(t))&&Jg(t.then)&&Jg(t.catch),setImmediate:bv,asap:Ev,isIterable:t=>null!=t&&Jg(t[Hg])};function Cv(t,e,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Av.inherits(Cv,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Av.toJSONObject(this.config),code:this.code,status:this.status}}});const Rv=Cv.prototype,Pv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Pv[t]={value:t}}),Object.defineProperties(Cv,Pv),Object.defineProperty(Rv,"isAxiosError",{value:!0}),Cv.from=(t,e,n,i,r,s)=>{const a=Object.create(Rv);Av.toFlatObject(t,a,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t);const o=t&&t.message?t.message:"Error",l=null==e&&t?t.code:e;return Cv.call(a,o,l,n,i,r),t&&null==a.cause&&Object.defineProperty(a,"cause",{value:t,configurable:!0}),a.name=t&&t.name||"Error",s&&Object.assign(a,s),a};function Ov(t){return Av.isPlainObject(t)||Av.isArray(t)}function Iv(t){return Av.endsWith(t,"[]")?t.slice(0,-2):t}function Dv(t,e,n){return t?t.concat(e).map(function(t,e){return t=Iv(t),!n&&e?"["+t+"]":t}).join(n?".":""):e}const Lv=Av.toFlatObject(Av,{},null,function(t){return/^is[A-Z]/.test(t)});function Nv(t,e,n){if(!Av.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const i=(n=Av.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!Av.isUndefined(e[t])})).metaTokens,r=n.visitor||c,s=n.dots,a=n.indexes,o=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Av.isSpecCompliantForm(e);if(!Av.isFunction(r))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(Av.isDate(t))return t.toISOString();if(Av.isBoolean(t))return t.toString();if(!o&&Av.isBlob(t))throw new Cv("Blob is not supported. Use a Buffer instead.");return Av.isArrayBuffer(t)||Av.isTypedArray(t)?o&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,n,r){let o=t;if(t&&!r&&"object"==typeof t)if(Av.endsWith(n,"{}"))n=i?n:n.slice(0,-2),t=JSON.stringify(t);else if(Av.isArray(t)&&function(t){return Av.isArray(t)&&!t.some(Ov)}(t)||(Av.isFileList(t)||Av.endsWith(n,"[]"))&&(o=Av.toArray(t)))return n=Iv(n),o.forEach(function(t,i){!Av.isUndefined(t)&&null!==t&&e.append(!0===a?Dv([n],i,s):null===a?n:n+"[]",l(t))}),!1;return!!Ov(t)||(e.append(Dv(r,n,s),l(t)),!1)}const h=[],u=Object.assign(Lv,{defaultVisitor:c,convertValue:l,isVisitable:Ov});if(!Av.isObject(t))throw new TypeError("data must be an object");return function t(n,i){if(!Av.isUndefined(n)){if(-1!==h.indexOf(n))throw Error("Circular reference detected in "+i.join("."));h.push(n),Av.forEach(n,function(n,s){!0===(!(Av.isUndefined(n)||null===n)&&r.call(e,n,Av.isString(s)?s.trim():s,i,u))&&t(n,i?i.concat(s):[s])}),h.pop()}}(t),e}function Uv(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function Fv(t,e){this._pairs=[],t&&Nv(t,this,e)}const kv=Fv.prototype;function Bv(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function zv(t,e,n){if(!e)return t;const i=n&&n.encode||Bv;Av.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(s=r?r(e,n):Av.isURLSearchParams(e)?e.toString():new Fv(e,n).toString(i),s){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+s}return t}kv.append=function(t,e){this._pairs.push([t,e])},kv.toString=function(t){const e=t?function(e){return t.call(this,e,Uv)}:Uv;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};class Vv{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Av.forEach(this.handlers,function(e){null!==e&&t(e)})}}const Hv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Wv={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Fv,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},jv="undefined"!=typeof window&&"undefined"!=typeof document,Gv="object"==typeof navigator&&navigator||void 0,Xv=jv&&(!Gv||["ReactNative","NativeScript","NS"].indexOf(Gv.product)<0),qv="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Yv=jv&&window.location.href||"http://localhost",Kv={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jv,hasStandardBrowserEnv:Xv,hasStandardBrowserWebWorkerEnv:qv,navigator:Gv,origin:Yv},Symbol.toStringTag,{value:"Module"})),...Wv};function Zv(t){function e(t,n,i,r){let s=t[r++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=r>=t.length;if(s=!s&&Av.isArray(i)?i.length:s,o)return Av.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a;i[s]&&Av.isObject(i[s])||(i[s]=[]);return e(t,n,i[s],r)&&Av.isArray(i[s])&&(i[s]=function(t){const e={},n=Object.keys(t);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],e[s]=t[s];return e}(i[s])),!a}if(Av.isFormData(t)&&Av.isFunction(t.entries)){const n={};return Av.forEachEntry(t,(t,i)=>{e(function(t){return Av.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),i,n,0)}),n}return null}const $v={transitional:Hv,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,r=Av.isObject(t);r&&Av.isHTMLForm(t)&&(t=new FormData(t));if(Av.isFormData(t))return i?JSON.stringify(Zv(t)):t;if(Av.isArrayBuffer(t)||Av.isBuffer(t)||Av.isStream(t)||Av.isFile(t)||Av.isBlob(t)||Av.isReadableStream(t))return t;if(Av.isArrayBufferView(t))return t.buffer;if(Av.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return Nv(t,new Kv.classes.URLSearchParams,{visitor:function(t,e,n,i){return Kv.isNode&&Av.isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}(t,this.formSerializer).toString();if((s=Av.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Nv(s?{"files[]":t}:t,e&&new e,this.formSerializer)}}return r||i?(e.setContentType("application/json",!1),function(t,e,n){if(Av.isString(t))try{return(e||JSON.parse)(t),Av.trim(t)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||$v.transitional,n=e&&e.forcedJSONParsing,i="json"===this.responseType;if(Av.isResponse(t)||Av.isReadableStream(t))return t;if(t&&Av.isString(t)&&(n&&!this.responseType||i)){const n=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(r){if(n){if("SyntaxError"===r.name)throw Cv.from(r,Cv.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Kv.classes.FormData,Blob:Kv.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Av.forEach(["delete","get","head","post","put","patch"],t=>{$v.headers[t]={}});const Jv=Av.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Qv=Symbol("internals");function ty(t){return t&&String(t).trim().toLowerCase()}function ey(t){return!1===t||null==t?t:Av.isArray(t)?t.map(ey):String(t)}function ny(t,e,n,i,r){return Av.isFunction(i)?i.call(this,e,n):(r&&(e=n),Av.isString(e)?Av.isString(i)?-1!==e.indexOf(i):Av.isRegExp(i)?i.test(e):void 0:void 0)}let iy=class{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function r(t,e,n){const r=ty(e);if(!r)throw new Error("header name must be a non-empty string");const s=Av.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||e]=ey(t))}const s=(t,e)=>Av.forEach(t,(t,n)=>r(t,n,e));if(Av.isPlainObject(t)||t instanceof this.constructor)s(t,e);else if(Av.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))s((t=>{const e={};let n,i,r;return t&&t.split("\n").forEach(function(t){r=t.indexOf(":"),n=t.substring(0,r).trim().toLowerCase(),i=t.substring(r+1).trim(),!n||e[n]&&Jv[n]||("set-cookie"===n?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)}),e})(t),e);else if(Av.isObject(t)&&Av.isIterable(t)){let n,i,r={};for(const e of t){if(!Av.isArray(e))throw TypeError("Object iterator must return a key-value pair");r[i=e[0]]=(n=r[i])?Av.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}s(r,e)}else null!=t&&r(e,t,n);return this}get(t,e){if(t=ty(t)){const n=Av.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}(t);if(Av.isFunction(e))return e.call(this,t,n);if(Av.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=ty(t)){const n=Av.findKey(this,t);return!(!n||void 0===this[n]||e&&!ny(0,this[n],n,e))}return!1}delete(t,e){const n=this;let i=!1;function r(t){if(t=ty(t)){const r=Av.findKey(n,t);!r||e&&!ny(0,n[r],r,e)||(delete n[r],i=!0)}}return Av.isArray(t)?t.forEach(r):r(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const r=e[n];t&&!ny(0,this[r],r,t,!0)||(delete this[r],i=!0)}return i}normalize(t){const e=this,n={};return Av.forEach(this,(i,r)=>{const s=Av.findKey(n,r);if(s)return e[s]=ey(i),void delete e[r];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}(r):String(r).trim();a!==r&&delete e[r],e[a]=ey(i),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return Av.forEach(this,(n,i)=>{null!=n&&!1!==n&&(e[i]=t&&Av.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(t=>n.set(t)),n}static accessor(t){const e=(this[Qv]=this[Qv]={accessors:{}}).accessors,n=this.prototype;function i(t){const i=ty(t);e[i]||(!function(t,e){const n=Av.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(t,n,r){return this[i].call(this,e,t,n,r)},configurable:!0})})}(n,t),e[i]=!0)}return Av.isArray(t)?t.forEach(i):i(t),this}};function ry(t,e){const n=this||$v,i=e||n,r=iy.from(i.headers);let s=i.data;return Av.forEach(t,function(t){s=t.call(n,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function sy(t){return!(!t||!t.__CANCEL__)}function ay(t,e,n){Cv.call(this,null==t?"canceled":t,Cv.ERR_CANCELED,e,n),this.name="CanceledError"}function oy(t,e,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(new Cv("Request failed with status code "+n.status,[Cv.ERR_BAD_REQUEST,Cv.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}iy.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Av.reduceDescriptors(iy.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}}),Av.freezeMethods(iy),Av.inherits(ay,Cv,{__CANCEL__:!0});const ly=(t,e,n=3)=>{let i=0;const r=function(t,e){t=t||10;const n=new Array(t),i=new Array(t);let r,s=0,a=0;return e=void 0!==e?e:1e3,function(o){const l=Date.now(),c=i[a];r||(r=l),n[s]=o,i[s]=l;let h=a,u=0;for(;h!==s;)u+=n[h++],h%=t;if(s=(s+1)%t,s===a&&(a=(a+1)%t),l-r<e)return;const d=c&&l-c;return d?Math.round(1e3*u/d):void 0}}(50,250);return function(t,e){let n,i,r=0,s=1e3/e;const a=(e,s=Date.now())=>{r=s,n=null,i&&(clearTimeout(i),i=null),t(...e)};return[(...t)=>{const e=Date.now(),o=e-r;o>=s?a(t,e):(n=t,i||(i=setTimeout(()=>{i=null,a(n)},s-o)))},()=>n&&a(n)]}(n=>{const s=n.loaded,a=n.lengthComputable?n.total:void 0,o=s-i,l=r(o);i=s;t({loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&s<=a?(a-s)/l:void 0,event:n,lengthComputable:null!=a,[e?"download":"upload"]:!0})},n)},cy=(t,e)=>{const n=null!=t;return[i=>e[0]({lengthComputable:n,total:t,loaded:i}),e[1]]},hy=t=>(...e)=>Av.asap(()=>t(...e)),uy=Kv.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Kv.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Kv.origin),Kv.navigator&&/(msie|trident)/i.test(Kv.navigator.userAgent)):()=>!0,dy=Kv.hasStandardBrowserEnv?{write(t,e,n,i,r,s){const a=[t+"="+encodeURIComponent(e)];Av.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),Av.isString(i)&&a.push("path="+i),Av.isString(r)&&a.push("domain="+r),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function py(t,e,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(i||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const fy=t=>t instanceof iy?{...t}:t;function my(t,e){e=e||{};const n={};function i(t,e,n,i){return Av.isPlainObject(t)&&Av.isPlainObject(e)?Av.merge.call({caseless:i},t,e):Av.isPlainObject(e)?Av.merge({},e):Av.isArray(e)?e.slice():e}function r(t,e,n,r){return Av.isUndefined(e)?Av.isUndefined(t)?void 0:i(void 0,t,0,r):i(t,e,0,r)}function s(t,e){if(!Av.isUndefined(e))return i(void 0,e)}function a(t,e){return Av.isUndefined(e)?Av.isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function o(n,r,s){return s in e?i(n,r):s in t?i(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(t,e,n)=>r(fy(t),fy(e),0,!0)};return Av.forEach(Object.keys({...t,...e}),function(i){const s=l[i]||r,a=s(t[i],e[i],i);Av.isUndefined(a)&&s!==o||(n[i]=a)}),n}const gy=t=>{const e=my({},t);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:a,auth:o}=e;if(e.headers=a=iy.from(a),e.url=zv(py(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Av.isFormData(n))if(Kv.hasStandardBrowserEnv||Kv.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(Av.isFunction(n.getHeaders)){const t=n.getHeaders(),e=["content-type","content-length"];Object.entries(t).forEach(([t,n])=>{e.includes(t.toLowerCase())&&a.set(t,n)})}if(Kv.hasStandardBrowserEnv&&(i&&Av.isFunction(i)&&(i=i(e)),i||!1!==i&&uy(e.url))){const t=r&&s&&dy.read(s);t&&a.set(r,t)}return e},vy="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise(function(e,n){const i=gy(t);let r=i.data;const s=iy.from(i.headers).normalize();let a,o,l,c,h,{responseType:u,onUploadProgress:d,onDownloadProgress:p}=i;function f(){c&&c(),h&&h(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=iy.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());oy(function(t){e(t),f()},function(t){n(t),f()},{data:u&&"text"!==u&&"json"!==u?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:t,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new Cv("Request aborted",Cv.ECONNABORTED,t,m)),m=null)},m.onerror=function(e){const i=new Cv(e&&e.message?e.message:"Network Error",Cv.ERR_NETWORK,t,m);i.event=e||null,n(i),m=null},m.ontimeout=function(){let e=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Hv;i.timeoutErrorMessage&&(e=i.timeoutErrorMessage),n(new Cv(e,r.clarifyTimeoutError?Cv.ETIMEDOUT:Cv.ECONNABORTED,t,m)),m=null},void 0===r&&s.setContentType(null),"setRequestHeader"in m&&Av.forEach(s.toJSON(),function(t,e){m.setRequestHeader(e,t)}),Av.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),u&&"json"!==u&&(m.responseType=i.responseType),p&&([l,h]=ly(p,!0),m.addEventListener("progress",l)),d&&m.upload&&([o,c]=ly(d),m.upload.addEventListener("progress",o),m.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(a=e=>{m&&(n(!e||e.type?new ay(null,t,m):e),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(i.url);v&&-1===Kv.protocols.indexOf(v)?n(new Cv("Unsupported protocol "+v+":",Cv.ERR_BAD_REQUEST,t)):m.send(r||null)})},yy=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,i=new AbortController;const r=function(t){if(!n){n=!0,a();const e=t instanceof Error?t:this.reason;i.abort(e instanceof Cv?e:new ay(e instanceof Error?e.message:e))}};let s=e&&setTimeout(()=>{s=null,r(new Cv(`timeout ${e} of ms exceeded`,Cv.ETIMEDOUT))},e);const a=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(r):t.removeEventListener("abort",r)}),t=null)};t.forEach(t=>t.addEventListener("abort",r));const{signal:o}=i;return o.unsubscribe=()=>Av.asap(a),o}},_y=function*(t,e){let n=t.byteLength;if(n<e)return void(yield t);let i,r=0;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},xy=async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},by=(t,e,n,i)=>{const r=async function*(t,e){for await(const n of xy(t))yield*_y(n,e)}(t,e);let s,a=0,o=t=>{s||(s=!0,i&&i(t))};return new ReadableStream({async pull(t){try{const{done:e,value:i}=await r.next();if(e)return o(),void t.close();let s=i.byteLength;if(n){let t=a+=s;n(t)}t.enqueue(new Uint8Array(i))}catch(e){throw o(e),e}},cancel:t=>(o(t),r.return())},{highWaterMark:2})},{isFunction:My}=Av,wy=(({Request:t,Response:e})=>({Request:t,Response:e}))(Av.global),{ReadableStream:Sy,TextEncoder:Ty}=Av.global,Ey=(t,...e)=>{try{return!!t(...e)}catch(n){return!1}},Ay=t=>{t=Av.merge.call({skipUndefined:!0},wy,t);const{fetch:e,Request:n,Response:i}=t,r=e?My(e):"function"==typeof fetch,s=My(n),a=My(i);if(!r)return!1;const o=r&&My(Sy),l=r&&("function"==typeof Ty?(t=>e=>t.encode(e))(new Ty):async t=>new Uint8Array(await new n(t).arrayBuffer())),c=s&&o&&Ey(()=>{let t=!1;const e=new n(Kv.origin,{body:new Sy,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),h=a&&o&&Ey(()=>Av.isReadableStream(new i("").body)),u={stream:h&&(t=>t.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!u[t]&&(u[t]=(e,n)=>{let i=e&&e[t];if(i)return i.call(e);throw new Cv(`Response type '${t}' is not supported`,Cv.ERR_NOT_SUPPORT,n)})});const d=async(t,e)=>{const i=Av.toFiniteNumber(t.getContentLength());return null==i?(async t=>{if(null==t)return 0;if(Av.isBlob(t))return t.size;if(Av.isSpecCompliantForm(t)){const e=new n(Kv.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return Av.isArrayBufferView(t)||Av.isArrayBuffer(t)?t.byteLength:(Av.isURLSearchParams(t)&&(t+=""),Av.isString(t)?(await l(t)).byteLength:void 0)})(e):i};return async t=>{let{url:r,method:a,data:o,signal:l,cancelToken:p,timeout:f,onDownloadProgress:m,onUploadProgress:g,responseType:v,headers:y,withCredentials:_="same-origin",fetchOptions:x}=gy(t),b=e||fetch;v=v?(v+"").toLowerCase():"text";let M=yy([l,p&&p.toAbortSignal()],f),w=null;const S=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let T;try{if(g&&c&&"get"!==a&&"head"!==a&&0!==(T=await d(y,o))){let t,e=new n(r,{method:"POST",body:o,duplex:"half"});if(Av.isFormData(o)&&(t=e.headers.get("content-type"))&&y.setContentType(t),e.body){const[t,n]=cy(T,ly(hy(g)));o=by(e.body,65536,t,n)}}Av.isString(_)||(_=_?"include":"omit");const e=s&&"credentials"in n.prototype,l={...x,signal:M,method:a.toUpperCase(),headers:y.normalize().toJSON(),body:o,duplex:"half",credentials:e?_:void 0};w=s&&new n(r,l);let p=await(s?b(w,x):b(r,l));const f=h&&("stream"===v||"response"===v);if(h&&(m||f&&S)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=p[e]});const e=Av.toFiniteNumber(p.headers.get("content-length")),[n,r]=m&&cy(e,ly(hy(m),!0))||[];p=new i(by(p.body,65536,n,()=>{r&&r(),S&&S()}),t)}v=v||"text";let E=await u[Av.findKey(u,v)||"text"](p,t);return!f&&S&&S(),await new Promise((e,n)=>{oy(e,n,{data:E,headers:iy.from(p.headers),status:p.status,statusText:p.statusText,config:t,request:w})})}catch(E){if(S&&S(),E&&"TypeError"===E.name&&/Load failed|fetch/i.test(E.message))throw Object.assign(new Cv("Network Error",Cv.ERR_NETWORK,t,w),{cause:E.cause||E});throw Cv.from(E,E&&E.code,t,w)}}},Cy=new Map,Ry=t=>{let e=t?t.env:{};const{fetch:n,Request:i,Response:r}=e,s=[i,r,n];let a,o,l=s.length,c=Cy;for(;l--;)a=s[l],o=c.get(a),void 0===o&&c.set(a,o=l?new Map:Ay(e)),c=o;return o};Ry();const Py={http:null,xhr:vy,fetch:{get:Ry}};Av.forEach(Py,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}});const Oy=t=>`- ${t}`,Iy=t=>Av.isFunction(t)||null===t||!1===t,Dy=(t,e)=>{t=Av.isArray(t)?t:[t];const{length:n}=t;let i,r;const s={};for(let a=0;a<n;a++){let n;if(i=t[a],r=i,!Iy(i)&&(r=Py[(n=String(i)).toLowerCase()],void 0===r))throw new Cv(`Unknown adapter '${n}'`);if(r&&(Av.isFunction(r)||(r=r.get(e))))break;s[n||"#"+a]=r}if(!r){const t=Object.entries(s).map(([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build"));throw new Cv("There is no suitable adapter to dispatch the request "+(n?t.length>1?"since :\n"+t.map(Oy).join("\n"):" "+Oy(t[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r};function Ly(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ay(null,t)}function Ny(t){Ly(t),t.headers=iy.from(t.headers),t.data=ry.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return Dy(t.adapter||$v.adapter,t)(t).then(function(e){return Ly(t),e.data=ry.call(t,t.transformResponse,e),e.headers=iy.from(e.headers),e},function(e){return sy(e)||(Ly(t),e&&e.response&&(e.response.data=ry.call(t,t.transformResponse,e.response),e.response.headers=iy.from(e.response.headers))),Promise.reject(e)})}const Uy="1.12.2",Fy={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Fy[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const ky={};Fy.transitional=function(t,e,n){return(i,r,s)=>{if(!1===t)throw new Cv(function(t,e){return"[Axios v"+Uy+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}(r," has been removed"+(e?" in "+e:"")),Cv.ERR_DEPRECATED);return e&&!ky[r]&&(ky[r]=!0),!t||t(i,r,s)}},Fy.spelling=function(t){return(t,e)=>!0};const By={assertOptions:function(t,e,n){if("object"!=typeof t)throw new Cv("options must be an object",Cv.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let r=i.length;for(;r-- >0;){const s=i[r],a=e[s];if(a){const e=t[s],n=void 0===e||a(e,s,t);if(!0!==n)throw new Cv("option "+s+" must be "+n,Cv.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Cv("Unknown option "+s,Cv.ERR_BAD_OPTION)}},validators:Fy},zy=By.validators;let Vy=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Vv,response:new Vv}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";try{n.stack?e&&!String(n.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+e):n.stack=e}catch(i){}}throw n}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=my(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:r}=e;void 0!==n&&By.assertOptions(n,{silentJSONParsing:zy.transitional(zy.boolean),forcedJSONParsing:zy.transitional(zy.boolean),clarifyTimeoutError:zy.transitional(zy.boolean)},!1),null!=i&&(Av.isFunction(i)?e.paramsSerializer={serialize:i}:By.assertOptions(i,{encode:zy.function,serialize:zy.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),By.assertOptions(e,{baseUrl:zy.spelling("baseURL"),withXsrfToken:zy.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=r&&Av.merge(r.common,r[e.method]);r&&Av.forEach(["delete","get","head","post","put","patch","common"],t=>{delete r[t]}),e.headers=iy.concat(s,r);const a=[];let o=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,a.unshift(t.fulfilled,t.rejected))});const l=[];let c;this.interceptors.response.forEach(function(t){l.push(t.fulfilled,t.rejected)});let h,u=0;if(!o){const t=[Ny.bind(this),void 0];for(t.unshift(...a),t.push(...l),h=t.length,c=Promise.resolve(e);u<h;)c=c.then(t[u++],t[u++]);return c}h=a.length;let d=e;for(;u<h;){const t=a[u++],e=a[u++];try{d=t(d)}catch(p){e.call(this,p);break}}try{c=Ny.call(this,d)}catch(p){return Promise.reject(p)}for(u=0,h=l.length;u<h;)c=c.then(l[u++],l[u++]);return c}getUri(t){return zv(py((t=my(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}};Av.forEach(["delete","get","head","options"],function(t){Vy.prototype[t]=function(e,n){return this.request(my(n||{},{method:t,url:e,data:(n||{}).data}))}}),Av.forEach(["post","put","patch"],function(t){function e(e){return function(n,i,r){return this.request(my(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Vy.prototype[t]=e(),Vy.prototype[t+"Form"]=e(!0)});const Hy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Hy).forEach(([t,e])=>{Hy[e]=t});const Wy=function t(e){const n=new Vy(e),i=Bg(Vy.prototype.request,n);return Av.extend(i,Vy.prototype,n,{allOwnKeys:!0}),Av.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return t(my(e,n))},i}($v);Wy.Axios=Vy,Wy.CanceledError=ay,Wy.CancelToken=class t{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const i=new Promise(t=>{n.subscribe(t),e=t}).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t(function(t,i,r){n.reason||(n.reason=new ay(t,i,r),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let e;return{token:new t(function(t){e=t}),cancel:e}}},Wy.isCancel=sy,Wy.VERSION=Uy,Wy.toFormData=Nv,Wy.AxiosError=Cv,Wy.Cancel=Wy.CanceledError,Wy.all=function(t){return Promise.all(t)},Wy.spread=function(t){return function(e){return t.apply(null,e)}},Wy.isAxiosError=function(t){return Av.isObject(t)&&!0===t.isAxiosError},Wy.mergeConfig=my,Wy.AxiosHeaders=iy,Wy.formToJSON=t=>Zv(Av.isHTMLForm(t)?new FormData(t):t),Wy.getAdapter=Dy,Wy.HttpStatusCode=Hy,Wy.default=Wy;const{Axios:jy,AxiosError:Gy,CanceledError:Xy,isCancel:qy,CancelToken:Yy,VERSION:Ky,all:Zy,Cancel:$y,isAxiosError:Jy,spread:Qy,toFormData:t_,AxiosHeaders:e_,HttpStatusCode:n_,formToJSON:i_,getAdapter:r_,mergeConfig:s_}=Wy;var a_,o_,l_,c_,h_,u_,d_,p_,f_,m_,g_,v_,y_,__,x_,b_,M_,w_,S_,T_,E_,A_,C_,R_,P_,O_,I_,D_,L_,N_,U_,F_,k_,B_,z_,V_,H_,W_,j_,G_,X_,q_,Y_,K_,Z_,$_,J_,Q_,tx,ex,nx,ix,rx,sx,ax,ox,lx,cx,hx,ux,dx,px,fx,mx,gx,vx,yx,_x,xx,bx,Mx,wx,Sx,Tx,Ex,Ax,Cx,Rx,Px,Ox,Ix,Dx,Lx,Nx,Ux,Fx,kx,Bx,zx,Vx,Hx,Wx,jx,Gx,Xx,qx,Yx,Kx,Zx,$x,Jx,Qx,tb,eb;function nb(){if(o_)return a_;o_=1;var t=Array.isArray;return a_=t}function ib(){if(c_)return l_;c_=1;var t="object"==typeof globalThis&&globalThis&&globalThis.Object===Object&&globalThis;return l_=t}function rb(){if(u_)return h_;u_=1;var t=ib(),e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")();return h_=n}function sb(){if(p_)return d_;p_=1;var t=rb().Symbol;return d_=t}function ab(){if(__)return y_;__=1;var t=sb(),e=function(){if(m_)return f_;m_=1;var t=sb(),e=Object.prototype,n=e.hasOwnProperty,i=e.toString,r=t?t.toStringTag:void 0;return f_=function(t){var e=n.call(t,r),s=t[r];try{t[r]=void 0;var a=!0}catch(l){}var o=i.call(t);return a&&(e?t[r]=s:delete t[r]),o}}(),n=function(){if(v_)return g_;v_=1;var t=Object.prototype.toString;return g_=function(e){return t.call(e)}}(),i=t?t.toStringTag:void 0;return y_=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":i&&i in Object(t)?e(t):n(t)}}function ob(){if(b_)return x_;return b_=1,x_=function(t){return null!=t&&"object"==typeof t}}function lb(){if(w_)return M_;w_=1;var t=ab(),e=ob();return M_=function(n){return"symbol"==typeof n||e(n)&&"[object Symbol]"==t(n)}}function cb(){if(T_)return S_;T_=1;var t=nb(),e=lb(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;return S_=function(r,s){if(t(r))return!1;var a=typeof r;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=r&&!e(r))||(i.test(r)||!n.test(r)||null!=s&&r in Object(s))}}function hb(){if(A_)return E_;return A_=1,E_=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}}function ub(){if(R_)return C_;R_=1;var t=ab(),e=hb();return C_=function(n){if(!e(n))return!1;var i=t(n);return"[object Function]"==i||"[object GeneratorFunction]"==i||"[object AsyncFunction]"==i||"[object Proxy]"==i}}function db(){if(D_)return I_;D_=1;var t,e=function(){if(O_)return P_;O_=1;var t=rb()["__core-js_shared__"];return P_=t}(),n=(t=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";return I_=function(t){return!!n&&n in t}}function pb(){if(N_)return L_;N_=1;var t=Function.prototype.toString;return L_=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}}function fb(){if(V_)return z_;V_=1;var t=function(){if(F_)return U_;F_=1;var t=ub(),e=db(),n=hb(),i=pb(),r=/^\[object .+?Constructor\]$/,s=Function.prototype,a=Object.prototype,o=s.toString,l=a.hasOwnProperty,c=RegExp("^"+o.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return U_=function(s){return!(!n(s)||e(s))&&(t(s)?c:r).test(i(s))}}(),e=B_?k_:(B_=1,k_=function(t,e){return null==t?void 0:t[e]});return z_=function(n,i){var r=e(n,i);return t(r)?r:void 0}}function mb(){if(W_)return H_;W_=1;var t=fb()(Object,"create");return H_=t}function gb(){if(ex)return tx;ex=1;var t=function(){if(G_)return j_;G_=1;var t=mb();return j_=function(){this.__data__=t?t(null):{},this.size=0}}(),e=q_?X_:(q_=1,X_=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}),n=function(){if(K_)return Y_;K_=1;var t=mb(),e=Object.prototype.hasOwnProperty;return Y_=function(n){var i=this.__data__;if(t){var r=i[n];return"__lodash_hash_undefined__"===r?void 0:r}return e.call(i,n)?i[n]:void 0}}(),i=function(){if($_)return Z_;$_=1;var t=mb(),e=Object.prototype.hasOwnProperty;return Z_=function(n){var i=this.__data__;return t?void 0!==i[n]:e.call(i,n)}}(),r=function(){if(Q_)return J_;Q_=1;var t=mb();return J_=function(e,n){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=t&&void 0===n?"__lodash_hash_undefined__":n,this}}();function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=r,tx=s}function vb(){if(sx)return rx;return sx=1,rx=function(t,e){return t===e||t!=t&&e!=e}}function yb(){if(ox)return ax;ox=1;var t=vb();return ax=function(e,n){for(var i=e.length;i--;)if(t(e[i][0],n))return i;return-1}}function _b(){if(vx)return gx;vx=1;var t=ix?nx:(ix=1,nx=function(){this.__data__=[],this.size=0}),e=function(){if(cx)return lx;cx=1;var t=yb(),e=Array.prototype.splice;return lx=function(n){var i=this.__data__,r=t(i,n);return!(r<0||(r==i.length-1?i.pop():e.call(i,r,1),--this.size,0))}}(),n=function(){if(ux)return hx;ux=1;var t=yb();return hx=function(e){var n=this.__data__,i=t(n,e);return i<0?void 0:n[i][1]}}(),i=function(){if(px)return dx;px=1;var t=yb();return dx=function(e){return t(this.__data__,e)>-1}}(),r=function(){if(mx)return fx;mx=1;var t=yb();return fx=function(e,n){var i=this.__data__,r=t(i,e);return r<0?(++this.size,i.push([e,n])):i[r][1]=n,this}}();function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=r,gx=s}function xb(){if(_x)return yx;_x=1;var t=fb()(rb(),"Map");return yx=t}function bb(){if(Tx)return Sx;Tx=1;var t=wx?Mx:(wx=1,Mx=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t});return Sx=function(e,n){var i=e.__data__;return t(n)?i["string"==typeof n?"string":"hash"]:i.map}}function Mb(){if(Nx)return Lx;Nx=1;var t=function(){if(bx)return xx;bx=1;var t=gb(),e=_b(),n=xb();return xx=function(){this.size=0,this.__data__={hash:new t,map:new(n||e),string:new t}}}(),e=function(){if(Ax)return Ex;Ax=1;var t=bb();return Ex=function(e){var n=t(this,e).delete(e);return this.size-=n?1:0,n}}(),n=function(){if(Rx)return Cx;Rx=1;var t=bb();return Cx=function(e){return t(this,e).get(e)}}(),i=function(){if(Ox)return Px;Ox=1;var t=bb();return Px=function(e){return t(this,e).has(e)}}(),r=function(){if(Dx)return Ix;Dx=1;var t=bb();return Ix=function(e,n){var i=t(this,e),r=i.size;return i.set(e,n),this.size+=i.size==r?0:1,this}}();function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=r,Lx=s}function wb(){if(Fx)return Ux;Fx=1;var t=Mb();function e(n,i){if("function"!=typeof n||null!=i&&"function"!=typeof i)throw new TypeError("Expected a function");var r=function(){var t=arguments,e=i?i.apply(this,t):t[0],s=r.cache;if(s.has(e))return s.get(e);var a=n.apply(this,t);return r.cache=s.set(e,a)||s,a};return r.cache=new(e.Cache||t),r}return e.Cache=t,Ux=e}function Sb(){if(Vx)return zx;Vx=1;var t=function(){if(Bx)return kx;Bx=1;var t=wb();return kx=function(e){var n=t(e,function(t){return 500===i.size&&i.clear(),t}),i=n.cache;return n}}(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,i=t(function(t){var i=[];return 46===t.charCodeAt(0)&&i.push(""),t.replace(e,function(t,e,r,s){i.push(r?s.replace(n,"$1"):e||t)}),i});return zx=i}function Tb(){if(Wx)return Hx;return Wx=1,Hx=function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}}function Eb(){if(qx)return Xx;qx=1;var t=function(){if(Gx)return jx;Gx=1;var t=sb(),e=Tb(),n=nb(),i=lb(),r=t?t.prototype:void 0,s=r?r.toString:void 0;return jx=function t(r){if("string"==typeof r)return r;if(n(r))return e(r,t)+"";if(i(r))return s?s.call(r):"";var a=r+"";return"0"==a&&1/r==-1/0?"-0":a},jx}();return Xx=function(e){return null==e?"":t(e)}}function Ab(){if(Kx)return Yx;Kx=1;var t=nb(),e=cb(),n=Sb(),i=Eb();return Yx=function(r,s){return t(r)?r:e(r,s)?[r]:n(i(r))}}function Cb(){if($x)return Zx;$x=1;var t=lb();return Zx=function(e){if("string"==typeof e||t(e))return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}}function Rb(){if(Qx)return Jx;Qx=1;var t=Ab(),e=Cb();return Jx=function(n,i){for(var r=0,s=(i=t(i,n)).length;null!=n&&r<s;)n=n[e(i[r++])];return r&&r==s?n:void 0}}function Pb(){if(eb)return tb;eb=1;var t=Rb();return tb=function(e,n,i){var r=null==e?void 0:t(e,n);return void 0===r?i:r}}const Ob=Vt(Pb());var Ib,Db;const Lb=Vt(Db?Ib:(Db=1,Ib=function(t){return null==t}));var Nb,Ub;const Fb=Vt(function(){if(Ub)return Nb;Ub=1;var t=ab(),e=nb(),n=ob();return Nb=function(i){return"string"==typeof i||!e(i)&&n(i)&&"[object String]"==t(i)}}());const kb=Vt(ub());const Bb=Vt(hb());var zb,Vb,Hb,Wb;function jb(){if(Vb)return zb;Vb=1;var t=ab(),e=ob();return zb=function(n){return"number"==typeof n||e(n)&&"[object Number]"==t(n)}}const Gb=Vt(function(){if(Wb)return Hb;Wb=1;var t=jb();return Hb=function(e){return t(e)&&e!=+e}}());const Xb=Vt(jb());var qb,Yb,Kb,Zb,$b,Jb,Qb,tM,eM,nM,iM,rM,sM,aM,oM,lM;function cM(){if(Zb)return Kb;Zb=1;var t=Yb?qb:(Yb=1,qb=function(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s});return Kb=function(e,n,i){var r=e.length;return i=void 0===i?r:i,!n&&i>=r?e:t(e,n,i)}}function hM(){if(Jb)return $b;Jb=1;var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");return $b=function(e){return t.test(e)}}function uM(){if(rM)return iM;rM=1;var t=tM?Qb:(tM=1,Qb=function(t){return t.split("")}),e=hM(),n=function(){if(nM)return eM;nM=1;var t="\\ud800-\\udfff",e="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",r="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",o="(?:"+n+"|"+i+")?",l="[\\ufe0e\\ufe0f]?",c=l+o+"(?:\\u200d(?:"+[r,s,a].join("|")+")"+l+o+")*",h="(?:"+[r+n+"?",n,s,a,e].join("|")+")",u=RegExp(i+"(?="+i+")|"+h+c,"g");return eM=function(t){return t.match(u)||[]}}();return iM=function(i){return e(i)?n(i):t(i)}}const dM=Vt(function(){if(lM)return oM;lM=1;var t=function(){if(aM)return sM;aM=1;var t=cM(),e=hM(),n=uM(),i=Eb();return sM=function(r){return function(s){s=i(s);var a=e(s)?n(s):void 0,o=a?a[0]:s.charAt(0),l=a?t(a,1).join(""):s.slice(1);return o[r]()+l}}}()("toUpperCase");return oM=t}());var pM,fM,mM,gM,vM,yM,_M,xM,bM,MM,wM,SM,TM,EM,AM,CM,RM,PM,OM,IM,DM,LM,NM,UM,FM,kM,BM,zM,VM,HM,WM,jM,GM,XM,qM,YM,KM,ZM,$M,JM,QM,tw,ew,nw,iw,rw,sw,aw;function ow(){if(SM)return wM;SM=1;var t=_b(),e=function(){if(fM)return pM;fM=1;var t=_b();return pM=function(){this.__data__=new t,this.size=0}}(),n=gM?mM:(gM=1,mM=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}),i=yM?vM:(yM=1,vM=function(t){return this.__data__.get(t)}),r=xM?_M:(xM=1,_M=function(t){return this.__data__.has(t)}),s=function(){if(MM)return bM;MM=1;var t=_b(),e=xb(),n=Mb();return bM=function(i,r){var s=this.__data__;if(s instanceof t){var a=s.__data__;if(!e||a.length<199)return a.push([i,r]),this.size=++s.size,this;s=this.__data__=new n(a)}return s.set(i,r),this.size=s.size,this}}();function a(e){var n=this.__data__=new t(e);this.size=n.size}return a.prototype.clear=e,a.prototype.delete=n,a.prototype.get=i,a.prototype.has=r,a.prototype.set=s,wM=a}function lw(){if(PM)return RM;PM=1;var t=Mb(),e=EM?TM:(EM=1,TM=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}),n=CM?AM:(CM=1,AM=function(t){return this.__data__.has(t)});function i(e){var n=-1,i=null==e?0:e.length;for(this.__data__=new t;++n<i;)this.add(e[n])}return i.prototype.add=i.prototype.push=e,i.prototype.has=n,RM=i}function cw(){if(IM)return OM;return IM=1,OM=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}}function hw(){if(LM)return DM;return LM=1,DM=function(t,e){return t.has(e)}}function uw(){if(UM)return NM;UM=1;var t=lw(),e=cw(),n=hw();return NM=function(i,r,s,a,o,l){var c=1&s,h=i.length,u=r.length;if(h!=u&&!(c&&u>h))return!1;var d=l.get(i),p=l.get(r);if(d&&p)return d==r&&p==i;var f=-1,m=!0,g=2&s?new t:void 0;for(l.set(i,r),l.set(r,i);++f<h;){var v=i[f],y=r[f];if(a)var _=c?a(y,v,f,r,i,l):a(v,y,f,i,r,l);if(void 0!==_){if(_)continue;m=!1;break}if(g){if(!e(r,function(t,e){if(!n(g,e)&&(v===t||o(v,t,s,a,l)))return g.push(e)})){m=!1;break}}else if(v!==y&&!o(v,y,s,a,l)){m=!1;break}}return l.delete(i),l.delete(r),m}}function dw(){if(HM)return VM;return HM=1,VM=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}}function pw(){if(jM)return WM;jM=1;var t=sb(),e=function(){if(kM)return FM;kM=1;var t=rb().Uint8Array;return FM=t}(),n=vb(),i=uw(),r=zM?BM:(zM=1,BM=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}),s=dw(),a=t?t.prototype:void 0,o=a?a.valueOf:void 0;return WM=function(t,a,l,c,h,u,d){switch(l){case"[object DataView]":if(t.byteLength!=a.byteLength||t.byteOffset!=a.byteOffset)return!1;t=t.buffer,a=a.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=a.byteLength||!u(new e(t),new e(a)));case"[object Boolean]":case"[object Date]":case"[object Number]":return n(+t,+a);case"[object Error]":return t.name==a.name&&t.message==a.message;case"[object RegExp]":case"[object String]":return t==a+"";case"[object Map]":var p=r;case"[object Set]":var f=1&c;if(p||(p=s),t.size!=a.size&&!f)return!1;var m=d.get(t);if(m)return m==a;c|=2,d.set(t,a);var g=i(p(t),p(a),c,h,u,d);return d.delete(t),g;case"[object Symbol]":if(o)return o.call(t)==o.call(a)}return!1}}function fw(){if(XM)return GM;return XM=1,GM=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}}function mw(){if(tw)return QM;tw=1;var t=ZM?KM:(ZM=1,KM=function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,s=[];++n<i;){var a=t[n];e(a,n,t)&&(s[r++]=a)}return s}),e=JM?$M:(JM=1,$M=function(){return[]}),n=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols;return QM=i?function(e){return null==e?[]:(e=Object(e),t(i(e),function(t){return n.call(e,t)}))}:e}function gw(){if(aw)return sw;aw=1;var t=function(){if(rw)return iw;rw=1;var t=ab(),e=ob();return iw=function(n){return e(n)&&"[object Arguments]"==t(n)}}(),e=ob(),n=Object.prototype,i=n.hasOwnProperty,r=n.propertyIsEnumerable,s=t(function(){return arguments}())?t:function(t){return e(t)&&i.call(t,"callee")&&!r.call(t,"callee")};return sw=s}var vw,yw,_w,xw,bw,Mw,ww,Sw,Tw,Ew,Aw,Cw={exports:{}};function Rw(){return _w||(_w=1,t=Cw,e=Cw.exports,n=rb(),i=yw?vw:(yw=1,vw=function(){return!1}),r=e&&!e.nodeType&&e,s=r&&t&&!t.nodeType&&t,a=s&&s.exports===r?n.Buffer:void 0,o=(a?a.isBuffer:void 0)||i,t.exports=o),Cw.exports;var t,e,n,i,r,s,a,o}function Pw(){if(bw)return xw;bw=1;var t=/^(?:0|[1-9]\d*)$/;return xw=function(e,n){var i=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&t.test(e))&&e>-1&&e%1==0&&e<n}}function Ow(){if(ww)return Mw;ww=1;return Mw=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}}function Iw(){if(Aw)return Ew;return Aw=1,Ew=function(t){return function(e){return t(e)}}}var Dw,Lw,Nw,Uw,Fw,kw,Bw,zw,Vw,Hw,Ww,jw,Gw,Xw,qw,Yw,Kw,Zw,$w,Jw,Qw,tS,eS,nS,iS,rS,sS,aS,oS,lS,cS,hS,uS,dS,pS,fS,mS,gS,vS,yS,_S,xS,bS,MS,wS,SS,TS,ES,AS,CS,RS,PS,OS,IS,DS,LS,NS,US,FS,kS,BS,zS,VS,HS,WS,jS,GS,XS,qS,YS,KS,ZS,$S,JS,QS,tT,eT,nT,iT,rT,sT,aT,oT,lT={exports:{}};function cT(){if(Nw)return Lw;Nw=1;var t=function(){if(Tw)return Sw;Tw=1;var t=ab(),e=Ow(),n=ob(),i={};return i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,Sw=function(r){return n(r)&&e(r.length)&&!!i[t(r)]}}(),e=Iw(),n=function(){return Dw||(Dw=1,t=lT,e=lT.exports,n=ib(),i=e&&!e.nodeType&&e,r=i&&t&&!t.nodeType&&t,s=r&&r.exports===i&&n.process,a=function(){try{return r&&r.require&&r.require("util").types||s&&s.binding&&s.binding("util")}catch(t){}}(),t.exports=a),lT.exports;var t,e,n,i,r,s,a}(),i=n&&n.isTypedArray,r=i?e(i):t;return Lw=r}function hT(){if(Fw)return Uw;Fw=1;var t=nw?ew:(nw=1,ew=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}),e=gw(),n=nb(),i=Rw(),r=Pw(),s=cT(),a=Object.prototype.hasOwnProperty;return Uw=function(o,l){var c=n(o),h=!c&&e(o),u=!c&&!h&&i(o),d=!c&&!h&&!u&&s(o),p=c||h||u||d,f=p?t(o.length,String):[],m=f.length;for(var g in o)!l&&!a.call(o,g)||p&&("length"==g||u&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||r(g,m))||f.push(g);return f}}function uT(){if(Vw)return zw;return Vw=1,zw=function(t,e){return function(n){return t(e(n))}}}function dT(){if(Gw)return jw;Gw=1;var t=function(){if(Bw)return kw;Bw=1;var t=Object.prototype;return kw=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}}(),e=function(){if(Ww)return Hw;Ww=1;var t=uT()(Object.keys,Object);return Hw=t}(),n=Object.prototype.hasOwnProperty;return jw=function(i){if(!t(i))return e(i);var r=[];for(var s in Object(i))n.call(i,s)&&"constructor"!=s&&r.push(s);return r}}function pT(){if(qw)return Xw;qw=1;var t=ub(),e=Ow();return Xw=function(n){return null!=n&&e(n.length)&&!t(n)}}function fT(){if(Kw)return Yw;Kw=1;var t=hT(),e=dT(),n=pT();return Yw=function(i){return n(i)?t(i):e(i)}}function mT(){if($w)return Zw;$w=1;var t=function(){if(YM)return qM;YM=1;var t=fw(),e=nb();return qM=function(n,i,r){var s=i(n);return e(n)?s:t(s,r(n))}}(),e=mw(),n=fT();return Zw=function(i){return t(i,n,e)}}function gT(){if(sS)return rS;sS=1;var t=fb()(rb(),"Set");return rS=t}function vT(){if(cS)return lS;cS=1;var t=function(){if(eS)return tS;eS=1;var t=fb()(rb(),"DataView");return tS=t}(),e=xb(),n=function(){if(iS)return nS;iS=1;var t=fb()(rb(),"Promise");return nS=t}(),i=gT(),r=function(){if(oS)return aS;oS=1;var t=fb()(rb(),"WeakMap");return aS=t}(),s=ab(),a=pb(),o="[object Map]",l="[object Promise]",c="[object Set]",h="[object WeakMap]",u="[object DataView]",d=a(t),p=a(e),f=a(n),m=a(i),g=a(r),v=s;return(t&&v(new t(new ArrayBuffer(1)))!=u||e&&v(new e)!=o||n&&v(n.resolve())!=l||i&&v(new i)!=c||r&&v(new r)!=h)&&(v=function(t){var e=s(t),n="[object Object]"==e?t.constructor:void 0,i=n?a(n):"";if(i)switch(i){case d:return u;case p:return o;case f:return l;case m:return c;case g:return h}return e}),lS=v}function yT(){if(uS)return hS;uS=1;var t=ow(),e=uw(),n=pw(),i=function(){if(Qw)return Jw;Qw=1;var t=mT(),e=Object.prototype.hasOwnProperty;return Jw=function(n,i,r,s,a,o){var l=1&r,c=t(n),h=c.length;if(h!=t(i).length&&!l)return!1;for(var u=h;u--;){var d=c[u];if(!(l?d in i:e.call(i,d)))return!1}var p=o.get(n),f=o.get(i);if(p&&f)return p==i&&f==n;var m=!0;o.set(n,i),o.set(i,n);for(var g=l;++u<h;){var v=n[d=c[u]],y=i[d];if(s)var _=l?s(y,v,d,i,n,o):s(v,y,d,n,i,o);if(!(void 0===_?v===y||a(v,y,r,s,o):_)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var x=n.constructor,b=i.constructor;x==b||!("constructor"in n)||!("constructor"in i)||"function"==typeof x&&x instanceof x&&"function"==typeof b&&b instanceof b||(m=!1)}return o.delete(n),o.delete(i),m}}(),r=vT(),s=nb(),a=Rw(),o=cT(),l="[object Arguments]",c="[object Array]",h="[object Object]",u=Object.prototype.hasOwnProperty;return hS=function(d,p,f,m,g,v){var y=s(d),_=s(p),x=y?c:r(d),b=_?c:r(p),M=(x=x==l?h:x)==h,w=(b=b==l?h:b)==h,S=x==b;if(S&&a(d)){if(!a(p))return!1;y=!0,M=!1}if(S&&!M)return v||(v=new t),y||o(d)?e(d,p,f,m,g,v):n(d,p,x,f,m,g,v);if(!(1&f)){var T=M&&u.call(d,"__wrapped__"),E=w&&u.call(p,"__wrapped__");if(T||E){var A=T?d.value():d,C=E?p.value():p;return v||(v=new t),g(A,C,f,m,v)}}return!!S&&(v||(v=new t),i(d,p,f,m,g,v))}}function _T(){if(pS)return dS;pS=1;var t=yT(),e=ob();return dS=function n(i,r,s,a,o){return i===r||(null==i||null==r||!e(i)&&!e(r)?i!=i&&r!=r:t(i,r,s,a,n,o))},dS}function xT(){if(vS)return gS;vS=1;var t=hb();return gS=function(e){return e==e&&!t(e)}}function bT(){if(bS)return xS;return bS=1,xS=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}}function MT(){if(wS)return MS;wS=1;var t=function(){if(mS)return fS;mS=1;var t=ow(),e=_T();return fS=function(n,i,r,s){var a=r.length,o=a,l=!s;if(null==n)return!o;for(n=Object(n);a--;){var c=r[a];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++a<o;){var h=(c=r[a])[0],u=n[h],d=c[1];if(l&&c[2]){if(void 0===u&&!(h in n))return!1}else{var p=new t;if(s)var f=s(u,d,h,n,i,p);if(!(void 0===f?e(d,u,3,s,p):f))return!1}}return!0}}(),e=function(){if(_S)return yS;_S=1;var t=xT(),e=fT();return yS=function(n){for(var i=e(n),r=i.length;r--;){var s=i[r],a=n[s];i[r]=[s,a,t(a)]}return i}}(),n=bT();return MS=function(i){var r=e(i);return 1==r.length&&r[0][2]?n(r[0][0],r[0][1]):function(e){return e===i||t(e,i,r)}}}function wT(){if(RS)return CS;RS=1;var t=TS?SS:(TS=1,SS=function(t,e){return null!=t&&e in Object(t)}),e=function(){if(AS)return ES;AS=1;var t=Ab(),e=gw(),n=nb(),i=Pw(),r=Ow(),s=Cb();return ES=function(a,o,l){for(var c=-1,h=(o=t(o,a)).length,u=!1;++c<h;){var d=s(o[c]);if(!(u=null!=a&&l(a,d)))break;a=a[d]}return u||++c!=h?u:!!(h=null==a?0:a.length)&&r(h)&&i(d,h)&&(n(a)||e(a))}}();return CS=function(n,i){return null!=n&&e(n,i,t)}}function ST(){if(DS)return IS;return DS=1,IS=function(t){return t}}function TT(){if(BS)return kS;BS=1;var t=NS?LS:(NS=1,LS=function(t){return function(e){return null==e?void 0:e[t]}}),e=function(){if(FS)return US;FS=1;var t=Rb();return US=function(e){return function(n){return t(n,e)}}}(),n=cb(),i=Cb();return kS=function(r){return n(r)?t(i(r)):e(r)}}function ET(){if(VS)return zS;VS=1;var t=MT(),e=function(){if(OS)return PS;OS=1;var t=_T(),e=Pb(),n=wT(),i=cb(),r=xT(),s=bT(),a=Cb();return PS=function(o,l){return i(o)&&r(l)?s(a(o),l):function(i){var r=e(i,o);return void 0===r&&r===l?n(i,o):t(l,r,3)}}}(),n=ST(),i=nb(),r=TT();return zS=function(s){return"function"==typeof s?s:null==s?n:"object"==typeof s?i(s)?e(s[0],s[1]):t(s):r(s)}}function AT(){if(WS)return HS;return WS=1,HS=function(t,e,n,i){for(var r=t.length,s=n+(i?1:-1);i?s--:++s<r;)if(e(t[s],s,t))return s;return-1}}function CT(){if(KS)return YS;KS=1;var t=AT(),e=GS?jS:(GS=1,jS=function(t){return t!=t}),n=qS?XS:(qS=1,XS=function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1});return YS=function(i,r,s){return r==r?n(i,r,s):t(i,e,s)}}function RT(){if(iT)return nT;iT=1;var t=gT(),e=eT?tT:(eT=1,tT=function(){}),n=dw(),i=t&&1/n(new t([,-0]))[1]==1/0?function(e){return new t(e)}:e;return nT=i}function PT(){if(sT)return rT;sT=1;var t=lw(),e=function(){if($S)return ZS;$S=1;var t=CT();return ZS=function(e,n){return!(null==e||!e.length)&&t(e,n,0)>-1}}(),n=QS?JS:(QS=1,JS=function(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}),i=hw(),r=RT(),s=dw();return rT=function(a,o,l){var c=-1,h=e,u=a.length,d=!0,p=[],f=p;if(l)d=!1,h=n;else if(u>=200){var m=o?null:r(a);if(m)return s(m);d=!1,h=i,f=new t}else f=o?[]:p;t:for(;++c<u;){var g=a[c],v=o?o(g):g;if(g=l||0!==g?g:0,d&&v==v){for(var y=f.length;y--;)if(f[y]===v)continue t;o&&f.push(v),p.push(g)}else h(f,v,l)||(f!==p&&f.push(v),p.push(g))}return p}}const OT=Vt(function(){if(oT)return aT;oT=1;var t=ET(),e=PT();return aT=function(n,i){return n&&n.length?e(n,t(i,2)):[]}}());var IT,DT,LT,NT,UT,FT,kT,BT,zT,VT,HT,WT,jT,GT,XT,qT,YT,KT,ZT,$T,JT,QT,tE,eE,nE,iE,rE,sE,aE,oE,lE,cE,hE,uE,dE,pE,fE,mE,gE,vE,yE,_E,xE,bE;function ME(){if(NT)return LT;NT=1;var t=fw(),e=function(){if(DT)return IT;DT=1;var t=sb(),e=gw(),n=nb(),i=t?t.isConcatSpreadable:void 0;return IT=function(t){return n(t)||e(t)||!!(i&&t&&t[i])}}();return LT=function n(i,r,s,a,o){var l=-1,c=i.length;for(s||(s=e),o||(o=[]);++l<c;){var h=i[l];r>0&&s(h)?r>1?n(h,r-1,s,a,o):t(o,h):a||(o[o.length]=h)}return o},LT}function wE(){if(BT)return kT;BT=1;var t=(FT?UT:(FT=1,UT=function(t){return function(e,n,i){for(var r=-1,s=Object(e),a=i(e),o=a.length;o--;){var l=a[t?o:++r];if(!1===n(s[l],l,s))break}return e}}))();return kT=t}function SE(){if(VT)return zT;VT=1;var t=wE(),e=fT();return zT=function(n,i){return n&&t(n,i,e)}}function TE(){if(GT)return jT;GT=1;var t=SE(),e=function(){if(WT)return HT;WT=1;var t=pT();return HT=function(e,n){return function(i,r){if(null==i)return i;if(!t(i))return e(i,r);for(var s=i.length,a=n?s:-1,o=Object(i);(n?a--:++a<s)&&!1!==r(o[a],a,o););return i}}}()(t);return jT=e}function EE(){if(qT)return XT;qT=1;var t=TE(),e=pT();return XT=function(n,i){var r=-1,s=e(n)?Array(n.length):[];return t(n,function(t,e,n){s[++r]=i(t,e,n)}),s}}function AE(){if(QT)return JT;QT=1;var t=function(){if($T)return ZT;$T=1;var t=lb();return ZT=function(e,n){if(e!==n){var i=void 0!==e,r=null===e,s=e==e,a=t(e),o=void 0!==n,l=null===n,c=n==n,h=t(n);if(!l&&!h&&!a&&e>n||a&&o&&c&&!l&&!h||r&&o&&c||!i&&c||!s)return 1;if(!r&&!a&&!h&&e<n||h&&i&&s&&!r&&!a||l&&i&&s||!o&&s||!c)return-1}return 0}}();return JT=function(e,n,i){for(var r=-1,s=e.criteria,a=n.criteria,o=s.length,l=i.length;++r<o;){var c=t(s[r],a[r]);if(c)return r>=l?c:c*("desc"==i[r]?-1:1)}return e.index-n.index}}function CE(){if(eE)return tE;eE=1;var t=Tb(),e=Rb(),n=ET(),i=EE(),r=KT?YT:(KT=1,YT=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}),s=Iw(),a=AE(),o=ST(),l=nb();return tE=function(c,h,u){h=h.length?t(h,function(t){return l(t)?function(n){return e(n,1===t.length?t[0]:t)}:t}):[o];var d=-1;h=t(h,s(n));var p=i(c,function(e,n,i){return{criteria:t(h,function(t){return t(e)}),index:++d,value:e}});return r(p,function(t,e){return a(t,e,u)})}}function RE(){if(sE)return rE;sE=1;var t=iE?nE:(iE=1,nE=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}),e=Math.max;return rE=function(n,i,r){return i=e(void 0===i?n.length-1:i,0),function(){for(var s=arguments,a=-1,o=e(s.length-i,0),l=Array(o);++a<o;)l[a]=s[i+a];a=-1;for(var c=Array(i+1);++a<i;)c[a]=s[a];return c[i]=r(l),t(n,this,c)}},rE}function PE(){if(cE)return lE;cE=1;var t=fb(),e=function(){try{var e=t(Object,"defineProperty");return e({},"",{}),e}catch(n){}}();return lE=e}function OE(){if(uE)return hE;uE=1;var t=oE?aE:(oE=1,aE=function(t){return function(){return t}}),e=PE(),n=ST();return hE=e?function(n,i){return e(n,"toString",{configurable:!0,enumerable:!1,value:t(i),writable:!0})}:n}function IE(){if(mE)return fE;mE=1;var t=OE(),e=function(){if(pE)return dE;pE=1;var t=Date.now;return dE=function(e){var n=0,i=0;return function(){var r=t(),s=16-(r-i);if(i=r,s>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}},dE}(),n=e(t);return fE=n}function DE(){if(_E)return yE;_E=1;var t=vb(),e=pT(),n=Pw(),i=hb();return yE=function(r,s,a){if(!i(a))return!1;var o=typeof s;return!!("number"==o?e(a)&&n(s,a.length):"string"==o&&s in a)&&t(a[s],r)}}const LE=Vt(function(){if(bE)return xE;bE=1;var t=ME(),e=CE(),n=function(){if(vE)return gE;vE=1;var t=ST(),e=RE(),n=IE();return gE=function(i,r){return n(e(i,r,t),i+"")}}(),i=DE(),r=n(function(n,r){if(null==n)return[];var s=r.length;return s>1&&i(n,r[0],r[1])?r=[]:s>2&&i(r[0],r[1],r[2])&&(r=[r[0]]),e(n,t(r,1),[])});return xE=r}());var NE,UE,FE,kE,BE,zE,VE,HE,WE,jE,GE,XE;function qE(){if(zE)return BE;zE=1;var t=function(){if(kE)return FE;kE=1;var t=/\s/;return FE=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}}(),e=/^\s+/;return BE=function(n){return n?n.slice(0,t(n)+1).replace(e,""):n}}function YE(){if(HE)return VE;HE=1;var t=qE(),e=hb(),n=lb(),i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt;return VE=function(o){if("number"==typeof o)return o;if(n(o))return NaN;if(e(o)){var l="function"==typeof o.valueOf?o.valueOf():o;o=e(l)?l+"":l}if("string"!=typeof o)return 0===o?o:+o;o=t(o);var c=r.test(o);return c||s.test(o)?a(o.slice(2),c?2:8):i.test(o)?NaN:+o}}function KE(){if(jE)return WE;jE=1;var t=hb(),e=function(){if(UE)return NE;UE=1;var t=rb();return NE=function(){return t.Date.now()}}(),n=YE(),i=Math.max,r=Math.min;return WE=function(s,a,o){var l,c,h,u,d,p,f=0,m=!1,g=!1,v=!0;if("function"!=typeof s)throw new TypeError("Expected a function");function y(t){var e=l,n=c;return l=c=void 0,f=t,u=s.apply(n,e)}function _(t){var e=t-p;return void 0===p||e>=a||e<0||g&&t-f>=h}function x(){var t=e();if(_(t))return b(t);d=setTimeout(x,function(t){var e=a-(t-p);return g?r(e,h-(t-f)):e}(t))}function b(t){return d=void 0,v&&l?y(t):(l=c=void 0,u)}function M(){var t=e(),n=_(t);if(l=arguments,c=this,p=t,n){if(void 0===d)return function(t){return f=t,d=setTimeout(x,a),m?y(t):u}(p);if(g)return clearTimeout(d),d=setTimeout(x,a),y(p)}return void 0===d&&(d=setTimeout(x,a)),u}return a=n(a)||0,t(o)&&(m=!!o.leading,h=(g="maxWait"in o)?i(n(o.maxWait)||0,a):h,v="trailing"in o?!!o.trailing:v),M.cancel=function(){void 0!==d&&clearTimeout(d),f=0,l=p=c=d=void 0},M.flush=function(){return void 0===d?u:b(e())},M},WE}const ZE=Vt(function(){if(XE)return GE;XE=1;var t=KE(),e=hb();return GE=function(n,i,r){var s=!0,a=!0;if("function"!=typeof n)throw new TypeError("Expected a function");return e(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),t(n,i,{leading:s,maxWait:i,trailing:a})}}());class $E extends Map{constructor(t,e=QE){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(JE(this,t))}has(t){return super.has(JE(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const i=e(n);t.has(i)&&(n=t.get(i),t.delete(i));return n}(this,t))}}function JE({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function QE(t){return null!==t&&"object"==typeof t?t.valueOf():t}var tA,eA,nA,iA,rA,sA;function aA(){if(eA)return tA;eA=1;var t=lb();return tA=function(e,n,i){for(var r=-1,s=e.length;++r<s;){var a=e[r],o=n(a);if(null!=o&&(void 0===l?o==o&&!t(o):i(o,l)))var l=o,c=a}return c}}function oA(){if(iA)return nA;return iA=1,nA=function(t,e){return t>e}}const lA=Vt(function(){if(sA)return rA;sA=1;var t=aA(),e=oA(),n=ST();return rA=function(i){return i&&i.length?t(i,n,e):void 0}}());var cA,hA,uA,dA;function pA(){if(hA)return cA;return hA=1,cA=function(t,e){return t<e}}const fA=Vt(function(){if(dA)return uA;dA=1;var t=aA(),e=pA(),n=ST();return uA=function(i){return i&&i.length?t(i,n,e):void 0}}());var mA,gA,vA,yA;const _A=Vt(function(){if(yA)return vA;yA=1;var t=ME(),e=function(){if(gA)return mA;gA=1;var t=Tb(),e=ET(),n=EE(),i=nb();return mA=function(r,s){return(i(r)?t:n)(r,e(s,3))}}();return vA=function(n,i){return t(e(n,i),1)}}());var xA,bA;const MA=Vt(function(){if(bA)return xA;bA=1;var t=_T();return xA=function(e,n){return t(e,n)}}());var wA,SA=1e9,TA=!0,EA="[DecimalError] ",AA=EA+"Invalid argument: ",CA=EA+"Exponent out of range: ",RA=Math.floor,PA=Math.pow,OA=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,IA=1e7,DA=9007199254740991,LA=RA(1286742750677284.5),NA={};function UA(t,e){var n,i,r,s,a,o,l,c,h=t.constructor,u=h.precision;if(!t.s||!e.s)return e.s||(e=new h(t)),TA?XA(e,u):e;if(l=t.d,c=e.d,a=t.e,r=e.e,l=l.slice(),s=a-r){for(s<0?(i=l,s=-s,o=c.length):(i=c,r=a,o=l.length),s>(o=(a=Math.ceil(u/7))>o?a+1:o+1)&&(s=o,i.length=1),i.reverse();s--;)i.push(0);i.reverse()}for((o=l.length)-(s=c.length)<0&&(s=o,i=c,c=l,l=i),n=0;s;)n=(l[--s]=l[s]+c[s]+n)/IA|0,l[s]%=IA;for(n&&(l.unshift(n),++r),o=l.length;0==l[--o];)l.pop();return e.d=l,e.e=r,TA?XA(e,u):e}function FA(t,e,n){if(t!==~~t||t<e||t>n)throw Error(AA+t)}function kA(t){var e,n,i,r=t.length-1,s="",a=t[0];if(r>0){for(s+=a,e=1;e<r;e++)(n=7-(i=t[e]+"").length)&&(s+=WA(n)),s+=i;(n=7-(i=(a=t[e])+"").length)&&(s+=WA(n))}else if(0===a)return"0";for(;a%10==0;)a/=10;return s+a}NA.absoluteValue=NA.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t},NA.comparedTo=NA.cmp=function(t){var e,n,i,r,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(e=0,n=(i=s.d.length)<(r=t.d.length)?i:r;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return i===r?0:i>r^s.s<0?1:-1},NA.decimalPlaces=NA.dp=function(){var t=this,e=t.d.length-1,n=7*(e-t.e);if(e=t.d[e])for(;e%10==0;e/=10)n--;return n<0?0:n},NA.dividedBy=NA.div=function(t){return BA(this,new this.constructor(t))},NA.dividedToIntegerBy=NA.idiv=function(t){var e=this.constructor;return XA(BA(this,new e(t),0,1),e.precision)},NA.equals=NA.eq=function(t){return!this.cmp(t)},NA.exponent=function(){return VA(this)},NA.greaterThan=NA.gt=function(t){return this.cmp(t)>0},NA.greaterThanOrEqualTo=NA.gte=function(t){return this.cmp(t)>=0},NA.isInteger=NA.isint=function(){return this.e>this.d.length-2},NA.isNegative=NA.isneg=function(){return this.s<0},NA.isPositive=NA.ispos=function(){return this.s>0},NA.isZero=function(){return 0===this.s},NA.lessThan=NA.lt=function(t){return this.cmp(t)<0},NA.lessThanOrEqualTo=NA.lte=function(t){return this.cmp(t)<1},NA.logarithm=NA.log=function(t){var e,n=this,i=n.constructor,r=i.precision,s=r+5;if(void 0===t)t=new i(10);else if((t=new i(t)).s<1||t.eq(wA))throw Error(EA+"NaN");if(n.s<1)throw Error(EA+(n.s?"NaN":"-Infinity"));return n.eq(wA)?new i(0):(TA=!1,e=BA(jA(n,s),jA(t,s),s),TA=!0,XA(e,r))},NA.minus=NA.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?qA(e,t):UA(e,(t.s=-t.s,t))},NA.modulo=NA.mod=function(t){var e,n=this,i=n.constructor,r=i.precision;if(!(t=new i(t)).s)throw Error(EA+"NaN");return n.s?(TA=!1,e=BA(n,t,0,1).times(t),TA=!0,n.minus(e)):XA(new i(n),r)},NA.naturalExponential=NA.exp=function(){return zA(this)},NA.naturalLogarithm=NA.ln=function(){return jA(this)},NA.negated=NA.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t},NA.plus=NA.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?UA(e,t):qA(e,(t.s=-t.s,t))},NA.precision=NA.sd=function(t){var e,n,i,r=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(AA+t);if(e=VA(r)+1,n=7*(i=r.d.length-1)+1,i=r.d[i]){for(;i%10==0;i/=10)n--;for(i=r.d[0];i>=10;i/=10)n++}return t&&e>n?e:n},NA.squareRoot=NA.sqrt=function(){var t,e,n,i,r,s,a,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(EA+"NaN")}for(t=VA(o),TA=!1,0==(r=Math.sqrt(+o))||r==1/0?(((e=kA(o.d)).length+t)%2==0&&(e+="0"),r=Math.sqrt(e),t=RA((t+1)/2)-(t<0||t%2),i=new l(e=r==1/0?"5e"+t:(e=r.toExponential()).slice(0,e.indexOf("e")+1)+t)):i=new l(r.toString()),r=a=(n=l.precision)+3;;)if(i=(s=i).plus(BA(o,s,a+2)).times(.5),kA(s.d).slice(0,a)===(e=kA(i.d)).slice(0,a)){if(e=e.slice(a-3,a+1),r==a&&"4999"==e){if(XA(s,n+1,0),s.times(s).eq(o)){i=s;break}}else if("9999"!=e)break;a+=4}return TA=!0,XA(i,n)},NA.times=NA.mul=function(t){var e,n,i,r,s,a,o,l,c,h=this,u=h.constructor,d=h.d,p=(t=new u(t)).d;if(!h.s||!t.s)return new u(0);for(t.s*=h.s,n=h.e+t.e,(l=d.length)<(c=p.length)&&(s=d,d=p,p=s,a=l,l=c,c=a),s=[],i=a=l+c;i--;)s.push(0);for(i=c;--i>=0;){for(e=0,r=l+i;r>i;)o=s[r]+p[i]*d[r-i-1]+e,s[r--]=o%IA|0,e=o/IA|0;s[r]=(s[r]+e)%IA|0}for(;!s[--a];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,TA?XA(t,u.precision):t},NA.toDecimalPlaces=NA.todp=function(t,e){var n=this,i=n.constructor;return n=new i(n),void 0===t?n:(FA(t,0,SA),void 0===e?e=i.rounding:FA(e,0,8),XA(n,t+VA(n)+1,e))},NA.toExponential=function(t,e){var n,i=this,r=i.constructor;return void 0===t?n=YA(i,!0):(FA(t,0,SA),void 0===e?e=r.rounding:FA(e,0,8),n=YA(i=XA(new r(i),t+1,e),!0,t+1)),n},NA.toFixed=function(t,e){var n,i,r=this,s=r.constructor;return void 0===t?YA(r):(FA(t,0,SA),void 0===e?e=s.rounding:FA(e,0,8),n=YA((i=XA(new s(r),t+VA(r)+1,e)).abs(),!1,t+VA(i)+1),r.isneg()&&!r.isZero()?"-"+n:n)},NA.toInteger=NA.toint=function(){var t=this,e=t.constructor;return XA(new e(t),VA(t)+1,e.rounding)},NA.toNumber=function(){return+this},NA.toPower=NA.pow=function(t){var e,n,i,r,s,a,o=this,l=o.constructor,c=+(t=new l(t));if(!t.s)return new l(wA);if(!(o=new l(o)).s){if(t.s<1)throw Error(EA+"Infinity");return o}if(o.eq(wA))return o;if(i=l.precision,t.eq(wA))return XA(o,i);if(a=(e=t.e)>=(n=t.d.length-1),s=o.s,a){if((n=c<0?-c:c)<=DA){for(r=new l(wA),e=Math.ceil(i/7+4),TA=!1;n%2&&KA((r=r.times(o)).d,e),0!==(n=RA(n/2));)KA((o=o.times(o)).d,e);return TA=!0,t.s<0?new l(wA).div(r):XA(r,i)}}else if(s<0)throw Error(EA+"NaN");return s=s<0&&1&t.d[Math.max(e,n)]?-1:1,o.s=1,TA=!1,r=t.times(jA(o,i+12)),TA=!0,(r=zA(r)).s=s,r},NA.toPrecision=function(t,e){var n,i,r=this,s=r.constructor;return void 0===t?i=YA(r,(n=VA(r))<=s.toExpNeg||n>=s.toExpPos):(FA(t,1,SA),void 0===e?e=s.rounding:FA(e,0,8),i=YA(r=XA(new s(r),t,e),t<=(n=VA(r))||n<=s.toExpNeg,t)),i},NA.toSignificantDigits=NA.tosd=function(t,e){var n=this.constructor;return void 0===t?(t=n.precision,e=n.rounding):(FA(t,1,SA),void 0===e?e=n.rounding:FA(e,0,8)),XA(new n(this),t,e)},NA.toString=NA.valueOf=NA.val=NA.toJSON=NA[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=VA(t),n=t.constructor;return YA(t,e<=n.toExpNeg||e>=n.toExpPos)};var BA=function(){function t(t,e){var n,i=0,r=t.length;for(t=t.slice();r--;)n=t[r]*e+i,t[r]=n%IA|0,i=n/IA|0;return i&&t.unshift(i),t}function e(t,e,n,i){var r,s;if(n!=i)s=n>i?1:-1;else for(r=s=0;r<n;r++)if(t[r]!=e[r]){s=t[r]>e[r]?1:-1;break}return s}function n(t,e,n){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*IA+t[n]-e[n];for(;!t[0]&&t.length>1;)t.shift()}return function(i,r,s,a){var o,l,c,h,u,d,p,f,m,g,v,y,_,x,b,M,w,S,T=i.constructor,E=i.s==r.s?1:-1,A=i.d,C=r.d;if(!i.s)return new T(i);if(!r.s)throw Error(EA+"Division by zero");for(l=i.e-r.e,w=C.length,b=A.length,f=(p=new T(E)).d=[],c=0;C[c]==(A[c]||0);)++c;if(C[c]>(A[c]||0)&&--l,(y=null==s?s=T.precision:a?s+(VA(i)-VA(r))+1:s)<0)return new T(0);if(y=y/7+2|0,c=0,1==w)for(h=0,C=C[0],y++;(c<b||h)&&y--;c++)_=h*IA+(A[c]||0),f[c]=_/C|0,h=_%C|0;else{for((h=IA/(C[0]+1)|0)>1&&(C=t(C,h),A=t(A,h),w=C.length,b=A.length),x=w,g=(m=A.slice(0,w)).length;g<w;)m[g++]=0;(S=C.slice()).unshift(0),M=C[0],C[1]>=IA/2&&++M;do{h=0,(o=e(C,m,w,g))<0?(v=m[0],w!=g&&(v=v*IA+(m[1]||0)),(h=v/M|0)>1?(h>=IA&&(h=IA-1),1==(o=e(u=t(C,h),m,d=u.length,g=m.length))&&(h--,n(u,w<d?S:C,d))):(0==h&&(o=h=1),u=C.slice()),(d=u.length)<g&&u.unshift(0),n(m,u,g),-1==o&&(o=e(C,m,w,g=m.length))<1&&(h++,n(m,w<g?S:C,g)),g=m.length):0===o&&(h++,m=[0]),f[c++]=h,o&&m[0]?m[g++]=A[x]||0:(m=[A[x]],g=1)}while((x++<b||void 0!==m[0])&&y--)}return f[0]||f.shift(),p.e=l,XA(p,a?s+VA(p)+1:s)}}();function zA(t,e){var n,i,r,s,a,o=0,l=0,c=t.constructor,h=c.precision;if(VA(t)>16)throw Error(CA+VA(t));if(!t.s)return new c(wA);for(TA=!1,a=h,s=new c(.03125);t.abs().gte(.1);)t=t.times(s),l+=5;for(a+=Math.log(PA(2,l))/Math.LN10*2+5|0,n=i=r=new c(wA),c.precision=a;;){if(i=XA(i.times(t),a),n=n.times(++o),kA((s=r.plus(BA(i,n,a))).d).slice(0,a)===kA(r.d).slice(0,a)){for(;l--;)r=XA(r.times(r),a);return c.precision=h,null==e?(TA=!0,XA(r,h)):r}r=s}}function VA(t){for(var e=7*t.e,n=t.d[0];n>=10;n/=10)e++;return e}function HA(t,e,n){if(e>t.LN10.sd())throw TA=!0,n&&(t.precision=n),Error(EA+"LN10 precision limit exceeded");return XA(new t(t.LN10),e)}function WA(t){for(var e="";t--;)e+="0";return e}function jA(t,e){var n,i,r,s,a,o,l,c,h,u=1,d=t,p=d.d,f=d.constructor,m=f.precision;if(d.s<1)throw Error(EA+(d.s?"NaN":"-Infinity"));if(d.eq(wA))return new f(0);if(null==e?(TA=!1,c=m):c=e,d.eq(10))return null==e&&(TA=!0),HA(f,c);if(c+=10,f.precision=c,i=(n=kA(p)).charAt(0),s=VA(d),!(Math.abs(s)<15e14))return l=HA(f,c+2,m).times(s+""),d=jA(new f(i+"."+n.slice(1)),c-10).plus(l),f.precision=m,null==e?(TA=!0,XA(d,m)):d;for(;i<7&&1!=i||1==i&&n.charAt(1)>3;)i=(n=kA((d=d.times(t)).d)).charAt(0),u++;for(s=VA(d),i>1?(d=new f("0."+n),s++):d=new f(i+"."+n.slice(1)),o=a=d=BA(d.minus(wA),d.plus(wA),c),h=XA(d.times(d),c),r=3;;){if(a=XA(a.times(h),c),kA((l=o.plus(BA(a,new f(r),c))).d).slice(0,c)===kA(o.d).slice(0,c))return o=o.times(2),0!==s&&(o=o.plus(HA(f,c+2,m).times(s+""))),o=BA(o,new f(u),c),f.precision=m,null==e?(TA=!0,XA(o,m)):o;o=l,r+=2}}function GA(t,e){var n,i,r;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;48===e.charCodeAt(i);)++i;for(r=e.length;48===e.charCodeAt(r-1);)--r;if(e=e.slice(i,r)){if(r-=i,n=n-i-1,t.e=RA(n/7),t.d=[],i=(n+1)%7,n<0&&(i+=7),i<r){for(i&&t.d.push(+e.slice(0,i)),r-=7;i<r;)t.d.push(+e.slice(i,i+=7));i=7-(e=e.slice(i)).length}else i-=r;for(;i--;)e+="0";if(t.d.push(+e),TA&&(t.e>LA||t.e<-LA))throw Error(CA+n)}else t.s=0,t.e=0,t.d=[0];return t}function XA(t,e,n){var i,r,s,a,o,l,c,h,u=t.d;for(a=1,s=u[0];s>=10;s/=10)a++;if((i=e-a)<0)i+=7,r=e,c=u[h=0];else{if((h=Math.ceil((i+1)/7))>=(s=u.length))return t;for(c=s=u[h],a=1;s>=10;s/=10)a++;r=(i%=7)-7+a}if(void 0!==n&&(o=c/(s=PA(10,a-r-1))%10|0,l=e<0||void 0!==u[h+1]||c%s,l=n<4?(o||l)&&(0==n||n==(t.s<0?3:2)):o>5||5==o&&(4==n||l||6==n&&(i>0?r>0?c/PA(10,a-r):0:u[h-1])%10&1||n==(t.s<0?8:7))),e<1||!u[0])return l?(s=VA(t),u.length=1,e=e-s-1,u[0]=PA(10,(7-e%7)%7),t.e=RA(-e/7)||0):(u.length=1,u[0]=t.e=t.s=0),t;if(0==i?(u.length=h,s=1,h--):(u.length=h+1,s=PA(10,7-i),u[h]=r>0?(c/PA(10,a-r)%PA(10,r)|0)*s:0),l)for(;;){if(0==h){(u[0]+=s)==IA&&(u[0]=1,++t.e);break}if(u[h]+=s,u[h]!=IA)break;u[h--]=0,s=1}for(i=u.length;0===u[--i];)u.pop();if(TA&&(t.e>LA||t.e<-LA))throw Error(CA+VA(t));return t}function qA(t,e){var n,i,r,s,a,o,l,c,h,u,d=t.constructor,p=d.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new d(t),TA?XA(e,p):e;if(l=t.d,u=e.d,i=e.e,c=t.e,l=l.slice(),a=c-i){for((h=a<0)?(n=l,a=-a,o=u.length):(n=u,i=c,o=l.length),a>(r=Math.max(Math.ceil(p/7),o)+2)&&(a=r,n.length=1),n.reverse(),r=a;r--;)n.push(0);n.reverse()}else{for((h=(r=l.length)<(o=u.length))&&(o=r),r=0;r<o;r++)if(l[r]!=u[r]){h=l[r]<u[r];break}a=0}for(h&&(n=l,l=u,u=n,e.s=-e.s),o=l.length,r=u.length-o;r>0;--r)l[o++]=0;for(r=u.length;r>a;){if(l[--r]<u[r]){for(s=r;s&&0===l[--s];)l[s]=IA-1;--l[s],l[r]+=IA}l[r]-=u[r]}for(;0===l[--o];)l.pop();for(;0===l[0];l.shift())--i;return l[0]?(e.d=l,e.e=i,TA?XA(e,p):e):new d(0)}function YA(t,e,n){var i,r=VA(t),s=kA(t.d),a=s.length;return e?(n&&(i=n-a)>0?s=s.charAt(0)+"."+s.slice(1)+WA(i):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(r<0?"e":"e+")+r):r<0?(s="0."+WA(-r-1)+s,n&&(i=n-a)>0&&(s+=WA(i))):r>=a?(s+=WA(r+1-a),n&&(i=n-r-1)>0&&(s=s+"."+WA(i))):((i=r+1)<a&&(s=s.slice(0,i)+"."+s.slice(i)),n&&(i=n-a)>0&&(r+1===a&&(s+="."),s+=WA(i))),t.s<0?"-"+s:s}function KA(t,e){if(t.length>e)return t.length=e,!0}function ZA(t){if(!t||"object"!=typeof t)throw Error(EA+"Object expected");var e,n,i,r=["precision",1,SA,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<r.length;e+=3)if(void 0!==(i=t[n=r[e]])){if(!(RA(i)===i&&i>=r[e+1]&&i<=r[e+2]))throw Error(AA+n+": "+i);this[n]=i}if(void 0!==(i=t[n="LN10"])){if(i!=Math.LN10)throw Error(AA+n+": "+i);this[n]=new this(i)}return this}var $A=function t(e){var n,i,r;function s(t){var e=this;if(!(e instanceof s))return new s(t);if(e.constructor=s,t instanceof s)return e.s=t.s,e.e=t.e,void(e.d=(t=t.d)?t.slice():t);if("number"==typeof t){if(0*t!=0)throw Error(AA+t);if(t>0)e.s=1;else{if(!(t<0))return e.s=0,e.e=0,void(e.d=[0]);t=-t,e.s=-1}return t===~~t&&t<1e7?(e.e=0,void(e.d=[t])):GA(e,t.toString())}if("string"!=typeof t)throw Error(AA+t);if(45===t.charCodeAt(0)?(t=t.slice(1),e.s=-1):e.s=1,!OA.test(t))throw Error(AA+t);GA(e,t)}if(s.prototype=NA,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=t,s.config=s.set=ZA,void 0===e&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<r.length;)e.hasOwnProperty(i=r[n++])||(e[i]=this[i]);return s.config(e),s}({precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"});wA=new $A(1);const JA=$A;var QA,tC;function eC(t,e){throw new Error("Invariant failed")}const nC=Vt(tC?QA:(tC=1,QA=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}));const iC=Vt(Pm());function rC(){return rC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},rC.apply(null,arguments)}var sC,aC;const oC=Vt(function(){if(aC)return sC;aC=1;var t=aA(),e=oA(),n=ET();return sC=function(i,r){return i&&i.length?t(i,n(r,2),e):void 0}}());var lC,cC;const hC=Vt(function(){if(cC)return lC;cC=1;var t=aA(),e=ET(),n=pA();return lC=function(i,r){return i&&i.length?t(i,e(r,2),n):void 0}}());var uC,dC,pC,fC;const mC=Vt(function(){if(fC)return pC;fC=1;var t=ab(),e=function(){if(dC)return uC;dC=1;var t=uT()(Object.getPrototypeOf,Object);return uC=t}(),n=ob(),i=Function.prototype,r=Object.prototype,s=i.toString,a=r.hasOwnProperty,o=s.call(Object);return pC=function(i){if(!n(i)||"[object Object]"!=t(i))return!1;var r=e(i);if(null===r)return!0;var l=a.call(r,"constructor")&&r.constructor;return"function"==typeof l&&l instanceof l&&s.call(l)==o}}());var gC,vC;const yC=Vt(function(){if(vC)return gC;vC=1;var t=ab(),e=ob();return gC=function(n){return!0===n||!1===n||e(n)&&"[object Boolean]"==t(n)}}());var _C,xC,bC,MC,wC,SC,TC,EC;function AC(){if(MC)return bC;MC=1;var t=YE(),e=1/0;return bC=function(n){return n?(n=t(n))===e||n===-1/0?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0}}function CC(){if(SC)return wC;SC=1;var t=function(){if(xC)return _C;xC=1;var t=Math.ceil,e=Math.max;return _C=function(n,i,r,s){for(var a=-1,o=e(t((i-n)/(r||1)),0),l=Array(o);o--;)l[s?o:++a]=n,n+=r;return l}}(),e=DE(),n=AC();return wC=function(i){return function(r,s,a){return a&&"number"!=typeof a&&e(r,s,a)&&(s=a=void 0),r=n(r),void 0===s?(s=r,r=0):s=n(s),a=void 0===a?r<s?1:-1:n(a),t(r,s,a,i)}}}const RC=Vt(function(){if(EC)return TC;EC=1;var t=CC()();return TC=t}());var PC,OC,IC,DC;const LC=Vt(function(){if(DC)return IC;DC=1;var t=cw(),e=ET(),n=function(){if(OC)return PC;OC=1;var t=TE();return PC=function(e,n){var i;return t(e,function(t,e,r){return!(i=n(t,e,r))}),!!i}}(),i=nb(),r=DE();return IC=function(s,a,o){var l=i(s)?t:n;return o&&r(s,a,o)&&(a=void 0),l(s,e(a,3))}}());var NC,UC,FC,kC;const BC=Vt(function(){if(kC)return FC;kC=1;var t=function(){if(UC)return NC;UC=1;var t=PE();return NC=function(e,n,i){"__proto__"==n&&t?t(e,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[n]=i}}(),e=SE(),n=ET();return FC=function(i,r){var s={};return r=n(r,3),e(i,function(e,n,i){t(s,n,r(e,n,i))}),s}}());var zC,VC,HC,WC,jC,GC;const XC=Vt(function(){if(GC)return jC;GC=1;var t=VC?zC:(VC=1,zC=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}),e=function(){if(WC)return HC;WC=1;var t=TE();return HC=function(e,n){var i=!0;return t(e,function(t,e,r){return i=!!n(t,e,r)}),i}}(),n=ET(),i=nb(),r=DE();return jC=function(s,a,o){var l=i(s)?t:e;return o&&r(s,a,o)&&(a=void 0),l(s,n(a,3))}}());var qC,YC,KC,ZC,$C,JC,QC,tR;function eR(){if(JC)return $C;JC=1;var t=AT(),e=ET(),n=function(){if(ZC)return KC;ZC=1;var t=AC();return KC=function(e){var n=t(e),i=n%1;return n==n?i?n-i:n:0}}(),i=Math.max;return $C=function(r,s,a){var o=null==r?0:r.length;if(!o)return-1;var l=null==a?0:n(a);return l<0&&(l=i(o+l,0)),t(r,e(s,3),l)}}const nR=Vt(function(){if(tR)return QC;tR=1;var t=function(){if(YC)return qC;YC=1;var t=ET(),e=pT(),n=fT();return qC=function(i){return function(r,s,a){var o=Object(r);if(!e(r)){var l=t(s,3);r=n(r),s=function(t){return l(o[t],t,o)}}var c=i(r,s,a);return c>-1?o[l?r[c]:c]:void 0}}}()(eR());return QC=t}());const iR=Vt(wb());function rR(t,[e,n]){return Math.min(n,Math.max(e,t))}function sR(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t?.(i),!1===n||!i.defaultPrevented)return e?.(i)}}const aR=t=>"boolean"==typeof t?`${t}`:0===t?"0":t,oR=Ht,lR=(t,e)=>n=>{var i;if(null==(null==e?void 0:e.variants))return oR(t,null==n?void 0:n.class,null==n?void 0:n.className);const{variants:r,defaultVariants:s}=e,a=Object.keys(r).map(t=>{const e=null==n?void 0:n[t],i=null==s?void 0:s[t];if(null===e)return null;const a=aR(e)||aR(i);return r[t][a]}),o=n&&Object.entries(n).reduce((t,e)=>{let[n,i]=e;return void 0===i||(t[n]=i),t},{}),l=null==e||null===(i=e.compoundVariants)||void 0===i?void 0:i.reduce((t,e)=>{let{class:n,className:i,...r}=e;return Object.entries(r).every(t=>{let[e,n]=t;return Array.isArray(n)?n.includes({...s,...o}[e]):{...s,...o}[e]===n})?[...t,n,i]:t},[]);return oR(t,a,l,null==n?void 0:n.class,null==n?void 0:n.className)},cR=Object.create(null);cR.open="0",cR.close="1",cR.ping="2",cR.pong="3",cR.message="4",cR.upgrade="5",cR.noop="6";const hR=Object.create(null);Object.keys(cR).forEach(t=>{hR[cR[t]]=t});const uR={type:"error",data:"parser error"},dR="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),pR="function"==typeof ArrayBuffer,fR=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,mR=({type:t,data:e},n,i)=>dR&&e instanceof Blob?n?i(e):gR(e,i):pR&&(e instanceof ArrayBuffer||fR(e))?n?i(e):gR(new Blob([e]),i):i(cR[t]+(e||"")),gR=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+(t||""))},n.readAsDataURL(t)};function vR(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let yR;const _R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xR="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let AX=0;AX<64;AX++)xR[_R.charCodeAt(AX)]=AX;const bR="function"==typeof ArrayBuffer,MR=(t,e)=>{if("string"!=typeof t)return{type:"message",data:SR(t,e)};const n=t.charAt(0);if("b"===n)return{type:"message",data:wR(t.substring(1),e)};return hR[n]?t.length>1?{type:hR[n],data:t.substring(1)}:{type:hR[n]}:uR},wR=(t,e)=>{if(bR){const n=(t=>{let e,n,i,r,s,a=.75*t.length,o=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);const c=new ArrayBuffer(a),h=new Uint8Array(c);for(e=0;e<o;e+=4)n=xR[t.charCodeAt(e)],i=xR[t.charCodeAt(e+1)],r=xR[t.charCodeAt(e+2)],s=xR[t.charCodeAt(e+3)],h[l++]=n<<2|i>>4,h[l++]=(15&i)<<4|r>>2,h[l++]=(3&r)<<6|63&s;return c})(t);return SR(n,e)}return{base64:!0,data:t}},SR=(t,e)=>"blob"===e?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,TR=String.fromCharCode(30);function ER(){return new TransformStream({transform(t,e){!function(t,e){dR&&t.data instanceof Blob?t.data.arrayBuffer().then(vR).then(e):pR&&(t.data instanceof ArrayBuffer||fR(t.data))?e(vR(t.data)):mR(t,!1,t=>{yR||(yR=new TextEncoder),e(yR.encode(t))})}(t,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const t=new DataView(r.buffer);t.setUint8(0,126),t.setUint16(1,i)}else{r=new Uint8Array(9);const t=new DataView(r.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(i))}t.data&&"string"!=typeof t.data&&(r[0]|=128),e.enqueue(r),e.enqueue(n)})}})}let AR;function CR(t){return t.reduce((t,e)=>t+e.length,0)}function RR(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let i=0;for(let r=0;r<e;r++)n[r]=t[0][i++],i===t[0].length&&(t.shift(),i=0);return t.length&&i<t[0].length&&(t[0]=t[0].slice(i)),n}function PR(t){if(t)return function(t){for(var e in PR.prototype)t[e]=PR.prototype[e];return t}(t)}PR.prototype.on=PR.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},PR.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},PR.prototype.off=PR.prototype.removeListener=PR.prototype.removeAllListeners=PR.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<i.length;r++)if((n=i[r])===e||n.fn===e){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+t],this},PR.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){i=0;for(var r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,e)}return this},PR.prototype.emitReserved=PR.prototype.emit,PR.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},PR.prototype.hasListeners=function(t){return!!this.listeners(t).length};const OR="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),IR="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function DR(t,...e){return e.reduce((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e),{})}const LR=IR.setTimeout,NR=IR.clearTimeout;function UR(t,e){e.useNativeTimers?(t.setTimeoutFn=LR.bind(IR),t.clearTimeoutFn=NR.bind(IR)):(t.setTimeoutFn=IR.setTimeout.bind(IR),t.clearTimeoutFn=IR.clearTimeout.bind(IR))}function FR(t){return"string"==typeof t?function(t){let e=0,n=0;for(let i=0,r=t.length;i<r;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))}function kR(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class BR extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}}class zR extends PR{constructor(t){super(),this.writable=!1,UR(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,n){return super.emitReserved("error",new BR(t,e,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=MR(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return-1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){const e=function(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}(t);return e.length?"?"+e:""}}class VR extends zR{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let t=0;this._polling&&(t++,this.once("pollComplete",function(){--t||e()})),this.writable||(t++,this.once("drain",function(){--t||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((t,e)=>{const n=t.split(TR),i=[];for(let r=0;r<n.length;r++){const t=MR(n[r],e);if(i.push(t),"error"===t.type)break}return i})(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((t,e)=>{const n=t.length,i=new Array(n);let r=0;t.forEach((t,s)=>{mR(t,!1,t=>{i[s]=t,++r===n&&e(i.join(TR))})})})(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=kR()),this.supportsBinary||e.sid||(e.b64=1),this.createUri(t,e)}}let HR=!1;try{HR="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(TX){}const WR=HR;function jR(){}class GR extends VR{constructor(t){if(super(t),"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",(t,e)=>{this.onError("xhr post error",t,e)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t,e)=>{this.onError("xhr poll error",t,e)}),this.pollXhr=t}}let XR=class t extends PR{constructor(t,e,n){super(),this.createRequest=t,UR(this,n),this._opts=n,this._method=n.method||"GET",this._uri=e,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const n=DR(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let t in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(t)&&i.setRequestHeader(t,this._opts.extraHeaders[t])}}catch(r){}if("POST"===this._method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{i.setRequestHeader("Accept","*/*")}catch(r){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var t;3===i.readyState&&(null===(t=this._opts.cookieJar)||void 0===t||t.parseCookies(i.getResponseHeader("set-cookie"))),4===i.readyState&&(200===i.status||1223===i.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof i.status?i.status:0)},0))},i.send(this._data)}catch(r){return void this.setTimeoutFn(()=>{this._onError(r)},0)}"undefined"!=typeof document&&(this._index=t.requestsCount++,t.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=jR,e)try{this._xhr.abort()}catch(n){}"undefined"!=typeof document&&delete t.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};if(XR.requestsCount=0,XR.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",qR);else if("function"==typeof addEventListener){addEventListener("onpagehide"in IR?"pagehide":"unload",qR,!1)}function qR(){for(let t in XR.requests)XR.requests.hasOwnProperty(t)&&XR.requests[t].abort()}const YR=function(){const t=KR({xdomain:!1});return t&&null!==t.responseType}();function KR(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||WR))return new XMLHttpRequest}catch(n){}if(!e)try{return new(IR[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}const ZR="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class $R extends zR{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,n=ZR?{}:DR(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,n)}catch(TX){return this.emitReserved("error",TX)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],i=e===t.length-1;mR(n,this.supportsBinary,t=>{try{this.doWrite(n,t)}catch(e){}i&&OR(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=kR()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const JR=IR.WebSocket||IR.MozWebSocket;const QR={websocket:class extends $R{createSocket(t,e,n){return ZR?new JR(t,e,n):e?new JR(t,e):new JR(t)}doWrite(t,e){this.ws.send(e)}},webtransport:class extends zR{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(TX){return this.emitReserved("error",TX)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=function(t,e){AR||(AR=new TextDecoder);const n=[];let i=0,r=-1,s=!1;return new TransformStream({transform(a,o){for(n.push(a);;){if(0===i){if(CR(n)<1)break;const t=RR(n,1);s=!(128&~t[0]),r=127&t[0],i=r<126?3:126===r?1:2}else if(1===i){if(CR(n)<2)break;const t=RR(n,2);r=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),i=3}else if(2===i){if(CR(n)<8)break;const t=RR(n,8),e=new DataView(t.buffer,t.byteOffset,t.length),s=e.getUint32(0);if(s>Math.pow(2,21)-1){o.enqueue(uR);break}r=s*Math.pow(2,32)+e.getUint32(4),i=3}else{if(CR(n)<r)break;const t=RR(n,r);o.enqueue(MR(s?t:AR.decode(t),e)),i=0}if(0===r||r>t){o.enqueue(uR);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(e).getReader(),i=ER();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const r=()=>{n.read().then(({done:t,value:e})=>{t||(this.onPacket(e),r())}).catch(t=>{})};r();const s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],i=e===t.length-1;this._writer.write(n).then(()=>{i&&OR(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;null===(t=this._transport)||void 0===t||t.close()}},polling:class extends GR{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=YR&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new XR(KR,this.uri(),t)}}},tP=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,eP=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function nP(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),i=t.indexOf("]");-1!=n&&-1!=i&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));let r=tP.exec(t||""),s={},a=14;for(;a--;)s[eP[a]]=r[a]||"";return-1!=n&&-1!=i&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(t,e){const n=/\/{2,9}/g,i=e.replace(n,"/").split("/");"/"!=e.slice(0,1)&&0!==e.length||i.splice(0,1);"/"==e.slice(-1)&&i.splice(i.length-1,1);return i}(0,s.path),s.queryKey=function(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,i){e&&(n[e]=i)}),n}(0,s.query),s}const iP="function"==typeof addEventListener&&"function"==typeof removeEventListener,rP=[];iP&&addEventListener("offline",()=>{rP.forEach(t=>t())},!1);class sP extends PR{constructor(t,e){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&"object"==typeof t&&(e=t,t=null),t){const n=nP(t);e.hostname=n.host,e.secure="https"===n.protocol||"wss"===n.protocol,e.port=n.port,n.query&&(e.query=n.query)}else e.host&&(e.hostname=nP(e.host).host);UR(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(t=>{const e=t.prototype.name;this.transports.push(e),this._transportsByName[e]=t}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let e={},n=t.split("&");for(let i=0,r=n.length;i<r;i++){let t=n[i].split("=");e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}return e}(this.opts.query)),iP&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},rP.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const t=this.opts.rememberUpgrade&&sP.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",sP.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let e=0;e<this.writeBuffer.length;e++){const n=this.writeBuffer[e].data;if(n&&(t+=FR(n)),e>0&&t>this._maxPayload)return this.writeBuffer.slice(0,e);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,OR(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,n){return this._sendPacket("message",t,e,n),this}send(t,e,n){return this._sendPacket("message",t,e,n),this}_sendPacket(t,e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const r={type:t,data:e,options:n};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(sP.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),iP&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const t=rP.indexOf(this._offlineEventListener);-1!==t&&rP.splice(t,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}sP.protocol=4;class aP extends sP{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),n=!1;sP.priorWebsocketSuccess=!1;const i=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;sP.priorWebsocketSuccess="websocket"===e.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}}))};function r(){n||(n=!0,c(),e.close(),e=null)}const s=t=>{const n=new Error("probe error: "+t);n.transport=e.name,r(),this.emitReserved("upgradeError",n)};function a(){s("transport closed")}function o(){s("socket closed")}function l(t){e&&t.name!==e.name&&r()}const c=()=>{e.removeListener("open",i),e.removeListener("error",s),e.removeListener("close",a),this.off("close",o),this.off("upgrading",l)};e.once("open",i),e.once("error",s),e.once("close",a),this.once("close",o),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn(()=>{n||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}let oP=class extends aP{constructor(t,e={}){const n="object"==typeof t?t:e;(!n.transports||n.transports&&"string"==typeof n.transports[0])&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(t=>QR[t]).filter(t=>!!t)),super(t,n)}};const lP="function"==typeof ArrayBuffer,cP=Object.prototype.toString,hP="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===cP.call(Blob),uP="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===cP.call(File);function dP(t){return lP&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||hP&&t instanceof Blob||uP&&t instanceof File}function pP(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(pP(t[e]))return!0;return!1}if(dP(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return pP(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&pP(t[n]))return!0;return!1}function fP(t){const e=[],n=t.data,i=t;return i.data=mP(n,e),i.attachments=e.length,{packet:i,buffers:e}}function mP(t,e){if(!t)return t;if(dP(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=mP(t[i],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=mP(t[i],e));return n}return t}function gP(t,e){return t.data=vP(t.data,e),delete t.attachments,t}function vP(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=vP(t[n],e);else if("object"==typeof t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=vP(t[n],e));return t}const yP=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var _P,xP;(xP=_P||(_P={}))[xP.CONNECT=0]="CONNECT",xP[xP.DISCONNECT=1]="DISCONNECT",xP[xP.EVENT=2]="EVENT",xP[xP.ACK=3]="ACK",xP[xP.CONNECT_ERROR=4]="CONNECT_ERROR",xP[xP.BINARY_EVENT=5]="BINARY_EVENT",xP[xP.BINARY_ACK=6]="BINARY_ACK";function bP(t){return"[object Object]"===Object.prototype.toString.call(t)}class MP extends PR{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const n=e.type===_P.BINARY_EVENT;n||e.type===_P.BINARY_ACK?(e.type=n?_P.EVENT:_P.ACK,this.reconstructor=new wP(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!dP(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===_P[n.type])throw new Error("unknown packet type "+n.type);if(n.type===_P.BINARY_EVENT||n.type===_P.BINARY_ACK){const i=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const r=t.substring(i,e);if(r!=Number(r)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===t.charAt(e+1)){const i=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}n.nsp=t.substring(i,e)}else n.nsp="/";const i=t.charAt(e+1);if(""!==i&&Number(i)==i){const i=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(!MP.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(e){return!1}}static isPayloadValid(t,e){switch(t){case _P.CONNECT:return bP(e);case _P.DISCONNECT:return void 0===e;case _P.CONNECT_ERROR:return"string"==typeof e||bP(e);case _P.EVENT:case _P.BINARY_EVENT:return Array.isArray(e)&&("number"==typeof e[0]||"string"==typeof e[0]&&-1===yP.indexOf(e[0]));case _P.ACK:case _P.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class wP{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=gP(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const SP=Object.freeze(Object.defineProperty({__proto__:null,Decoder:MP,Encoder:class{constructor(t){this.replacer=t}encode(t){return t.type!==_P.EVENT&&t.type!==_P.ACK||!pP(t)?[this.encodeAsString(t)]:this.encodeAsBinary({type:t.type===_P.EVENT?_P.BINARY_EVENT:_P.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id})}encodeAsString(t){let e=""+t.type;return t.type!==_P.BINARY_EVENT&&t.type!==_P.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=fP(t),n=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(n),i}},get PacketType(){return _P},protocol:5},Symbol.toStringTag,{value:"Module"}));function TP(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const EP=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class AP extends PR{constructor(t,e,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[TP(t,"open",this.onopen.bind(this)),TP(t,"packet",this.onpacket.bind(this)),TP(t,"error",this.onerror.bind(this)),TP(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var n,i,r;if(EP.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const s={type:_P.EVENT,data:e,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,n=e.pop();this._registerAckCallback(t,n),s.id=t}const a=null===(i=null===(n=this.io.engine)||void 0===n?void 0:n.transport)||void 0===i?void 0:i.writable,o=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!a||(o?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(t,e){var n;const i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===i)return void(this.acks[t]=e);const r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))},i),s=(...t)=>{this.io.clearTimeoutFn(r),e.apply(this,t)};s.withError=!0,this.acks[t]=s}emitWithAck(t,...e){return new Promise((n,i)=>{const r=(t,e)=>t?i(t):n(e);r.withError=!0,e.push(r),this.emit(t,...e)})}_addToQueue(t){let e;"function"==typeof t[t.length-1]&&(e=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((t,...i)=>{if(n!==this._queue[0])return;return null!==t?n.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(t)):(this._queue.shift(),e&&e(null,...i)),n.pending=!1,this._drainQueue()}),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||0===this._queue.length)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:_P.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(e=>String(e.id)===t)){const e=this.acks[t];delete this.acks[t],e.withError&&e.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case _P.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _P.EVENT:case _P.BINARY_EVENT:this.onevent(t);break;case _P.ACK:case _P.BINARY_ACK:this.onack(t);break;case _P.DISCONNECT:this.ondisconnect();break;case _P.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let n=!1;return function(...i){n||(n=!0,e.packet({type:_P.ACK,id:t,data:i}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:_P.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const n of e)n.apply(this,t.data)}}}function CP(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}CP.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=1&Math.floor(10*e)?t+n:t-n}return 0|Math.min(t,this.max)},CP.prototype.reset=function(){this.attempts=0},CP.prototype.setMin=function(t){this.ms=t},CP.prototype.setMax=function(t){this.max=t},CP.prototype.setJitter=function(t){this.jitter=t};class RP extends PR{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,UR(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new CP({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const i=e.parser||SP;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new oP(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=TP(e,"open",function(){n.onopen(),t&&t()}),r=e=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",e),t?t(e):this.maybeReconnectOnOpen()},s=TP(e,"error",r);if(!1!==this._timeout){const t=this._timeout,n=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),e.close()},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(i),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(TP(t,"ping",this.onping.bind(this)),TP(t,"data",this.ondata.bind(this)),TP(t,"error",this.onerror.bind(this)),TP(t,"close",this.onclose.bind(this)),TP(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){OR(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new AP(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const n of e){if(this.nsps[n].active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()}))},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const PP={};function OP(t,e){"object"==typeof t&&(e=t,t=void 0);const n=function(t,e="",n){let i=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),i=nP(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+e,i.href=i.protocol+"://"+r+(n&&n.port===i.port?"":":"+i.port),i}(t,(e=e||{}).path||"/socket.io"),i=n.source,r=n.id,s=n.path,a=PP[r]&&s in PP[r].nsps;let o;return e.forceNew||e["force new connection"]||!1===e.multiplex||a?o=new RP(i,e):(PP[r]||(PP[r]=new RP(i,e)),o=PP[r]),n.query&&!e.query&&(e.query=n.queryKey),o.socket(n.path,e)}Object.assign(OP,{Manager:RP,Socket:AP,io:OP,connect:OP});const IP="180",DP={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},LP={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},NP=0,UP=1,FP=2,kP=3,BP=0,zP=1,VP=2,HP=0,WP=2,jP=100,GP=101,XP=102,qP=200,YP=201,KP=202,ZP=203,$P=204,JP=205,QP=206,tO=207,eO=208,nO=209,iO=210,rO=211,sO=212,aO=213,oO=214,lO=0,cO=1,hO=2,uO=3,dO=4,pO=5,fO=6,mO=7,gO=0,vO=4,yO="attached",_O="detached",xO=300,bO=301,MO=302,wO=303,SO=304,TO=306,EO=1e3,AO=1001,CO=1002,RO=1003,PO=1004,OO=1005,IO=1006,DO=1007,LO=1008,NO=1008,UO=1009,FO=1010,kO=1011,BO=1012,zO=1013,VO=1014,HO=1015,WO=1016,jO=1017,GO=1018,XO=1020,qO=35902,YO=35899,KO=1021,ZO=1022,$O=1023,JO=1026,QO=1027,tI=1028,eI=1029,nI=1030,iI=1031,rI=1033,sI=33776,aI=33777,oI=33778,lI=33779,cI=35840,hI=35841,uI=35842,dI=35843,pI=36196,fI=37492,mI=37496,gI=37808,vI=37809,yI=37810,_I=37811,xI=37812,bI=37813,MI=37814,wI=37815,SI=37816,TI=37817,EI=37818,AI=37819,CI=37820,RI=37821,PI=36492,OI=36494,II=36495,DI=36283,LI=36284,NI=36285,UI=36286,FI=2300,kI=2301,BI=2302,zI=2400,VI=2401,HI=2402,WI=2500,jI=2501,GI="",XI="srgb",qI="srgb-linear",YI="linear",KI="srgb",ZI=7680,$I=512,JI=513,QI=514,tD=515,eD=516,nD=517,iD=518,rD=519,sD=35044,aD="300 es",oD=2e3,lD=2001;let cD=class{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){const n=this._listeners;return void 0!==n&&(void 0!==n[t]&&-1!==n[t].indexOf(e))}removeEventListener(t,e){const n=this._listeners;if(void 0===n)return;const i=n[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}dispatchEvent(t){const e=this._listeners;if(void 0===e)return;const n=e[t.type];if(void 0!==n){t.target=this;const e=n.slice(0);for(let n=0,i=e.length;n<i;n++)e[n].call(this,t);t.target=null}}};const hD=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let uD=1234567;const dD=Math.PI/180,pD=180/Math.PI;function fD(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(hD[255&t]+hD[t>>8&255]+hD[t>>16&255]+hD[t>>24&255]+"-"+hD[255&e]+hD[e>>8&255]+"-"+hD[e>>16&15|64]+hD[e>>24&255]+"-"+hD[63&n|128]+hD[n>>8&255]+"-"+hD[n>>16&255]+hD[n>>24&255]+hD[255&i]+hD[i>>8&255]+hD[i>>16&255]+hD[i>>24&255]).toLowerCase()}function mD(t,e,n){return Math.max(e,Math.min(n,t))}function gD(t,e){return(t%e+e)%e}function vD(t,e,n){return(1-n)*t+n*e}function yD(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function _D(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const xD={DEG2RAD:dD,RAD2DEG:pD,generateUUID:fD,clamp:mD,euclideanModulo:gD,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:vD,damp:function(t,e,n,i){return vD(t,e,1-Math.exp(-n*i))},pingpong:function(t,e=1){return e-Math.abs(gD(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(uD=t);let e=uD+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*dD},radToDeg:function(t){return t*pD},isPowerOfTwo:function(t){return!(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((e+i)/2),h=a((e+i)/2),u=s((e-i)/2),d=a((e-i)/2),p=s((i-e)/2),f=a((i-e)/2);switch(r){case"XYX":t.set(o*h,l*u,l*d,o*c);break;case"YZY":t.set(l*d,o*h,l*u,o*c);break;case"ZXZ":t.set(l*u,l*d,o*h,o*c);break;case"XZX":t.set(o*h,l*f,l*p,o*c);break;case"YXY":t.set(l*p,o*h,l*f,o*c);break;case"ZYZ":t.set(l*f,l*p,o*h,o*c)}},normalize:_D,denormalize:yD};class bD{constructor(t=0,e=0){bD.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=mD(this.x,t.x,e.x),this.y=mD(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=mD(this.x,t,e),this.y=mD(this.y,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(mD(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(mD(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class MD{constructor(t=0,e=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerpFlat(t,e,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],h=n[i+3];const u=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return t[e+0]=o,t[e+1]=l,t[e+2]=c,void(t[e+3]=h);if(1===a)return t[e+0]=u,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(h!==f||o!==u||l!==d||c!==p){let t=1-a;const e=o*u+l*d+c*p+h*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,e*n);t=Math.sin(t*s)/r,a=Math.sin(a*s)/r}const r=a*n;if(o=o*t+u*r,l=l*t+d*r,c=c*t+p*r,h=h*t+f*r,t===1-a){const t=1/Math.sqrt(o*o+l*l+c*c+h*h);o*=t,l*=t,c*=t,h*=t}}t[e]=o,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],h=r[s],u=r[s+1],d=r[s+2],p=r[s+3];return t[e]=a*p+c*h+o*d-l*u,t[e+1]=o*p+c*u+l*h-a*d,t[e+2]=l*p+c*d+a*u-o*h,t[e+3]=c*p-a*h-o*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const n=t._x,i=t._y,r=t._z,s=t._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),h=a(r/2),u=o(n/2),d=o(i/2),p=o(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"YXZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"ZXY":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"ZYX":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"YZX":this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p;break;case"XZY":this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],a=e[5],o=e[9],l=e[2],c=e[6],h=e[10],u=n+a+h;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(c-o)*t,this._y=(r-l)*t,this._z=(s-i)*t}else if(n>a&&n>h){const t=2*Math.sqrt(1+n-a-h);this._w=(c-o)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(r+l)/t}else if(a>h){const t=2*Math.sqrt(1+a-n-h);this._w=(r-l)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(o+c)/t}else{const t=2*Math.sqrt(1+h-n-a);this._w=(s-i)/t,this._x=(r+l)/t,this._y=(o+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<1e-8?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(mD(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,s=t._w,a=e._x,o=e._y,l=e._z,c=e._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,s=this._w;let a=s*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=s*h+this._w*u,this._x=n*h+this._x*u,this._y=i*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(t),i*Math.cos(t),r*Math.sin(e),r*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class wD{constructor(t=0,e=0,n=0){wD.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(TD.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(TD.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,a=t.z,o=t.w,l=2*(s*i-a*n),c=2*(a*e-r*i),h=2*(r*n-s*e);return this.x=e+o*l+s*h-a*c,this.y=n+o*c+a*l-r*h,this.z=i+o*h+r*c-s*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=mD(this.x,t.x,e.x),this.y=mD(this.y,t.y,e.y),this.z=mD(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=mD(this.x,t,e),this.y=mD(this.y,t,e),this.z=mD(this.z,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(mD(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return SD.copy(this).projectOnVector(t),this.sub(SD)}reflect(t){return this.sub(SD.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(mD(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,n=Math.sqrt(1-e*e);return this.x=n*Math.cos(t),this.y=e,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const SD=new wD,TD=new MD;class ED{constructor(t,e,n,i,r,s,a,o,l){ED.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l)}set(t,e,n,i,r,s,a,o,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=a,c[3]=e,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],h=n[7],u=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],x=i[2],b=i[5],M=i[8];return r[0]=s*f+a*v+o*x,r[3]=s*m+a*y+o*b,r[6]=s*g+a*_+o*M,r[1]=l*f+c*v+h*x,r[4]=l*m+c*y+h*b,r[7]=l*g+c*_+h*M,r[2]=u*f+d*v+p*x,r[5]=u*m+d*y+p*b,r[8]=u*g+d*_+p*M,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8];return e*s*c-e*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=c*s-a*l,u=a*o-c*r,d=l*r-s*o,p=e*h+n*u+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=h*f,t[1]=(i*l-c*n)*f,t[2]=(a*n-i*s)*f,t[3]=u*f,t[4]=(c*e-i*o)*f,t[5]=(i*r-a*e)*f,t[6]=d*f,t[7]=(n*o-l*e)*f,t[8]=(s*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+t,-i*l,i*o,-i*(-l*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(AD.makeScale(t,e)),this}rotate(t){return this.premultiply(AD.makeRotation(-t)),this}translate(t,e){return this.premultiply(AD.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const AD=new ED;function CD(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const RD={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function PD(t,e){return new RD[t](e)}function OD(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function ID(){const t=OD("canvas");return t.style.display="block",t}const DD={};function LD(t){t in DD||(DD[t]=!0)}const ND=(new ED).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),UD=(new ED).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function FD(){const t={enabled:!0,workingColorSpace:qI,spaces:{},convert:function(t,e,n){return!1!==this.enabled&&e!==n&&e&&n?(this.spaces[e].transfer===KI&&(t.r=BD(t.r),t.g=BD(t.g),t.b=BD(t.b)),this.spaces[e].primaries!==this.spaces[n].primaries&&(t.applyMatrix3(this.spaces[e].toXYZ),t.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===KI&&(t.r=zD(t.r),t.g=zD(t.g),t.b=zD(t.b)),t):t},workingToColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},colorSpaceToWorking:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){return t===GI?YI:this.spaces[t].transfer},getToneMappingMode:function(t){return this.spaces[t].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(t,e=this.workingColorSpace){return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,n){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(t=this.workingColorSpace){return this.spaces[t].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(e,n){return LD("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(e,n)},toWorkingColorSpace:function(e,n){return LD("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(e,n)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[qI]:{primaries:e,whitePoint:i,transfer:YI,toXYZ:ND,fromXYZ:UD,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:XI},outputColorSpaceConfig:{drawingBufferColorSpace:XI}},[XI]:{primaries:e,whitePoint:i,transfer:KI,toXYZ:ND,fromXYZ:UD,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:XI}}}),t}const kD=FD();function BD(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function zD(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let VD;class HD{static getDataURL(t,e="image/png"){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let n;if(t instanceof HTMLCanvasElement)n=t;else{void 0===VD&&(VD=OD("canvas")),VD.width=t.width,VD.height=t.height;const e=VD.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),n=VD}return n.toDataURL(e)}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=OD("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*BD(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*BD(e[t]/255)):e[t]=BD(e[t]);return{data:e,width:t.width,height:t.height}}return t}}let WD=0;class jD{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:WD++}),this.uuid=fD(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){const e=this.data;return"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):null!==e?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(GD(i[e].image)):t.push(GD(i[e]))}else t=GD(i);n.url=t}return e||(t.images[this.uuid]=n),n}}function GD(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?HD.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:{}}let XD=0;const qD=new wD;class YD extends cD{constructor(t=YD.DEFAULT_IMAGE,e=YD.DEFAULT_MAPPING,n=1001,i=1001,r=1006,s=1008,a=1023,o=1009,l=YD.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:XD++}),this.uuid=fD(),this.name="",this.source=new jD(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new bD(0,0),this.repeat=new bD(1,1),this.center=new bD(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ED,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(qD).x}get height(){return this.source.getSize(qD).y}get depth(){return this.source.getSize(qD).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const e in t){const n=t[e];if(void 0===n)continue;const i=this[e];void 0!==i&&(i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[e]=n)}}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==xO)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case EO:t.x=t.x-Math.floor(t.x);break;case AO:t.x=t.x<0?0:1;break;case CO:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case EO:t.y=t.y-Math.floor(t.y);break;case AO:t.y=t.y<0?0:1;break;case CO:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}YD.DEFAULT_IMAGE=null,YD.DEFAULT_MAPPING=xO,YD.DEFAULT_ANISOTROPY=1;class KD{constructor(t=0,e=0,n=0,i=1){KD.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const s=.01,a=.1,o=t.elements,l=o[0],c=o[4],h=o[8],u=o[1],d=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(c-u)<s&&Math.abs(h-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+u)<a&&Math.abs(h+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+u)/4,_=(h+f)/4,x=(p+m)/4;return t>o&&t>v?t<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=y/n,r=_/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=y/i,r=x/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=x/r),this.set(n,i,r,e),this}let v=Math.sqrt((m-p)*(m-p)+(h-f)*(h-f)+(u-c)*(u-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(h-f)/v,this.z=(u-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=mD(this.x,t.x,e.x),this.y=mD(this.y,t.y,e.y),this.z=mD(this.z,t.z,e.z),this.w=mD(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=mD(this.x,t,e),this.y=mD(this.y,t,e),this.z=mD(this.z,t,e),this.w=mD(this.w,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(mD(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ZD extends cD{constructor(t=1,e=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:IO,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=n.depth,this.scissor=new KD(0,0,t,e),this.scissorTest=!1,this.viewport=new KD(0,0,t,e);const i={width:t,height:e,depth:n.depth},r=new YD(i);this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(t={}){const e={minFilter:IO,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==t.mapping&&(e.mapping=t.mapping),void 0!==t.wrapS&&(e.wrapS=t.wrapS),void 0!==t.wrapT&&(e.wrapT=t.wrapT),void 0!==t.wrapR&&(e.wrapR=t.wrapR),void 0!==t.magFilter&&(e.magFilter=t.magFilter),void 0!==t.minFilter&&(e.minFilter=t.minFilter),void 0!==t.format&&(e.format=t.format),void 0!==t.type&&(e.type=t.type),void 0!==t.anisotropy&&(e.anisotropy=t.anisotropy),void 0!==t.colorSpace&&(e.colorSpace=t.colorSpace),void 0!==t.flipY&&(e.flipY=t.flipY),void 0!==t.generateMipmaps&&(e.generateMipmaps=t.generateMipmaps),void 0!==t.internalFormat&&(e.internalFormat=t.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(e)}}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==t&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=t,this.textures[i].image.height=e,this.textures[i].image.depth=n,this.textures[i].isArrayTexture=this.textures[i].image.depth>1;this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let e=0,n=t.textures.length;e<n;e++){this.textures[e]=t.textures[e].clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;const n=Object.assign({},t.textures[e].image);this.textures[e].source=new jD(n)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class $D extends ZD{constructor(t=1,e=1,n={}){super(t,e,n),this.isWebGLRenderTarget=!0}}class JD extends YD{constructor(t=null,e=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=RO,this.minFilter=RO,this.wrapR=AO,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class QD extends YD{constructor(t=null,e=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=RO,this.minFilter=RO,this.wrapR=AO,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tL{constructor(t=new wD(1/0,1/0,1/0),e=new wD(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(nL.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(nL.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=nL.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===e&&void 0!==i&&!0!==t.isInstancedMesh)for(let e=0,n=i.count;e<n;e++)!0===t.isMesh?t.getVertexPosition(e,nL):nL.fromBufferAttribute(i,e),nL.applyMatrix4(t.matrixWorld),this.expandByPoint(nL);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),iL.copy(t.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),iL.copy(n.boundingBox)),iL.applyMatrix4(t.matrixWorld),this.union(iL)}const i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,nL),nL.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(hL),uL.subVectors(this.max,hL),rL.subVectors(t.a,hL),sL.subVectors(t.b,hL),aL.subVectors(t.c,hL),oL.subVectors(sL,rL),lL.subVectors(aL,sL),cL.subVectors(rL,aL);let e=[0,-oL.z,oL.y,0,-lL.z,lL.y,0,-cL.z,cL.y,oL.z,0,-oL.x,lL.z,0,-lL.x,cL.z,0,-cL.x,-oL.y,oL.x,0,-lL.y,lL.x,0,-cL.y,cL.x,0];return!!fL(e,rL,sL,aL,uL)&&(e=[1,0,0,0,1,0,0,0,1],!!fL(e,rL,sL,aL,uL)&&(dL.crossVectors(oL,lL),e=[dL.x,dL.y,dL.z],fL(e,rL,sL,aL,uL)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,nL).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(nL).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(eL[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),eL[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),eL[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),eL[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),eL[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),eL[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),eL[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),eL[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(eL)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}}const eL=[new wD,new wD,new wD,new wD,new wD,new wD,new wD,new wD],nL=new wD,iL=new tL,rL=new wD,sL=new wD,aL=new wD,oL=new wD,lL=new wD,cL=new wD,hL=new wD,uL=new wD,dL=new wD,pL=new wD;function fL(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){pL.fromArray(t,s);const a=r.x*Math.abs(pL.x)+r.y*Math.abs(pL.y)+r.z*Math.abs(pL.z),o=e.dot(pL),l=n.dot(pL),c=i.dot(pL);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const mL=new tL,gL=new wD,vL=new wD;class yL{constructor(t=new wD,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):mL.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;gL.subVectors(t,this.center);const e=gL.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(gL,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(vL.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(gL.copy(t.center).add(vL)),this.expandByPoint(gL.copy(t.center).sub(vL))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}}const _L=new wD,xL=new wD,bL=new wD,ML=new wD,wL=new wD,SL=new wD,TL=new wD;class EL{constructor(t=new wD,e=new wD(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,_L)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=_L.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(_L.copy(this.origin).addScaledVector(this.direction,e),_L.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){xL.copy(t).add(e).multiplyScalar(.5),bL.copy(e).sub(t).normalize(),ML.copy(this.origin).sub(xL);const r=.5*t.distanceTo(e),s=-this.direction.dot(bL),a=ML.dot(this.direction),o=-ML.dot(bL),l=ML.lengthSq(),c=Math.abs(1-s*s);let h,u,d,p;if(c>0)if(h=s*o-a,u=s*a-o,p=r*c,h>=0)if(u>=-p)if(u<=p){const t=1/c;h*=t,u*=t,d=h*(h+s*u+2*a)+u*(s*h+u+2*o)+l}else u=r,h=Math.max(0,-(s*u+a)),d=-h*h+u*(u+2*o)+l;else u=-r,h=Math.max(0,-(s*u+a)),d=-h*h+u*(u+2*o)+l;else u<=-p?(h=Math.max(0,-(-s*r+a)),u=h>0?-r:Math.min(Math.max(-r,-o),r),d=-h*h+u*(u+2*o)+l):u<=p?(h=0,u=Math.min(Math.max(-r,-o),r),d=u*(u+2*o)+l):(h=Math.max(0,-(s*r+a)),u=h>0?r:Math.min(Math.max(-r,-o),r),d=-h*h+u*(u+2*o)+l);else u=s>0?-r:r,h=Math.max(0,-(s*u+a)),d=-h*h+u*(u+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,h),i&&i.copy(xL).addScaledVector(bL,u),d}intersectSphere(t,e){_L.subVectors(t.center,this.origin);const n=_L.dot(this.direction),i=_L.dot(_L)-n*n,r=t.radius*t.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return!(t.radius<0)&&this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(n=(t.min.x-u.x)*l,i=(t.max.x-u.x)*l):(n=(t.max.x-u.x)*l,i=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,s=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,s=(t.min.y-u.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),h>=0?(a=(t.min.z-u.z)*h,o=(t.max.z-u.z)*h):(a=(t.max.z-u.z)*h,o=(t.min.z-u.z)*h),n>o||a>i?null:((a>n||n!=n)&&(n=a),(o<i||i!=i)&&(i=o),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,_L)}intersectTriangle(t,e,n,i,r){wL.subVectors(e,t),SL.subVectors(n,t),TL.crossVectors(wL,SL);let s,a=this.direction.dot(TL);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}ML.subVectors(this.origin,t);const o=s*this.direction.dot(SL.crossVectors(ML,SL));if(o<0)return null;const l=s*this.direction.dot(wL.cross(ML));if(l<0)return null;if(o+l>a)return null;const c=-s*ML.dot(TL);return c<0?null:this.at(c/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class AL{constructor(t,e,n,i,r,s,a,o,l,c,h,u,d,p,f,m){AL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l,c,h,u,d,p,f,m)}set(t,e,n,i,r,s,a,o,l,c,h,u,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new AL).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/CL.setFromMatrixColumn(t,0).length(),r=1/CL.setFromMatrixColumn(t,1).length(),s=1/CL.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){const t=s*c,n=s*h,i=a*c,r=a*h;e[0]=o*c,e[4]=-o*h,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-a*o,e[2]=r-t*l,e[6]=i+n*l,e[10]=s*o}else if("YXZ"===t.order){const t=o*c,n=o*h,i=l*c,r=l*h;e[0]=t+r*a,e[4]=i*a-n,e[8]=s*l,e[1]=s*h,e[5]=s*c,e[9]=-a,e[2]=n*a-i,e[6]=r+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*c,n=o*h,i=l*c,r=l*h;e[0]=t-r*a,e[4]=-s*h,e[8]=i+n*a,e[1]=n+i*a,e[5]=s*c,e[9]=r-t*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*c,n=s*h,i=a*c,r=a*h;e[0]=o*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=o*h,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*c,e[4]=r-t*h,e[8]=i*h+n,e[1]=h,e[5]=s*c,e[9]=-a*c,e[2]=-l*c,e[6]=n*h+i,e[10]=t-r*h}else if("XZY"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*c,e[4]=-h,e[8]=l*c,e[1]=t*h+r,e[5]=s*c,e[9]=n*h-i,e[2]=i*h-n,e[6]=a*c,e[10]=r*h+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(PL,t,OL)}lookAt(t,e,n){const i=this.elements;return LL.subVectors(t,e),0===LL.lengthSq()&&(LL.z=1),LL.normalize(),IL.crossVectors(n,LL),0===IL.lengthSq()&&(1===Math.abs(n.z)?LL.x+=1e-4:LL.z+=1e-4,LL.normalize(),IL.crossVectors(n,LL)),IL.normalize(),DL.crossVectors(LL,IL),i[0]=IL.x,i[4]=DL.x,i[8]=LL.x,i[1]=IL.y,i[5]=DL.y,i[9]=LL.y,i[2]=IL.z,i[6]=DL.z,i[10]=LL.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],h=n[5],u=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],x=n[15],b=i[0],M=i[4],w=i[8],S=i[12],T=i[1],E=i[5],A=i[9],C=i[13],R=i[2],P=i[6],O=i[10],I=i[14],D=i[3],L=i[7],N=i[11],U=i[15];return r[0]=s*b+a*T+o*R+l*D,r[4]=s*M+a*E+o*P+l*L,r[8]=s*w+a*A+o*O+l*N,r[12]=s*S+a*C+o*I+l*U,r[1]=c*b+h*T+u*R+d*D,r[5]=c*M+h*E+u*P+d*L,r[9]=c*w+h*A+u*O+d*N,r[13]=c*S+h*C+u*I+d*U,r[2]=p*b+f*T+m*R+g*D,r[6]=p*M+f*E+m*P+g*L,r[10]=p*w+f*A+m*O+g*N,r[14]=p*S+f*C+m*I+g*U,r[3]=v*b+y*T+_*R+x*D,r[7]=v*M+y*E+_*P+x*L,r[11]=v*w+y*A+_*O+x*N,r[15]=v*S+y*C+_*I+x*U,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],a=t[5],o=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+r*o*h-i*l*h-r*a*u+n*l*u+i*a*d-n*o*d)+t[7]*(+e*o*d-e*l*u+r*s*u-i*s*d+i*l*c-r*o*c)+t[11]*(+e*l*h-e*a*d-r*s*h+n*s*d+r*a*c-n*l*c)+t[15]*(-i*a*c-e*o*h+e*a*u+i*s*h-n*s*u+n*o*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=h*m*l-f*u*l+f*o*d-a*m*d-h*o*g+a*u*g,y=p*u*l-c*m*l-p*o*d+s*m*d+c*o*g-s*u*g,_=c*f*l-p*h*l+p*a*d-s*f*d-c*a*g+s*h*g,x=p*h*o-c*f*o-p*a*u+s*f*u+c*a*m-s*h*m,b=e*v+n*y+i*_+r*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/b;return t[0]=v*M,t[1]=(f*u*r-h*m*r-f*i*d+n*m*d+h*i*g-n*u*g)*M,t[2]=(a*m*r-f*o*r+f*i*l-n*m*l-a*i*g+n*o*g)*M,t[3]=(h*o*r-a*u*r-h*i*l+n*u*l+a*i*d-n*o*d)*M,t[4]=y*M,t[5]=(c*m*r-p*u*r+p*i*d-e*m*d-c*i*g+e*u*g)*M,t[6]=(p*o*r-s*m*r-p*i*l+e*m*l+s*i*g-e*o*g)*M,t[7]=(s*u*r-c*o*r+c*i*l-e*u*l-s*i*d+e*o*d)*M,t[8]=_*M,t[9]=(p*h*r-c*f*r-p*n*d+e*f*d+c*n*g-e*h*g)*M,t[10]=(s*f*r-p*a*r+p*n*l-e*f*l-s*n*g+e*a*g)*M,t[11]=(c*a*r-s*h*r-c*n*l+e*h*l+s*n*d-e*a*d)*M,t[12]=x*M,t[13]=(c*f*i-p*h*i+p*n*u-e*f*u-c*n*m+e*h*m)*M,t[14]=(p*a*i-s*f*i-p*n*o+e*f*o+s*n*m-e*a*m)*M,t[15]=(s*h*i-c*a*i+c*n*o-e*h*o-s*n*u+e*a*u)*M,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,a=t.y,o=t.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,s=e._y,a=e._z,o=e._w,l=r+r,c=s+s,h=a+a,u=r*l,d=r*c,p=r*h,f=s*c,m=s*h,g=a*h,v=o*l,y=o*c,_=o*h,x=n.x,b=n.y,M=n.z;return i[0]=(1-(f+g))*x,i[1]=(d+_)*x,i[2]=(p-y)*x,i[3]=0,i[4]=(d-_)*b,i[5]=(1-(u+g))*b,i[6]=(m+v)*b,i[7]=0,i[8]=(p+y)*M,i[9]=(m-v)*M,i[10]=(1-(u+f))*M,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=CL.set(i[0],i[1],i[2]).length();const s=CL.set(i[4],i[5],i[6]).length(),a=CL.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],RL.copy(this);const o=1/r,l=1/s,c=1/a;return RL.elements[0]*=o,RL.elements[1]*=o,RL.elements[2]*=o,RL.elements[4]*=l,RL.elements[5]*=l,RL.elements[6]*=l,RL.elements[8]*=c,RL.elements[9]*=c,RL.elements[10]*=c,e.setFromRotationMatrix(RL),n.x=r,n.y=s,n.z=a,this}makePerspective(t,e,n,i,r,s,a=2e3,o=!1){const l=this.elements,c=2*r/(e-t),h=2*r/(n-i),u=(e+t)/(e-t),d=(n+i)/(n-i);let p,f;if(o)p=r/(s-r),f=s*r/(s-r);else if(a===oD)p=-(s+r)/(s-r),f=-2*s*r/(s-r);else{if(a!==lD)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);p=-s/(s-r),f=-s*r/(s-r)}return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=h,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,i,r,s,a=2e3,o=!1){const l=this.elements,c=2/(e-t),h=2/(n-i),u=-(e+t)/(e-t),d=-(n+i)/(n-i);let p,f;if(o)p=1/(s-r),f=s/(s-r);else if(a===oD)p=-2/(s-r),f=-(s+r)/(s-r);else{if(a!==lD)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=-1/(s-r),f=-r/(s-r)}return l[0]=c,l[4]=0,l[8]=0,l[12]=u,l[1]=0,l[5]=h,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const CL=new wD,RL=new AL,PL=new wD(0,0,0),OL=new wD(1,1,1),IL=new wD,DL=new wD,LL=new wD,NL=new AL,UL=new MD;class FL{constructor(t=0,e=0,n=0,i=FL.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],h=i[2],u=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(mD(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-mD(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(mD(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-mD(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(mD(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-mD(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return NL.makeRotationFromQuaternion(t),this.setFromRotationMatrix(NL,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return UL.setFromEuler(this),this.setFromQuaternion(UL,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}FL.DEFAULT_ORDER="XYZ";class kL{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return!!(this.mask&1<<t)}}let BL=0;const zL=new wD,VL=new MD,HL=new AL,WL=new wD,jL=new wD,GL=new wD,XL=new MD,qL=new wD(1,0,0),YL=new wD(0,1,0),KL=new wD(0,0,1),ZL={type:"added"},$L={type:"removed"},JL={type:"childadded",child:null},QL={type:"childremoved",child:null};class tN extends cD{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:BL++}),this.uuid=fD(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=tN.DEFAULT_UP.clone();const t=new wD,e=new FL,n=new MD,i=new wD(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new AL},normalMatrix:{value:new ED}}),this.matrix=new AL,this.matrixWorld=new AL,this.matrixAutoUpdate=tN.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=tN.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new kL,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return VL.setFromAxisAngle(t,e),this.quaternion.multiply(VL),this}rotateOnWorldAxis(t,e){return VL.setFromAxisAngle(t,e),this.quaternion.premultiply(VL),this}rotateX(t){return this.rotateOnAxis(qL,t)}rotateY(t){return this.rotateOnAxis(YL,t)}rotateZ(t){return this.rotateOnAxis(KL,t)}translateOnAxis(t,e){return zL.copy(t).applyQuaternion(this.quaternion),this.position.add(zL.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(qL,t)}translateY(t){return this.translateOnAxis(YL,t)}translateZ(t){return this.translateOnAxis(KL,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(HL.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?WL.copy(t):WL.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),jL.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?HL.lookAt(jL,WL,this.up):HL.lookAt(WL,jL,this.up),this.quaternion.setFromRotationMatrix(HL),i&&(HL.extractRotation(i.matrixWorld),VL.setFromRotationMatrix(HL),this.quaternion.premultiply(VL.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this||t&&t.isObject3D&&(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(ZL),JL.child=t,this.dispatchEvent(JL),JL.child=null),this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent($L),QL.child=t,this.dispatchEvent(QL),QL.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),HL.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),HL.multiply(t.parent.matrixWorld)),t.applyMatrix4(HL),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(ZL),JL.child=t,this.dispatchEvent(JL),JL.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getObjectsByProperty(t,e,n=[]){this[t]===e&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jL,t,GL),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jL,XL,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++){e[n].updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){t[e].updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox?t.boundingBox.toJSON():void 0,boundingSphere:t.boundingSphere?t.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(t=>({...t})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(t),i.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(i.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(i.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=s(t.geometries),i=s(t.materials),r=s(t.textures),a=s(t.images),o=s(t.shapes),l=s(t.skeletons),c=s(t.animations),h=s(t.nodes);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),h.length>0&&(n.nodes=h)}return n.object=i,n;function s(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}tN.DEFAULT_UP=new wD(0,1,0),tN.DEFAULT_MATRIX_AUTO_UPDATE=!0,tN.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const eN=new wD,nN=new wD,iN=new wD,rN=new wD,sN=new wD,aN=new wD,oN=new wD,lN=new wD,cN=new wD,hN=new wD,uN=new KD,dN=new KD,pN=new KD;class fN{constructor(t=new wD,e=new wD,n=new wD){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),eN.subVectors(t,e),i.cross(eN);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){eN.subVectors(i,e),nN.subVectors(n,e),iN.subVectors(t,e);const s=eN.dot(eN),a=eN.dot(nN),o=eN.dot(iN),l=nN.dot(nN),c=nN.dot(iN),h=s*l-a*a;if(0===h)return r.set(0,0,0),null;const u=1/h,d=(l*o-a*c)*u,p=(s*c-a*o)*u;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return null!==this.getBarycoord(t,e,n,i,rN)&&(rN.x>=0&&rN.y>=0&&rN.x+rN.y<=1)}static getInterpolation(t,e,n,i,r,s,a,o){return null===this.getBarycoord(t,e,n,i,rN)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,rN.x),o.addScaledVector(s,rN.y),o.addScaledVector(a,rN.z),o)}static getInterpolatedAttribute(t,e,n,i,r,s){return uN.setScalar(0),dN.setScalar(0),pN.setScalar(0),uN.fromBufferAttribute(t,e),dN.fromBufferAttribute(t,n),pN.fromBufferAttribute(t,i),s.setScalar(0),s.addScaledVector(uN,r.x),s.addScaledVector(dN,r.y),s.addScaledVector(pN,r.z),s}static isFrontFacing(t,e,n,i){return eN.subVectors(n,e),nN.subVectors(t,e),eN.cross(nN).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return eN.subVectors(this.c,this.b),nN.subVectors(this.a,this.b),.5*eN.cross(nN).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return fN.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return fN.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,n,i,r){return fN.getInterpolation(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return fN.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return fN.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let s,a;sN.subVectors(i,n),aN.subVectors(r,n),lN.subVectors(t,n);const o=sN.dot(lN),l=aN.dot(lN);if(o<=0&&l<=0)return e.copy(n);cN.subVectors(t,i);const c=sN.dot(cN),h=aN.dot(cN);if(c>=0&&h<=c)return e.copy(i);const u=o*h-c*l;if(u<=0&&o>=0&&c<=0)return s=o/(o-c),e.copy(n).addScaledVector(sN,s);hN.subVectors(t,r);const d=sN.dot(hN),p=aN.dot(hN);if(p>=0&&d<=p)return e.copy(r);const f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),e.copy(n).addScaledVector(aN,a);const m=c*p-d*h;if(m<=0&&h-c>=0&&d-p>=0)return oN.subVectors(r,i),a=(h-c)/(h-c+(d-p)),e.copy(i).addScaledVector(oN,a);const g=1/(m+f+u);return s=f*g,a=u*g,e.copy(n).addScaledVector(sN,s).addScaledVector(aN,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const mN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},gN={h:0,s:0,l:0},vN={h:0,s:0,l:0};function yN(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class _N{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=XI){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,kD.colorSpaceToWorking(this,e),this}setRGB(t,e,n,i=kD.workingColorSpace){return this.r=t,this.g=e,this.b=n,kD.colorSpaceToWorking(this,i),this}setHSL(t,e,n,i=kD.workingColorSpace){if(t=gD(t,1),e=mD(e,0,1),n=mD(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=yN(r,i,t+1/3),this.g=yN(r,i,t),this.b=yN(r,i,t-1/3)}return kD.colorSpaceToWorking(this,i),this}setStyle(t,e=XI){function n(t){void 0!==t&&parseFloat(t)}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let t;const r=i[1],s=i[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(t[4]),this.setRGB(Math.min(255,parseInt(t[1],10))/255,Math.min(255,parseInt(t[2],10))/255,Math.min(255,parseInt(t[3],10))/255,e);if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(t[4]),this.setRGB(Math.min(100,parseInt(t[1],10))/100,Math.min(100,parseInt(t[2],10))/100,Math.min(100,parseInt(t[3],10))/100,e);break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(t[4]),this.setHSL(parseFloat(t[1])/360,parseFloat(t[2])/100,parseFloat(t[3])/100,e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],n=t.length;if(3===n)return this.setRGB(parseInt(t.charAt(0),16)/15,parseInt(t.charAt(1),16)/15,parseInt(t.charAt(2),16)/15,e);if(6===n)return this.setHex(parseInt(t,16),e)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=XI){const n=mN[t.toLowerCase()];return void 0!==n&&this.setHex(n,e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=BD(t.r),this.g=BD(t.g),this.b=BD(t.b),this}copyLinearToSRGB(t){return this.r=zD(t.r),this.g=zD(t.g),this.b=zD(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=XI){return kD.workingToColorSpace(xN.copy(this),t),65536*Math.round(mD(255*xN.r,0,255))+256*Math.round(mD(255*xN.g,0,255))+Math.round(mD(255*xN.b,0,255))}getHexString(t=XI){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=kD.workingColorSpace){kD.workingToColorSpace(xN.copy(this),e);const n=xN.r,i=xN.g,r=xN.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const t=s-a;switch(l=c<=.5?t/(s+a):t/(2-s-a),s){case n:o=(i-r)/t+(i<r?6:0);break;case i:o=(r-n)/t+2;break;case r:o=(n-i)/t+4}o/=6}return t.h=o,t.s=l,t.l=c,t}getRGB(t,e=kD.workingColorSpace){return kD.workingToColorSpace(xN.copy(this),e),t.r=xN.r,t.g=xN.g,t.b=xN.b,t}getStyle(t=XI){kD.workingToColorSpace(xN.copy(this),t);const e=xN.r,n=xN.g,i=xN.b;return t!==XI?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*n)},${Math.round(255*i)})`}offsetHSL(t,e,n){return this.getHSL(gN),this.setHSL(gN.h+t,gN.s+e,gN.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(gN),t.getHSL(vN);const n=vD(gN.h,vN.h,e),i=vD(gN.s,vN.s,e),r=vD(gN.l,vN.l,e);return this.setHSL(n,i,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,i=this.b,r=t.elements;return this.r=r[0]*e+r[3]*n+r[6]*i,this.g=r[1]*e+r[4]*n+r[7]*i,this.b=r[2]*e+r[5]*n+r[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const xN=new _N;_N.NAMES=mN;let bN=0;class MN extends cD{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:bN++}),this.uuid=fD(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=$P,this.blendDst=JP,this.blendEquation=jP,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new _N(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ZI,this.stencilZFail=ZI,this.stencilZPass=ZI,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n)continue;const i=this[e];void 0!==i&&(i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(t).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(t).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==$P&&(n.blendSrc=this.blendSrc),this.blendDst!==JP&&(n.blendDst=this.blendDst),this.blendEquation!==jP&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ZI&&(n.stencilFail=this.stencilFail),this.stencilZFail!==ZI&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==ZI&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class wN extends MN{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _N(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new FL,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const SN=TN();function TN(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const t=l-127;t<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):t<-14?(i[l]=1024>>-t-14,i[256|l]=1024>>-t-14|32768,r[l]=-t-1,r[256|l]=-t-1):t<=15?(i[l]=t+15<<10,i[256|l]=t+15<<10|32768,r[l]=13,r[256|l]=13):t<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let t=l<<13,e=0;for(;!(8388608&t);)t<<=1,e-=8388608;t&=-8388609,e+=947912704,s[l]=t|e}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function EN(t){Math.abs(t),t=mD(t,-65504,65504),SN.floatView[0]=t;const e=SN.uint32View[0],n=e>>23&511;return SN.baseTable[n]+((8388607&e)>>SN.shiftTable[n])}function AN(t){const e=t>>10;return SN.uint32View[0]=SN.mantissaTable[SN.offsetTable[e]+(1023&t)]+SN.exponentTable[e],SN.floatView[0]}class CN{static toHalfFloat(t){return EN(t)}static fromHalfFloat(t){return AN(t)}}const RN=new wD,PN=new bD;let ON=0;class IN{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ON++}),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=sD,this.updateRanges=[],this.gpuType=HO,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)PN.fromBufferAttribute(this,e),PN.applyMatrix3(t),this.setXY(e,PN.x,PN.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)RN.fromBufferAttribute(this,e),RN.applyMatrix3(t),this.setXYZ(e,RN.x,RN.y,RN.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)RN.fromBufferAttribute(this,e),RN.applyMatrix4(t),this.setXYZ(e,RN.x,RN.y,RN.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)RN.fromBufferAttribute(this,e),RN.applyNormalMatrix(t),this.setXYZ(e,RN.x,RN.y,RN.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)RN.fromBufferAttribute(this,e),RN.transformDirection(t),this.setXYZ(e,RN.x,RN.y,RN.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=yD(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=_D(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=yD(e,this.array)),e}setX(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=yD(e,this.array)),e}setY(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=yD(e,this.array)),e}setZ(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=yD(e,this.array)),e}setW(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array),i=_D(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array),i=_D(i,this.array),r=_D(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==sD&&(t.usage=this.usage),t}}class DN extends IN{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class LN extends IN{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class NN extends IN{constructor(t,e,n){super(new Float32Array(t),e,n)}}let UN=0;const FN=new AL,kN=new tN,BN=new wD,zN=new tL,VN=new tL,HN=new wD;class WN extends cD{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:UN++}),this.uuid=fD(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(CD(t)?LN:DN)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new ED).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return FN.makeRotationFromQuaternion(t),this.applyMatrix4(FN),this}rotateX(t){return FN.makeRotationX(t),this.applyMatrix4(FN),this}rotateY(t){return FN.makeRotationY(t),this.applyMatrix4(FN),this}rotateZ(t){return FN.makeRotationZ(t),this.applyMatrix4(FN),this}translate(t,e,n){return FN.makeTranslation(t,e,n),this.applyMatrix4(FN),this}scale(t,e,n){return FN.makeScale(t,e,n),this.applyMatrix4(FN),this}lookAt(t){return kN.lookAt(t),kN.updateMatrix(),this.applyMatrix4(kN.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(BN).negate(),this.translate(BN.x,BN.y,BN.z),this}setFromPoints(t){const e=this.getAttribute("position");if(void 0===e){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}this.setAttribute("position",new NN(e,3))}else{const n=Math.min(t.length,e.count);for(let i=0;i<n;i++){const n=t[i];e.setXYZ(i,n.x,n.y,n.z||0)}t.length,e.count,e.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new tL);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingBox.set(new wD(-1/0,-1/0,-1/0),new wD(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];zN.setFromBufferAttribute(n),this.morphTargetsRelative?(HN.addVectors(this.boundingBox.min,zN.min),this.boundingBox.expandByPoint(HN),HN.addVectors(this.boundingBox.max,zN.max),this.boundingBox.expandByPoint(HN)):(this.boundingBox.expandByPoint(zN.min),this.boundingBox.expandByPoint(zN.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new yL);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingSphere.set(new wD,1/0);else if(t){const n=this.boundingSphere.center;if(zN.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const n=e[t];VN.setFromBufferAttribute(n),this.morphTargetsRelative?(HN.addVectors(zN.min,VN.min),zN.expandByPoint(HN),HN.addVectors(zN.max,VN.max),zN.expandByPoint(HN)):(zN.expandByPoint(VN.min),zN.expandByPoint(VN.max))}zN.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)HN.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(HN));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],a=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)HN.fromBufferAttribute(s,e),a&&(BN.fromBufferAttribute(t,e),HN.add(BN)),i=Math.max(i,n.distanceToSquared(HN))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return;const n=e.position,i=e.normal,r=e.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new IN(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let w=0;w<n.count;w++)a[w]=new wD,o[w]=new wD;const l=new wD,c=new wD,h=new wD,u=new bD,d=new bD,p=new bD,f=new wD,m=new wD;function g(t,e,i){l.fromBufferAttribute(n,t),c.fromBufferAttribute(n,e),h.fromBufferAttribute(n,i),u.fromBufferAttribute(r,t),d.fromBufferAttribute(r,e),p.fromBufferAttribute(r,i),c.sub(l),h.sub(l),d.sub(u),p.sub(u);const s=1/(d.x*p.y-p.x*d.y);isFinite(s)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(h,-d.y).multiplyScalar(s),m.copy(h).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(s),a[t].add(f),a[e].add(f),a[i].add(f),o[t].add(m),o[e].add(m),o[i].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:t.count}]);for(let w=0,S=v.length;w<S;++w){const e=v[w],n=e.start;for(let i=n,r=n+e.count;i<r;i+=3)g(t.getX(i+0),t.getX(i+1),t.getX(i+2))}const y=new wD,_=new wD,x=new wD,b=new wD;function M(t){x.fromBufferAttribute(i,t),b.copy(x);const e=a[t];y.copy(e),y.sub(x.multiplyScalar(x.dot(e))).normalize(),_.crossVectors(b,e);const n=_.dot(o[t])<0?-1:1;s.setXYZW(t,y.x,y.y,y.z,n)}for(let w=0,S=v.length;w<S;++w){const e=v[w],n=e.start;for(let i=n,r=n+e.count;i<r;i+=3)M(t.getX(i+0)),M(t.getX(i+1)),M(t.getX(i+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new IN(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new wD,r=new wD,s=new wD,a=new wD,o=new wD,l=new wD,c=new wD,h=new wD;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),p=t.getX(u+1),f=t.getX(u+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,f),c.subVectors(s,r),h.subVectors(i,r),c.cross(h),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(c),o.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,u=e.count;t<u;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,r),h.subVectors(i,r),c.cross(h),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)HN.fromBufferAttribute(t,e),HN.normalize(),t.setXYZ(e,HN.x,HN.y,HN.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,s=new n.constructor(e.length*i);let a=0,o=0;for(let l=0,c=e.length;l<c;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(let t=0;t<i;t++)s[o++]=n[a++]}return new IN(s,i,r)}if(null===this.index)return this;const e=new WN,n=this.index.array,i=this.attributes;for(const a in i){const r=t(i[a],n);e.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);i.push(r)}e.morphAttributes[a]=i}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const t=s[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const o in n){const e=n[o];t.data.attributes[o]=e.toJSON(t.data)}const i={};let r=!1;for(const o in this.morphAttributes){const e=this.morphAttributes[o],n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];n.push(r.toJSON(t.data))}n.length>0&&(i[o]=n,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere=a.toJSON()),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone());const i=t.attributes;for(const l in i){const t=i[l];this.setAttribute(l,t.clone(e))}const r=t.morphAttributes;for(const l in r){const t=[],n=r[l];for(let i=0,r=n.length;i<r;i++)t.push(n[i].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const jN=new AL,GN=new EL,XN=new yL,qN=new wD,YN=new wD,KN=new wD,ZN=new wD,$N=new wD,JN=new wD,QN=new wD,tU=new wD;class eU extends tN{constructor(t=new WN,e=new wN){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(i,t);const a=this.morphTargetInfluences;if(r&&a){JN.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&($N.fromBufferAttribute(o,t),s?JN.addScaledVector($N,i):JN.addScaledVector($N.sub(e),i))}e.add(JN)}return e}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),XN.copy(n.boundingSphere),XN.applyMatrix4(r),GN.copy(t.ray).recast(t.near),!1===XN.containsPoint(GN.origin)){if(null===GN.intersectSphere(XN,qN))return;if(GN.origin.distanceToSquared(qN)>(t.far-t.near)**2)return}jN.copy(r).invert(),GN.copy(t.ray).applyMatrix4(jN),null!==n.boundingBox&&!1===GN.intersectsBox(n.boundingBox)||this._computeIntersections(t,e,GN)}}_computeIntersections(t,e,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,h=r.attributes.normal,u=r.groups,d=r.drawRange;if(null!==a)if(Array.isArray(s))for(let p=0,f=u.length;p<f;p++){const r=u[p],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),u=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<u;s+=3){i=nU(this,o,t,n,l,c,h,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=nU(this,s,t,n,l,c,h,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let p=0,f=u.length;p<f;p++){const r=u[p],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),u=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<u;s+=3){i=nU(this,a,t,n,l,c,h,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=nU(this,s,t,n,l,c,h,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}}}function nU(t,e,n,i,r,s,a,o,l,c){t.getVertexPosition(o,YN),t.getVertexPosition(l,KN),t.getVertexPosition(c,ZN);const h=function(t,e,n,i,r,s,a,o){let l;if(l=1===e.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,0===e.side,o),null===l)return null;tU.copy(o),tU.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(tU);return c<n.near||c>n.far?null:{distance:c,point:tU.clone(),object:t}}(t,e,n,i,YN,KN,ZN,QN);if(h){const t=new wD;fN.getBarycoord(QN,YN,KN,ZN,t),r&&(h.uv=fN.getInterpolatedAttribute(r,o,l,c,t,new bD)),s&&(h.uv1=fN.getInterpolatedAttribute(s,o,l,c,t,new bD)),a&&(h.normal=fN.getInterpolatedAttribute(a,o,l,c,t,new wD),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const e={a:o,b:l,c:c,normal:new wD,materialIndex:0};fN.getNormal(YN,KN,ZN,e.normal),h.face=e,h.barycoord=t}return h}class iU extends WN{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],c=[],h=[];let u=0,d=0;function p(t,e,n,i,r,s,p,f,m,g,v){const y=s/m,_=p/g,x=s/2,b=p/2,M=f/2,w=m+1,S=g+1;let T=0,E=0;const A=new wD;for(let a=0;a<S;a++){const s=a*_-b;for(let o=0;o<w;o++){const u=o*y-x;A[t]=u*i,A[e]=s*r,A[n]=M,l.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=f>0?1:-1,c.push(A.x,A.y,A.z),h.push(o/m),h.push(1-a/g),T+=1}}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=u+t+w*a,n=u+t+w*(a+1),i=u+(t+1)+w*(a+1),r=u+(t+1)+w*a;o.push(e,n,r),o.push(n,i,r),E+=6}a.addGroup(d,E,v),d+=E,u+=T}p("z","y","x",-1,-1,n,e,t,s,r,0),p("z","y","x",1,-1,n,e,-t,s,r,1),p("x","z","y",1,1,t,n,e,i,s,2),p("x","z","y",1,-1,t,n,-e,i,s,3),p("x","y","z",1,-1,t,e,n,i,r,4),p("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new NN(l,3)),this.setAttribute("normal",new NN(c,3)),this.setAttribute("uv",new NN(h,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new iU(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function rU(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?e[n][i]=null:e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function sU(t){const e={};for(let n=0;n<t.length;n++){const i=rU(t[n]);for(const t in i)e[t]=i[t]}return e}function aU(t){const e=t.getRenderTarget();return null===e?t.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:kD.workingColorSpace}const oU={clone:rU,merge:sU};class lU extends MN{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=rU(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class cU extends tN{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new AL,this.projectionMatrix=new AL,this.projectionMatrixInverse=new AL,this.coordinateSystem=oD,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const hU=new wD,uU=new bD,dU=new bD;class pU extends cU{constructor(t=50,e=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*pD*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*dD*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*pD*Math.atan(Math.tan(.5*dD*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,n){hU.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(hU.x,hU.y).multiplyScalar(-t/hU.z),hU.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(hU.x,hU.y).multiplyScalar(-t/hU.z)}getViewSize(t,e){return this.getViewBounds(t,uU,dU),e.subVectors(dU,uU)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*dD*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/t,e-=s.offsetY*n/a,i*=s.width/t,n*=s.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const fU=-90;class mU extends tN{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new pU(fU,1,t,e);i.layers=this.layers,this.add(i);const r=new pU(fU,1,t,e);r.layers=this.layers,this.add(r);const s=new pU(fU,1,t,e);s.layers=this.layers,this.add(s);const a=new pU(fU,1,t,e);a.layers=this.layers,this.add(a);const o=new pU(fU,1,t,e);o.layers=this.layers,this.add(o);const l=new pU(fU,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,i,r,s,a,o]=e;for(const l of e)this.remove(l);if(t===oD)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(t!==lD)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of e)this.add(l),l.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,c]=this.children,h=t.getRenderTarget(),u=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.xr.enabled;t.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0,i),t.render(e,r),t.setRenderTarget(n,1,i),t.render(e,s),t.setRenderTarget(n,2,i),t.render(e,a),t.setRenderTarget(n,3,i),t.render(e,o),t.setRenderTarget(n,4,i),t.render(e,l),n.texture.generateMipmaps=f,t.setRenderTarget(n,5,i),t.render(e,c),t.setRenderTarget(h,u,d),t.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class gU extends YD{constructor(t=[],e=301,n,i,r,s,a,o,l,c){super(t,e,n,i,r,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class vU extends $D{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];this.texture=new gU(i),this._setTextureOptions(e),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new iU(5,5,5),r=new lU({name:"CubemapFromEquirect",uniforms:rU(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=e;const s=new eU(i,r),a=e.minFilter;e.minFilter===LO&&(e.minFilter=IO);return new mU(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e=!0,n=!0,i=!0){const r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}}class yU extends tN{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _U={type:"move"};class xU{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new yU,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new yU,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new wD,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new wD),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new yU,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new wD,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new wD),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n),i=this._getHandJoint(l,s);null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=t.radius),i.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=e.getPose(t.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(_U)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new yU;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class bU{constructor(t,e=25e-5){this.isFogExp2=!0,this.name="",this.color=new _N(t),this.density=e}clone(){return new bU(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class MU{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new _N(t),this.near=e,this.far=n}clone(){return new MU(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class wU extends tN{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new FL,this.environmentIntensity=1,this.environmentRotation=new FL,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class SU{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=sD,this.updateRanges=[],this.version=0,this.uuid=fD()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=fD()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=fD()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const TU=new wD;class EU{constructor(t,e,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)TU.fromBufferAttribute(this,e),TU.applyMatrix4(t),this.setXYZ(e,TU.x,TU.y,TU.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)TU.fromBufferAttribute(this,e),TU.applyNormalMatrix(t),this.setXYZ(e,TU.x,TU.y,TU.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)TU.fromBufferAttribute(this,e),TU.transformDirection(t),this.setXYZ(e,TU.x,TU.y,TU.z);return this}getComponent(t,e){let n=this.array[t*this.data.stride+this.offset+e];return this.normalized&&(n=yD(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=_D(n,this.array)),this.data.array[t*this.data.stride+this.offset+e]=n,this}setX(t,e){return this.normalized&&(e=_D(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=_D(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=_D(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=_D(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=yD(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=yD(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=yD(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=yD(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array),i=_D(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array),i=_D(i,this.array),r=_D(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new IN(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new EU(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class AU extends MN{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new _N(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let CU;const RU=new wD,PU=new wD,OU=new wD,IU=new bD,DU=new bD,LU=new AL,NU=new wD,UU=new wD,FU=new wD,kU=new bD,BU=new bD,zU=new bD;class VU extends tN{constructor(t=new AU){if(super(),this.isSprite=!0,this.type="Sprite",void 0===CU){CU=new WN;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new SU(t,5);CU.setIndex([0,1,2,0,2,3]),CU.setAttribute("position",new EU(e,3,0,!1)),CU.setAttribute("uv",new EU(e,2,3,!1))}this.geometry=CU,this.material=t,this.center=new bD(.5,.5),this.count=1}raycast(t,e){t.camera,PU.setFromMatrixScale(this.matrixWorld),LU.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),OU.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&PU.multiplyScalar(-OU.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;HU(NU.set(-.5,-.5,0),OU,s,PU,i,r),HU(UU.set(.5,-.5,0),OU,s,PU,i,r),HU(FU.set(.5,.5,0),OU,s,PU,i,r),kU.set(0,0),BU.set(1,0),zU.set(1,1);let a=t.ray.intersectTriangle(NU,UU,FU,!1,RU);if(null===a&&(HU(UU.set(-.5,.5,0),OU,s,PU,i,r),BU.set(0,1),a=t.ray.intersectTriangle(NU,FU,UU,!1,RU),null===a))return;const o=t.ray.origin.distanceTo(RU);o<t.near||o>t.far||e.push({distance:o,point:RU.clone(),uv:fN.getInterpolation(RU,NU,UU,FU,kU,BU,zU,new bD),face:null,object:this})}copy(t,e){return super.copy(t,e),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function HU(t,e,n,i,r,s){IU.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(DU.x=s*IU.x-r*IU.y,DU.y=r*IU.x+s*IU.y):DU.copy(IU),t.copy(e),t.x+=DU.x,t.y+=DU.y,t.applyMatrix4(LU)}const WU=new wD,jU=new wD;class GU extends tN{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let n=0,i=e.length;n<i;n++){const t=e[n];this.addLevel(t.object.clone(),t.distance,t.hysteresis)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0,n=0){e=Math.abs(e);const i=this.levels;let r;for(r=0;r<i.length&&!(e<i[r].distance);r++);return i.splice(r,0,{distance:e,hysteresis:n,object:t}),this.add(t),this}removeLevel(t){const e=this.levels;for(let n=0;n<e.length;n++)if(e[n].distance===t){const t=e.splice(n,1);return this.remove(t[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,i;for(n=1,i=e.length;n<i;n++){let i=e[n].distance;if(e[n].object.visible&&(i-=i*e[n].hysteresis),t<i)break}return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){WU.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(WU);this.getObjectForDistance(n).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){WU.setFromMatrixPosition(t.matrixWorld),jU.setFromMatrixPosition(this.matrixWorld);const n=WU.distanceTo(jU)/t.zoom;let i,r;for(e[0].object.visible=!0,i=1,r=e.length;i<r;i++){let t=e[i].distance;if(e[i].object.visible&&(t-=t*e[i].hysteresis),!(n>=t))break;e[i-1].object.visible=!1,e[i].object.visible=!0}for(this._currentLevel=i-1;i<r;i++)e[i].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const t=n[i];e.object.levels.push({object:t.object.uuid,distance:t.distance,hysteresis:t.hysteresis})}return e}}const XU=new wD,qU=new KD,YU=new KD,KU=new wD,ZU=new AL,$U=new wD,JU=new yL,QU=new AL,tF=new EL;class eF extends eU{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=yO,this.bindMatrix=new AL,this.bindMatrixInverse=new AL,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;null===this.boundingBox&&(this.boundingBox=new tL),this.boundingBox.makeEmpty();const e=t.getAttribute("position");for(let n=0;n<e.count;n++)this.getVertexPosition(n,$U),this.boundingBox.expandByPoint($U)}computeBoundingSphere(){const t=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new yL),this.boundingSphere.makeEmpty();const e=t.getAttribute("position");for(let n=0;n<e.count;n++)this.getVertexPosition(n,$U),this.boundingSphere.expandByPoint($U)}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,e){const n=this.material,i=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),JU.copy(this.boundingSphere),JU.applyMatrix4(i),!1!==t.ray.intersectsSphere(JU)&&(QU.copy(i).invert(),tF.copy(t.ray).applyMatrix4(QU),null!==this.boundingBox&&!1===tF.intersectsBox(this.boundingBox)||this._computeIntersections(t,e,tF)))}getVertexPosition(t,e){return super.getVertexPosition(t,e),this.applyBoneTransform(t,e),e}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new KD,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.fromBufferAttribute(e,n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode===yO?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===_O&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}applyBoneTransform(t,e){const n=this.skeleton,i=this.geometry;qU.fromBufferAttribute(i.attributes.skinIndex,t),YU.fromBufferAttribute(i.attributes.skinWeight,t),XU.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){const t=YU.getComponent(r);if(0!==t){const i=qU.getComponent(r);ZU.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),e.addScaledVector(KU.copy(XU).applyMatrix4(ZU),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}class nF extends tN{constructor(){super(),this.isBone=!0,this.type="Bone"}}class iF extends YD{constructor(t=null,e=1,n=1,i,r,s,a,o,l=1003,c=1003,h,u){super(null,s,a,o,l,c,i,r,h,u),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const rF=new AL,sF=new AL;class aF{constructor(t=[],e=[]){this.uuid=fD(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new AL)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new AL;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=t.length;r<s;r++){const i=t[r]?t[r].matrixWorld:sF;rF.multiplyMatrices(i,e[r]),rF.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new aF(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new iF(e,t,t,$O,HO);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,i=t.bones.length;n<i;n++){let i=e[t.bones[n]];void 0===i&&(i=new nF),this.bones.push(i),this.boneInverses.push((new AL).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let i=0,r=e.length;i<r;i++){const r=e[i];t.bones.push(r.uuid);const s=n[i];t.boneInverses.push(s.toArray())}return t}}class oF extends IN{constructor(t,e,n,i=1){super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const lF=new AL,cF=new AL,hF=[],uF=new tL,dF=new AL,pF=new eU,fF=new yL;class mF extends eU{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new oF(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,dF)}computeBoundingBox(){const t=this.geometry,e=this.count;null===this.boundingBox&&(this.boundingBox=new tL),null===t.boundingBox&&t.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<e;n++)this.getMatrixAt(n,lF),uF.copy(t.boundingBox).applyMatrix4(lF),this.boundingBox.union(uF)}computeBoundingSphere(){const t=this.geometry,e=this.count;null===this.boundingSphere&&(this.boundingSphere=new yL),null===t.boundingSphere&&t.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<e;n++)this.getMatrixAt(n,lF),fF.copy(t.boundingSphere).applyMatrix4(lF),this.boundingSphere.union(fF)}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.morphTexture&&(this.morphTexture=t.morphTexture.clone()),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}getMorphAt(t,e){const n=e.morphTargetInfluences,i=this.morphTexture.source.data.data,r=t*(n.length+1)+1;for(let s=0;s<n.length;s++)n[s]=i[r+s]}raycast(t,e){const n=this.matrixWorld,i=this.count;if(pF.geometry=this.geometry,pF.material=this.material,void 0!==pF.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),fF.copy(this.boundingSphere),fF.applyMatrix4(n),!1!==t.ray.intersectsSphere(fF)))for(let r=0;r<i;r++){this.getMatrixAt(r,lF),cF.multiplyMatrices(n,lF),pF.matrixWorld=cF,pF.raycast(t,hF);for(let t=0,n=hF.length;t<n;t++){const n=hF[t];n.instanceId=r,n.object=this,e.push(n)}hF.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new oF(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}setMorphAt(t,e){const n=e.morphTargetInfluences,i=n.length+1;null===this.morphTexture&&(this.morphTexture=new iF(new Float32Array(i*this.count),i,this.count,tI,HO));const r=this.morphTexture.source.data.data;let s=0;for(let l=0;l<n.length;l++)s+=n[l];const a=this.geometry.morphTargetsRelative?1:1-s,o=i*t;r[o]=a,r.set(n,o+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const gF=new wD,vF=new wD,yF=new ED;class _F{constructor(t=new wD(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=gF.subVectors(n,e).cross(vF.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(gF),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(t.start).addScaledVector(n,r)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||yF.getNormalMatrix(t),i=this.coplanarPoint(gF).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const xF=new yL,bF=new bD(.5,.5),MF=new wD;class wF{constructor(t=new _F,e=new _F,n=new _F,i=new _F,r=new _F,s=new _F){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,e=2e3,n=!1){const i=this.planes,r=t.elements,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],h=r[5],u=r[6],d=r[7],p=r[8],f=r[9],m=r[10],g=r[11],v=r[12],y=r[13],_=r[14],x=r[15];if(i[0].setComponents(l-s,d-c,g-p,x-v).normalize(),i[1].setComponents(l+s,d+c,g+p,x+v).normalize(),i[2].setComponents(l+a,d+h,g+f,x+y).normalize(),i[3].setComponents(l-a,d-h,g-f,x-y).normalize(),n)i[4].setComponents(o,u,m,_).normalize(),i[5].setComponents(l-o,d-u,g-m,x-_).normalize();else if(i[4].setComponents(l-o,d-u,g-m,x-_).normalize(),e===oD)i[5].setComponents(l+o,d+u,g+m,x+_).normalize();else{if(e!==lD)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);i[5].setComponents(o,u,m,_).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),xF.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),xF.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(xF)}intersectsSprite(t){xF.center.set(0,0,0);const e=bF.distanceTo(t.center);return xF.radius=.7071067811865476+e,xF.applyMatrix4(t.matrixWorld),this.intersectsSphere(xF)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++){if(e[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(MF.x=i.normal.x>0?t.max.x:t.min.x,MF.y=i.normal.y>0?t.max.y:t.min.y,MF.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(MF)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const SF=new AL,TF=new wF;class EF{constructor(){this.coordinateSystem=oD}intersectsObject(t,e){if(!e.isArrayCamera||0===e.cameras.length)return!1;for(let n=0;n<e.cameras.length;n++){const i=e.cameras[n];if(SF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),TF.setFromProjectionMatrix(SF,i.coordinateSystem,i.reversedDepth),TF.intersectsObject(t))return!0}return!1}intersectsSprite(t,e){if(!e||!e.cameras||0===e.cameras.length)return!1;for(let n=0;n<e.cameras.length;n++){const i=e.cameras[n];if(SF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),TF.setFromProjectionMatrix(SF,i.coordinateSystem,i.reversedDepth),TF.intersectsSprite(t))return!0}return!1}intersectsSphere(t,e){if(!e||!e.cameras||0===e.cameras.length)return!1;for(let n=0;n<e.cameras.length;n++){const i=e.cameras[n];if(SF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),TF.setFromProjectionMatrix(SF,i.coordinateSystem,i.reversedDepth),TF.intersectsSphere(t))return!0}return!1}intersectsBox(t,e){if(!e||!e.cameras||0===e.cameras.length)return!1;for(let n=0;n<e.cameras.length;n++){const i=e.cameras[n];if(SF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),TF.setFromProjectionMatrix(SF,i.coordinateSystem,i.reversedDepth),TF.intersectsBox(t))return!0}return!1}containsPoint(t,e){if(!e||!e.cameras||0===e.cameras.length)return!1;for(let n=0;n<e.cameras.length;n++){const i=e.cameras[n];if(SF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),TF.setFromProjectionMatrix(SF,i.coordinateSystem,i.reversedDepth),TF.containsPoint(t))return!0}return!1}clone(){return new EF}}function AF(t,e){return t-e}function CF(t,e){return t.z-e.z}function RF(t,e){return e.z-t.z}class PF{constructor(){this.index=0,this.pool=[],this.list=[]}push(t,e,n,i){const r=this.pool,s=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const a=r[this.index];s.push(a),this.index++,a.start=t,a.count=e,a.z=n,a.index=i}reset(){this.list.length=0,this.index=0}}const OF=new AL,IF=new _N(1,1,1),DF=new wF,LF=new EF,NF=new tL,UF=new yL,FF=new wD,kF=new wD,BF=new wD,zF=new PF,VF=new eU,HF=[];function WF(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let s=0;s<r;s++)for(let r=0;r<i;r++)e.setComponent(s+n,r,t.getComponent(s,r))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function jF(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}class GF extends eU{constructor(t,e,n=2*e,i){super(new WN,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=t,this._maxVertexCount=e,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(t),this._multiDrawStarts=new Int32Array(t),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let t=Math.sqrt(4*this._maxInstanceCount);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4),n=new iF(e,t,t,$O,HO);this._matricesTexture=n}_initIndirectTexture(){let t=Math.sqrt(this._maxInstanceCount);t=Math.ceil(t);const e=new Uint32Array(t*t),n=new iF(e,t,t,eI,VO);this._indirectTexture=n}_initColorsTexture(){let t=Math.sqrt(this._maxInstanceCount);t=Math.ceil(t);const e=new Float32Array(t*t*4).fill(1),n=new iF(e,t,t,$O,HO);n.colorSpace=kD.workingColorSpace,this._colorsTexture=n}_initializeGeometry(t){const e=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(!1===this._geometryInitialized){for(const i in t.attributes){const r=t.getAttribute(i),{array:s,itemSize:a,normalized:o}=r,l=new s.constructor(n*a),c=new IN(l,a,o);e.setAttribute(i,c)}if(null!==t.getIndex()){const t=n>65535?new Uint32Array(i):new Uint16Array(i);e.setIndex(new IN(t,1))}this._geometryInitialized=!0}}_validateGeometry(t){const e=this.geometry;if(Boolean(t.getIndex())!==Boolean(e.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in e.attributes){if(!t.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=t.getAttribute(n),r=e.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(t){const e=this._instanceInfo;if(t<0||t>=e.length||!1===e[t].active)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${t}. Instance is either out of range or has been deleted.`)}validateGeometryId(t){const e=this._geometryInfo;if(t<0||t>=e.length||!1===e[t].active)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${t}. Geometry is either out of range or has been deleted.`)}setCustomSort(t){return this.customSort=t,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new tL);const t=this.boundingBox,e=this._instanceInfo;t.makeEmpty();for(let n=0,i=e.length;n<i;n++){if(!1===e[n].active)continue;const i=e[n].geometryIndex;this.getMatrixAt(n,OF),this.getBoundingBoxAt(i,NF).applyMatrix4(OF),t.union(NF)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new yL);const t=this.boundingSphere,e=this._instanceInfo;t.makeEmpty();for(let n=0,i=e.length;n<i;n++){if(!1===e[n].active)continue;const i=e[n].geometryIndex;this.getMatrixAt(n,OF),this.getBoundingSphereAt(i,UF).applyMatrix4(OF),t.union(UF)}}addInstance(t){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const e={visible:!0,active:!0,geometryIndex:t};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(AF),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=e):(n=this._instanceInfo.length,this._instanceInfo.push(e));const i=this._matricesTexture;OF.identity().toArray(i.image.data,16*n),i.needsUpdate=!0;const r=this._colorsTexture;return r&&(IF.toArray(r.image.data,4*n),r.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(t,e=-1,n=-1){this._initializeGeometry(t),this._validateGeometry(t);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=-1===e?t.getAttribute("position").count:e;const s=t.getIndex();if(null!==s&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=-1===n?s.count:n),-1!==i.indexStart&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let a;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(AF),a=this._availableGeometryIds.shift(),r[a]=i):(a=this._geometryCount,this._geometryCount++,r.push(i)),this.setGeometryAt(a,t),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,a}setGeometryAt(t,e){if(t>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(e);const n=this.geometry,i=null!==n.getIndex(),r=n.getIndex(),s=e.getIndex(),a=this._geometryInfo[t];if(i&&s.count>a.reservedIndexCount||e.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const o=a.vertexStart,l=a.reservedVertexCount;a.vertexCount=e.getAttribute("position").count;for(const c in n.attributes){const t=e.getAttribute(c),i=n.getAttribute(c);WF(t,i,o);const r=t.itemSize;for(let e=t.count,n=l;e<n;e++){const t=o+e;for(let e=0;e<r;e++)i.setComponent(t,e,0)}i.needsUpdate=!0,i.addUpdateRange(o*r,l*r)}if(i){const t=a.indexStart,n=a.reservedIndexCount;a.indexCount=e.getIndex().count;for(let e=0;e<s.count;e++)r.setX(t+e,o+s.getX(e));for(let e=s.count,i=n;e<i;e++)r.setX(t+e,o);r.needsUpdate=!0,r.addUpdateRange(t,a.reservedIndexCount)}return a.start=i?a.indexStart:a.vertexStart,a.count=i?a.indexCount:a.vertexCount,a.boundingBox=null,null!==e.boundingBox&&(a.boundingBox=e.boundingBox.clone()),a.boundingSphere=null,null!==e.boundingSphere&&(a.boundingSphere=e.boundingSphere.clone()),this._visibilityChanged=!0,t}deleteGeometry(t){const e=this._geometryInfo;if(t>=e.length||!1===e[t].active)return this;const n=this._instanceInfo;for(let i=0,r=n.length;i<r;i++)n[i].active&&n[i].geometryIndex===t&&this.deleteInstance(i);return e[t].active=!1,this._availableGeometryIds.push(t),this._visibilityChanged=!0,this}deleteInstance(t){return this.validateInstanceId(t),this._instanceInfo[t].active=!1,this._availableInstanceIds.push(t),this._visibilityChanged=!0,this}optimize(){let t=0,e=0;const n=this._geometryInfo,i=n.map((t,e)=>e).sort((t,e)=>n[t].vertexStart-n[e].vertexStart),r=this.geometry;for(let s=0,a=n.length;s<a;s++){const a=i[s],o=n[a];if(!1!==o.active){if(null!==r.index){if(o.indexStart!==e){const{indexStart:n,vertexStart:i,reservedIndexCount:s}=o,a=r.index,l=a.array,c=t-i;for(let t=n;t<n+s;t++)l[t]=l[t]+c;a.array.copyWithin(e,n,n+s),a.addUpdateRange(e,s),o.indexStart=e}e+=o.reservedIndexCount}if(o.vertexStart!==t){const{vertexStart:e,reservedVertexCount:n}=o,i=r.attributes;for(const r in i){const s=i[r],{array:a,itemSize:o}=s;a.copyWithin(t*o,e*o,(e+n)*o),s.addUpdateRange(t*o,n*o)}o.vertexStart=t}t+=o.reservedVertexCount,o.start=r.index?o.indexStart:o.vertexStart,this._nextIndexStart=r.index?o.indexStart+o.reservedIndexCount:0,this._nextVertexStart=o.vertexStart+o.reservedVertexCount}}return this}getBoundingBoxAt(t,e){if(t>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[t];if(null===i.boundingBox){const t=new tL,e=n.index,r=n.attributes.position;for(let n=i.start,s=i.start+i.count;n<s;n++){let i=n;e&&(i=e.getX(i)),t.expandByPoint(FF.fromBufferAttribute(r,i))}i.boundingBox=t}return e.copy(i.boundingBox),e}getBoundingSphereAt(t,e){if(t>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[t];if(null===i.boundingSphere){const e=new yL;this.getBoundingBoxAt(t,NF),NF.getCenter(e.center);const r=n.index,s=n.attributes.position;let a=0;for(let t=i.start,n=i.start+i.count;t<n;t++){let n=t;r&&(n=r.getX(n)),FF.fromBufferAttribute(s,n),a=Math.max(a,e.center.distanceToSquared(FF))}e.radius=Math.sqrt(a),i.boundingSphere=e}return e.copy(i.boundingSphere),e}setMatrixAt(t,e){this.validateInstanceId(t);const n=this._matricesTexture,i=this._matricesTexture.image.data;return e.toArray(i,16*t),n.needsUpdate=!0,this}getMatrixAt(t,e){return this.validateInstanceId(t),e.fromArray(this._matricesTexture.image.data,16*t)}setColorAt(t,e){return this.validateInstanceId(t),null===this._colorsTexture&&this._initColorsTexture(),e.toArray(this._colorsTexture.image.data,4*t),this._colorsTexture.needsUpdate=!0,this}getColorAt(t,e){return this.validateInstanceId(t),e.fromArray(this._colorsTexture.image.data,4*t)}setVisibleAt(t,e){return this.validateInstanceId(t),this._instanceInfo[t].visible===e||(this._instanceInfo[t].visible=e,this._visibilityChanged=!0),this}getVisibleAt(t){return this.validateInstanceId(t),this._instanceInfo[t].visible}setGeometryIdAt(t,e){return this.validateInstanceId(t),this.validateGeometryId(e),this._instanceInfo[t].geometryIndex=e,this}getGeometryIdAt(t){return this.validateInstanceId(t),this._instanceInfo[t].geometryIndex}getGeometryRangeAt(t,e={}){this.validateGeometryId(t);const n=this._geometryInfo[t];return e.vertexStart=n.vertexStart,e.vertexCount=n.vertexCount,e.reservedVertexCount=n.reservedVertexCount,e.indexStart=n.indexStart,e.indexCount=n.indexCount,e.reservedIndexCount=n.reservedIndexCount,e.start=n.start,e.count=n.count,e}setInstanceCount(t){const e=this._availableInstanceIds,n=this._instanceInfo;for(e.sort(AF);e[e.length-1]===n.length-1;)n.pop(),e.pop();if(t<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${t} are being used. Cannot shrink instance count.`);const i=new Int32Array(t),r=new Int32Array(t);jF(this._multiDrawCounts,i),jF(this._multiDrawStarts,r),this._multiDrawCounts=i,this._multiDrawStarts=r,this._maxInstanceCount=t;const s=this._indirectTexture,a=this._matricesTexture,o=this._colorsTexture;s.dispose(),this._initIndirectTexture(),jF(s.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),jF(a.image.data,this._matricesTexture.image.data),o&&(o.dispose(),this._initColorsTexture(),jF(o.image.data,this._colorsTexture.image.data))}setGeometrySize(t,e){const n=[...this._geometryInfo].filter(t=>t.active);if(Math.max(...n.map(t=>t.vertexStart+t.reservedVertexCount))>t)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${e}. Cannot shrink further.`);if(this.geometry.index){if(Math.max(...n.map(t=>t.indexStart+t.reservedIndexCount))>e)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${e}. Cannot shrink further.`)}const i=this.geometry;i.dispose(),this._maxVertexCount=t,this._maxIndexCount=e,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new WN,this._initializeGeometry(i));const r=this.geometry;i.index&&jF(i.index.array,r.index.array);for(const s in i.attributes)jF(i.attributes[s].array,r.attributes[s].array)}raycast(t,e){const n=this._instanceInfo,i=this._geometryInfo,r=this.matrixWorld,s=this.geometry;VF.material=this.material,VF.geometry.index=s.index,VF.geometry.attributes=s.attributes,null===VF.geometry.boundingBox&&(VF.geometry.boundingBox=new tL),null===VF.geometry.boundingSphere&&(VF.geometry.boundingSphere=new yL);for(let a=0,o=n.length;a<o;a++){if(!n[a].visible||!n[a].active)continue;const s=n[a].geometryIndex,o=i[s];VF.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(a,VF.matrixWorld).premultiply(r),this.getBoundingBoxAt(s,VF.geometry.boundingBox),this.getBoundingSphereAt(s,VF.geometry.boundingSphere),VF.raycast(t,HF);for(let t=0,n=HF.length;t<n;t++){const n=HF[t];n.object=this,n.batchId=a,e.push(n)}HF.length=0}VF.material=null,VF.geometry.index=null,VF.geometry.attributes={},VF.geometry.setDrawRange(0,1/0)}copy(t){return super.copy(t),this.geometry=t.geometry.clone(),this.perObjectFrustumCulled=t.perObjectFrustumCulled,this.sortObjects=t.sortObjects,this.boundingBox=null!==t.boundingBox?t.boundingBox.clone():null,this.boundingSphere=null!==t.boundingSphere?t.boundingSphere.clone():null,this._geometryInfo=t._geometryInfo.map(t=>({...t,boundingBox:null!==t.boundingBox?t.boundingBox.clone():null,boundingSphere:null!==t.boundingSphere?t.boundingSphere.clone():null})),this._instanceInfo=t._instanceInfo.map(t=>({...t})),this._availableInstanceIds=t._availableInstanceIds.slice(),this._availableGeometryIds=t._availableGeometryIds.slice(),this._nextIndexStart=t._nextIndexStart,this._nextVertexStart=t._nextVertexStart,this._geometryCount=t._geometryCount,this._maxInstanceCount=t._maxInstanceCount,this._maxVertexCount=t._maxVertexCount,this._maxIndexCount=t._maxIndexCount,this._geometryInitialized=t._geometryInitialized,this._multiDrawCounts=t._multiDrawCounts.slice(),this._multiDrawStarts=t._multiDrawStarts.slice(),this._indirectTexture=t._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=t._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=t._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(t,e,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const s=i.getIndex(),a=null===s?1:s.array.BYTES_PER_ELEMENT,o=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,h=this._geometryInfo,u=this.perObjectFrustumCulled,d=this._indirectTexture,p=d.image.data,f=n.isArrayCamera?LF:DF;u&&!n.isArrayCamera&&(OF.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),DF.setFromProjectionMatrix(OF,n.coordinateSystem,n.reversedDepth));let m=0;if(this.sortObjects){OF.copy(this.matrixWorld).invert(),FF.setFromMatrixPosition(n.matrixWorld).applyMatrix4(OF),kF.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(OF);for(let i=0,r=o.length;i<r;i++)if(o[i].visible&&o[i].active){const t=o[i].geometryIndex;this.getMatrixAt(i,OF),this.getBoundingSphereAt(t,UF).applyMatrix4(OF);let e=!1;if(u&&(e=!f.intersectsSphere(UF,n)),!e){const e=h[t],n=BF.subVectors(UF.center,FF).dot(kF);zF.push(e.start,e.count,n,i)}}const t=zF.list,e=this.customSort;null===e?t.sort(r.transparent?RF:CF):e.call(this,t,n);for(let n=0,i=t.length;n<i;n++){const e=t[n];l[m]=e.start*a,c[m]=e.count,p[m]=e.index,m++}zF.reset()}else for(let g=0,v=o.length;g<v;g++)if(o[g].visible&&o[g].active){const t=o[g].geometryIndex;let e=!1;if(u&&(this.getMatrixAt(g,OF),this.getBoundingSphereAt(t,UF).applyMatrix4(OF),e=!f.intersectsSphere(UF,n)),!e){const e=h[t];l[m]=e.start*a,c[m]=e.count,p[m]=g,m++}}d.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(t,e,n,i,r,s){this.onBeforeRender(t,null,i,r,s)}}class XF extends MN{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new _N(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const qF=new wD,YF=new wD,KF=new AL,ZF=new EL,$F=new yL,JF=new wD,QF=new wD;class tk extends tN{constructor(t=new WN,e=new XF){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)qF.fromBufferAttribute(e,t-1),YF.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=qF.distanceTo(YF);t.setAttribute("lineDistance",new NN(n,1))}return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),$F.copy(n.boundingSphere),$F.applyMatrix4(i),$F.radius+=r,!1===t.ray.intersectsSphere($F))return;KF.copy(i).invert(),ZF.copy(t.ray).applyMatrix4(KF);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=this.isLineSegments?2:1,c=n.index,h=n.attributes.position;if(null!==c){const n=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=c.getX(r),i=c.getX(r+1),s=ek(this,t,ZF,o,n,i,r);s&&e.push(s)}if(this.isLineLoop){const r=c.getX(i-1),s=c.getX(n),a=ek(this,t,ZF,o,r,s,i-1);a&&e.push(a)}}else{const n=Math.max(0,s.start),i=Math.min(h.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=ek(this,t,ZF,o,r,r+1,r);n&&e.push(n)}if(this.isLineLoop){const r=ek(this,t,ZF,o,i-1,n,i-1);r&&e.push(r)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function ek(t,e,n,i,r,s,a){const o=t.geometry.attributes.position;qF.fromBufferAttribute(o,r),YF.fromBufferAttribute(o,s);if(n.distanceSqToSegment(qF,YF,JF,QF)>i)return;JF.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(JF);return l<e.near||l>e.far?void 0:{distance:l,point:QF.clone().applyMatrix4(t.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:t}}const nk=new wD,ik=new wD;class rk extends tk{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)nk.fromBufferAttribute(e,t),ik.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+nk.distanceTo(ik);t.setAttribute("lineDistance",new NN(n,1))}return this}}class sk extends tk{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class ak extends MN{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new _N(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const ok=new AL,lk=new EL,ck=new yL,hk=new wD;class uk extends tN{constructor(t=new WN,e=new ak){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ck.copy(n.boundingSphere),ck.applyMatrix4(i),ck.radius+=r,!1===t.ray.intersectsSphere(ck))return;ok.copy(i).invert(),lk.copy(t.ray).applyMatrix4(ok);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),r=Math.min(l.count,s.start+s.count);n<r;n++){const r=l.getX(n);hk.fromBufferAttribute(c,r),dk(hk,r,o,i,t,e,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);n<r;n++)hk.fromBufferAttribute(c,n),dk(hk,n,o,i,t,e,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function dk(t,e,n,i,r,s,a){const o=lk.distanceSqToPoint(t);if(o<n){const n=new wD;lk.closestPointToPoint(t,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class pk extends YD{constructor(t,e,n,i,r=1006,s=1006,a,o,l){super(t,e,n,i,r,s,a,o,l),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const c=this;"requestVideoFrameCallback"in t&&(this._requestVideoFrameCallbackId=t.requestVideoFrameCallback(function e(){c.needsUpdate=!0,c._requestVideoFrameCallbackId=t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),super.dispose()}}class fk extends YD{constructor(t,e,n,i,r,s,a,o,l,c,h,u){super(null,s,a,o,l,c,i,r,h,u),this.isCompressedTexture=!0,this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class mk extends YD{constructor(t,e,n=1014,i,r,s,a=1003,o=1003,l,c=1026,h=1){if(c!==JO&&c!==QO)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:t,height:e,depth:h},i,r,s,a,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new jD(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}class gk extends YD{constructor(t=null){super(),this.sourceTexture=t,this.isExternalTexture=!0}copy(t){return super.copy(t),this.sourceTexture=t.sourceTexture,this}}class vk extends WN{constructor(t=1,e=1,n=4,i=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:t,height:e,capSegments:n,radialSegments:i,heightSegments:r},e=Math.max(0,e),n=Math.max(1,Math.floor(n)),i=Math.max(3,Math.floor(i)),r=Math.max(1,Math.floor(r));const s=[],a=[],o=[],l=[],c=e/2,h=Math.PI/2*t,u=e,d=2*h+u,p=2*n+r,f=i+1,m=new wD,g=new wD;for(let v=0;v<=p;v++){let y=0,_=0,x=0,b=0;if(v<=n){const e=v/n,i=e*Math.PI/2;_=-c-t*Math.cos(i),x=t*Math.sin(i),b=-t*Math.cos(i),y=e*h}else if(v<=n+r){const i=(v-n)/r;_=i*e-c,x=t,b=0,y=h+i*u}else{const e=(v-n-r)/n,i=e*Math.PI/2;_=c+t*Math.sin(i),x=t*Math.cos(i),b=t*Math.sin(i),y=h+u+e*h}const M=Math.max(0,Math.min(1,y/d));let w=0;0===v?w=.5/i:v===p&&(w=-.5/i);for(let t=0;t<=i;t++){const e=t/i,n=e*Math.PI*2,r=Math.sin(n),s=Math.cos(n);g.x=-x*s,g.y=_,g.z=x*r,a.push(g.x,g.y,g.z),m.set(-x*s,b,x*r),m.normalize(),o.push(m.x,m.y,m.z),l.push(e+w,M)}if(v>0){const t=(v-1)*f;for(let e=0;e<i;e++){const n=t+e,i=t+e+1,r=v*f+e,a=v*f+e+1;s.push(n,i,r),s.push(i,a,r)}}}this.setIndex(s),this.setAttribute("position",new NN(a,3)),this.setAttribute("normal",new NN(o,3)),this.setAttribute("uv",new NN(l,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new vk(t.radius,t.height,t.capSegments,t.radialSegments,t.heightSegments)}}class yk extends WN{constructor(t=1,e=32,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},e=Math.max(3,e);const r=[],s=[],a=[],o=[],l=new wD,c=new bD;s.push(0,0,0),a.push(0,0,1),o.push(.5,.5);for(let h=0,u=3;h<=e;h++,u+=3){const r=n+h/e*i;l.x=t*Math.cos(r),l.y=t*Math.sin(r),s.push(l.x,l.y,l.z),a.push(0,0,1),c.x=(s[u]/t+1)/2,c.y=(s[u+1]/t+1)/2,o.push(c.x,c.y)}for(let h=1;h<=e;h++)r.push(h,h+1,0);this.setIndex(r),this.setAttribute("position",new NN(s,3)),this.setAttribute("normal",new NN(a,3)),this.setAttribute("uv",new NN(o,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new yk(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class _k extends WN{constructor(t=1,e=1,n=1,i=32,r=1,s=!1,a=0,o=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],h=[],u=[],d=[];let p=0;const f=[],m=n/2;let g=0;function v(n){const r=p,s=new bD,f=new wD;let v=0;const y=!0===n?t:e,_=!0===n?1:-1;for(let t=1;t<=i;t++)h.push(0,m*_,0),u.push(0,_,0),d.push(.5,.5),p++;const x=p;for(let t=0;t<=i;t++){const e=t/i*o+a,n=Math.cos(e),r=Math.sin(e);f.x=y*r,f.y=m*_,f.z=y*n,h.push(f.x,f.y,f.z),u.push(0,_,0),s.x=.5*n+.5,s.y=.5*r*_+.5,d.push(s.x,s.y),p++}for(let t=0;t<i;t++){const e=r+t,i=x+t;!0===n?c.push(i,i+1,e):c.push(i+1,i,e),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const s=new wD,v=new wD;let y=0;const _=(e-t)/n;for(let l=0;l<=r;l++){const c=[],g=l/r,y=g*(e-t)+t;for(let t=0;t<=i;t++){const e=t/i,r=e*o+a,l=Math.sin(r),f=Math.cos(r);v.x=y*l,v.y=-g*n+m,v.z=y*f,h.push(v.x,v.y,v.z),s.set(l,_,f).normalize(),u.push(s.x,s.y,s.z),d.push(e,1-g),c.push(p++)}f.push(c)}for(let n=0;n<i;n++)for(let i=0;i<r;i++){const s=f[i][n],a=f[i+1][n],o=f[i+1][n+1],l=f[i][n+1];(t>0||0!==i)&&(c.push(s,a,l),y+=3),(e>0||i!==r-1)&&(c.push(a,o,l),y+=3)}l.addGroup(g,y,0),g+=y}(),!1===s&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new NN(h,3)),this.setAttribute("normal",new NN(u,3)),this.setAttribute("uv",new NN(d,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new _k(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class xk extends _k{constructor(t=1,e=1,n=32,i=1,r=!1,s=0,a=2*Math.PI){super(0,t,e,n,i,r,s,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:a}}static fromJSON(t){return new xk(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class bk extends WN{constructor(t=[],e=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i};const r=[],s=[];function a(t,e,n,i){const r=i+1,s=[];for(let a=0;a<=r;a++){s[a]=[];const i=t.clone().lerp(n,a/r),o=e.clone().lerp(n,a/r),l=r-a;for(let t=0;t<=l;t++)s[a][t]=0===t&&a===r?i:i.clone().lerp(o,t/l)}for(let a=0;a<r;a++)for(let t=0;t<2*(r-a)-1;t++){const e=Math.floor(t/2);t%2==0?(o(s[a][e+1]),o(s[a+1][e]),o(s[a][e])):(o(s[a][e+1]),o(s[a+1][e+1]),o(s[a+1][e]))}}function o(t){r.push(t.x,t.y,t.z)}function l(e,n){const i=3*e;n.x=t[i+0],n.y=t[i+1],n.z=t[i+2]}function c(t,e,n,i){i<0&&1===t.x&&(s[e]=t.x-1),0===n.x&&0===n.z&&(s[e]=i/2/Math.PI+.5)}function h(t){return Math.atan2(t.z,-t.x)}function u(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}!function(t){const n=new wD,i=new wD,r=new wD;for(let s=0;s<e.length;s+=3)l(e[s+0],n),l(e[s+1],i),l(e[s+2],r),a(n,i,r,t)}(i),function(t){const e=new wD;for(let n=0;n<r.length;n+=3)e.x=r[n+0],e.y=r[n+1],e.z=r[n+2],e.normalize().multiplyScalar(t),r[n+0]=e.x,r[n+1]=e.y,r[n+2]=e.z}(n),function(){const t=new wD;for(let e=0;e<r.length;e+=3){t.x=r[e+0],t.y=r[e+1],t.z=r[e+2];const n=h(t)/2/Math.PI+.5,i=u(t)/Math.PI+.5;s.push(n,1-i)}(function(){const t=new wD,e=new wD,n=new wD,i=new wD,a=new bD,o=new bD,l=new bD;for(let u=0,d=0;u<r.length;u+=9,d+=6){t.set(r[u+0],r[u+1],r[u+2]),e.set(r[u+3],r[u+4],r[u+5]),n.set(r[u+6],r[u+7],r[u+8]),a.set(s[d+0],s[d+1]),o.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(t).add(e).add(n).divideScalar(3);const p=h(i);c(a,d+0,t,p),c(o,d+2,e,p),c(l,d+4,n,p)}})(),function(){for(let t=0;t<s.length;t+=6){const e=s[t+0],n=s[t+2],i=s[t+4],r=Math.max(e,n,i),a=Math.min(e,n,i);r>.9&&a<.1&&(e<.2&&(s[t+0]+=1),n<.2&&(s[t+2]+=1),i<.2&&(s[t+4]+=1))}}()}(),this.setAttribute("position",new NN(r,3)),this.setAttribute("normal",new NN(r.slice(),3)),this.setAttribute("uv",new NN(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new bk(t.vertices,t.indices,t.radius,t.details)}}class Mk extends bk{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Mk(t.radius,t.detail)}}const wk=new wD,Sk=new wD,Tk=new wD,Ek=new fN;class Ak extends WN{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const n=4,i=Math.pow(10,n),r=Math.cos(dD*e),s=t.getIndex(),a=t.getAttribute("position"),o=s?s.count:a.count,l=[0,0,0],c=["a","b","c"],h=new Array(3),u={},d=[];for(let t=0;t<o;t+=3){s?(l[0]=s.getX(t),l[1]=s.getX(t+1),l[2]=s.getX(t+2)):(l[0]=t,l[1]=t+1,l[2]=t+2);const{a:e,b:n,c:o}=Ek;if(e.fromBufferAttribute(a,l[0]),n.fromBufferAttribute(a,l[1]),o.fromBufferAttribute(a,l[2]),Ek.getNormal(Tk),h[0]=`${Math.round(e.x*i)},${Math.round(e.y*i)},${Math.round(e.z*i)}`,h[1]=`${Math.round(n.x*i)},${Math.round(n.y*i)},${Math.round(n.z*i)}`,h[2]=`${Math.round(o.x*i)},${Math.round(o.y*i)},${Math.round(o.z*i)}`,h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=h[t],i=h[e],s=Ek[c[t]],a=Ek[c[e]],o=`${n}_${i}`,p=`${i}_${n}`;p in u&&u[p]?(Tk.dot(u[p].normal)<=r&&(d.push(s.x,s.y,s.z),d.push(a.x,a.y,a.z)),u[p]=null):o in u||(u[o]={index0:l[t],index1:l[e],normal:Tk.clone()})}}for(const t in u)if(u[t]){const{index0:e,index1:n}=u[t];wk.fromBufferAttribute(a,e),Sk.fromBufferAttribute(a,n),d.push(wk.x,wk.y,wk.z),d.push(Sk.x,Sk.y,Sk.z)}this.setAttribute("position",new NN(d,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}class Ck{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e=null){const n=this.getLengths();let i=0;const r=n.length;let s;s=e||t*n[r-1];let a,o=0,l=r-1;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),a=n[i]-s,a<0)o=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),a=this.getPoint(r),o=e||(s.isVector2?new bD:new wD);return o.copy(a).sub(s).normalize(),o}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e=!1){const n=new wD,i=[],r=[],s=[],a=new wD,o=new AL;for(let d=0;d<=t;d++){const e=d/t;i[d]=this.getTangentAt(e,new wD)}r[0]=new wD,s[0]=new wD;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),h=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),u<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(mD(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(o.makeRotationAxis(a,t))}s[d].crossVectors(i[d],r[d])}if(!0===e){let e=Math.acos(mD(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(a.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(o.makeRotationAxis(i[n],e*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Rk extends Ck{constructor(t=0,e=0,n=1,i=1,r=0,s=2*Math.PI,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(t,e=new bD){const n=e,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0!==this.aClockwise||s||(r===i?r=-i:r-=i);const a=this.aStartAngle+t*r;let o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=o-this.aX,i=l-this.aY;o=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(o,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class Pk extends Rk{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Ok(){let t=0,e=0,n=0,i=0;function r(r,s,a,o){t=r,e=a,n=-3*r+3*s-2*a-o,i=2*r-2*s+a+o}return{initCatmullRom:function(t,e,n,i,s){r(e,n,s*(n-t),s*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,s,a,o){let l=(e-t)/s-(n-t)/(s+a)+(n-e)/a,c=(n-e)/a-(i-e)/(a+o)+(i-n)/o;l*=a,c*=a,r(e,n,l,c)},calc:function(r){const s=r*r;return t+e*r+n*s+i*(s*r)}}}const Ik=new wD,Dk=new Ok,Lk=new Ok,Nk=new Ok;class Uk extends Ck{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new wD){const n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t;let a,o,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?a=i[(l-1)%r]:(Ik.subVectors(i[0],i[1]).add(i[0]),a=Ik);const h=i[l%r],u=i[(l+1)%r];if(this.closed||l+2<r?o=i[(l+2)%r]:(Ik.subVectors(i[r-1],i[r-2]).add(i[r-1]),o=Ik),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(h),t),n=Math.pow(h.distanceToSquared(u),t),i=Math.pow(u.distanceToSquared(o),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),Dk.initNonuniformCatmullRom(a.x,h.x,u.x,o.x,e,n,i),Lk.initNonuniformCatmullRom(a.y,h.y,u.y,o.y,e,n,i),Nk.initNonuniformCatmullRom(a.z,h.z,u.z,o.z,e,n,i)}else"catmullrom"===this.curveType&&(Dk.initCatmullRom(a.x,h.x,u.x,o.x,this.tension),Lk.initCatmullRom(a.y,h.y,u.y,o.y,this.tension),Nk.initCatmullRom(a.z,h.z,u.z,o.z,this.tension));return n.set(Dk.calc(c),Lk.calc(c),Nk.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new wD).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Fk(t,e,n,i,r){const s=.5*(i-e),a=.5*(r-n),o=t*t;return(2*n-2*i+s+a)*(t*o)+(-3*n+3*i-2*s-a)*o+s*t+n}function kk(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function Bk(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}class zk extends Ck{constructor(t=new bD,e=new bD,n=new bD,i=new bD){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new bD){const n=e,i=this.v0,r=this.v1,s=this.v2,a=this.v3;return n.set(Bk(t,i.x,r.x,s.x,a.x),Bk(t,i.y,r.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Vk extends Ck{constructor(t=new wD,e=new wD,n=new wD,i=new wD){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new wD){const n=e,i=this.v0,r=this.v1,s=this.v2,a=this.v3;return n.set(Bk(t,i.x,r.x,s.x,a.x),Bk(t,i.y,r.y,s.y,a.y),Bk(t,i.z,r.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Hk extends Ck{constructor(t=new bD,e=new bD){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new bD){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new bD){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Wk extends Ck{constructor(t=new wD,e=new wD){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new wD){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new wD){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class jk extends Ck{constructor(t=new bD,e=new bD,n=new bD){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new bD){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(kk(t,i.x,r.x,s.x),kk(t,i.y,r.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Gk extends Ck{constructor(t=new wD,e=new wD,n=new wD){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new wD){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(kk(t,i.x,r.x,s.x),kk(t,i.y,r.y,s.y),kk(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Xk extends Ck{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new bD){const n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),a=r-s,o=i[0===s?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],h=i[s>i.length-3?i.length-1:s+2];return n.set(Fk(a,o.x,l.x,c.x,h.x),Fk(a,o.y,l.y,c.y,h.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new bD).fromArray(n))}return this}}var qk=Object.freeze({__proto__:null,ArcCurve:Pk,CatmullRomCurve3:Uk,CubicBezierCurve:zk,CubicBezierCurve3:Vk,EllipseCurve:Rk,LineCurve:Hk,LineCurve3:Wk,QuadraticBezierCurve:jk,QuadraticBezierCurve3:Gk,SplineCurve:Xk});class Yk extends Ck{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const n=!0===t.isVector2?"LineCurve":"LineCurve3";this.curves.push(new qk[n](e,t))}return this}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const t=i[r]-n,s=this.curves[r],a=s.getLength(),o=0===a?0:1-t/a;return s.getPointAt(o,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],a=s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,o=s.getPoints(a);for(let t=0;t<o.length;t++){const i=o[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new qk[n.type]).fromJSON(n))}return this}}class Kk extends Yk{constructor(t){super(),this.type="Path",this.currentPoint=new bD,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Hk(this.currentPoint.clone(),new bD(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new jk(this.currentPoint.clone(),new bD(t,e),new bD(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){const a=new zk(this.currentPoint.clone(),new bD(t,e),new bD(n,i),new bD(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Xk(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){const a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(t+a,e+o,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,a,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,i,r,s,a,o),this}absellipse(t,e,n,i,r,s,a,o){const l=new Rk(t,e,n,i,r,s,a,o);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Zk extends Kk{constructor(t){super(t),this.uuid=fD(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Kk).fromJSON(n))}return this}}function $k(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=Jk(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(i&&(s=function(t,e,n,i){const r=[];for(let s=0,a=e.length;s<a;s++){const n=Jk(t,e[s]*i,s<a-1?e[s+1]*i:t.length,i,!1);n===n.next&&(n.steiner=!0),r.push(cB(n))}r.sort(sB);for(let s=0;s<r.length;s++)n=aB(r[s],n);return n}(t,e,s,n)),t.length>80*n){o=1/0,l=1/0;let e=-1/0,i=-1/0;for(let s=n;s<r;s+=n){const n=t[s],r=t[s+1];n<o&&(o=n),r<l&&(l=r),n>e&&(e=n),r>i&&(i=r)}c=Math.max(e-o,i-l),c=0!==c?32767/c:0}return tB(s,a,n,o,l,c,0),a}function Jk(t,e,n,i,r){let s;if(r===function(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}(t,e,n,i)>0)for(let a=e;a<n;a+=i)s=xB(a/i|0,t[a],t[a+1],s);else for(let a=n-i;a>=e;a-=i)s=xB(a/i|0,t[a],t[a+1],s);return s&&fB(s,s.next)&&(bB(s),s=s.next),s}function Qk(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!fB(i,i.next)&&0!==pB(i.prev,i,i.next))i=i.next;else{if(bB(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function tB(t,e,n,i,r,s,a){if(!t)return;!a&&s&&function(t,e,n,i){let r=t;do{0===r.z&&(r.z=lB(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n=1;do{let i,r=t;t=null;let s=null;for(e=0;r;){e++;let a=r,o=0;for(let t=0;t<n&&(o++,a=a.nextZ,a);t++);let l=n;for(;o>0||l>0&&a;)0!==o&&(0===l||!a||r.z<=a.z)?(i=r,r=r.nextZ,o--):(i=a,a=a.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;r=a}s.nextZ=null,n*=2}while(e>1)}(r)}(t,i,r,s);let o=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(s?nB(t,i,r,s):eB(t))e.push(l.i,t.i,c.i),bB(t),t=c.next,o=c.next;else if((t=c)===o){a?1===a?tB(t=iB(Qk(t),e),e,n,i,r,s,2):2===a&&rB(t,e,n,i,r,s):tB(Qk(t),e,n,i,r,s,1);break}}}function eB(t){const e=t.prev,n=t,i=t.next;if(pB(e,n,i)>=0)return!1;const r=e.x,s=n.x,a=i.x,o=e.y,l=n.y,c=i.y,h=Math.min(r,s,a),u=Math.min(o,l,c),d=Math.max(r,s,a),p=Math.max(o,l,c);let f=i.next;for(;f!==e;){if(f.x>=h&&f.x<=d&&f.y>=u&&f.y<=p&&uB(r,o,s,l,a,c,f.x,f.y)&&pB(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function nB(t,e,n,i){const r=t.prev,s=t,a=t.next;if(pB(r,s,a)>=0)return!1;const o=r.x,l=s.x,c=a.x,h=r.y,u=s.y,d=a.y,p=Math.min(o,l,c),f=Math.min(h,u,d),m=Math.max(o,l,c),g=Math.max(h,u,d),v=lB(p,f,e,n,i),y=lB(m,g,e,n,i);let _=t.prevZ,x=t.nextZ;for(;_&&_.z>=v&&x&&x.z<=y;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==r&&_!==a&&uB(o,h,l,u,c,d,_.x,_.y)&&pB(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==a&&uB(o,h,l,u,c,d,x.x,x.y)&&pB(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==r&&_!==a&&uB(o,h,l,u,c,d,_.x,_.y)&&pB(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==a&&uB(o,h,l,u,c,d,x.x,x.y)&&pB(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function iB(t,e){let n=t;do{const i=n.prev,r=n.next.next;!fB(i,r)&&mB(i,n,n.next,r)&&yB(i,r)&&yB(r,i)&&(e.push(i.i,n.i,r.i),bB(n),bB(n.next),n=t=r),n=n.next}while(n!==t);return Qk(n)}function rB(t,e,n,i,r,s){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&dB(a,t)){let o=_B(a,t);return a=Qk(a,a.next),o=Qk(o,o.next),tB(a,e,n,i,r,s,0),void tB(o,e,n,i,r,s,0)}t=t.next}a=a.next}while(a!==t)}function sB(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function aB(t,e){const n=function(t,e){let n=e;const i=t.x,r=t.y;let s,a=-1/0;if(fB(t,n))return n;do{if(fB(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>a&&(a=t,s=n.x<n.next.x?n:n.next,t===i))return s}n=n.next}while(n!==e);if(!s)return null;const o=s,l=s.x,c=s.y;let h=1/0;n=s;do{if(i>=n.x&&n.x>=l&&i!==n.x&&hB(r<c?i:a,r,l,c,r<c?a:i,r,n.x,n.y)){const e=Math.abs(r-n.y)/(i-n.x);yB(n,t)&&(e<h||e===h&&(n.x>s.x||n.x===s.x&&oB(s,n)))&&(s=n,h=e)}n=n.next}while(n!==o);return s}(t,e);if(!n)return e;const i=_B(n,t);return Qk(i,i.next),Qk(n,n.next)}function oB(t,e){return pB(t.prev,t,e.prev)<0&&pB(e.next,t,t.next)<0}function lB(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function cB(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function hB(t,e,n,i,r,s,a,o){return(r-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function uB(t,e,n,i,r,s,a,o){return!(t===a&&e===o)&&hB(t,e,n,i,r,s,a,o)}function dB(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&mB(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(yB(t,e)&&yB(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(pB(t.prev,t,e.prev)||pB(t,e.prev,e))||fB(t,e)&&pB(t.prev,t,t.next)>0&&pB(e.prev,e,e.next)>0)}function pB(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function fB(t,e){return t.x===e.x&&t.y===e.y}function mB(t,e,n,i){const r=vB(pB(t,e,n)),s=vB(pB(t,e,i)),a=vB(pB(n,i,t)),o=vB(pB(n,i,e));return r!==s&&a!==o||(!(0!==r||!gB(t,n,e))||(!(0!==s||!gB(t,i,e))||(!(0!==a||!gB(n,t,i))||!(0!==o||!gB(n,e,i)))))}function gB(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function vB(t){return t>0?1:t<0?-1:0}function yB(t,e){return pB(t.prev,t,t.next)<0?pB(t,e,t.next)>=0&&pB(t,t.prev,e)>=0:pB(t,e,t.prev)<0||pB(t,t.next,e)<0}function _B(t,e){const n=MB(t.i,t.x,t.y),i=MB(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function xB(t,e,n,i){const r=MB(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function bB(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function MB(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class wB{static triangulate(t,e,n=2){return $k(t,e,n)}}class SB{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return SB.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];TB(t),EB(n,t);let s=t.length;e.forEach(TB);for(let o=0;o<e.length;o++)i.push(s),s+=e[o].length,EB(n,e[o]);const a=wB.triangulate(n,i);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}}function TB(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function EB(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class AB extends WN{constructor(t=new Zk([new bD(.5,.5),new bD(-.5,.5),new bD(-.5,-.5),new bD(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let a=0,o=t.length;a<o;a++){s(t[a])}function s(t){const s=[],a=void 0!==e.curveSegments?e.curveSegments:12,o=void 0!==e.steps?e.steps:1,l=void 0!==e.depth?e.depth:1;let c=void 0===e.bevelEnabled||e.bevelEnabled,h=void 0!==e.bevelThickness?e.bevelThickness:.2,u=void 0!==e.bevelSize?e.bevelSize:h-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:CB;let g,v,y,_,x,b=!1;f&&(g=f.getSpacedPoints(o),b=!0,c=!1,v=f.computeFrenetFrames(o,!1),y=new wD,_=new wD,x=new wD),c||(p=0,h=0,u=0,d=0);const M=t.extractPoints(a);let w=M.shape;const S=M.holes;if(!SB.isClockWise(w)){w=w.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];SB.isClockWise(e)&&(S[t]=e.reverse())}}function T(t){const e=1e-10*1e-10;let n=t[0];for(let i=1;i<=t.length;i++){const r=i%t.length,s=t[r],a=s.x-n.x,o=s.y-n.y,l=a*a+o*o,c=Math.max(Math.abs(s.x),Math.abs(s.y),Math.abs(n.x),Math.abs(n.y));l<=e*c*c?(t.splice(r,1),i--):n=s}}T(w),S.forEach(T);const E=S.length,A=w;for(let e=0;e<E;e++){const t=S[e];w=w.concat(t)}function C(t,e,n){return t.clone().addScaledVector(e,n)}const R=w.length;function P(t,e,n){let i,r,s;const a=t.x-e.x,o=t.y-e.y,l=n.x-t.x,c=n.y-t.y,h=a*a+o*o,u=a*c-o*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(h),d=Math.sqrt(l*l+c*c),p=e.x-o/u,f=e.y+a/u,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(a*c-o*l);i=p+a*m-t.x,r=f+o*m-t.y;const g=i*i+r*r;if(g<=2)return new bD(i,r);s=Math.sqrt(g/2)}else{let t=!1;a>Number.EPSILON?l>Number.EPSILON&&(t=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(o)===Math.sign(c)&&(t=!0),t?(i=-o,r=a,s=Math.sqrt(h)):(i=a,r=o,s=Math.sqrt(h/2))}return new bD(i/s,r/s)}const O=[];for(let e=0,n=A.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),O[e]=P(A[e],A[i],A[r]);const I=[];let D,L,N=O.concat();for(let e=0,n=E;e<n;e++){const t=S[e];D=[];for(let e=0,n=t.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),D[e]=P(t[e],t[i],t[r]);I.push(D),N=N.concat(D)}if(0===p)L=SB.triangulateShape(A,S);else{const t=[],e=[];for(let n=0;n<p;n++){const i=n/p,r=h*Math.cos(i*Math.PI/2),s=u*Math.sin(i*Math.PI/2)+d;for(let e=0,n=A.length;e<n;e++){const n=C(A[e],O[e],s);B(n.x,n.y,-r),0===i&&t.push(n)}for(let t=0,n=E;t<n;t++){const n=S[t];D=I[t];const a=[];for(let t=0,e=n.length;t<e;t++){const e=C(n[t],D[t],s);B(e.x,e.y,-r),0===i&&a.push(e)}0===i&&e.push(a)}}L=SB.triangulateShape(t,e)}const U=L.length,F=u+d;for(let e=0;e<R;e++){const t=c?C(w[e],N[e],F):w[e];b?(_.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),x.copy(g[0]).add(_).add(y),B(x.x,x.y,x.z)):B(t.x,t.y,0)}for(let e=1;e<=o;e++)for(let t=0;t<R;t++){const n=c?C(w[t],N[t],F):w[t];b?(_.copy(v.normals[e]).multiplyScalar(n.x),y.copy(v.binormals[e]).multiplyScalar(n.y),x.copy(g[e]).add(_).add(y),B(x.x,x.y,x.z)):B(n.x,n.y,l/o*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=h*Math.cos(t*Math.PI/2),i=u*Math.sin(t*Math.PI/2)+d;for(let e=0,r=A.length;e<r;e++){const t=C(A[e],O[e],i);B(t.x,t.y,l+n)}for(let e=0,r=S.length;e<r;e++){const t=S[e];D=I[e];for(let e=0,r=t.length;e<r;e++){const r=C(t[e],D[e],i);b?B(r.x,r.y+g[o-1].y,g[o-1].x+n):B(r.x,r.y,l+n)}}}function k(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=o+2*p;t<n;t++){const n=R*t,s=R*(t+1);V(e+i+n,e+r+n,e+r+s,e+i+s)}}}function B(t,e,n){s.push(t),s.push(e),s.push(n)}function z(t,e,r){H(t),H(e),H(r);const s=i.length/3,a=m.generateTopUV(n,i,s-3,s-2,s-1);W(a[0]),W(a[1]),W(a[2])}function V(t,e,r,s){H(t),H(e),H(s),H(e),H(r),H(s);const a=i.length/3,o=m.generateSideWallUV(n,i,a-6,a-3,a-2,a-1);W(o[0]),W(o[1]),W(o[3]),W(o[1]),W(o[2]),W(o[3])}function H(t){i.push(s[3*t+0]),i.push(s[3*t+1]),i.push(s[3*t+2])}function W(t){r.push(t.x),r.push(t.y)}!function(){const t=i.length/3;if(c){let t=0,e=R*t;for(let n=0;n<U;n++){const t=L[n];z(t[2]+e,t[1]+e,t[0]+e)}t=o+2*p,e=R*t;for(let n=0;n<U;n++){const t=L[n];z(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<U;t++){const e=L[t];z(e[2],e[1],e[0])}for(let t=0;t<U;t++){const e=L[t];z(e[0]+R*o,e[1]+R*o,e[2]+R*o)}}n.addGroup(t,i.length/3-t,0)}(),function(){const t=i.length/3;let e=0;k(A,e),e+=A.length;for(let n=0,i=S.length;n<i;n++){const t=S[n];k(t,e),e+=t.length}n.addGroup(t,i.length/3-t,1)}()}this.setAttribute("position",new NN(i,3)),this.setAttribute("uv",new NN(r,2)),this.computeVertexNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const e=t[i];n.shapes.push(e.uuid)}else n.shapes.push(t.uuid);n.options=Object.assign({},e),void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let r=0,s=t.shapes.length;r<s;r++){const i=e[t.shapes[r]];n.push(i)}const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new qk[i.type]).fromJSON(i)),new AB(n,t.options)}}const CB={generateTopUV:function(t,e,n,i,r){const s=e[3*n],a=e[3*n+1],o=e[3*i],l=e[3*i+1],c=e[3*r],h=e[3*r+1];return[new bD(s,a),new bD(o,l),new bD(c,h)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[3*n],o=e[3*n+1],l=e[3*n+2],c=e[3*i],h=e[3*i+1],u=e[3*i+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*s],g=e[3*s+1],v=e[3*s+2];return Math.abs(o-h)<Math.abs(a-c)?[new bD(a,1-l),new bD(c,1-u),new bD(d,1-f),new bD(m,1-v)]:[new bD(o,1-l),new bD(h,1-u),new bD(p,1-f),new bD(g,1-v)]}};class RB extends bk{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new RB(t.radius,t.detail)}}class PB extends WN{constructor(t=[new bD(0,-.5),new bD(.5,0),new bD(0,.5)],e=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e),i=mD(i,0,2*Math.PI);const r=[],s=[],a=[],o=[],l=[],c=1/e,h=new wD,u=new bD,d=new wD,p=new wD,f=new wD;let m=0,g=0;for(let v=0;v<=t.length-1;v++)switch(v){case 0:m=t[v+1].x-t[v].x,g=t[v+1].y-t[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case t.length-1:o.push(f.x,f.y,f.z);break;default:m=t[v+1].x-t[v].x,g=t[v+1].y-t[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=e;v++){const r=n+v*c*i,d=Math.sin(r),p=Math.cos(r);for(let n=0;n<=t.length-1;n++){h.x=t[n].x*d,h.y=t[n].y,h.z=t[n].x*p,s.push(h.x,h.y,h.z),u.x=v/e,u.y=n/(t.length-1),a.push(u.x,u.y);const i=o[3*n+0]*d,r=o[3*n+1],c=o[3*n+0]*p;l.push(i,r,c)}}for(let v=0;v<e;v++)for(let e=0;e<t.length-1;e++){const n=e+v*t.length,i=n,s=n+t.length,a=n+t.length+1,o=n+1;r.push(i,s,o),r.push(a,o,s)}this.setIndex(r),this.setAttribute("position",new NN(s,3)),this.setAttribute("uv",new NN(a,2)),this.setAttribute("normal",new NN(l,3))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new PB(t.points,t.segments,t.phiStart,t.phiLength)}}class OB extends bk{constructor(t=1,e=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new OB(t.radius,t.detail)}}class IB extends WN{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,s=e/2,a=Math.floor(n),o=Math.floor(i),l=a+1,c=o+1,h=t/a,u=e/o,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){const t=g*u-s;for(let e=0;e<l;e++){const n=e*h-r;p.push(n,-t,0),f.push(0,0,1),m.push(e/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),i=t+1+l*(g+1),r=t+1+l*g;d.push(e,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new NN(p,3)),this.setAttribute("normal",new NN(f,3)),this.setAttribute("uv",new NN(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new IB(t.width,t.height,t.widthSegments,t.heightSegments)}}class DB extends WN{constructor(t=.5,e=1,n=32,i=1,r=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:s},n=Math.max(3,n);const a=[],o=[],l=[],c=[];let h=t;const u=(e-t)/(i=Math.max(1,i)),d=new wD,p=new bD;for(let f=0;f<=i;f++){for(let t=0;t<=n;t++){const i=r+t/n*s;d.x=h*Math.cos(i),d.y=h*Math.sin(i),o.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/e+1)/2,p.y=(d.y/e+1)/2,c.push(p.x,p.y)}h+=u}for(let f=0;f<i;f++){const t=f*(n+1);for(let e=0;e<n;e++){const i=e+t,r=i,s=i+n+1,o=i+n+2,l=i+1;a.push(r,s,l),a.push(s,o,l)}}this.setIndex(a),this.setAttribute("position",new NN(o,3)),this.setAttribute("normal",new NN(l,3)),this.setAttribute("uv",new NN(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new DB(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class LB extends WN{constructor(t=new Zk([new bD(0,.5),new bD(-.5,-.5),new bD(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],r=[],s=[];let a=0,o=0;if(!1===Array.isArray(t))l(t);else for(let c=0;c<t.length;c++)l(t[c]),this.addGroup(a,o,c),a+=o,o=0;function l(t){const a=i.length/3,l=t.extractPoints(e);let c=l.shape;const h=l.holes;!1===SB.isClockWise(c)&&(c=c.reverse());for(let e=0,n=h.length;e<n;e++){const t=h[e];!0===SB.isClockWise(t)&&(h[e]=t.reverse())}const u=SB.triangulateShape(c,h);for(let e=0,n=h.length;e<n;e++){const t=h[e];c=c.concat(t)}for(let e=0,n=c.length;e<n;e++){const t=c[e];i.push(t.x,t.y,0),r.push(0,0,1),s.push(t.x,t.y)}for(let e=0,i=u.length;e<i;e++){const t=u[e],i=t[0]+a,r=t[1]+a,s=t[2]+a;n.push(i,r,s),o+=3}}this.setIndex(n),this.setAttribute("position",new NN(i,3)),this.setAttribute("normal",new NN(r,3)),this.setAttribute("uv",new NN(s,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}return new LB(n,t.curveSegments)}}class NB extends WN{constructor(t=1,e=32,n=16,i=0,r=2*Math.PI,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const o=Math.min(s+a,Math.PI);let l=0;const c=[],h=new wD,u=new wD,d=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0===g&&0===s?y=.5/e:g===n&&o===Math.PI&&(y=-.5/e);for(let n=0;n<=e;n++){const o=n/e;h.x=-t*Math.cos(i+o*r)*Math.sin(s+v*a),h.y=t*Math.cos(s+v*a),h.z=t*Math.sin(i+o*r)*Math.sin(s+v*a),p.push(h.x,h.y,h.z),u.copy(h).normalize(),f.push(u.x,u.y,u.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let t=0;t<e;t++){const e=c[g][t+1],i=c[g][t],r=c[g+1][t],a=c[g+1][t+1];(0!==g||s>0)&&d.push(e,i,a),(g!==n-1||o<Math.PI)&&d.push(i,r,a)}this.setIndex(d),this.setAttribute("position",new NN(p,3)),this.setAttribute("normal",new NN(f,3)),this.setAttribute("uv",new NN(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new NB(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class UB extends bk{constructor(t=1,e=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new UB(t.radius,t.detail)}}class FB extends WN{constructor(t=1,e=.4,n=12,i=48,r=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const s=[],a=[],o=[],l=[],c=new wD,h=new wD,u=new wD;for(let d=0;d<=n;d++)for(let s=0;s<=i;s++){const p=s/i*r,f=d/n*Math.PI*2;h.x=(t+e*Math.cos(f))*Math.cos(p),h.y=(t+e*Math.cos(f))*Math.sin(p),h.z=e*Math.sin(f),a.push(h.x,h.y,h.z),c.x=t*Math.cos(p),c.y=t*Math.sin(p),u.subVectors(h,c).normalize(),o.push(u.x,u.y,u.z),l.push(s/i),l.push(d/n)}for(let d=1;d<=n;d++)for(let t=1;t<=i;t++){const e=(i+1)*d+t-1,n=(i+1)*(d-1)+t-1,r=(i+1)*(d-1)+t,a=(i+1)*d+t;s.push(e,n,a),s.push(n,r,a)}this.setIndex(s),this.setAttribute("position",new NN(a,3)),this.setAttribute("normal",new NN(o,3)),this.setAttribute("uv",new NN(l,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new FB(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class kB extends WN{constructor(t=1,e=.4,n=64,i=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);const a=[],o=[],l=[],c=[],h=new wD,u=new wD,d=new wD,p=new wD,f=new wD,m=new wD,g=new wD;for(let y=0;y<=n;++y){const a=y/n*r*Math.PI*2;v(a,r,s,t,d),v(a+.01,r,s,t,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let t=0;t<=i;++t){const r=t/i*Math.PI*2,s=-e*Math.cos(r),a=e*Math.sin(r);h.x=d.x+(s*g.x+a*f.x),h.y=d.y+(s*g.y+a*f.y),h.z=d.z+(s*g.z+a*f.z),o.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(y/n),c.push(t/i)}}for(let y=1;y<=n;y++)for(let t=1;t<=i;t++){const e=(i+1)*(y-1)+(t-1),n=(i+1)*y+(t-1),r=(i+1)*y+t,s=(i+1)*(y-1)+t;a.push(e,n,s),a.push(n,r,s)}function v(t,e,n,i,r){const s=Math.cos(t),a=Math.sin(t),o=n/e*t,l=Math.cos(o);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*a*.5,r.z=i*Math.sin(o)*.5}this.setIndex(a),this.setAttribute("position",new NN(o,3)),this.setAttribute("normal",new NN(l,3)),this.setAttribute("uv",new NN(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new kB(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class BB extends WN{constructor(t=new Gk(new wD(-1,-1,0),new wD(-1,1,0),new wD(1,1,0)),e=64,n=1,i=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r};const s=t.computeFrenetFrames(e,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const a=new wD,o=new wD,l=new bD;let c=new wD;const h=[],u=[],d=[],p=[];function f(r){c=t.getPointAt(r/e,c);const l=s.normals[r],d=s.binormals[r];for(let t=0;t<=i;t++){const e=t/i*Math.PI*2,r=Math.sin(e),s=-Math.cos(e);o.x=s*l.x+r*d.x,o.y=s*l.y+r*d.y,o.z=s*l.z+r*d.z,o.normalize(),u.push(o.x,o.y,o.z),a.x=c.x+n*o.x,a.y=c.y+n*o.y,a.z=c.z+n*o.z,h.push(a.x,a.y,a.z)}}!function(){for(let t=0;t<e;t++)f(t);f(!1===r?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=i;n++)l.x=t/e,l.y=n/i,d.push(l.x,l.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=i;e++){const n=(i+1)*(t-1)+(e-1),r=(i+1)*t+(e-1),s=(i+1)*t+e,a=(i+1)*(t-1)+e;p.push(n,r,a),p.push(r,s,a)}}()}(),this.setIndex(p),this.setAttribute("position",new NN(h,3)),this.setAttribute("normal",new NN(u,3)),this.setAttribute("uv",new NN(d,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new BB((new qk[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class zB extends WN{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,i=new wD,r=new wD;if(null!==t.index){const s=t.attributes.position,a=t.index;let o=t.groups;0===o.length&&(o=[{start:0,count:a.count,materialIndex:0}]);for(let t=0,l=o.length;t<l;++t){const l=o[t],c=l.start;for(let t=c,o=c+l.count;t<o;t+=3)for(let l=0;l<3;l++){const o=a.getX(t+l),c=a.getX(t+(l+1)%3);i.fromBufferAttribute(s,o),r.fromBufferAttribute(s,c),!0===VB(i,r,n)&&(e.push(i.x,i.y,i.z),e.push(r.x,r.y,r.z))}}}else{const s=t.attributes.position;for(let t=0,a=s.count/3;t<a;t++)for(let o=0;o<3;o++){const a=3*t+o,l=3*t+(o+1)%3;i.fromBufferAttribute(s,a),r.fromBufferAttribute(s,l),!0===VB(i,r,n)&&(e.push(i.x,i.y,i.z),e.push(r.x,r.y,r.z))}}this.setAttribute("position",new NN(e,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function VB(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}var HB=Object.freeze({__proto__:null,BoxGeometry:iU,CapsuleGeometry:vk,CircleGeometry:yk,ConeGeometry:xk,CylinderGeometry:_k,DodecahedronGeometry:Mk,EdgesGeometry:Ak,ExtrudeGeometry:AB,IcosahedronGeometry:RB,LatheGeometry:PB,OctahedronGeometry:OB,PlaneGeometry:IB,PolyhedronGeometry:bk,RingGeometry:DB,ShapeGeometry:LB,SphereGeometry:NB,TetrahedronGeometry:UB,TorusGeometry:FB,TorusKnotGeometry:kB,TubeGeometry:BB,WireframeGeometry:zB});class WB extends MN{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new _N(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class jB extends lU{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class GB extends MN{constructor(t){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new _N(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _N(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new FL,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class XB extends GB{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new bD(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mD(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new _N(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new _N(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new _N(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(t)}get anisotropy(){return this._anisotropy}set anisotropy(t){this._anisotropy>0!=t>0&&this.version++,this._anisotropy=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get dispersion(){return this._dispersion}set dispersion(t){this._dispersion>0!=t>0&&this.version++,this._dispersion=t}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=t.anisotropy,this.anisotropyRotation=t.anisotropyRotation,this.anisotropyMap=t.anisotropyMap,this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.dispersion=t.dispersion,this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class qB extends MN{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new _N(16777215),this.specular=new _N(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _N(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new FL,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class YB extends MN{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new _N(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _N(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class KB extends MN{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class ZB extends MN{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new _N(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _N(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new FL,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class $B extends MN{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class JB extends MN{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}class QB extends MN{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new _N(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new bD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class tz extends XF{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}function ez(t,e){return t&&t.constructor!==e?"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t):t}function nz(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function iz(t){const e=t.length,n=new Array(e);for(let i=0;i!==e;++i)n[i]=i;return n.sort(function(e,n){return t[e]-t[n]}),n}function rz(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){const i=n[s]*e;for(let n=0;n!==e;++n)r[a++]=t[i+n]}return r}function sz(t,e,n,i){let r=1,s=t[0];for(;void 0!==s&&void 0===s[i];)s=t[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(e.push(s.time),n.push(...a)),s=t[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(e.push(s.time),n.push(a)),s=t[r++]}while(void 0!==s)}class az{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let s;n:{i:if(!(t<i)){for(let s=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=e[++n],t<i)break e}s=e.length;break n}if(!(t>=r)){const a=e[1];t<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=e[--n-1],t>=r)break e}s=n,n=0;break n}break t}for(;n<s;){const i=n+s>>>1;t<e[i]?s=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let s=0;s!==i;++s)e[s]=n[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class oz extends az{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:zI,endingEnd:zI}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,s=t+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case VI:r=t,a=2*e-n;break;case HI:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case VI:s=t,o=2*n-e;break;case HI:s=1,o=n+i[1]-i[0];break;default:s=t-1,o=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let x=0;x!==a;++x)r[x]=g*s[c+x]+v*s[l+x]+y*s[o+x]+_*s[h+x];return r}}class lz extends az{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,c=(n-e)/(i-e),h=1-c;for(let u=0;u!==a;++u)r[u]=s[l+u]*h+s[o+u]*c;return r}}class cz extends az{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class hz{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ez(e,this.TimeBufferType),this.values=ez(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:ez(t.times,Array),values:ez(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new cz(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new lz(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new oz(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case FI:e=this.InterpolantFactoryMethodDiscrete;break;case kI:e=this.InterpolantFactoryMethodLinear;break;case BI:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return FI;case this.InterpolantFactoryMethodLinear:return kI;case this.InterpolantFactoryMethodSmooth:return BI}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(t=!1);let s=null;for(let a=0;a!==r;a++){const e=n[a];if("number"==typeof e&&isNaN(e)){t=!1;break}if(null!==s&&s>e){t=!1;break}s=e}if(void 0!==i&&nz(i))for(let a=0,o=i.length;a!==o;++a){const e=i[a];if(isNaN(e)){t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===BI,r=t.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=t[a];if(o!==t[a+1]&&(1!==a||o!==t[0]))if(i)r=!0;else{const t=a*n,i=t-n,s=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[i+a]||n!==e[s+a]){r=!0;break}}}if(r){if(a!==s){t[s]=t[a];const i=a*n,r=s*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*n,i=s*n,a=0;a!==n;++a)e[i+a]=e[t+a];++s}return s!==t.length?(this.times=t.slice(0,s),this.values=e.slice(0,s*n)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}hz.prototype.ValueTypeName="",hz.prototype.TimeBufferType=Float32Array,hz.prototype.ValueBufferType=Float32Array,hz.prototype.DefaultInterpolation=kI;class uz extends hz{constructor(t,e,n){super(t,e,n)}}uz.prototype.ValueTypeName="bool",uz.prototype.ValueBufferType=Array,uz.prototype.DefaultInterpolation=FI,uz.prototype.InterpolantFactoryMethodLinear=void 0,uz.prototype.InterpolantFactoryMethodSmooth=void 0;class dz extends hz{constructor(t,e,n,i){super(t,e,n,i)}}dz.prototype.ValueTypeName="color";class pz extends hz{constructor(t,e,n,i){super(t,e,n,i)}}pz.prototype.ValueTypeName="number";class fz extends az{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-e)/(i-e);let l=t*a;for(let c=l+a;l!==c;l+=4)MD.slerpFlat(r,0,s,l-a,s,l,o);return r}}class mz extends hz{constructor(t,e,n,i){super(t,e,n,i)}InterpolantFactoryMethodLinear(t){return new fz(this.times,this.values,this.getValueSize(),t)}}mz.prototype.ValueTypeName="quaternion",mz.prototype.InterpolantFactoryMethodSmooth=void 0;class gz extends hz{constructor(t,e,n){super(t,e,n)}}gz.prototype.ValueTypeName="string",gz.prototype.ValueBufferType=Array,gz.prototype.DefaultInterpolation=FI,gz.prototype.InterpolantFactoryMethodLinear=void 0,gz.prototype.InterpolantFactoryMethodSmooth=void 0;class vz extends hz{constructor(t,e,n,i){super(t,e,n,i)}}vz.prototype.ValueTypeName="vector";class yz{constructor(t="",e=-1,n=[],i=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=fD(),this.userData={},this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let s=0,a=n.length;s!==a;++s)e.push(_z(n[s]).scale(i));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r.userData=JSON.parse(t.userData||"{}"),r}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode,userData:JSON.stringify(t.userData)};for(let r=0,s=n.length;r!==s;++r)e.push(hz.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const r=e.length,s=[];for(let a=0;a<r;a++){let t=[],o=[];t.push((a+r-1)%r,a,(a+1)%r),o.push(0,1,0);const l=iz(t);t=rz(t,1,l),o=rz(o,1,l),i||0!==t[0]||(t.push(r),o.push(o[0])),s.push(new pz(".morphTargetInfluences["+e[a].name+"]",t,o).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,o=t.length;a<o;a++){const e=t[a],n=e.name.match(r);if(n&&n.length>1){const t=n[1];let r=i[t];r||(i[t]=r=[]),r.push(e)}}const s=[];for(const a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],e,n));return s}static parseAnimation(t,e){if(!t)return null;const n=function(t,e,n,i,r){if(0!==n.length){const s=[],a=[];sz(n,s,a,i),0!==s.length&&r.push(new t(e,s,a))}},i=[],r=t.name||"default",s=t.fps||30,a=t.blendMode;let o=t.length||-1;const l=t.hierarchy||[];for(let c=0;c<l.length;c++){const t=l[c].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let i=0;i<t[n].morphTargets.length;i++)e[t[n].morphTargets[i]]=-1;for(const r in e){const e=[],s=[];for(let i=0;i!==t[n].morphTargets.length;++i){const i=t[n];e.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new pz(".morphTargetInfluence["+r+"]",e,s))}o=e.length*s}else{const r=".bones["+e[c].name+"]";n(vz,r+".position",t,"pos",i),n(mz,r+".quaternion",t,"rot",i),n(vz,r+".scale",t,"scl",i)}}if(0===i.length)return null;return new this(r,o,i,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let n=0;n<this.tracks.length;n++)t.push(this.tracks[n].clone());const e=new this.constructor(this.name,this.duration,t,this.blendMode);return e.userData=JSON.parse(JSON.stringify(this.userData)),e}toJSON(){return this.constructor.toJSON(this)}}function _z(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return pz;case"vector":case"vector2":case"vector3":case"vector4":return vz;case"color":return dz;case"quaternion":return mz;case"bool":case"boolean":return uz;case"string":return gz}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];sz(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const xz={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class bz{constructor(t,e,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.abortController=new AbortController,this.itemStart=function(t){o++,!1===s&&void 0!==i.onStart&&i.onStart(t,a,o),s=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}const Mz=new bz;class wz{constructor(t){this.manager=void 0!==t?t:Mz,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}abort(){return this}}wz.DEFAULT_MATERIAL_NAME="__DEFAULT";const Sz={};class Tz extends Error{constructor(t,e){super(t),this.response=e}}class Ez extends wz{constructor(t){super(t),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=xz.get(`file:${t}`);if(void 0!==r)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(void 0!==Sz[t])return void Sz[t].push({onLoad:e,onProgress:n,onError:i});Sz[t]=[],Sz[t].push({onLoad:e,onProgress:n,onError:i});const s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,o=this.responseType;fetch(s).then(e=>{if(200===e.status||0===e.status){if(e.status,"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=Sz[t],i=e.body.getReader(),r=e.headers.get("X-File-Size")||e.headers.get("Content-Length"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(t){!function e(){i.read().then(({done:i,value:r})=>{if(i)t.close();else{o+=r.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(r),e()}},e=>{t.error(e)})}()}});return new Response(l)}throw new Tz(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)}).then(t=>{switch(o){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then(t=>(new DOMParser).parseFromString(t,a));case"json":return t.json();default:if(""===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),n=e&&e[1]?e[1].toLowerCase():void 0,i=new TextDecoder(n);return t.arrayBuffer().then(t=>i.decode(t))}}}).then(e=>{xz.add(`file:${t}`,e);const n=Sz[t];delete Sz[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}}).catch(e=>{const n=Sz[t];if(void 0===n)throw this.manager.itemError(t),e;delete Sz[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const Az=new WeakMap;class Cz extends wz{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=xz.get(`image:${t}`);if(void 0!==s){if(!0===s.complete)r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0);else{let t=Az.get(s);void 0===t&&(t=[],Az.set(s,t)),t.push({onLoad:e,onError:i})}return s}const a=OD("img");function o(){c(),e&&e(this);const n=Az.get(this)||[];for(let t=0;t<n.length;t++){const e=n[t];e.onLoad&&e.onLoad(this)}Az.delete(this),r.manager.itemEnd(t)}function l(e){c(),i&&i(e),xz.remove(`image:${t}`);const n=Az.get(this)||[];for(let t=0;t<n.length;t++){const i=n[t];i.onError&&i.onError(e)}Az.delete(this),r.manager.itemError(t),r.manager.itemEnd(t)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),xz.add(`image:${t}`,a),r.manager.itemStart(t),a.src=t,a}}class Rz extends wz{constructor(t){super(t)}load(t,e,n,i){const r=new gU;r.colorSpace=XI;const s=new Cz(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function o(n){s.load(t[n],function(t){r.images[n]=t,a++,6===a&&(r.needsUpdate=!0,e&&e(r))},void 0,i)}for(let l=0;l<t.length;++l)o(l);return r}}class Pz extends wz{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new iF,a=new Ez(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(r.withCredentials),a.load(t,function(t){let n;try{n=r.parse(t)}catch(a){if(void 0===i)return;i(a)}void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:AO,s.wrapT=void 0!==n.wrapT?n.wrapT:AO,s.magFilter=void 0!==n.magFilter?n.magFilter:IO,s.minFilter=void 0!==n.minFilter?n.minFilter:IO,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(s.colorSpace=n.colorSpace),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=LO),1===n.mipmapCount&&(s.minFilter=IO),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,e&&e(s,n)},n,i),s}}class Oz extends tN{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new _N(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(e.object.target=this.target.uuid),e}}class Iz extends Oz{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(tN.DEFAULT_UP),this.updateMatrix(),this.groundColor=new _N(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const Dz=new AL,Lz=new wD,Nz=new wD;class Uz{constructor(t){this.camera=t,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new bD(512,512),this.mapType=UO,this.map=null,this.mapPass=null,this.matrix=new AL,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wF,this._frameExtents=new bD(1,1),this._viewportCount=1,this._viewports=[new KD(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Lz.setFromMatrixPosition(t.matrixWorld),e.position.copy(Lz),Nz.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Nz),e.updateMatrixWorld(),Dz.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Dz,e.coordinateSystem,e.reversedDepth),e.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Dz)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.intensity=t.intensity,this.bias=t.bias,this.radius=t.radius,this.autoUpdate=t.autoUpdate,this.needsUpdate=t.needsUpdate,this.normalBias=t.normalBias,this.blurSamples=t.blurSamples,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 1!==this.intensity&&(t.intensity=this.intensity),0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Fz extends Uz{constructor(){super(new pU(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(t){const e=this.camera,n=2*pD*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class kz extends Oz{constructor(t,e,n=0,i=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(tN.DEFAULT_UP),this.updateMatrix(),this.target=new tN,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Fz}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const Bz=new AL,zz=new wD,Vz=new wD;class Hz extends Uz{constructor(){super(new pU(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new bD(4,2),this._viewportCount=6,this._viewports=[new KD(2,1,1,1),new KD(0,1,1,1),new KD(3,1,1,1),new KD(1,1,1,1),new KD(3,0,1,1),new KD(1,0,1,1)],this._cubeDirections=[new wD(1,0,0),new wD(-1,0,0),new wD(0,0,1),new wD(0,0,-1),new wD(0,1,0),new wD(0,-1,0)],this._cubeUps=[new wD(0,1,0),new wD(0,1,0),new wD(0,1,0),new wD(0,1,0),new wD(0,0,1),new wD(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),zz.setFromMatrixPosition(t.matrixWorld),n.position.copy(zz),Vz.copy(n.position),Vz.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Vz),n.updateMatrixWorld(),i.makeTranslation(-zz.x,-zz.y,-zz.z),Bz.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bz,n.coordinateSystem,n.reversedDepth)}}class Wz extends Oz{constructor(t,e,n=0,i=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Hz}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class jz extends cU{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,s=n+t,a=i+e,o=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,a-=e*this.view.offsetY,o=a-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}class Gz extends Uz{constructor(){super(new jz(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Xz extends Oz{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(tN.DEFAULT_UP),this.updateMatrix(),this.target=new tN,this.shadow=new Gz}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class qz extends Oz{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class Yz extends Oz{constructor(t,e,n=10,i=10){super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class Kz{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new wD)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*i),e.addScaledVector(s[2],.488603*r),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*i*1.092548),e.addScaledVector(s[5],i*r*1.092548),e.addScaledVector(s[6],.315392*(3*r*r-1)),e.addScaledVector(s[7],n*r*1.092548),e.addScaledVector(s[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*i),e.addScaledVector(s[2],1.023328*r),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*i),e.addScaledVector(s[5],.858086*i*r),e.addScaledVector(s[6],.743125*r*r-.247708),e.addScaledVector(s[7],.858086*n*r),e.addScaledVector(s[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}class Zz extends Oz{constructor(t=new Kz,e=1){super(void 0,e),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}class $z extends wz{constructor(t){super(t),this.textures={}}load(t,e,n,i){const r=this,s=new Ez(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(n){try{e(r.parse(JSON.parse(n)))}catch(s){i&&i(s),r.manager.itemError(t)}},n,i)}parse(t){const e=this.textures;function n(t){return e[t],e[t]}const i=this.createMaterialFromType(t.type);if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&void 0!==i.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.sheen&&(i.sheen=t.sheen),void 0!==t.sheenColor&&(i.sheenColor=(new _N).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(i.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==i.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==i.specular&&i.specular.setHex(t.specular),void 0!==t.specularIntensity&&(i.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearcoat&&(i.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(i.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.dispersion&&(i.dispersion=t.dispersion),void 0!==t.iridescence&&(i.iridescence=t.iridescence),void 0!==t.iridescenceIOR&&(i.iridescenceIOR=t.iridescenceIOR),void 0!==t.iridescenceThicknessRange&&(i.iridescenceThicknessRange=t.iridescenceThicknessRange),void 0!==t.transmission&&(i.transmission=t.transmission),void 0!==t.thickness&&(i.thickness=t.thickness),void 0!==t.attenuationDistance&&(i.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(t.attenuationColor),void 0!==t.anisotropy&&(i.anisotropy=t.anisotropy),void 0!==t.anisotropyRotation&&(i.anisotropyRotation=t.anisotropyRotation),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.flatShading&&(i.flatShading=t.flatShading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.combine&&(i.combine=t.combine),void 0!==t.side&&(i.side=t.side),void 0!==t.shadowSide&&(i.shadowSide=t.shadowSide),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.alphaHash&&(i.alphaHash=t.alphaHash),void 0!==t.depthFunc&&(i.depthFunc=t.depthFunc),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.blendSrc&&(i.blendSrc=t.blendSrc),void 0!==t.blendDst&&(i.blendDst=t.blendDst),void 0!==t.blendEquation&&(i.blendEquation=t.blendEquation),void 0!==t.blendSrcAlpha&&(i.blendSrcAlpha=t.blendSrcAlpha),void 0!==t.blendDstAlpha&&(i.blendDstAlpha=t.blendDstAlpha),void 0!==t.blendEquationAlpha&&(i.blendEquationAlpha=t.blendEquationAlpha),void 0!==t.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(t.blendColor),void 0!==t.blendAlpha&&(i.blendAlpha=t.blendAlpha),void 0!==t.stencilWriteMask&&(i.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(i.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(i.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(i.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(i.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(i.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(i.stencilZPass=t.stencilZPass),void 0!==t.stencilWrite&&(i.stencilWrite=t.stencilWrite),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(i.rotation=t.rotation),void 0!==t.linewidth&&(i.linewidth=t.linewidth),void 0!==t.dashSize&&(i.dashSize=t.dashSize),void 0!==t.gapSize&&(i.gapSize=t.gapSize),void 0!==t.scale&&(i.scale=t.scale),void 0!==t.polygonOffset&&(i.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(i.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(i.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(i.dithering=t.dithering),void 0!==t.alphaToCoverage&&(i.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(i.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.forceSinglePass&&(i.forceSinglePass=t.forceSinglePass),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.toneMapped&&(i.toneMapped=t.toneMapped),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?i.vertexColors=t.vertexColors>0:i.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const r in t.uniforms){const e=t.uniforms[r];switch(i.uniforms[r]={},e.type){case"t":i.uniforms[r].value=n(e.value);break;case"c":i.uniforms[r].value=(new _N).setHex(e.value);break;case"v2":i.uniforms[r].value=(new bD).fromArray(e.value);break;case"v3":i.uniforms[r].value=(new wD).fromArray(e.value);break;case"v4":i.uniforms[r].value=(new KD).fromArray(e.value);break;case"m3":i.uniforms[r].value=(new ED).fromArray(e.value);break;case"m4":i.uniforms[r].value=(new AL).fromArray(e.value);break;default:i.uniforms[r].value=e.value}}if(void 0!==t.defines&&(i.defines=t.defines),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.glslVersion&&(i.glslVersion=t.glslVersion),void 0!==t.extensions)for(const r in t.extensions)i.extensions[r]=t.extensions[r];if(void 0!==t.lights&&(i.lights=t.lights),void 0!==t.clipping&&(i.clipping=t.clipping),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=n(t.map)),void 0!==t.matcap&&(i.matcap=n(t.matcap)),void 0!==t.alphaMap&&(i.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(i.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(i.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),i.normalScale=(new bD).fromArray(e)}return void 0!==t.displacementMap&&(i.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=n(t.specularMap)),void 0!==t.specularIntensityMap&&(i.specularIntensityMap=n(t.specularIntensityMap)),void 0!==t.specularColorMap&&(i.specularColorMap=n(t.specularColorMap)),void 0!==t.envMap&&(i.envMap=n(t.envMap)),void 0!==t.envMapRotation&&i.envMapRotation.fromArray(t.envMapRotation),void 0!==t.envMapIntensity&&(i.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(i.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(i.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(i.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(i.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(i.clearcoatNormalScale=(new bD).fromArray(t.clearcoatNormalScale)),void 0!==t.iridescenceMap&&(i.iridescenceMap=n(t.iridescenceMap)),void 0!==t.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(t.iridescenceThicknessMap)),void 0!==t.transmissionMap&&(i.transmissionMap=n(t.transmissionMap)),void 0!==t.thicknessMap&&(i.thicknessMap=n(t.thicknessMap)),void 0!==t.anisotropyMap&&(i.anisotropyMap=n(t.anisotropyMap)),void 0!==t.sheenColorMap&&(i.sheenColorMap=n(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(i.sheenRoughnessMap=n(t.sheenRoughnessMap)),i}setTextures(t){return this.textures=t,this}createMaterialFromType(t){return $z.createMaterialFromType(t)}static createMaterialFromType(t){return new{ShadowMaterial:WB,SpriteMaterial:AU,RawShaderMaterial:jB,ShaderMaterial:lU,PointsMaterial:ak,MeshPhysicalMaterial:XB,MeshStandardMaterial:GB,MeshPhongMaterial:qB,MeshToonMaterial:YB,MeshNormalMaterial:KB,MeshLambertMaterial:ZB,MeshDepthMaterial:$B,MeshDistanceMaterial:JB,MeshBasicMaterial:wN,MeshMatcapMaterial:QB,LineDashedMaterial:tz,LineBasicMaterial:XF,Material:MN}[t]}}class Jz{static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class Qz extends WN{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class tV extends wz{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new Ez(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(n){try{e(r.parse(JSON.parse(n)))}catch(s){i&&i(s),r.manager.itemError(t)}},n,i)}parse(t){const e={},n={};function i(t,i){if(void 0!==e[i])return e[i];const r=t.interleavedBuffers[i],s=function(t,e){if(void 0!==n[e])return n[e];const i=t.arrayBuffers,r=i[e],s=new Uint32Array(r).buffer;return n[e]=s,s}(t,r.buffer),a=PD(r.type,s),o=new SU(a,r.stride);return o.uuid=r.uuid,e[i]=o,o}const r=t.isInstancedBufferGeometry?new Qz:new WN,s=t.data.index;if(void 0!==s){const t=PD(s.type,s.array);r.setIndex(new IN(t,1))}const a=t.data.attributes;for(const h in a){const e=a[h];let n;if(e.isInterleavedBufferAttribute){const r=i(t.data,e.data);n=new EU(r,e.itemSize,e.offset,e.normalized)}else{const t=PD(e.type,e.array);n=new(e.isInstancedBufferAttribute?oF:IN)(t,e.itemSize,e.normalized)}void 0!==e.name&&(n.name=e.name),void 0!==e.usage&&n.setUsage(e.usage),r.setAttribute(h,n)}const o=t.data.morphAttributes;if(o)for(const h in o){const e=o[h],n=[];for(let r=0,s=e.length;r<s;r++){const s=e[r];let a;if(s.isInterleavedBufferAttribute){const e=i(t.data,s.data);a=new EU(e,s.itemSize,s.offset,s.normalized)}else{const t=PD(s.type,s.array);a=new IN(t,s.itemSize,s.normalized)}void 0!==s.name&&(a.name=s.name),n.push(a)}r.morphAttributes[h]=n}t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(let h=0,u=l.length;h!==u;++h){const t=l[h];r.addGroup(t.start,t.count,t.materialIndex)}const c=t.data.boundingSphere;return void 0!==c&&(r.boundingSphere=(new yL).fromJSON(c)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}}const eV={UVMapping:xO,CubeReflectionMapping:bO,CubeRefractionMapping:MO,EquirectangularReflectionMapping:wO,EquirectangularRefractionMapping:SO,CubeUVReflectionMapping:TO},nV={RepeatWrapping:EO,ClampToEdgeWrapping:AO,MirroredRepeatWrapping:CO},iV={NearestFilter:RO,NearestMipmapNearestFilter:PO,NearestMipmapLinearFilter:OO,LinearFilter:IO,LinearMipmapNearestFilter:DO,LinearMipmapLinearFilter:LO},rV=new WeakMap;let sV;class aV{static getContext(){return void 0===sV&&(sV=new(window.AudioContext||window.webkitAudioContext)),sV}static setContext(t){sV=t}}const oV=new AL,lV=new AL,cV=new AL;class hV extends pU{constructor(t=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=t}}class uV{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=performance.now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}const dV=new wD,pV=new MD,fV=new wD,mV=new wD,gV=new wD;class vV extends tN{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return;if(!1===this.hasPlaybackControl)return;this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(t=0){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+t),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){return this.detune=t,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1!==this.hasPlaybackControl&&this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}copy(t,e){return super.copy(t,e),"buffer"!==t.sourceType||(this.autoplay=t.autoplay,this.buffer=t.buffer,this.detune=t.detune,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.offset=t.offset,this.duration=t.duration,this.playbackRate=t.playbackRate,this.hasPlaybackControl=t.hasPlaybackControl,this.sourceType=t.sourceType,this.filters=t.filters.slice()),this}clone(t){return new this.constructor(this.listener).copy(this,t)}}const yV=new wD,_V=new MD,xV=new wD,bV=new wD;class MV{constructor(t,e,n){let i,r,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let s=this.cumulativeWeight;if(0===s){for(let t=0;t!==i;++t)n[r+t]=n[t];s=e}else{s+=e;const t=e/s;this._mixBufferRegion(n,r,0,t,i)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(n,i,t,1-r,e)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let o=e,l=e+e;o!==l;++o)if(n[o]!==n[o+e]){a.setValue(n,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let r=n,s=i;r!==s;++r)e[r]=e[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)t[e+s]=t[n+s]}_slerp(t,e,n,i){MD.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){const s=this._workIndex*r;MD.multiplyQuaternionsFlat(t,s,t,e,t,n),MD.slerpFlat(t,e,t,e,t,s,i)}_lerp(t,e,n,i,r){const s=1-i;for(let a=0;a!==r;++a){const r=e+a;t[r]=t[r]*s+t[n+a]*i}}_lerpAdditive(t,e,n,i,r){for(let s=0;s!==r;++s){const r=e+s;t[r]=t[r]+t[n+s]*i}}}const wV="\\[\\]\\.:\\/",SV=new RegExp("["+wV+"]","g"),TV="[^"+wV+"]",EV="[^"+wV.replace("\\.","")+"]",AV=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",TV)+/(WCOD+)?/.source.replace("WCOD",EV)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",TV)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",TV)+"$"),CV=["material","materials","bones","map"];class RV{constructor(t,e,n){this.path=e,this.parsedPath=n||RV.parseTrackName(e),this.node=RV.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new RV.Composite(t,e,n):new RV(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(SV,"")}static parseTrackName(t){const e=AV.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==CV.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const s=n(r.children);if(s)return s}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=RV.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return;if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return;if(!t.material.map)return;t=t.material.map;break;default:if(void 0===t[n])return;t=t[n]}if(void 0!==i){if(void 0===t[i])return;t=t[i]}}const s=t[i];if(void 0===s){e.nodeName;return}let a=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?a=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return;if(!t.geometry.morphAttributes)return;void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}RV.Composite=class{constructor(t,e,n){const i=n||RV.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},RV.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},RV.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},RV.prototype.GetterByBindingType=[RV.prototype._getValue_direct,RV.prototype._getValue_array,RV.prototype._getValue_arrayElement,RV.prototype._getValue_toArray],RV.prototype.SetterByBindingTypeAndVersioning=[[RV.prototype._setValue_direct,RV.prototype._setValue_direct_setNeedsUpdate,RV.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[RV.prototype._setValue_array,RV.prototype._setValue_array_setNeedsUpdate,RV.prototype._setValue_array_setMatrixWorldNeedsUpdate],[RV.prototype._setValue_arrayElement,RV.prototype._setValue_arrayElement_setNeedsUpdate,RV.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[RV.prototype._setValue_fromArray,RV.prototype._setValue_fromArray_setNeedsUpdate,RV.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class PV{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,s=r.length,a=new Array(s),o={endingStart:zI,endingEnd:zI};for(let l=0;l!==s;++l){const t=r[l].createInterpolant(null);a[l]=t,t.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n=!1){if(t.fadeOut(e),this.fadeIn(e),!0===n){const n=this._clip.duration,i=t._clip.duration,r=i/n,s=n/i;t.warp(1,r,e),this.warp(s,1,e)}return this}crossFadeTo(t,e,n=!1){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,s=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=r,o[1]=r+n,l[0]=t/s,l[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;i<0||0===n?e=0:(this._startTime=null,e=n*i)}e*=this._updateTimeScale(t);const s=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;if(this.blendMode===jI)for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(s),e[n].accumulateAdditive(a);else for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(s),e[n].accumulate(i,a)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const s=2202===n;if(0===t)return-1===r||!s||1&~r?i:e-i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&!(1&~r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=VI,i.endingEnd=VI):(i.endingStart=t?this.zeroSlopeAtStart?VI:zI:HI,i.endingEnd=e?this.zeroSlopeAtEnd?VI:zI:HI)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,o=s.sampleValues;return a[0]=r,o[0]=e,a[1]=r+t,o[1]=n,this}}const OV=new Float32Array(1);class IV{constructor(t){this.value=t}clone(){return new IV(void 0===this.value.clone?this.value:this.value.clone())}}let DV=0;const LV=new AL;class NV{constructor(t,e,n=0,i=1/0){this.ray=new EL(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new kL,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)}setFromXRController(t){return LV.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(LV),this}intersectObject(t,e=!0,n=[]){return FV(t,this,n,e),n.sort(UV),n}intersectObjects(t,e=!0,n=[]){for(let i=0,r=t.length;i<r;i++)FV(t[i],this,n,e);return n.sort(UV),n}}function UV(t,e){return t.distance-e.distance}function FV(t,e,n,i){let r=!0;if(t.layers.test(e.layers)){!1===t.raycast(e,n)&&(r=!1)}if(!0===r&&!0===i){const i=t.children;for(let t=0,r=i.length;t<r;t++)FV(i[t],e,n,!0)}}function kV(){!1===this._document.hidden&&this.reset()}class BV{constructor(t=1,e=0,n=0){this.radius=t,this.phi=e,this.theta=n}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=mD(this.phi,t,Math.PI-t),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(mD(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class zV{constructor(t,e,n,i){zV.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==t&&this.set(t,e,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(t,e=0){for(let n=0;n<4;n++)this.elements[n]=t[n+e];return this}set(t,e,n,i){const r=this.elements;return r[0]=t,r[2]=e,r[1]=n,r[3]=i,this}}const VV=new bD;const HV=new wD,WV=new wD,jV=new wD,GV=new wD,XV=new wD,qV=new wD,YV=new wD;const KV=new wD;const ZV=new wD,$V=new AL,JV=new AL;function QV(t){const e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...QV(t.children[n]));return e}const tH=new wD,eH=new _N,nH=new _N;const iH=new wD,rH=new wD,sH=new wD;const aH=new wD,oH=new cU;function lH(t,e,n,i,r,s,a){aH.set(r,s,a).unproject(i);const o=e[t];if(void 0!==o){const t=n.getAttribute("position");for(let e=0,n=o.length;e<n;e++)t.setXYZ(o[e],aH.x,aH.y,aH.z)}}const cH=new tL;const hH=new wD;let uH,dH;function pH(t,e,n,i){const r=function(t){switch(t){case UO:case FO:return{byteLength:1,components:1};case BO:case kO:case WO:return{byteLength:2,components:1};case jO:case GO:return{byteLength:2,components:4};case VO:case zO:case HO:return{byteLength:4,components:1};case qO:case YO:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}(i);switch(n){case KO:return t*e;case tI:case eI:return t*e/r.components*r.byteLength;case nI:case iI:return t*e*2/r.components*r.byteLength;case ZO:return t*e*3/r.components*r.byteLength;case $O:case rI:return t*e*4/r.components*r.byteLength;case sI:case aI:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case oI:case lI:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case hI:case dI:return Math.max(t,16)*Math.max(e,8)/4;case cI:case uI:return Math.max(t,8)*Math.max(e,8)/2;case pI:case fI:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case mI:case gI:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case vI:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case yI:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case _I:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case xI:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case bI:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case MI:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case wI:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case SI:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case TI:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case EI:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case AI:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case CI:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case RI:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case PI:case OI:case II:return Math.ceil(t/4)*Math.ceil(e/4)*16;case DI:case LI:return Math.ceil(t/4)*Math.ceil(e/4)*8;case NI:case UI:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function fH(){let t=null,e=!1,n=null,i=null;function r(e,s){n(e,s),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function mH(t){const e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const i=e.get(n);i&&(t.deleteBuffer(i.buffer),e.delete(n))},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const t=e.get(n);return void((!t||t.version<n.version)&&e.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const r=e.get(n);if(void 0===r)e.set(n,function(e,n){const i=e.array,r=e.usage,s=i.byteLength,a=t.createBuffer();let o;if(t.bindBuffer(n,a),t.bufferData(n,i,r),e.onUploadCallback(),i instanceof Float32Array)o=t.FLOAT;else if("undefined"!=typeof Float16Array&&i instanceof Float16Array)o=t.HALF_FLOAT;else if(i instanceof Uint16Array)o=e.isFloat16BufferAttribute?t.HALF_FLOAT:t.UNSIGNED_SHORT;else if(i instanceof Int16Array)o=t.SHORT;else if(i instanceof Uint32Array)o=t.UNSIGNED_INT;else if(i instanceof Int32Array)o=t.INT;else if(i instanceof Int8Array)o=t.BYTE;else if(i instanceof Uint8Array)o=t.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);o=t.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,size:s}}(n,i));else if(r.version<n.version){if(r.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,n,i){const r=n.array,s=n.updateRanges;if(t.bindBuffer(i,e),0===s.length)t.bufferSubData(i,0,r);else{s.sort((t,e)=>t.start-e.start);let e=0;for(let t=1;t<s.length;t++){const n=s[e],i=s[t];i.start<=n.start+n.count+1?n.count=Math.max(n.count,i.start+i.count-n.start):(++e,s[e]=i)}s.length=e+1;for(let n=0,a=s.length;n<a;n++){const e=s[n];t.bufferSubData(i,e.start*r.BYTES_PER_ELEMENT,r,e.start,e.count)}n.clearUpdateRanges()}n.onUploadCallback()}(r.buffer,n,i),r.version=n.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:IP}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=IP));const gH={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},vH={common:{diffuse:{value:new _N(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ED},alphaMap:{value:null},alphaMapTransform:{value:new ED},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ED}},envmap:{envMap:{value:null},envMapRotation:{value:new ED},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ED}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ED}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ED},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ED},normalScale:{value:new bD(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ED},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ED}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ED}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ED}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _N(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _N(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ED},alphaTest:{value:0},uvTransform:{value:new ED}},sprite:{diffuse:{value:new _N(16777215)},opacity:{value:1},center:{value:new bD(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ED},alphaMap:{value:null},alphaMapTransform:{value:new ED},alphaTest:{value:0}}},yH={basic:{uniforms:sU([vH.common,vH.specularmap,vH.envmap,vH.aomap,vH.lightmap,vH.fog]),vertexShader:gH.meshbasic_vert,fragmentShader:gH.meshbasic_frag},lambert:{uniforms:sU([vH.common,vH.specularmap,vH.envmap,vH.aomap,vH.lightmap,vH.emissivemap,vH.bumpmap,vH.normalmap,vH.displacementmap,vH.fog,vH.lights,{emissive:{value:new _N(0)}}]),vertexShader:gH.meshlambert_vert,fragmentShader:gH.meshlambert_frag},phong:{uniforms:sU([vH.common,vH.specularmap,vH.envmap,vH.aomap,vH.lightmap,vH.emissivemap,vH.bumpmap,vH.normalmap,vH.displacementmap,vH.fog,vH.lights,{emissive:{value:new _N(0)},specular:{value:new _N(1118481)},shininess:{value:30}}]),vertexShader:gH.meshphong_vert,fragmentShader:gH.meshphong_frag},standard:{uniforms:sU([vH.common,vH.envmap,vH.aomap,vH.lightmap,vH.emissivemap,vH.bumpmap,vH.normalmap,vH.displacementmap,vH.roughnessmap,vH.metalnessmap,vH.fog,vH.lights,{emissive:{value:new _N(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:gH.meshphysical_vert,fragmentShader:gH.meshphysical_frag},toon:{uniforms:sU([vH.common,vH.aomap,vH.lightmap,vH.emissivemap,vH.bumpmap,vH.normalmap,vH.displacementmap,vH.gradientmap,vH.fog,vH.lights,{emissive:{value:new _N(0)}}]),vertexShader:gH.meshtoon_vert,fragmentShader:gH.meshtoon_frag},matcap:{uniforms:sU([vH.common,vH.bumpmap,vH.normalmap,vH.displacementmap,vH.fog,{matcap:{value:null}}]),vertexShader:gH.meshmatcap_vert,fragmentShader:gH.meshmatcap_frag},points:{uniforms:sU([vH.points,vH.fog]),vertexShader:gH.points_vert,fragmentShader:gH.points_frag},dashed:{uniforms:sU([vH.common,vH.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gH.linedashed_vert,fragmentShader:gH.linedashed_frag},depth:{uniforms:sU([vH.common,vH.displacementmap]),vertexShader:gH.depth_vert,fragmentShader:gH.depth_frag},normal:{uniforms:sU([vH.common,vH.bumpmap,vH.normalmap,vH.displacementmap,{opacity:{value:1}}]),vertexShader:gH.meshnormal_vert,fragmentShader:gH.meshnormal_frag},sprite:{uniforms:sU([vH.sprite,vH.fog]),vertexShader:gH.sprite_vert,fragmentShader:gH.sprite_frag},background:{uniforms:{uvTransform:{value:new ED},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:gH.background_vert,fragmentShader:gH.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ED}},vertexShader:gH.backgroundCube_vert,fragmentShader:gH.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:gH.cube_vert,fragmentShader:gH.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gH.equirect_vert,fragmentShader:gH.equirect_frag},distanceRGBA:{uniforms:sU([vH.common,vH.displacementmap,{referencePosition:{value:new wD},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gH.distanceRGBA_vert,fragmentShader:gH.distanceRGBA_frag},shadow:{uniforms:sU([vH.lights,vH.fog,{color:{value:new _N(0)},opacity:{value:1}}]),vertexShader:gH.shadow_vert,fragmentShader:gH.shadow_frag}};yH.physical={uniforms:sU([yH.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ED},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ED},clearcoatNormalScale:{value:new bD(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ED},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ED},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ED},sheen:{value:0},sheenColor:{value:new _N(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ED},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ED},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ED},transmissionSamplerSize:{value:new bD},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ED},attenuationDistance:{value:0},attenuationColor:{value:new _N(0)},specularColor:{value:new _N(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ED},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ED},anisotropyVector:{value:new bD},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ED}}]),vertexShader:gH.meshphysical_vert,fragmentShader:gH.meshphysical_frag};const _H={r:0,b:0,g:0},xH=new FL,bH=new AL;function MH(t,e,n,i,r,s,a){const o=new _N(0);let l,c,h=!0===s?0:1,u=null,d=0,p=null;function f(t){let i=!0===t.isScene?t.background:null;if(i&&i.isTexture){i=(t.backgroundBlurriness>0?n:e).get(i)}return i}function m(e,n){e.getRGB(_H,aU(t)),i.buffers.color.setClear(_H.r,_H.g,_H.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),h=e,m(o,h)},getClearAlpha:function(){return h},setClearAlpha:function(t){h=t,m(o,h)},render:function(e){let n=!1;const r=f(e);null===r?m(o,h):r&&r.isColor&&(m(r,1),n=!0);const s=t.xr.getEnvironmentBlendMode();"additive"===s?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))},addToRenderList:function(e,n){const i=f(n);i&&(i.isCubeTexture||i.mapping===TO)?(void 0===c&&(c=new eU(new iU(1,1,1),new lU({name:"BackgroundCubeMaterial",uniforms:rU(yH.backgroundCube.uniforms),vertexShader:yH.backgroundCube.vertexShader,fragmentShader:yH.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),xH.copy(n.backgroundRotation),xH.x*=-1,xH.y*=-1,xH.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(xH.y*=-1,xH.z*=-1),c.material.uniforms.envMap.value=i,c.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(bH.makeRotationFromEuler(xH)),c.material.toneMapped=kD.getTransfer(i.colorSpace)!==KI,u===i&&d===i.version&&p===t.toneMapping||(c.material.needsUpdate=!0,u=i,d=i.version,p=t.toneMapping),c.layers.enableAll(),e.unshift(c,c.geometry,c.material,0,0,null)):i&&i.isTexture&&(void 0===l&&(l=new eU(new IB(2,2),new lU({name:"BackgroundMaterial",uniforms:rU(yH.background.uniforms),vertexShader:yH.background.vertexShader,fragmentShader:yH.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=i,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=kD.getTransfer(i.colorSpace)!==KI,!0===i.matrixAutoUpdate&&i.updateMatrix(),l.material.uniforms.uvTransform.value.copy(i.matrix),u===i&&d===i.version&&p===t.toneMapping||(l.material.needsUpdate=!0,u=i,d=i.version,p=t.toneMapping),l.layers.enableAll(),e.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function wH(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=c(null);let s=r,a=!1;function o(e){return t.bindVertexArray(e)}function l(e){return t.deleteVertexArray(e)}function c(t){const e=[],i=[],r=[];for(let s=0;s<n;s++)e[s]=0,i[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:i,attributeDivisors:r,object:t,attributes:{},index:null}}function h(){const t=s.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function u(t){d(t,0)}function d(e,n){const i=s.newAttributes,r=s.enabledAttributes,a=s.attributeDivisors;i[e]=1,0===r[e]&&(t.enableVertexAttribArray(e),r[e]=1),a[e]!==n&&(t.vertexAttribDivisor(e,n),a[e]=n)}function p(){const e=s.newAttributes,n=s.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function f(e,n,i,r,s,a,o){!0===o?t.vertexAttribIPointer(e,n,i,s,a):t.vertexAttribPointer(e,n,i,r,s,a)}function m(){g(),a=!0,s!==r&&(s=r,o(s.object))}function g(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(n,r,l,m,g){let v=!1;const y=function(e,n,r){const s=!0===r.wireframe;let a=i[e.id];void 0===a&&(a={},i[e.id]=a);let o=a[n.id];void 0===o&&(o={},a[n.id]=o);let l=o[s];void 0===l&&(l=c(t.createVertexArray()),o[s]=l);return l}(m,l,r);s!==y&&(s=y,o(s.object)),v=function(t,e,n,i){const r=s.attributes,a=e.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const e=r[s];let n=a[s];if(void 0===n&&("instanceMatrix"===s&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===s&&t.instanceColor&&(n=t.instanceColor)),void 0===e)return!0;if(e.attribute!==n)return!0;if(n&&e.data!==n.data)return!0;o++}}return s.attributesNum!==o||s.index!==i}(n,m,l,g),v&&function(t,e,n,i){const r={},a=e.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let e=a[s];void 0===e&&("instanceMatrix"===s&&t.instanceMatrix&&(e=t.instanceMatrix),"instanceColor"===s&&t.instanceColor&&(e=t.instanceColor));const n={};n.attribute=e,e&&e.data&&(n.data=e.data),r[s]=n,o++}}s.attributes=r,s.attributesNum=o,s.index=i}(n,m,l,g),null!==g&&e.update(g,t.ELEMENT_ARRAY_BUFFER),(v||a)&&(a=!1,function(n,i,r,s){h();const a=s.attributes,o=r.getAttributes(),l=i.defaultAttributeValues;for(const c in o){const i=o[c];if(i.location>=0){let r=a[c];if(void 0===r&&("instanceMatrix"===c&&n.instanceMatrix&&(r=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(r=n.instanceColor)),void 0!==r){const a=r.normalized,o=r.itemSize,l=e.get(r);if(void 0===l)continue;const c=l.buffer,h=l.type,p=l.bytesPerElement,m=h===t.INT||h===t.UNSIGNED_INT||r.gpuType===zO;if(r.isInterleavedBufferAttribute){const e=r.data,l=e.stride,g=r.offset;if(e.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)d(i.location+t,e.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=e.meshPerAttribute*e.count)}else for(let t=0;t<i.locationSize;t++)u(i.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<i.locationSize;t++)f(i.location+t,o/i.locationSize,h,a,l*p,(g+o/i.locationSize*t)*p,m)}else{if(r.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)d(i.location+t,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let t=0;t<i.locationSize;t++)u(i.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<i.locationSize;t++)f(i.location+t,o/i.locationSize,h,a,o*p,o/i.locationSize*t*p,m)}}else if(void 0!==l){const e=l[c];if(void 0!==e)switch(e.length){case 2:t.vertexAttrib2fv(i.location,e);break;case 3:t.vertexAttrib3fv(i.location,e);break;case 4:t.vertexAttrib4fv(i.location,e);break;default:t.vertexAttrib1fv(i.location,e)}}}}p()}(n,r,l,m),null!==g&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const t in i){const e=i[t];for(const t in e){const n=e[t];for(const t in n)l(n[t].object),delete n[t];delete e[t]}delete i[t]}},releaseStatesOfGeometry:function(t){if(void 0===i[t.id])return;const e=i[t.id];for(const n in e){const t=e[n];for(const e in t)l(t[e].object),delete t[e];delete e[n]}delete i[t.id]},releaseStatesOfProgram:function(t){for(const e in i){const n=i[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)l(r[t].object),delete r[t];delete n[t.id]}},initAttributes:h,enableAttribute:u,disableUnusedAttributes:p}}function SH(t,e,n){let i;function r(e,r,s){0!==s&&(t.drawArraysInstanced(i,e,r,s),n.update(r,i,s))}this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i,1)},this.renderInstances=r,this.renderMultiDraw=function(t,r,s){if(0===s)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,t,0,r,0,s);let a=0;for(let e=0;e<s;e++)a+=r[e];n.update(a,i,1)},this.renderMultiDrawInstances=function(t,s,a,o){if(0===a)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<t.length;e++)r(t[e],s[e],o[e]);else{l.multiDrawArraysInstancedWEBGL(i,t,0,s,0,o,0,a);let e=0;for(let t=0;t<a;t++)e+=s[t]*o[t];n.update(e,i,1)}}}function TH(t,e,n,i){let r;function s(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const o=s(a);o!==a&&(a=o);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&e.has("EXT_clip_control"),h=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:s,textureFormatReadable:function(e){return e===$O||i.convert(e)===t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const r=n===WO&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(n!==UO&&i.convert(n)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==HO&&!r)},precision:a,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:h,maxVertexTextures:u,maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxCubemapSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexUniforms:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:t.getParameter(t.MAX_VARYING_VECTORS),maxFragmentUniforms:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:u>0,maxSamples:t.getParameter(t.MAX_SAMPLES)}}function EH(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new _F,o=new ED,l={value:null,needsUpdate:!1};function c(t,n,i,r){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const e=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(t[n]).applyMatrix4(r,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const n=0!==t.length||e||0!==i||r;return r=e,i=t.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(t,e){n=c(t,e,0)},this.setState=function(a,o,h){const u=a.clippingPlanes,d=a.clipIntersection,p=a.clipShadows,f=t.get(a);if(!r||null===u||0===u.length||s&&!p)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);e.numPlanes=i,e.numIntersection=0}();else{const t=s?0:i,e=4*t;let r=f.clippingState||null;l.value=r,r=c(u,o,e,h);for(let i=0;i!==e;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function AH(t){let e=new WeakMap;function n(t,e){return e===wO?t.mapping=bO:e===SO&&(t.mapping=MO),t}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===wO||s===SO){if(e.has(r)){return n(e.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const a=new vU(s.height);return a.fromEquirectangularTexture(t,r),e.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}const CH=[.125,.215,.35,.446,.526,.582],RH=20,PH=new jz,OH=new _N;let IH=null,DH=0,LH=0,NH=!1;const UH=(1+Math.sqrt(5))/2,FH=1/UH,kH=[new wD(-UH,FH,0),new wD(UH,FH,0),new wD(-FH,0,UH),new wD(FH,0,UH),new wD(0,UH,-FH),new wD(0,UH,FH),new wD(-1,1,-1),new wD(1,1,-1),new wD(-1,1,1),new wD(1,1,1)],BH=new wD;class zH{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100,r={}){const{size:s=256,position:a=BH}=r;IH=this._renderer.getRenderTarget(),DH=this._renderer.getActiveCubeFace(),LH=this._renderer.getActiveMipmapLevel(),NH=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(t,n,i,o,a),e>0&&this._blur(o,0,0,e),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=jH(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=WH(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(IH,DH,LH),this._renderer.xr.enabled=NH,t.scissorTest=!1,HH(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===bO||t.mapping===MO?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),IH=this._renderer.getRenderTarget(),DH=this._renderer.getActiveCubeFace(),LH=this._renderer.getActiveMipmapLevel(),NH=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:IO,minFilter:IO,generateMipmaps:!1,type:WO,format:$O,colorSpace:qI,depthBuffer:!1},i=VH(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=VH(t,e,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],n=[],i=[];let r=t;const s=t-4+1+CH.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);n.push(s);let o=1/s;a>t-4?o=CH[a-t+4-1]:0===a&&(o=0),i.push(o);const l=1/(s-2),c=-l,h=1+l,u=[c,c,h,c,h,h,c,c,h,h,c,h],d=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*d),y=new Float32Array(m*p*d),_=new Float32Array(g*p*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(i,f*p*t),y.set(u,m*p*t);const r=[t,t,t,t,t,t];_.set(r,g*p*t)}const x=new WN;x.setAttribute("position",new IN(v,f)),x.setAttribute("uv",new IN(y,m)),x.setAttribute("faceIndex",new IN(_,g)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(t,e,n){const i=new Float32Array(RH),r=new wD(0,1,0),s=new lU({name:"SphericalGaussianBlur",defines:{n:RH,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:GH(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(i,t,e)}return i}_compileMaterial(t){const e=new eU(this._lodPlanes[0],t);this._renderer.compile(e,PH)}_sceneToCubeUV(t,e,n,i,r){const s=new pU(90,1,e,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,h=l.toneMapping;l.getClearColor(OH),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(i),l.clearDepth(),l.setRenderTarget(null));const u=new wN({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),d=new eU(new iU,u);let p=!1;const f=t.background;f?f.isColor&&(u.color.copy(f),t.background=null,p=!0):(u.color.copy(OH),p=!0);for(let m=0;m<6;m++){const e=m%3;0===e?(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x+o[m],r.y,r.z)):1===e?(s.up.set(0,0,a[m]),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y+o[m],r.z)):(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y,r.z+o[m]));const n=this._cubeSize;HH(i,e*n,m>2?n:0,n,n),l.setRenderTarget(i),p&&l.render(d,s),l.render(t,s)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=h,l.autoClear=c,t.background=f}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===bO||t.mapping===MO;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=jH()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=WH());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new eU(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const a=this._cubeSize;HH(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,PH)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const e=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=kH[(i-r-1)%kH.length];this._blur(t,r-1,r,e,n)}e.autoClear=n}_blur(t,e,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,a){const o=this._renderer,l=this._blurMaterial,c=new eU(this._lodPlanes[i],l),h=l.uniforms,u=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):RH,m=[];let g=0;for(let _=0;_<RH;++_){const t=_/p,e=Math.exp(-t*t/2);m.push(e),0===_?g+=e:_<f&&(g+=2*e)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;h.envMap.value=t.texture,h.samples.value=f,h.weights.value=m,h.latitudinal.value="latitudinal"===s,a&&(h.poleAxis.value=a);const{_lodMax:v}=this;h.dTheta.value=d,h.mipInt.value=v-n;const y=this._sizeLods[i];HH(e,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(e),o.render(c,PH)}}function VH(t,e,n){const i=new $D(t,e,n);return i.texture.mapping=TO,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function HH(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function WH(){return new lU({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:GH(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function jH(){return new lU({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:GH(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function GH(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function XH(t){let e=new WeakMap,n=null;function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=s===wO||s===SO,o=s===bO||s===MO;if(a||o){let s=e.get(r);const l=void 0!==s?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===n&&(n=new zH(t)),s=a?n.fromEquirectangular(r,s):n.fromCubemap(r,s),s.texture.pmremVersion=r.pmremVersion,e.set(r,s),s.texture;if(void 0!==s)return s.texture;{const l=r.image;return a&&l&&l.height>0||o&&l&&function(t){let e=0;const n=6;for(let i=0;i<n;i++)void 0!==t[i]&&e++;return e===n}(l)?(null===n&&(n=new zH(t)),s=a?n.fromEquirectangular(r):n.fromCubemap(r),s.texture.pmremVersion=r.pmremVersion,e.set(r,s),r.addEventListener("dispose",i),s.texture):null}}}return r},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function qH(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(t){const e=n(t);return null===e&&LD("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function YH(t,e,n,i){const r={},s=new WeakMap;function a(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const n in o.attributes)e.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(e.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(t){const n=[],i=t.index,r=t.attributes.position;let a=0;if(null!==i){const t=i.array;a=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],s=t[e+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const t=r.array;a=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}}const o=new(CD(n)?LN:DN)(n,1);o.version=a;const l=s.get(t);l&&e.remove(l),s.set(t,o)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",a),r[e.id]=!0,n.memory.geometries++),e},update:function(n){const i=n.attributes;for(const r in i)e.update(i[r],t.ARRAY_BUFFER)},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return s.get(t)}}}function KH(t,e,n){let i,r,s;function a(e,a,o){0!==o&&(t.drawElementsInstanced(i,a,r,e*s,o),n.update(a,i,o))}this.setMode=function(t){i=t},this.setIndex=function(t){r=t.type,s=t.bytesPerElement},this.render=function(e,a){t.drawElements(i,a,r,e*s),n.update(a,i,1)},this.renderInstances=a,this.renderMultiDraw=function(t,s,a){if(0===a)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,r,t,0,a);let o=0;for(let e=0;e<a;e++)o+=s[e];n.update(o,i,1)},this.renderMultiDrawInstances=function(t,o,l,c){if(0===l)return;const h=e.get("WEBGL_multi_draw");if(null===h)for(let e=0;e<t.length;e++)a(t[e]/s,o[e],c[e]);else{h.multiDrawElementsInstancedWEBGL(i,o,0,r,t,0,c,0,l);let e=0;for(let t=0;t<l;t++)e+=o[t]*c[t];n.update(e,i,1)}}}function ZH(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,i,r){switch(e.calls++,i){case t.TRIANGLES:e.triangles+=r*(n/3);break;case t.LINES:e.lines+=r*(n/2);break;case t.LINE_STRIP:e.lines+=r*(n-1);break;case t.LINE_LOOP:e.lines+=r*n;break;case t.POINTS:e.points+=r*n}}}}function $H(t,e,n){const i=new WeakMap,r=new KD;return{update:function(s,a,o){const l=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,h=void 0!==c?c.length:0;let u=i.get(a);if(void 0===u||u.count!==h){let t=function(){v.dispose(),i.delete(a),a.removeEventListener("dispose",t)};void 0!==u&&u.texture.dispose();const n=void 0!==a.morphAttributes.position,s=void 0!==a.morphAttributes.normal,o=void 0!==a.morphAttributes.color,l=a.morphAttributes.position||[],c=a.morphAttributes.normal||[],d=a.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===s&&(p=2),!0===o&&(p=3);let f=a.attributes.position.count*p,m=1;f>e.maxTextureSize&&(m=Math.ceil(f/e.maxTextureSize),f=e.maxTextureSize);const g=new Float32Array(f*m*4*h),v=new JD(g,f,m,h);v.type=HO,v.needsUpdate=!0;const y=4*p;for(let e=0;e<h;e++){const t=l[e],i=c[e],a=d[e],h=f*m*4*e;for(let e=0;e<t.count;e++){const l=e*y;!0===n&&(r.fromBufferAttribute(t,e),g[h+l+0]=r.x,g[h+l+1]=r.y,g[h+l+2]=r.z,g[h+l+3]=0),!0===s&&(r.fromBufferAttribute(i,e),g[h+l+4]=r.x,g[h+l+5]=r.y,g[h+l+6]=r.z,g[h+l+7]=0),!0===o&&(r.fromBufferAttribute(a,e),g[h+l+8]=r.x,g[h+l+9]=r.y,g[h+l+10]=r.z,g[h+l+11]=4===a.itemSize?r.w:1)}}u={count:h,texture:v,size:new bD(f,m)},i.set(a,u),a.addEventListener("dispose",t)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)o.getUniforms().setValue(t,"morphTexture",s.morphTexture,n);else{let e=0;for(let t=0;t<l.length;t++)e+=l[t];const n=a.morphTargetsRelative?1:1-e;o.getUniforms().setValue(t,"morphTargetBaseInfluence",n),o.getUniforms().setValue(t,"morphTargetInfluences",l)}o.getUniforms().setValue(t,"morphTargetsTexture",u.texture,n),o.getUniforms().setValue(t,"morphTargetsTextureSize",u.size)}}}function JH(t,e,n,i){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(a){const o=i.render.frame,l=a.geometry,c=e.get(a,l);if(r.get(c)!==o&&(e.update(c),r.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(n.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,t.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const t=a.skeleton;r.get(t)!==o&&(t.update(),r.set(t,o))}return c},dispose:function(){r=new WeakMap}}}const QH=new YD,tW=new mk(1,1),eW=new JD,nW=new QD,iW=new gU,rW=[],sW=[],aW=new Float32Array(16),oW=new Float32Array(9),lW=new Float32Array(4);function cW(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=rW[r];if(void 0===s&&(s=new Float32Array(r),rW[r]=s),0!==e){i.toArray(s,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(s,r)}return s}function hW(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function uW(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function dW(t,e){let n=sW[e];void 0===n&&(n=new Int32Array(e),sW[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function pW(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function fW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(hW(n,e))return;t.uniform2fv(this.addr,e),uW(n,e)}}function mW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(hW(n,e))return;t.uniform3fv(this.addr,e),uW(n,e)}}function gW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(hW(n,e))return;t.uniform4fv(this.addr,e),uW(n,e)}}function vW(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(hW(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),uW(n,e)}else{if(hW(n,i))return;lW.set(i),t.uniformMatrix2fv(this.addr,!1,lW),uW(n,i)}}function yW(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(hW(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),uW(n,e)}else{if(hW(n,i))return;oW.set(i),t.uniformMatrix3fv(this.addr,!1,oW),uW(n,i)}}function _W(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(hW(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),uW(n,e)}else{if(hW(n,i))return;aW.set(i),t.uniformMatrix4fv(this.addr,!1,aW),uW(n,i)}}function xW(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function bW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(hW(n,e))return;t.uniform2iv(this.addr,e),uW(n,e)}}function MW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(hW(n,e))return;t.uniform3iv(this.addr,e),uW(n,e)}}function wW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(hW(n,e))return;t.uniform4iv(this.addr,e),uW(n,e)}}function SW(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function TW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(hW(n,e))return;t.uniform2uiv(this.addr,e),uW(n,e)}}function EW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(hW(n,e))return;t.uniform3uiv(this.addr,e),uW(n,e)}}function AW(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(hW(n,e))return;t.uniform4uiv(this.addr,e),uW(n,e)}}function CW(t,e,n){const i=this.cache,r=n.allocateTextureUnit();let s;i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),this.type===t.SAMPLER_2D_SHADOW?(tW.compareFunction=515,s=tW):s=QH,n.setTexture2D(e||s,r)}function RW(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||nW,r)}function PW(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||iW,r)}function OW(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||eW,r)}function IW(t,e){t.uniform1fv(this.addr,e)}function DW(t,e){const n=cW(e,this.size,2);t.uniform2fv(this.addr,n)}function LW(t,e){const n=cW(e,this.size,3);t.uniform3fv(this.addr,n)}function NW(t,e){const n=cW(e,this.size,4);t.uniform4fv(this.addr,n)}function UW(t,e){const n=cW(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function FW(t,e){const n=cW(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function kW(t,e){const n=cW(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function BW(t,e){t.uniform1iv(this.addr,e)}function zW(t,e){t.uniform2iv(this.addr,e)}function VW(t,e){t.uniform3iv(this.addr,e)}function HW(t,e){t.uniform4iv(this.addr,e)}function WW(t,e){t.uniform1uiv(this.addr,e)}function jW(t,e){t.uniform2uiv(this.addr,e)}function GW(t,e){t.uniform3uiv(this.addr,e)}function XW(t,e){t.uniform4uiv(this.addr,e)}function qW(t,e,n){const i=this.cache,r=e.length,s=dW(n,r);hW(i,s)||(t.uniform1iv(this.addr,s),uW(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||QH,s[a])}function YW(t,e,n){const i=this.cache,r=e.length,s=dW(n,r);hW(i,s)||(t.uniform1iv(this.addr,s),uW(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||nW,s[a])}function KW(t,e,n){const i=this.cache,r=e.length,s=dW(n,r);hW(i,s)||(t.uniform1iv(this.addr,s),uW(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||iW,s[a])}function ZW(t,e,n){const i=this.cache,r=e.length,s=dW(n,r);hW(i,s)||(t.uniform1iv(this.addr,s),uW(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||eW,s[a])}class $W{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return pW;case 35664:return fW;case 35665:return mW;case 35666:return gW;case 35674:return vW;case 35675:return yW;case 35676:return _W;case 5124:case 35670:return xW;case 35667:case 35671:return bW;case 35668:case 35672:return MW;case 35669:case 35673:return wW;case 5125:return SW;case 36294:return TW;case 36295:return EW;case 36296:return AW;case 35678:case 36198:case 36298:case 36306:case 35682:return CW;case 35679:case 36299:case 36307:return RW;case 35680:case 36300:case 36308:case 36293:return PW;case 36289:case 36303:case 36311:case 36292:return OW}}(e.type)}}class JW{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return IW;case 35664:return DW;case 35665:return LW;case 35666:return NW;case 35674:return UW;case 35675:return FW;case 35676:return kW;case 5124:case 35670:return BW;case 35667:case 35671:return zW;case 35668:case 35672:return VW;case 35669:case 35673:return HW;case 5125:return WW;case 36294:return jW;case 36295:return GW;case 36296:return XW;case 35678:case 36198:case 36298:case 36306:case 35682:return qW;case 35679:case 36299:case 36307:return YW;case 35680:case 36300:case 36308:case 36293:return KW;case 36289:case 36303:case 36311:case 36292:return ZW}}(e.type)}}class QW{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(t,e[s.id],n)}}}const tj=/(\w+)(\])?(\[|\.)?/g;function ej(t,e){t.seq.push(e),t.map[e.id]=e}function nj(t,e,n){const i=t.name,r=i.length;for(tj.lastIndex=0;;){const s=tj.exec(i),a=tj.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===r){ej(n,void 0===c?new $W(o,t,e):new JW(o,t,e));break}{let t=n.map[o];void 0===t&&(t=new QW(o),ej(n,t)),n=t}}}class ij{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);nj(n,t.getUniformLocation(e,n.name),this)}}setValue(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)}setOptional(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)}static upload(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const s=e[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,i)}}static seqWithValue(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n}}function rj(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}let sj=0;const aj=new ED;function oj(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=(t.getShaderInfoLog(e)||"").trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){const n=t.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const t=a+1;i.push(`${t===e?">":" "} ${t}: ${n[a]}`)}return i.join("\n")}(t.getShaderSource(e),i)}return r}function lj(t,e){const n=function(t){kD._getMatrix(aj,kD.workingColorSpace,t);const e=`mat3( ${aj.elements.map(t=>t.toFixed(4))} )`;switch(kD.getTransfer(t)){case YI:return[e,"LinearTransferOETF"];case KI:return[e,"sRGBTransferOETF"];default:return[e,"LinearTransferOETF"]}}(e);return[`vec4 ${t}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function cj(t,e){let n;switch(e){case 1:default:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const hj=new wD;function uj(){kD.getLuminanceCoefficients(hj);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${hj.x.toFixed(4)}, ${hj.y.toFixed(4)}, ${hj.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function dj(t){return""!==t}function pj(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function fj(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const mj=/^[ \t]*#include +<([\w\d./]+)>/gm;function gj(t){return t.replace(mj,yj)}const vj=new Map;function yj(t,e){let n=gH[e];if(void 0===n){const t=vj.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");n=gH[t]}return gj(n)}const _j=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xj(t){return t.replace(_j,bj)}function bj(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Mj(t){let e=`precision ${t.precision} float;\n\tprecision ${t.precision} int;\n\tprecision ${t.precision} sampler2D;\n\tprecision ${t.precision} samplerCube;\n\tprecision ${t.precision} sampler3D;\n\tprecision ${t.precision} sampler2DArray;\n\tprecision ${t.precision} sampler2DShadow;\n\tprecision ${t.precision} samplerCubeShadow;\n\tprecision ${t.precision} sampler2DArrayShadow;\n\tprecision ${t.precision} isampler2D;\n\tprecision ${t.precision} isampler3D;\n\tprecision ${t.precision} isamplerCube;\n\tprecision ${t.precision} isampler2DArray;\n\tprecision ${t.precision} usampler2D;\n\tprecision ${t.precision} usampler3D;\n\tprecision ${t.precision} usamplerCube;\n\tprecision ${t.precision} usampler2DArray;\n\t`;return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function wj(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case bO:case MO:e="ENVMAP_TYPE_CUBE";break;case TO:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),h=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===MO&&(e="ENVMAP_MODE_REFRACTION");return e}(n),u=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),p=function(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(dj).join("\n")}(n),f=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),m=r.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(dj).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(dj).join("\n"),v.length>0&&(v+="\n")):(g=[Mj(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(dj).join("\n"),v=[Mj(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?gH.tonemapping_pars_fragment:"",0!==n.toneMapping?cj("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",gH.colorspace_pars_fragment,lj("linearToOutputTexel",n.outputColorSpace),uj(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(dj).join("\n")),a=gj(a),a=pj(a,n),a=fj(a,n),o=gj(o),o=pj(o,n),o=fj(o,n),a=xj(a),o=xj(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===aD?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===aD?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+a,x=y+v+o,b=rj(r,r.VERTEX_SHADER,_),M=rj(r,r.FRAGMENT_SHADER,x);function w(e){if(t.debug.checkShaderErrors){const n=r.getProgramInfoLog(m)||"",i=r.getShaderInfoLog(b)||"",s=r.getShaderInfoLog(M)||"",a=n.trim(),o=i.trim(),l=s.trim();let c=!0,h=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(c=!1,"function"==typeof t.debug.onShaderError)t.debug.onShaderError(r,m,b,M);else{oj(r,b,"vertex"),oj(r,M,"fragment")}else""!==a||""!==o&&""!==l||(h=!1);h&&(e.diagnostics={runnable:c,programLog:a,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}r.deleteShader(b),r.deleteShader(M),S=new ij(r,m),T=function(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),s=i.name;let a=1;i.type===t.FLOAT_MAT2&&(a=2),i.type===t.FLOAT_MAT3&&(a=3),i.type===t.FLOAT_MAT4&&(a=4),n[s]={type:i.type,location:t.getAttribLocation(e,s),locationSize:a}}return n}(r,m)}let S,T;r.attachShader(m,b),r.attachShader(m,M),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),this.getUniforms=function(){return void 0===S&&w(this),S},this.getAttributes=function(){return void 0===T&&w(this),T};let E=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===E&&(E=r.getProgramParameter(m,37297)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=sj++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=M,this}let Sj=0;class Tj{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new Ej(t),e.set(t,n)),n}}class Ej{constructor(t){this.id=Sj++,this.code=t,this.usedTimes=0}}function Aj(t,e,n,i,r,s,a){const o=new kL,l=new Tj,c=new Set,h=[],u=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(t){return c.add(t),0===t?"uv":`uv${t}`}return{getParameters:function(s,o,h,g,v){const y=g.fog,_=v.geometry,x=s.isMeshStandardMaterial?g.environment:null,b=(s.isMeshStandardMaterial?n:e).get(s.envMap||x),M=b&&b.mapping===TO?b.image.height:null,w=f[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),s.precision);const S=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,T=void 0!==S?S.length:0;let E,A,C,R,P=0;if(void 0!==_.morphAttributes.position&&(P=1),void 0!==_.morphAttributes.normal&&(P=2),void 0!==_.morphAttributes.color&&(P=3),w){const t=yH[w];E=t.vertexShader,A=t.fragmentShader}else E=s.vertexShader,A=s.fragmentShader,l.update(s),C=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const O=t.getRenderTarget(),I=t.state.buffers.depth.getReversed(),D=!0===v.isInstancedMesh,L=!0===v.isBatchedMesh,N=!!s.map,U=!!s.matcap,F=!!b,k=!!s.aoMap,B=!!s.lightMap,z=!!s.bumpMap,V=!!s.normalMap,H=!!s.displacementMap,W=!!s.emissiveMap,j=!!s.metalnessMap,G=!!s.roughnessMap,X=s.anisotropy>0,q=s.clearcoat>0,Y=s.dispersion>0,K=s.iridescence>0,Z=s.sheen>0,$=s.transmission>0,J=X&&!!s.anisotropyMap,Q=q&&!!s.clearcoatMap,tt=q&&!!s.clearcoatNormalMap,et=q&&!!s.clearcoatRoughnessMap,nt=K&&!!s.iridescenceMap,it=K&&!!s.iridescenceThicknessMap,rt=Z&&!!s.sheenColorMap,st=Z&&!!s.sheenRoughnessMap,at=!!s.specularMap,ot=!!s.specularColorMap,lt=!!s.specularIntensityMap,ct=$&&!!s.transmissionMap,ht=$&&!!s.thicknessMap,ut=!!s.gradientMap,dt=!!s.alphaMap,pt=s.alphaTest>0,ft=!!s.alphaHash,mt=!!s.extensions;let gt=0;s.toneMapped&&(null!==O&&!0!==O.isXRRenderTarget||(gt=t.toneMapping));const vt={shaderID:w,shaderType:s.type,shaderName:s.name,vertexShader:E,fragmentShader:A,defines:s.defines,customVertexShaderID:C,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,batching:L,batchingColor:L&&null!==v._colorsTexture,instancing:D,instancingColor:D&&null!==v.instanceColor,instancingMorph:D&&null!==v.morphTexture,supportsVertexTextures:d,outputColorSpace:null===O?t.outputColorSpace:!0===O.isXRRenderTarget?O.texture.colorSpace:qI,alphaToCoverage:!!s.alphaToCoverage,map:N,matcap:U,envMap:F,envMapMode:F&&b.mapping,envMapCubeUVHeight:M,aoMap:k,lightMap:B,bumpMap:z,normalMap:V,displacementMap:d&&H,emissiveMap:W,normalMapObjectSpace:V&&1===s.normalMapType,normalMapTangentSpace:V&&0===s.normalMapType,metalnessMap:j,roughnessMap:G,anisotropy:X,anisotropyMap:J,clearcoat:q,clearcoatMap:Q,clearcoatNormalMap:tt,clearcoatRoughnessMap:et,dispersion:Y,iridescence:K,iridescenceMap:nt,iridescenceThicknessMap:it,sheen:Z,sheenColorMap:rt,sheenRoughnessMap:st,specularMap:at,specularColorMap:ot,specularIntensityMap:lt,transmission:$,transmissionMap:ct,thicknessMap:ht,gradientMap:ut,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:dt,alphaTest:pt,alphaHash:ft,combine:s.combine,mapUv:N&&m(s.map.channel),aoMapUv:k&&m(s.aoMap.channel),lightMapUv:B&&m(s.lightMap.channel),bumpMapUv:z&&m(s.bumpMap.channel),normalMapUv:V&&m(s.normalMap.channel),displacementMapUv:H&&m(s.displacementMap.channel),emissiveMapUv:W&&m(s.emissiveMap.channel),metalnessMapUv:j&&m(s.metalnessMap.channel),roughnessMapUv:G&&m(s.roughnessMap.channel),anisotropyMapUv:J&&m(s.anisotropyMap.channel),clearcoatMapUv:Q&&m(s.clearcoatMap.channel),clearcoatNormalMapUv:tt&&m(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:et&&m(s.clearcoatRoughnessMap.channel),iridescenceMapUv:nt&&m(s.iridescenceMap.channel),iridescenceThicknessMapUv:it&&m(s.iridescenceThicknessMap.channel),sheenColorMapUv:rt&&m(s.sheenColorMap.channel),sheenRoughnessMapUv:st&&m(s.sheenRoughnessMap.channel),specularMapUv:at&&m(s.specularMap.channel),specularColorMapUv:ot&&m(s.specularColorMap.channel),specularIntensityMapUv:lt&&m(s.specularIntensityMap.channel),transmissionMapUv:ct&&m(s.transmissionMap.channel),thicknessMapUv:ht&&m(s.thicknessMap.channel),alphaMapUv:dt&&m(s.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(V||X),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!_.attributes.uv&&(N||dt),fog:!!y,useFog:!0===s.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===s.flatShading&&!1===s.wireframe,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:u,reversedDepthBuffer:I,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:T,morphTextureStride:P,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&h.length>0,shadowMapType:t.shadowMap.type,toneMapping:gt,decodeVideoTexture:N&&!0===s.map.isVideoTexture&&kD.getTransfer(s.map.colorSpace)===KI,decodeVideoTextureEmissive:W&&!0===s.emissiveMap.isVideoTexture&&kD.getTransfer(s.emissiveMap.colorSpace)===KI,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:mt&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(mt&&!0===s.extensions.multiDraw||L)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return vt.vertexUv1s=c.has(1),vt.vertexUv2s=c.has(2),vt.vertexUv3s=c.has(3),c.clear(),vt},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){o.disableAll(),e.supportsVertexTextures&&o.enable(0);e.instancing&&o.enable(1);e.instancingColor&&o.enable(2);e.instancingMorph&&o.enable(3);e.matcap&&o.enable(4);e.envMap&&o.enable(5);e.normalMapObjectSpace&&o.enable(6);e.normalMapTangentSpace&&o.enable(7);e.clearcoat&&o.enable(8);e.iridescence&&o.enable(9);e.alphaTest&&o.enable(10);e.vertexColors&&o.enable(11);e.vertexAlphas&&o.enable(12);e.vertexUv1s&&o.enable(13);e.vertexUv2s&&o.enable(14);e.vertexUv3s&&o.enable(15);e.vertexTangents&&o.enable(16);e.anisotropy&&o.enable(17);e.alphaHash&&o.enable(18);e.batching&&o.enable(19);e.dispersion&&o.enable(20);e.batchingColor&&o.enable(21);e.gradientMap&&o.enable(22);t.push(o.mask),o.disableAll(),e.fog&&o.enable(0);e.useFog&&o.enable(1);e.flatShading&&o.enable(2);e.logarithmicDepthBuffer&&o.enable(3);e.reversedDepthBuffer&&o.enable(4);e.skinning&&o.enable(5);e.morphTargets&&o.enable(6);e.morphNormals&&o.enable(7);e.morphColors&&o.enable(8);e.premultipliedAlpha&&o.enable(9);e.shadowMapEnabled&&o.enable(10);e.doubleSided&&o.enable(11);e.flipSided&&o.enable(12);e.useDepthPacking&&o.enable(13);e.dithering&&o.enable(14);e.transmission&&o.enable(15);e.sheen&&o.enable(16);e.opaque&&o.enable(17);e.pointsUvs&&o.enable(18);e.decodeVideoTexture&&o.enable(19);e.decodeVideoTextureEmissive&&o.enable(20);e.alphaToCoverage&&o.enable(21);t.push(o.mask)}(n,e),n.push(t.outputColorSpace)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=f[t.type];let n;if(e){const t=yH[e];n=oU.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,r=h.length;t<r;t++){const e=h[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new wj(t,n,e,s),h.push(i)),i},releaseProgram:function(t){if(0===--t.usedTimes){const e=h.indexOf(t);h[e]=h[h.length-1],h.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:h,dispose:function(){l.dispose()}}}function Cj(){let t=new WeakMap;return{has:function(e){return t.has(e)},get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function Rj(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Pj(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Oj(){const t=[];let e=0;const n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},t[e]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),e++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){e=0,n.length=0,i.length=0,r.length=0},push:function(t,e,a,o,l,c){const h=s(t,e,a,o,l,c);a.transmission>0?i.push(h):!0===a.transparent?r.push(h):n.push(h)},unshift:function(t,e,a,o,l,c){const h=s(t,e,a,o,l,c);a.transmission>0?i.unshift(h):!0===a.transparent?r.unshift(h):n.unshift(h)},finish:function(){for(let n=e,i=t.length;n<i;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Rj),i.length>1&&i.sort(e||Pj),r.length>1&&r.sort(e||Pj)}}}function Ij(){let t=new WeakMap;return{get:function(e,n){const i=t.get(e);let r;return void 0===i?(r=new Oj,t.set(e,[r])):n>=i.length?(r=new Oj,i.push(r)):r=i[n],r},dispose:function(){t=new WeakMap}}}function Dj(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new wD,color:new _N};break;case"SpotLight":n={position:new wD,direction:new wD,color:new _N,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new wD,color:new _N,distance:0,decay:0};break;case"HemisphereLight":n={direction:new wD,skyColor:new _N,groundColor:new _N};break;case"RectAreaLight":n={color:new _N,position:new wD,halfWidth:new wD,halfHeight:new wD}}return t[e.id]=n,n}}}let Lj=0;function Nj(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Uj(t){const e=new Dj,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bD};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bD,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)i.probe.push(new wD);const r=new wD,s=new AL,a=new AL;return{setup:function(r){let s=0,a=0,o=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let l=0,c=0,h=0,u=0,d=0,p=0,f=0,m=0,g=0,v=0,y=0;r.sort(Nj);for(let t=0,x=r.length;t<x;t++){const _=r[t],x=_.color,b=_.intensity,M=_.distance,w=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)s+=x.r*b,a+=x.g*b,o+=x.b*b;else if(_.isLightProbe){for(let t=0;t<9;t++)i.probe[t].addScaledVector(_.sh.coefficients[t],b);y++}else if(_.isDirectionalLight){const t=e.get(_);if(t.color.copy(_.color).multiplyScalar(_.intensity),_.castShadow){const t=_.shadow,e=n.get(_);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,i.directionalShadow[l]=e,i.directionalShadowMap[l]=w,i.directionalShadowMatrix[l]=_.shadow.matrix,p++}i.directional[l]=t,l++}else if(_.isSpotLight){const t=e.get(_);t.position.setFromMatrixPosition(_.matrixWorld),t.color.copy(x).multiplyScalar(b),t.distance=M,t.coneCos=Math.cos(_.angle),t.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),t.decay=_.decay,i.spot[h]=t;const r=_.shadow;if(_.map&&(i.spotLightMap[g]=_.map,g++,r.updateMatrices(_),_.castShadow&&v++),i.spotLightMatrix[h]=r.matrix,_.castShadow){const t=n.get(_);t.shadowIntensity=r.intensity,t.shadowBias=r.bias,t.shadowNormalBias=r.normalBias,t.shadowRadius=r.radius,t.shadowMapSize=r.mapSize,i.spotShadow[h]=t,i.spotShadowMap[h]=w,m++}h++}else if(_.isRectAreaLight){const t=e.get(_);t.color.copy(x).multiplyScalar(b),t.halfWidth.set(.5*_.width,0,0),t.halfHeight.set(0,.5*_.height,0),i.rectArea[u]=t,u++}else if(_.isPointLight){const t=e.get(_);if(t.color.copy(_.color).multiplyScalar(_.intensity),t.distance=_.distance,t.decay=_.decay,_.castShadow){const t=_.shadow,e=n.get(_);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,e.shadowCameraNear=t.camera.near,e.shadowCameraFar=t.camera.far,i.pointShadow[c]=e,i.pointShadowMap[c]=w,i.pointShadowMatrix[c]=_.shadow.matrix,f++}i.point[c]=t,c++}else if(_.isHemisphereLight){const t=e.get(_);t.skyColor.copy(_.color).multiplyScalar(b),t.groundColor.copy(_.groundColor).multiplyScalar(b),i.hemi[d]=t,d++}}u>0&&(!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=vH.LTC_FLOAT_1,i.rectAreaLTC2=vH.LTC_FLOAT_2):(i.rectAreaLTC1=vH.LTC_HALF_1,i.rectAreaLTC2=vH.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=a,i.ambient[2]=o;const _=i.hash;_.directionalLength===l&&_.pointLength===c&&_.spotLength===h&&_.rectAreaLength===u&&_.hemiLength===d&&_.numDirectionalShadows===p&&_.numPointShadows===f&&_.numSpotShadows===m&&_.numSpotMaps===g&&_.numLightProbes===y||(i.directional.length=l,i.spot.length=h,i.rectArea.length=u,i.point.length=c,i.hemi.length=d,i.directionalShadow.length=p,i.directionalShadowMap.length=p,i.pointShadow.length=f,i.pointShadowMap.length=f,i.spotShadow.length=m,i.spotShadowMap.length=m,i.directionalShadowMatrix.length=p,i.pointShadowMatrix.length=f,i.spotLightMatrix.length=m+g-v,i.spotLightMap.length=g,i.numSpotLightShadowsWithMaps=v,i.numLightProbes=y,_.directionalLength=l,_.pointLength=c,_.spotLength=h,_.rectAreaLength=u,_.hemiLength=d,_.numDirectionalShadows=p,_.numPointShadows=f,_.numSpotShadows=m,_.numSpotMaps=g,_.numLightProbes=y,i.version=Lj++)},setupView:function(t,e){let n=0,o=0,l=0,c=0,h=0;const u=e.matrixWorldInverse;for(let d=0,p=t.length;d<p;d++){const e=t[d];if(e.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),r.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(r),t.direction.transformDirection(u),n++}else if(e.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(e.matrixWorld),r.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(r),t.direction.transformDirection(u),l++}else if(e.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(u),a.identity(),s.copy(e.matrixWorld),s.premultiply(u),a.extractRotation(s),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=i.point[o];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(u),o++}else if(e.isHemisphereLight){const t=i.hemi[h];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(u),h++}}},state:i}}function Fj(t){const e=new Uj(t),n=[],i=[];const r={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function(t){r.camera=t,n.length=0,i.length=0},state:r,setupLights:function(){e.setup(n)},setupLightsView:function(t){e.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){i.push(t)}}}function kj(t){let e=new WeakMap;return{get:function(n,i=0){const r=e.get(n);let s;return void 0===r?(s=new Fj(t),e.set(n,[s])):i>=r.length?(s=new Fj(t),r.push(s)):s=r[i],s},dispose:function(){e=new WeakMap}}}function Bj(t,e,n){let i=new wF;const r=new bD,s=new bD,a=new KD,o=new $B({depthPacking:3201}),l=new JB,c={},h=n.maxTextureSize,u={[BP]:1,[zP]:0,[VP]:2},d=new lU({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new bD},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new WN;f.setAttribute("position",new IN(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new eU(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let v=this.type;function y(n,i){const s=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new $D(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,s,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,s,p,m,null)}function _(e,n,i,r){let s=null;const a=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===i.isPointLight?l:o,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const t=s.uuid,e=n.uuid;let i=c[t];void 0===i&&(i={},c[t]=i);let r=i[e];void 0===r&&(r=s.clone(),i[e]=r,n.addEventListener("dispose",b)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=3===r?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],s.alphaMap=n.alphaMap,s.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){t.properties.get(s).light=i}return s}function x(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=e.update(n),l=n.material;if(Array.isArray(l)){const e=i.groups;for(let c=0,h=e.length;c<h;c++){const h=e[c],u=l[h.materialIndex];if(u&&u.visible){const e=_(n,u,a,o);n.onBeforeShadow(t,n,r,s,i,e,h),t.renderBufferDirect(s,null,i,e,n,h),n.onAfterShadow(t,n,r,s,i,e,h)}}}else if(l.visible){const e=_(n,l,a,o);n.onBeforeShadow(t,n,r,s,i,e,null),t.renderBufferDirect(s,null,i,e,n,null),n.onAfterShadow(t,n,r,s,i,e,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)x(l[t],r,s,a,o)}function b(t){t.target.removeEventListener("dispose",b);for(const e in c){const n=c[e],i=t.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(e,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),!0===d.buffers.depth.getReversed()?d.buffers.color.setClear(0,0,0,0):d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=3!==v&&3===this.type,f=3===v&&3!==this.type;for(let m=0,g=e.length;m<g;m++){const l=e[m],c=l.shadow;if(void 0===c)continue;if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const u=c.getFrameExtents();if(r.multiply(u),s.copy(c.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/u.x),r.x=s.x*u.x,c.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/u.y),r.y=s.y*u.y,c.mapSize.y=s.y)),null===c.map||!0===p||!0===f){const t=3!==this.type?{minFilter:RO,magFilter:RO}:{};null!==c.map&&c.map.dispose(),c.map=new $D(r.x,r.y,t),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}t.setRenderTarget(c.map),t.clear();const g=c.getViewportCount();for(let t=0;t<g;t++){const e=c.getViewport(t);a.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(a),c.updateMatrices(l,t),i=c.getFrustum(),x(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&y(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,t.setRenderTarget(l,c,u)}}const zj={[lO]:1,[hO]:6,[dO]:7,[uO]:5,[cO]:0,[fO]:2,[mO]:4,[pO]:3};function Vj(t,e){const n=new function(){let e=!1;const n=new KD;let i=null;const r=new KD(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,s,a,o){!0===o&&(e*=a,i*=a,s*=a),n.set(e,i,s,a),!1===r.equals(n)&&(t.clearColor(e,i,s,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},i=new function(){let n=!1,i=!1,r=null,s=null,a=null;return{setReversed:function(t){if(i!==t){const n=e.get("EXT_clip_control");t?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),i=t;const r=a;a=null,this.setClear(r)}},getReversed:function(){return i},setTest:function(e){e?z(t.DEPTH_TEST):V(t.DEPTH_TEST)},setMask:function(e){r===e||n||(t.depthMask(e),r=e)},setFunc:function(e){if(i&&(e=zj[e]),s!==e){switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}s=e}},setLocked:function(t){n=t},setClear:function(e){a!==e&&(i&&(e=1-e),t.clearDepth(e),a=e)},reset:function(){n=!1,r=null,s=null,a=null,i=!1}}},r=new function(){let e=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(n){e||(n?z(t.STENCIL_TEST):V(t.STENCIL_TEST))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&s===a||(t.stencilFunc(e,n,a),i=e,r=n,s=a)},setOp:function(e,n,i){a===e&&o===n&&l===i||(t.stencilOp(e,n,i),a=e,o=n,l=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null}}},s=new WeakMap,a=new WeakMap;let o={},l={},c=new WeakMap,h=[],u=null,d=!1,p=null,f=null,m=null,g=null,v=null,y=null,_=null,x=new _N(0,0,0),b=0,M=!1,w=null,S=null,T=null,E=null,A=null;const C=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,P=0;const O=t.getParameter(t.VERSION);-1!==O.indexOf("WebGL")?(P=parseFloat(/^WebGL (\d)/.exec(O)[1]),R=P>=1):-1!==O.indexOf("OpenGL ES")&&(P=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),R=P>=2);let I=null,D={};const L=t.getParameter(t.SCISSOR_BOX),N=t.getParameter(t.VIEWPORT),U=(new KD).fromArray(L),F=(new KD).fromArray(N);function k(e,n,i,r){const s=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let o=0;o<i;o++)e===t.TEXTURE_3D||e===t.TEXTURE_2D_ARRAY?t.texImage3D(n,0,t.RGBA,1,1,r,0,t.RGBA,t.UNSIGNED_BYTE,s):t.texImage2D(n+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,s);return a}const B={};function z(e){!0!==o[e]&&(t.enable(e),o[e]=!0)}function V(e){!1!==o[e]&&(t.disable(e),o[e]=!1)}B[t.TEXTURE_2D]=k(t.TEXTURE_2D,t.TEXTURE_2D,1),B[t.TEXTURE_CUBE_MAP]=k(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),B[t.TEXTURE_2D_ARRAY]=k(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),B[t.TEXTURE_3D]=k(t.TEXTURE_3D,t.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),r.setClear(0),z(t.DEPTH_TEST),i.setFunc(3),G(!1),X(1),z(t.CULL_FACE),j(0);const H={[jP]:t.FUNC_ADD,[GP]:t.FUNC_SUBTRACT,[XP]:t.FUNC_REVERSE_SUBTRACT};H[103]=t.MIN,H[104]=t.MAX;const W={[qP]:t.ZERO,[YP]:t.ONE,[KP]:t.SRC_COLOR,[$P]:t.SRC_ALPHA,[iO]:t.SRC_ALPHA_SATURATE,[eO]:t.DST_COLOR,[QP]:t.DST_ALPHA,[ZP]:t.ONE_MINUS_SRC_COLOR,[JP]:t.ONE_MINUS_SRC_ALPHA,[nO]:t.ONE_MINUS_DST_COLOR,[tO]:t.ONE_MINUS_DST_ALPHA,[rO]:t.CONSTANT_COLOR,[sO]:t.ONE_MINUS_CONSTANT_COLOR,[aO]:t.CONSTANT_ALPHA,[oO]:t.ONE_MINUS_CONSTANT_ALPHA};function j(e,n,i,r,s,a,o,l,c,h){if(0!==e){if(!1===d&&(z(t.BLEND),d=!0),5===e)s=s||n,a=a||i,o=o||r,n===f&&s===v||(t.blendEquationSeparate(H[n],H[s]),f=n,v=s),i===m&&r===g&&a===y&&o===_||(t.blendFuncSeparate(W[i],W[r],W[a],W[o]),m=i,g=r,y=a,_=o),!1!==l.equals(x)&&c===b||(t.blendColor(l.r,l.g,l.b,c),x.copy(l),b=c),p=e,M=!1;else if(e!==p||h!==M){if(f===jP&&v===jP||(t.blendEquation(t.FUNC_ADD),f=jP,v=jP),h)switch(e){case 1:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE)}else switch(e){case 1:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE)}m=null,g=null,y=null,_=null,x.set(0,0,0),b=0,p=e,M=h}}else!0===d&&(V(t.BLEND),d=!1)}function G(e){w!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),w=e)}function X(e){0!==e?(z(t.CULL_FACE),e!==S&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):V(t.CULL_FACE),S=e}function q(e,n,i){e?(z(t.POLYGON_OFFSET_FILL),E===n&&A===i||(t.polygonOffset(n,i),E=n,A=i)):V(t.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:i,stencil:r},enable:z,disable:V,bindFramebuffer:function(e,n){return l[e]!==n&&(t.bindFramebuffer(e,n),l[e]=n,e===t.DRAW_FRAMEBUFFER&&(l[t.FRAMEBUFFER]=n),e===t.FRAMEBUFFER&&(l[t.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(e,n){let i=h,r=!1;if(e){i=c.get(n),void 0===i&&(i=[],c.set(n,i));const s=e.textures;if(i.length!==s.length||i[0]!==t.COLOR_ATTACHMENT0){for(let e=0,n=s.length;e<n;e++)i[e]=t.COLOR_ATTACHMENT0+e;i.length=s.length,r=!0}}else i[0]!==t.BACK&&(i[0]=t.BACK,r=!0);r&&t.drawBuffers(i)},useProgram:function(e){return u!==e&&(t.useProgram(e),u=e,!0)},setBlending:j,setMaterial:function(e,s){2===e.side?V(t.CULL_FACE):z(t.CULL_FACE);let a=1===e.side;s&&(a=!a),G(a),1===e.blending&&!1===e.transparent?j(0):j(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.blendColor,e.blendAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),n.setMask(e.colorWrite);const o=e.stencilWrite;r.setTest(o),o&&(r.setMask(e.stencilWriteMask),r.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),r.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),q(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?z(t.SAMPLE_ALPHA_TO_COVERAGE):V(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:G,setCullFace:X,setLineWidth:function(e){e!==T&&(R&&t.lineWidth(e),T=e)},setPolygonOffset:q,setScissorTest:function(e){e?z(t.SCISSOR_TEST):V(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+C-1),I!==e&&(t.activeTexture(e),I=e)},bindTexture:function(e,n,i){void 0===i&&(i=null===I?t.TEXTURE0+C-1:I);let r=D[i];void 0===r&&(r={type:void 0,texture:void 0},D[i]=r),r.type===e&&r.texture===n||(I!==i&&(t.activeTexture(i),I=i),t.bindTexture(e,n||B[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=D[I];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D(...arguments)}catch(e){}},compressedTexImage3D:function(){try{t.compressedTexImage3D(...arguments)}catch(e){}},texImage2D:function(){try{t.texImage2D(...arguments)}catch(e){}},texImage3D:function(){try{t.texImage3D(...arguments)}catch(e){}},updateUBOMapping:function(e,n){let i=a.get(n);void 0===i&&(i=new WeakMap,a.set(n,i));let r=i.get(e);void 0===r&&(r=t.getUniformBlockIndex(n,e.name),i.set(e,r))},uniformBlockBinding:function(e,n){const i=a.get(n).get(e);s.get(n)!==i&&(t.uniformBlockBinding(n,i,e.__bindingPointIndex),s.set(n,i))},texStorage2D:function(){try{t.texStorage2D(...arguments)}catch(e){}},texStorage3D:function(){try{t.texStorage3D(...arguments)}catch(e){}},texSubImage2D:function(){try{t.texSubImage2D(...arguments)}catch(e){}},texSubImage3D:function(){try{t.texSubImage3D(...arguments)}catch(e){}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D(...arguments)}catch(e){}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D(...arguments)}catch(e){}},scissor:function(e){!1===U.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),U.copy(e))},viewport:function(e){!1===F.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),F.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),i.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),o={},I=null,D={},l={},c=new WeakMap,h=[],u=null,d=!1,p=null,f=null,m=null,g=null,v=null,y=null,_=null,x=new _N(0,0,0),b=0,M=!1,w=null,S=null,T=null,E=null,A=null,U.set(0,0,t.canvas.width,t.canvas.height),F.set(0,0,t.canvas.width,t.canvas.height),n.reset(),i.reset(),r.reset()}}}function Hj(t,e,n,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new bD,h=new WeakMap;let u;const d=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(TX){}function f(t,e){return p?new OffscreenCanvas(t,e):OD("canvas")}function m(t,e,n){let i=1;const r=W(t);if((r.width>n||r.height>n)&&(i=n/Math.max(r.width,r.height)),i<1){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&t instanceof VideoFrame){const n=Math.floor(i*r.width),s=Math.floor(i*r.height);void 0===u&&(u=f(n,s));const a=e?f(n,s):u;a.width=n,a.height=s;return a.getContext("2d").drawImage(t,0,0,n,s),a}return t}return t}function g(t){return t.generateMipmaps}function v(e){t.generateMipmap(e)}function y(e){return e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:e.isWebGL3DRenderTarget?t.TEXTURE_3D:e.isWebGLArrayRenderTarget||e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function _(n,i,r,s,a=!1){if(null!==n&&void 0!==t[n])return t[n];let o=i;if(i===t.RED&&(r===t.FLOAT&&(o=t.R32F),r===t.HALF_FLOAT&&(o=t.R16F),r===t.UNSIGNED_BYTE&&(o=t.R8)),i===t.RED_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.R8UI),r===t.UNSIGNED_SHORT&&(o=t.R16UI),r===t.UNSIGNED_INT&&(o=t.R32UI),r===t.BYTE&&(o=t.R8I),r===t.SHORT&&(o=t.R16I),r===t.INT&&(o=t.R32I)),i===t.RG&&(r===t.FLOAT&&(o=t.RG32F),r===t.HALF_FLOAT&&(o=t.RG16F),r===t.UNSIGNED_BYTE&&(o=t.RG8)),i===t.RG_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.RG8UI),r===t.UNSIGNED_SHORT&&(o=t.RG16UI),r===t.UNSIGNED_INT&&(o=t.RG32UI),r===t.BYTE&&(o=t.RG8I),r===t.SHORT&&(o=t.RG16I),r===t.INT&&(o=t.RG32I)),i===t.RGB_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.RGB8UI),r===t.UNSIGNED_SHORT&&(o=t.RGB16UI),r===t.UNSIGNED_INT&&(o=t.RGB32UI),r===t.BYTE&&(o=t.RGB8I),r===t.SHORT&&(o=t.RGB16I),r===t.INT&&(o=t.RGB32I)),i===t.RGBA_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.RGBA8UI),r===t.UNSIGNED_SHORT&&(o=t.RGBA16UI),r===t.UNSIGNED_INT&&(o=t.RGBA32UI),r===t.BYTE&&(o=t.RGBA8I),r===t.SHORT&&(o=t.RGBA16I),r===t.INT&&(o=t.RGBA32I)),i===t.RGB&&(r===t.UNSIGNED_INT_5_9_9_9_REV&&(o=t.RGB9_E5),r===t.UNSIGNED_INT_10F_11F_11F_REV&&(o=t.R11F_G11F_B10F)),i===t.RGBA){const e=a?YI:kD.getTransfer(s);r===t.FLOAT&&(o=t.RGBA32F),r===t.HALF_FLOAT&&(o=t.RGBA16F),r===t.UNSIGNED_BYTE&&(o=e===KI?t.SRGB8_ALPHA8:t.RGBA8),r===t.UNSIGNED_SHORT_4_4_4_4&&(o=t.RGBA4),r===t.UNSIGNED_SHORT_5_5_5_1&&(o=t.RGB5_A1)}return o!==t.R16F&&o!==t.R32F&&o!==t.RG16F&&o!==t.RG32F&&o!==t.RGBA16F&&o!==t.RGBA32F||e.get("EXT_color_buffer_float"),o}function x(e,n){let i;return e?null===n||n===VO||n===XO?i=t.DEPTH24_STENCIL8:n===HO?i=t.DEPTH32F_STENCIL8:n===BO&&(i=t.DEPTH24_STENCIL8):null===n||n===VO||n===XO?i=t.DEPTH_COMPONENT24:n===HO?i=t.DEPTH_COMPONENT32F:n===BO&&(i=t.DEPTH_COMPONENT16),i}function b(t,e){return!0===g(t)||t.isFramebufferTexture&&t.minFilter!==RO&&t.minFilter!==IO?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function M(t){const e=t.target;e.removeEventListener("dispose",M),function(t){const e=i.get(t);if(void 0===e.__webglInit)return;const n=t.source,r=d.get(n);if(r){const i=r[e.__cacheKey];i.usedTimes--,0===i.usedTimes&&S(t),0===Object.keys(r).length&&d.delete(n)}i.remove(t)}(e),e.isVideoTexture&&h.delete(e)}function w(e){const n=e.target;n.removeEventListener("dispose",w),function(e){const n=i.get(e);e.depthTexture&&(e.depthTexture.dispose(),i.remove(e.depthTexture));if(e.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let e=0;e<n.__webglFramebuffer[i].length;e++)t.deleteFramebuffer(n.__webglFramebuffer[i][e]);else t.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let e=0;e<n.__webglFramebuffer.length;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let e=0;e<n.__webglColorRenderbuffer.length;e++)n.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(n.__webglColorRenderbuffer[e]);n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=e.textures;for(let s=0,o=r.length;s<o;s++){const e=i.get(r[s]);e.__webglTexture&&(t.deleteTexture(e.__webglTexture),a.memory.textures--),i.remove(r[s])}i.remove(e)}(n)}function S(e){const n=i.get(e);t.deleteTexture(n.__webglTexture);const r=e.source;delete d.get(r)[n.__cacheKey],a.memory.textures--}let T=0;function E(e,r){const s=i.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;h.get(t)!==e&&(h.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&!0!==e.isExternalTexture&&e.version>0&&s.__version!==e.version){const t=e.image;if(null===t);else if(!1!==t.complete)return void D(s,e,r)}else e.isExternalTexture&&(s.__webglTexture=e.sourceTexture?e.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,s.__webglTexture,t.TEXTURE0+r)}const A={[EO]:t.REPEAT,[AO]:t.CLAMP_TO_EDGE,[CO]:t.MIRRORED_REPEAT},C={[RO]:t.NEAREST,[PO]:t.NEAREST_MIPMAP_NEAREST,[OO]:t.NEAREST_MIPMAP_LINEAR,[IO]:t.LINEAR,[DO]:t.LINEAR_MIPMAP_NEAREST,[LO]:t.LINEAR_MIPMAP_LINEAR},R={[$I]:t.NEVER,[rD]:t.ALWAYS,[JI]:t.LESS,[tD]:t.LEQUAL,[QI]:t.EQUAL,[iD]:t.GEQUAL,[eD]:t.GREATER,[nD]:t.NOTEQUAL};function P(n,s){if(s.type===HO&&!1===e.has("OES_texture_float_linear")&&(s.magFilter===IO||s.magFilter===DO||s.magFilter===OO||s.magFilter===LO||s.minFilter===IO||s.minFilter===DO||s.minFilter===OO||s.minFilter),t.texParameteri(n,t.TEXTURE_WRAP_S,A[s.wrapS]),t.texParameteri(n,t.TEXTURE_WRAP_T,A[s.wrapT]),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,A[s.wrapR]),t.texParameteri(n,t.TEXTURE_MAG_FILTER,C[s.magFilter]),t.texParameteri(n,t.TEXTURE_MIN_FILTER,C[s.minFilter]),s.compareFunction&&(t.texParameteri(n,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(n,t.TEXTURE_COMPARE_FUNC,R[s.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(s.magFilter===RO)return;if(s.minFilter!==OO&&s.minFilter!==LO)return;if(s.type===HO&&!1===e.has("OES_texture_float_linear"))return;if(s.anisotropy>1||i.get(s).__currentAnisotropy){const a=e.get("EXT_texture_filter_anisotropic");t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy}}}function O(e,n){let i=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",M));const r=n.source;let s=d.get(r);void 0===s&&(s={},d.set(r,s));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(n);if(o!==e.__cacheKey){void 0===s[o]&&(s[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;const r=s[e.__cacheKey];void 0!==r&&(s[e.__cacheKey].usedTimes--,0===r.usedTimes&&S(n)),e.__cacheKey=o,e.__webglTexture=s[o].texture}return i}function I(t,e,n){return Math.floor(Math.floor(t/n)/e)}function D(e,a,o){let l=t.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=t.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=t.TEXTURE_3D);const c=O(e,a),h=a.source;n.bindTexture(l,e.__webglTexture,t.TEXTURE0+o);const u=i.get(h);if(h.version!==u.__version||!0===c){n.activeTexture(t.TEXTURE0+o);const e=kD.getPrimaries(kD.workingColorSpace),i=a.colorSpace===GI?null:kD.getPrimaries(a.colorSpace),d=a.colorSpace===GI||e===i?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let p=m(a.image,!1,r.maxTextureSize);p=H(a,p);const f=s.convert(a.format,a.colorSpace),y=s.convert(a.type);let M,w=_(a.internalFormat,f,y,a.colorSpace,a.isVideoTexture);P(l,a);const S=a.mipmaps,T=!0!==a.isVideoTexture,E=void 0===u.__version||!0===c,A=h.dataReady,C=b(a,p);if(a.isDepthTexture)w=x(a.format===QO,a.type),E&&(T?n.texStorage2D(t.TEXTURE_2D,1,w,p.width,p.height):n.texImage2D(t.TEXTURE_2D,0,w,p.width,p.height,0,f,y,null));else if(a.isDataTexture)if(S.length>0){T&&E&&n.texStorage2D(t.TEXTURE_2D,C,w,S[0].width,S[0].height);for(let e=0,i=S.length;e<i;e++)M=S[e],T?A&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,M.width,M.height,f,y,M.data):n.texImage2D(t.TEXTURE_2D,e,w,M.width,M.height,0,f,y,M.data);a.generateMipmaps=!1}else T?(E&&n.texStorage2D(t.TEXTURE_2D,C,w,p.width,p.height),A&&function(e,i,r,s){const a=e.updateRanges;if(0===a.length)n.texSubImage2D(t.TEXTURE_2D,0,0,0,i.width,i.height,r,s,i.data);else{a.sort((t,e)=>t.start-e.start);let o=0;for(let t=1;t<a.length;t++){const e=a[o],n=a[t],r=e.start+e.count,s=I(n.start,i.width,4),l=I(e.start,i.width,4);n.start<=r+1&&s===l&&I(n.start+n.count-1,i.width,4)===s?e.count=Math.max(e.count,n.start+n.count-e.start):(++o,a[o]=n)}a.length=o+1;const l=t.getParameter(t.UNPACK_ROW_LENGTH),c=t.getParameter(t.UNPACK_SKIP_PIXELS),h=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,i.width);for(let e=0,u=a.length;e<u;e++){const o=a[e],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),h=l%i.width,u=Math.floor(l/i.width),d=c,p=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,h),t.pixelStorei(t.UNPACK_SKIP_ROWS,u),n.texSubImage2D(t.TEXTURE_2D,0,h,u,d,p,r,s,i.data)}e.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,l),t.pixelStorei(t.UNPACK_SKIP_PIXELS,c),t.pixelStorei(t.UNPACK_SKIP_ROWS,h)}}(a,p,f,y)):n.texImage2D(t.TEXTURE_2D,0,w,p.width,p.height,0,f,y,p.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){T&&E&&n.texStorage3D(t.TEXTURE_2D_ARRAY,C,w,S[0].width,S[0].height,p.depth);for(let e=0,i=S.length;e<i;e++)if(M=S[e],a.format!==$O){if(null!==f)if(T){if(A)if(a.layerUpdates.size>0){const i=pH(M.width,M.height,a.format,a.type);for(const r of a.layerUpdates){const s=M.data.subarray(r*i/M.data.BYTES_PER_ELEMENT,(r+1)*i/M.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,r,M.width,M.height,1,f,s)}a.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,M.width,M.height,p.depth,f,M.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,w,M.width,M.height,p.depth,0,M.data,0,0)}else T?A&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,M.width,M.height,p.depth,f,y,M.data):n.texImage3D(t.TEXTURE_2D_ARRAY,e,w,M.width,M.height,p.depth,0,f,y,M.data)}else{T&&E&&n.texStorage2D(t.TEXTURE_2D,C,w,S[0].width,S[0].height);for(let e=0,i=S.length;e<i;e++)M=S[e],a.format!==$O?null!==f&&(T?A&&n.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,M.width,M.height,f,M.data):n.compressedTexImage2D(t.TEXTURE_2D,e,w,M.width,M.height,0,M.data)):T?A&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,M.width,M.height,f,y,M.data):n.texImage2D(t.TEXTURE_2D,e,w,M.width,M.height,0,f,y,M.data)}else if(a.isDataArrayTexture)if(T){if(E&&n.texStorage3D(t.TEXTURE_2D_ARRAY,C,w,p.width,p.height,p.depth),A)if(a.layerUpdates.size>0){const e=pH(p.width,p.height,a.format,a.type);for(const i of a.layerUpdates){const r=p.data.subarray(i*e/p.data.BYTES_PER_ELEMENT,(i+1)*e/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,i,p.width,p.height,1,f,y,r)}a.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,f,y,p.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,w,p.width,p.height,p.depth,0,f,y,p.data);else if(a.isData3DTexture)T?(E&&n.texStorage3D(t.TEXTURE_3D,C,w,p.width,p.height,p.depth),A&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,f,y,p.data)):n.texImage3D(t.TEXTURE_3D,0,w,p.width,p.height,p.depth,0,f,y,p.data);else if(a.isFramebufferTexture){if(E)if(T)n.texStorage2D(t.TEXTURE_2D,C,w,p.width,p.height);else{let e=p.width,i=p.height;for(let r=0;r<C;r++)n.texImage2D(t.TEXTURE_2D,r,w,e,i,0,f,y,null),e>>=1,i>>=1}}else if(S.length>0){if(T&&E){const e=W(S[0]);n.texStorage2D(t.TEXTURE_2D,C,w,e.width,e.height)}for(let e=0,i=S.length;e<i;e++)M=S[e],T?A&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,f,y,M):n.texImage2D(t.TEXTURE_2D,e,w,f,y,M);a.generateMipmaps=!1}else if(T){if(E){const e=W(p);n.texStorage2D(t.TEXTURE_2D,C,w,e.width,e.height)}A&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,f,y,p)}else n.texImage2D(t.TEXTURE_2D,0,w,f,y,p);g(a)&&v(l),u.__version=h.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}function L(e,r,a,l,c,h){const u=s.convert(a.format,a.colorSpace),d=s.convert(a.type),p=_(a.internalFormat,u,d,a.colorSpace),f=i.get(r),m=i.get(a);if(m.__renderTarget=r,!f.__hasExternalTextures){const e=Math.max(1,r.width>>h),i=Math.max(1,r.height>>h);c===t.TEXTURE_3D||c===t.TEXTURE_2D_ARRAY?n.texImage3D(c,h,p,e,i,r.depth,0,u,d,null):n.texImage2D(c,h,p,e,i,0,u,d,null)}n.bindFramebuffer(t.FRAMEBUFFER,e),V(r)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,l,c,m.__webglTexture,0,z(r)):(c===t.TEXTURE_2D||c>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,l,c,m.__webglTexture,h),n.bindFramebuffer(t.FRAMEBUFFER,null)}function N(e,n,i){if(t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer){const r=n.depthTexture,s=r&&r.isDepthTexture?r.type:null,a=x(n.stencilBuffer,s),l=n.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,c=z(n);V(n)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,c,a,n.width,n.height):i?t.renderbufferStorageMultisample(t.RENDERBUFFER,c,a,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,a,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,l,t.RENDERBUFFER,e)}else{const e=n.textures;for(let r=0;r<e.length;r++){const a=e[r],l=s.convert(a.format,a.colorSpace),c=s.convert(a.type),h=_(a.internalFormat,l,c,a.colorSpace),u=z(n);i&&!1===V(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,u,h,n.width,n.height):V(n)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,u,h,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,h,n.width,n.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function U(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const s=i.get(r.depthTexture);s.__renderTarget=r,s.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),E(r.depthTexture,0);const a=s.__webglTexture,l=z(r);if(r.depthTexture.format===JO)V(r)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0);else{if(r.depthTexture.format!==QO)throw new Error("Unknown depthTexture format");V(r)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0)}}function F(e){const r=i.get(e),s=!0===e.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==e.depthTexture){const t=e.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),t){const e=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,t.removeEventListener("dispose",e)};t.addEventListener("dispose",e),r.__depthDisposeCallback=e}r.__boundDepthTexture=t}if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");const t=e.texture.mipmaps;t&&t.length>0?U(r.__webglFramebuffer[0],e):U(r.__webglFramebuffer,e)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=t.createRenderbuffer(),N(r.__webglDepthbuffer[i],e,!1);else{const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,s=r.__webglDepthbuffer[i];t.bindRenderbuffer(t.RENDERBUFFER,s),t.framebufferRenderbuffer(t.FRAMEBUFFER,n,t.RENDERBUFFER,s)}}else{const i=e.texture.mipmaps;if(i&&i.length>0?n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=t.createRenderbuffer(),N(r.__webglDepthbuffer,e,!1);else{const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,n,t.RENDERBUFFER,i)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}const k=[],B=[];function z(t){return Math.min(r.maxSamples,t.samples)}function V(t){const n=i.get(t);return t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function H(t,e){const n=t.colorSpace;t.format,t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||n!==qI&&n!==GI&&kD.getTransfer(n),e}function W(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?(c.width=t.naturalWidth||t.width,c.height=t.naturalHeight||t.height):"undefined"!=typeof VideoFrame&&t instanceof VideoFrame?(c.width=t.displayWidth,c.height=t.displayHeight):(c.width=t.width,c.height=t.height),c}this.allocateTextureUnit=function(){const t=T;return r.maxTextures,T+=1,t},this.resetTextureUnits=function(){T=0},this.setTexture2D=E,this.setTexture2DArray=function(e,r){const s=i.get(e);!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version?D(s,e,r):n.bindTexture(t.TEXTURE_2D_ARRAY,s.__webglTexture,t.TEXTURE0+r)},this.setTexture3D=function(e,r){const s=i.get(e);!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version?D(s,e,r):n.bindTexture(t.TEXTURE_3D,s.__webglTexture,t.TEXTURE0+r)},this.setTextureCube=function(e,a){const o=i.get(e);e.version>0&&o.__version!==e.version?function(e,a,o){if(6!==a.image.length)return;const l=O(e,a),c=a.source;n.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+o);const h=i.get(c);if(c.version!==h.__version||!0===l){n.activeTexture(t.TEXTURE0+o);const e=kD.getPrimaries(kD.workingColorSpace),i=a.colorSpace===GI?null:kD.getPrimaries(a.colorSpace),u=a.colorSpace===GI||e===i?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,u);const d=a.isCompressedTexture||a.image[0].isCompressedTexture,p=a.image[0]&&a.image[0].isDataTexture,f=[];for(let t=0;t<6;t++)f[t]=d||p?p?a.image[t].image:a.image[t]:m(a.image[t],!0,r.maxCubemapSize),f[t]=H(a,f[t]);const y=f[0],x=s.convert(a.format,a.colorSpace),M=s.convert(a.type),w=_(a.internalFormat,x,M,a.colorSpace),S=!0!==a.isVideoTexture,T=void 0===h.__version||!0===l,E=c.dataReady;let A,C=b(a,y);if(P(t.TEXTURE_CUBE_MAP,a),d){S&&T&&n.texStorage2D(t.TEXTURE_CUBE_MAP,C,w,y.width,y.height);for(let e=0;e<6;e++){A=f[e].mipmaps;for(let i=0;i<A.length;i++){const r=A[i];a.format!==$O?null!==x&&(S?E&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0,0,r.width,r.height,x,r.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,w,r.width,r.height,0,r.data)):S?E&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0,0,r.width,r.height,x,M,r.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,w,r.width,r.height,0,x,M,r.data)}}}else{if(A=a.mipmaps,S&&T){A.length>0&&C++;const e=W(f[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,C,w,e.width,e.height)}for(let e=0;e<6;e++)if(p){S?E&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,f[e].width,f[e].height,x,M,f[e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,w,f[e].width,f[e].height,0,x,M,f[e].data);for(let i=0;i<A.length;i++){const r=A[i].image[e].image;S?E&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,0,0,r.width,r.height,x,M,r.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,w,r.width,r.height,0,x,M,r.data)}}else{S?E&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,x,M,f[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,w,x,M,f[e]);for(let i=0;i<A.length;i++){const r=A[i];S?E&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,0,0,x,M,r.image[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,w,x,M,r.image[e])}}}g(a)&&v(t.TEXTURE_CUBE_MAP),h.__version=c.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}(o,e,a):n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture,t.TEXTURE0+a)},this.rebindTextures=function(e,n,r){const s=i.get(e);void 0!==n&&L(s.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==r&&F(e)},this.setupRenderTarget=function(e){const r=e.texture,o=i.get(e),l=i.get(r);e.addEventListener("dispose",w);const c=e.textures,h=!0===e.isWebGLCubeRenderTarget,u=c.length>1;if(u||(void 0===l.__webglTexture&&(l.__webglTexture=t.createTexture()),l.__version=r.version,a.memory.textures++),h){o.__webglFramebuffer=[];for(let e=0;e<6;e++)if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer[e]=[];for(let n=0;n<r.mipmaps.length;n++)o.__webglFramebuffer[e][n]=t.createFramebuffer()}else o.__webglFramebuffer[e]=t.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer=[];for(let e=0;e<r.mipmaps.length;e++)o.__webglFramebuffer[e]=t.createFramebuffer()}else o.__webglFramebuffer=t.createFramebuffer();if(u)for(let e=0,n=c.length;e<n;e++){const n=i.get(c[e]);void 0===n.__webglTexture&&(n.__webglTexture=t.createTexture(),a.memory.textures++)}if(e.samples>0&&!1===V(e)){o.__webglMultisampledFramebuffer=t.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const i=c[n];o.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const r=s.convert(i.format,i.colorSpace),a=s.convert(i.type),l=_(i.internalFormat,r,a,i.colorSpace,!0===e.isXRRenderTarget),h=z(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,h,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,o.__webglColorRenderbuffer[n])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(o.__webglDepthRenderbuffer=t.createRenderbuffer(),N(o.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(h){n.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture),P(t.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)L(o.__webglFramebuffer[n][i],e,r,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else L(o.__webglFramebuffer[n],e,r,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(r)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(u){for(let r=0,s=c.length;r<s;r++){const s=c[r],a=i.get(s);let l=t.TEXTURE_2D;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(l=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(l,a.__webglTexture),P(l,s),L(o.__webglFramebuffer,e,s,t.COLOR_ATTACHMENT0+r,l,0),g(s)&&v(l)}n.unbindTexture()}else{let i=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(i=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),P(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)L(o.__webglFramebuffer[n],e,r,t.COLOR_ATTACHMENT0,i,n);else L(o.__webglFramebuffer,e,r,t.COLOR_ATTACHMENT0,i,0);g(r)&&v(i),n.unbindTexture()}e.depthBuffer&&F(e)},this.updateRenderTargetMipmap=function(t){const e=t.textures;for(let r=0,s=e.length;r<s;r++){const s=e[r];if(g(s)){const e=y(t),r=i.get(s).__webglTexture;n.bindTexture(e,r),v(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.samples>0)if(!1===V(e)){const r=e.textures,s=e.width,a=e.height;let o=t.COLOR_BUFFER_BIT;const c=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,h=i.get(e),u=r.length>1;if(u)for(let e=0;e<r.length;e++)n.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,h.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,h.__webglMultisampledFramebuffer);const d=e.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglFramebuffer);for(let n=0;n<r.length;n++){if(e.resolveDepthBuffer&&(e.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&e.resolveStencilBuffer&&(o|=t.STENCIL_BUFFER_BIT)),u){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,h.__webglColorRenderbuffer[n]);const e=i.get(r[n]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,s,a,0,0,s,a,o,t.NEAREST),!0===l&&(k.length=0,B.length=0,k.push(t.COLOR_ATTACHMENT0+n),e.depthBuffer&&!1===e.resolveDepthBuffer&&(k.push(c),B.push(c),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,B)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,k))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),u)for(let e=0;e<r.length;e++){n.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,h.__webglColorRenderbuffer[e]);const s=i.get(r[e]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,h.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,s,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,h.__webglMultisampledFramebuffer)}else if(e.depthBuffer&&!1===e.resolveDepthBuffer&&l){const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=L,this.useMultisampledRTT=V}function Wj(t,e){return{convert:function(n,i=""){let r;const s=kD.getTransfer(i);if(n===UO)return t.UNSIGNED_BYTE;if(n===jO)return t.UNSIGNED_SHORT_4_4_4_4;if(n===GO)return t.UNSIGNED_SHORT_5_5_5_1;if(n===qO)return t.UNSIGNED_INT_5_9_9_9_REV;if(n===YO)return t.UNSIGNED_INT_10F_11F_11F_REV;if(n===FO)return t.BYTE;if(n===kO)return t.SHORT;if(n===BO)return t.UNSIGNED_SHORT;if(n===zO)return t.INT;if(n===VO)return t.UNSIGNED_INT;if(n===HO)return t.FLOAT;if(n===WO)return t.HALF_FLOAT;if(n===KO)return t.ALPHA;if(n===ZO)return t.RGB;if(n===$O)return t.RGBA;if(n===JO)return t.DEPTH_COMPONENT;if(n===QO)return t.DEPTH_STENCIL;if(n===tI)return t.RED;if(n===eI)return t.RED_INTEGER;if(n===nI)return t.RG;if(n===iI)return t.RG_INTEGER;if(n===rI)return t.RGBA_INTEGER;if(n===sI||n===aI||n===oI||n===lI)if(s===KI){if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===sI)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===aI)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===oI)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===lI)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=e.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===sI)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===aI)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===oI)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===lI)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===cI||n===hI||n===uI||n===dI){if(r=e.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===cI)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===hI)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===uI)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===dI)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===pI||n===fI||n===mI){if(r=e.get("WEBGL_compressed_texture_etc"),null===r)return null;if(n===pI||n===fI)return s===KI?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===mI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===gI||n===vI||n===yI||n===_I||n===xI||n===bI||n===MI||n===wI||n===SI||n===TI||n===EI||n===AI||n===CI||n===RI){if(r=e.get("WEBGL_compressed_texture_astc"),null===r)return null;if(n===gI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===vI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===yI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===_I)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===xI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===bI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===MI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===wI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===SI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===TI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===EI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===AI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===CI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===RI)return s===KI?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===PI||n===OI||n===II){if(r=e.get("EXT_texture_compression_bptc"),null===r)return null;if(n===PI)return s===KI?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===OI)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===II)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===DI||n===LI||n===NI||n===UI){if(r=e.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===DI)return r.COMPRESSED_RED_RGTC1_EXT;if(n===LI)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===NI)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===UI)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===XO?t.UNSIGNED_INT_24_8:void 0!==t[n]?t[n]:null}}}class jj{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e){if(null===this.texture){const n=new gk(t.texture);t.depthNear===e.depthNear&&t.depthFar===e.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}getMesh(t){if(null!==this.texture&&null===this.mesh){const e=t.cameras[0].viewport,n=new lU({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new eU(new IB(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Gj extends cD{constructor(t,e){super();const n=this;let i=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,h=null,u=null,d=null,p=null;const f="undefined"!=typeof XRWebGLBinding,m=new jj,g={},v=e.getContextAttributes();let y=null,_=null;const x=[],b=[],M=new bD;let w=null;const S=new pU;S.viewport=new KD;const T=new pU;T.viewport=new KD;const E=[S,T],A=new hV;let C=null,R=null;function P(t){const e=b.indexOf(t.inputSource);if(-1===e)return;const n=x[e];void 0!==n&&(n.update(t.inputSource,t.frame,l||s),n.dispatchEvent({type:t.type,data:t.inputSource}))}function O(){i.removeEventListener("select",P),i.removeEventListener("selectstart",P),i.removeEventListener("selectend",P),i.removeEventListener("squeeze",P),i.removeEventListener("squeezestart",P),i.removeEventListener("squeezeend",P),i.removeEventListener("end",O),i.removeEventListener("inputsourceschange",I);for(let t=0;t<x.length;t++){const e=b[t];null!==e&&(b[t]=null,x[t].disconnect(e))}C=null,R=null,m.reset();for(const t in g)delete g[t];t.setRenderTarget(y),d=null,u=null,h=null,i=null,_=null,F.stop(),n.isPresenting=!1,t.setPixelRatio(w),t.setSize(M.width,M.height,!1),n.dispatchEvent({type:"sessionend"})}function I(t){for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=b.indexOf(n);i>=0&&(b[i]=null,x[i].disconnect(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e];let i=b.indexOf(n);if(-1===i){for(let t=0;t<x.length;t++){if(t>=b.length){b.push(n),i=t;break}if(null===b[t]){b[t]=n,i=t;break}}if(-1===i)break}const r=x[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=x[t];return void 0===e&&(e=new xU,x[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=x[t];return void 0===e&&(e=new xU,x[t]=e),e.getGripSpace()},this.getHand=function(t){let e=x[t];return void 0===e&&(e=new xU,x[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,n.isPresenting},this.setReferenceSpaceType=function(t){a=t,n.isPresenting},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(t){l=t},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return null===h&&f&&(h=new XRWebGLBinding(i,e)),h},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){y=t.getRenderTarget(),i.addEventListener("select",P),i.addEventListener("selectstart",P),i.addEventListener("selectend",P),i.addEventListener("squeeze",P),i.addEventListener("squeezestart",P),i.addEventListener("squeezeend",P),i.addEventListener("end",O),i.addEventListener("inputsourceschange",I),!0!==v.xrCompatible&&await e.makeXRCompatible(),w=t.getPixelRatio(),t.getSize(M);if(f&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,s=null,a=null;v.depth&&(a=v.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,n=v.stencil?QO:JO,s=v.stencil?XO:VO);const o={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:r};h=this.getBinding(),u=h.createProjectionLayer(o),i.updateRenderState({layers:[u]}),t.setPixelRatio(1),t.setSize(u.textureWidth,u.textureHeight,!1),_=new $D(u.textureWidth,u.textureHeight,{format:$O,type:UO,depthTexture:new mk(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:t.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===u.ignoreDepthValues,resolveStencilBuffer:!1===u.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,e,n),i.updateRenderState({baseLayer:d}),t.setPixelRatio(1),t.setSize(d.framebufferWidth,d.framebufferHeight,!1),_=new $D(d.framebufferWidth,d.framebufferHeight,{format:$O,type:UO,colorSpace:t.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}_.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),F.setContext(i),F.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const D=new wD,L=new wD;function N(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;let e=t.near,n=t.far;null!==m.texture&&(m.depthNear>0&&(e=m.depthNear),m.depthFar>0&&(n=m.depthFar)),A.near=T.near=S.near=e,A.far=T.far=S.far=n,C===A.near&&R===A.far||(i.updateRenderState({depthNear:A.near,depthFar:A.far}),C=A.near,R=A.far),A.layers.mask=6|t.layers.mask,S.layers.mask=3&A.layers.mask,T.layers.mask=5&A.layers.mask;const r=t.parent,s=A.cameras;N(A,r);for(let i=0;i<s.length;i++)N(s[i],r);2===s.length?function(t,e,n){D.setFromMatrixPosition(e.matrixWorld),L.setFromMatrixPosition(n.matrixWorld);const i=D.distanceTo(L),r=e.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],h=(r[8]-1)/r[0],u=(s[8]+1)/s[0],d=a*h,p=a*u,f=i/(-h+u),m=f*-h;if(e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert(),-1===r[10])t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const e=a+f,n=o+f,r=d-m,s=p+(i-m),h=l*o/n*e,u=c*o/n*e;t.projectionMatrix.makePerspective(r,s,h,u,e,n),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}}(A,S,T):A.projectionMatrix.copy(S.projectionMatrix),function(t,e,n){null===n?t.matrix.copy(e.matrixWorld):(t.matrix.copy(n.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*pD*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,A,r)},this.getCamera=function(){return A},this.getFoveation=function(){if(null!==u||null!==d)return o},this.setFoveation=function(t){o=t,null!==u&&(u.fixedFoveation=t),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=t)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(A)},this.getCameraTexture=function(t){return g[t]};let U=null;const F=new fH;F.setAnimationLoop(function(e,r){if(c=r.getViewerPose(l||s),p=r,null!==c){const e=c.views;null!==d&&(t.setRenderTargetFramebuffer(_,d.framebuffer),t.setRenderTarget(_));let r=!1;e.length!==A.cameras.length&&(A.cameras.length=0,r=!0);for(let n=0;n<e.length;n++){const i=e[n];let s=null;if(null!==d)s=d.getViewport(i);else{const e=h.getViewSubImage(u,i);s=e.viewport,0===n&&(t.setRenderTargetTextures(_,e.colorTexture,e.depthStencilTexture),t.setRenderTarget(_))}let a=E[n];void 0===a&&(a=new pU,a.layers.enable(n),a.viewport=new KD,E[n]=a),a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(i.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===n&&(A.matrix.copy(a.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),!0===r&&A.cameras.push(a)}const s=i.enabledFeatures;if(s&&s.includes("depth-sensing")&&"gpu-optimized"==i.depthUsage&&f){h=n.getBinding();const t=h.getDepthInformation(e[0]);t&&t.isValid&&t.texture&&m.init(t,i.renderState)}if(s&&s.includes("camera-access")&&f){t.state.unbindTexture(),h=n.getBinding();for(let t=0;t<e.length;t++){const n=e[t].camera;if(n){let t=g[n];t||(t=new gk,g[n]=t);const e=h.getCameraImage(n);t.sourceTexture=e}}}}for(let t=0;t<x.length;t++){const e=b[t],n=x[t];null!==e&&void 0!==n&&n.update(e,r,l||s)}U&&U(e,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),p=null}),this.setAnimationLoop=function(t){U=t},this.dispose=function(){}}}const Xj=new FL,qj=new AL;function Yj(t,e){function n(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function i(t,i){t.opacity.value=i.opacity,i.color&&t.diffuse.value.copy(i.color),i.emissive&&t.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(t.map.value=i.map,n(i.map,t.mapTransform)),i.alphaMap&&(t.alphaMap.value=i.alphaMap,n(i.alphaMap,t.alphaMapTransform)),i.bumpMap&&(t.bumpMap.value=i.bumpMap,n(i.bumpMap,t.bumpMapTransform),t.bumpScale.value=i.bumpScale,1===i.side&&(t.bumpScale.value*=-1)),i.normalMap&&(t.normalMap.value=i.normalMap,n(i.normalMap,t.normalMapTransform),t.normalScale.value.copy(i.normalScale),1===i.side&&t.normalScale.value.negate()),i.displacementMap&&(t.displacementMap.value=i.displacementMap,n(i.displacementMap,t.displacementMapTransform),t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias),i.emissiveMap&&(t.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,t.emissiveMapTransform)),i.specularMap&&(t.specularMap.value=i.specularMap,n(i.specularMap,t.specularMapTransform)),i.alphaTest>0&&(t.alphaTest.value=i.alphaTest);const r=e.get(i),s=r.envMap,a=r.envMapRotation;s&&(t.envMap.value=s,Xj.copy(a),Xj.x*=-1,Xj.y*=-1,Xj.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(Xj.y*=-1,Xj.z*=-1),t.envMapRotation.value.setFromMatrix4(qj.makeRotationFromEuler(Xj)),t.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,t.reflectivity.value=i.reflectivity,t.ior.value=i.ior,t.refractionRatio.value=i.refractionRatio),i.lightMap&&(t.lightMap.value=i.lightMap,t.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,t.lightMapTransform)),i.aoMap&&(t.aoMap.value=i.aoMap,t.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,t.aoMapTransform))}return{refreshFogUniforms:function(e,n){n.color.getRGB(e.fogColor.value,aU(t)),n.isFog?(e.fogNear.value=n.near,e.fogFar.value=n.far):n.isFogExp2&&(e.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(t,r):r.isMeshToonMaterial?(i(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,r)):r.isMeshPhongMaterial?(i(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,r)):r.isMeshStandardMaterial?(i(t,r),function(t,e){t.metalness.value=e.metalness,e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap,n(e.metalnessMap,t.metalnessMapTransform));t.roughness.value=e.roughness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap,n(e.roughnessMap,t.roughnessMapTransform));e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}(t,r),r.isMeshPhysicalMaterial&&function(t,e,i){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,n(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,n(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,n(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,n(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,n(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),1===e.side&&t.clearcoatNormalScale.value.negate()));e.dispersion>0&&(t.dispersion.value=e.dispersion);e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,n(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,n(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,n(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,n(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,n(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,n(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,n(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,r,o)):r.isMeshMatcapMaterial?(i(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,r)):r.isMeshDepthMaterial?i(t,r):r.isMeshDistanceMaterial?(i(t,r),function(t,n){const i=e.get(n).light;t.referencePosition.value.setFromMatrixPosition(i.matrixWorld),t.nearDistance.value=i.shadow.camera.near,t.farDistance.value=i.shadow.camera.far}(t,r)):r.isMeshNormalMaterial?i(t,r):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform))}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,i,r){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*i,t.scale.value=.5*r,e.map&&(t.map.value=e.map,n(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r,s,a):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Kj(t,e,n,i){let r={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(t,e,n,i){const r=t.value,s=e+"_"+n;if(void 0===i[s])return i[s]="number"==typeof r||"boolean"==typeof r?r:r.clone(),!0;{const t=i[s];if("number"==typeof r||"boolean"==typeof r){if(t!==r)return i[s]=r,!0}else if(!1===t.equals(r))return t.copy(r),!0}return!1}function c(t){const e={boundary:0,storage:0};return"number"==typeof t||"boolean"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture,e}function h(e){const n=e.target;n.removeEventListener("dispose",h);const i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),t.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(t,e){const n=e.program;i.uniformBlockBinding(t,n)},update:function(n,u){let d=r[n.id];void 0===d&&(!function(t){const e=t.uniforms;let n=0;const i=16;for(let s=0,a=e.length;s<a;s++){const t=Array.isArray(e[s])?e[s]:[e[s]];for(let e=0,r=t.length;e<r;e++){const r=t[e],s=Array.isArray(r.value)?r.value:[r.value];for(let t=0,e=s.length;t<e;t++){const e=c(s[t]),a=n%i,o=a%e.boundary,l=a+o;n+=o,0!==l&&i-l<e.storage&&(n+=i-l),r.__data=new Float32Array(e.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=e.storage}}}const r=n%i;r>0&&(n+=i-r);t.__size=n,t.__cache={}}(n),d=function(e){const n=function(){for(let t=0;t<o;t++)if(-1===a.indexOf(t))return a.push(t),t;return 0}();e.__bindingPointIndex=n;const i=t.createBuffer(),r=e.__size,s=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,i),t.bufferData(t.UNIFORM_BUFFER,r,s),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",h));const p=u.program;i.updateUBOMapping(n,p);const f=e.render.frame;s[n.id]!==f&&(!function(e){const n=r[e.id],i=e.uniforms,s=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,n);for(let r=0,a=i.length;r<a;r++){const e=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!0===l(i,r,n,s)){const e=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const a=n[s],o=c(a);"number"==typeof a||"boolean"==typeof a?(i.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=0,i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=0,i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=0):(a.toArray(i.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,i.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(n),s[n.id]=f)},dispose:function(){for(const e in r)t.deleteBuffer(r[e]);a=[],r={},s={}}}}class Zj{constructor(t={}){const{canvas:e=ID(),context:n=null,depth:i=!0,stencil:r=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reversedDepthBuffer:u=!1}=t;let d;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=s;const p=new Uint32Array(4),f=new Int32Array(4);let m=null,g=null;const v=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const _=this;let x=!1;this._outputColorSpace=XI;let b=0,M=0,w=null,S=-1,T=null;const E=new KD,A=new KD;let C=null;const R=new _N(0);let P=0,O=e.width,I=e.height,D=1,L=null,N=null;const U=new KD(0,0,O,I),F=new KD(0,0,O,I);let k=!1;const B=new wF;let z=!1,V=!1;const H=new AL,W=new wD,j=new KD,G={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let X=!1;function q(){return null===w?D:1}let Y,K,Z,$,J,Q,tt,et,nt,it,rt,st,at,ot,lt,ct,ht,ut,dt,pt,ft,mt,gt,vt,yt=n;function _t(t,n){return e.getContext(t,n)}try{const t={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${IP}`),e.addEventListener("webglcontextlost",Mt,!1),e.addEventListener("webglcontextrestored",wt,!1),e.addEventListener("webglcontextcreationerror",St,!1),null===yt){const e="webgl2";if(yt=_t(e,t),null===yt)throw _t(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ht){throw Ht}function xt(){Y=new qH(yt),Y.init(),mt=new Wj(yt,Y),K=new TH(yt,Y,t,mt),Z=new Vj(yt,Y),K.reversedDepthBuffer&&u&&Z.buffers.depth.setReversed(!0),$=new ZH(yt),J=new Cj,Q=new Hj(yt,Y,Z,J,K,mt,$),tt=new AH(_),et=new XH(_),nt=new mH(yt),gt=new wH(yt,nt),it=new YH(yt,nt,$,gt),rt=new JH(yt,it,nt,$),dt=new $H(yt,K,Q),ct=new EH(J),st=new Aj(_,tt,et,Y,K,gt,ct),at=new Yj(_,J),ot=new Ij,lt=new kj(Y),ut=new MH(_,tt,et,Z,rt,d,o),ht=new Bj(_,rt,K),vt=new Kj(yt,$,K,Z),pt=new SH(yt,Y,$),ft=new KH(yt,Y,$),$.programs=st.programs,_.capabilities=K,_.extensions=Y,_.properties=J,_.renderLists=ot,_.shadowMap=ht,_.state=Z,_.info=$}xt();const bt=new Gj(_,yt);function Mt(t){t.preventDefault(),x=!0}function wt(){x=!1;const t=$.autoReset,e=ht.enabled,n=ht.autoUpdate,i=ht.needsUpdate,r=ht.type;xt(),$.autoReset=t,ht.enabled=e,ht.autoUpdate=n,ht.needsUpdate=i,ht.type=r}function St(t){}function Tt(t){const e=t.target;e.removeEventListener("dispose",Tt),function(t){(function(t){const e=J.get(t).programs;void 0!==e&&(e.forEach(function(t){st.releaseProgram(t)}),t.isShaderMaterial&&st.releaseShaderCache(t))})(t),J.remove(t)}(e)}function Et(t,e,n){!0===t.transparent&&2===t.side&&!1===t.forceSinglePass?(t.side=1,t.needsUpdate=!0,Ut(t,e,n),t.side=0,t.needsUpdate=!0,Ut(t,e,n),t.side=2):Ut(t,e,n)}this.xr=bt,this.getContext=function(){return yt},this.getContextAttributes=function(){return yt.getContextAttributes()},this.forceContextLoss=function(){const t=Y.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=Y.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(t){void 0!==t&&(D=t,this.setSize(O,I,!1))},this.getSize=function(t){return t.set(O,I)},this.setSize=function(t,n,i=!0){bt.isPresenting||(O=t,I=n,e.width=Math.floor(t*D),e.height=Math.floor(n*D),!0===i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(O*D,I*D).floor()},this.setDrawingBufferSize=function(t,n,i){O=t,I=n,D=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(E)},this.getViewport=function(t){return t.copy(U)},this.setViewport=function(t,e,n,i){t.isVector4?U.set(t.x,t.y,t.z,t.w):U.set(t,e,n,i),Z.viewport(E.copy(U).multiplyScalar(D).round())},this.getScissor=function(t){return t.copy(F)},this.setScissor=function(t,e,n,i){t.isVector4?F.set(t.x,t.y,t.z,t.w):F.set(t,e,n,i),Z.scissor(A.copy(F).multiplyScalar(D).round())},this.getScissorTest=function(){return k},this.setScissorTest=function(t){Z.setScissorTest(k=t)},this.setOpaqueSort=function(t){L=t},this.setTransparentSort=function(t){N=t},this.getClearColor=function(t){return t.copy(ut.getClearColor())},this.setClearColor=function(){ut.setClearColor(...arguments)},this.getClearAlpha=function(){return ut.getClearAlpha()},this.setClearAlpha=function(){ut.setClearAlpha(...arguments)},this.clear=function(t=!0,e=!0,n=!0){let i=0;if(t){let t=!1;if(null!==w){const e=w.texture.format;t=e===rI||e===iI||e===eI}if(t){const t=w.texture.type,e=t===UO||t===VO||t===BO||t===XO||t===jO||t===GO,n=ut.getClearColor(),i=ut.getClearAlpha(),r=n.r,s=n.g,a=n.b;e?(p[0]=r,p[1]=s,p[2]=a,p[3]=i,yt.clearBufferuiv(yt.COLOR,0,p)):(f[0]=r,f[1]=s,f[2]=a,f[3]=i,yt.clearBufferiv(yt.COLOR,0,f))}else i|=yt.COLOR_BUFFER_BIT}e&&(i|=yt.DEPTH_BUFFER_BIT),n&&(i|=yt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),yt.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Mt,!1),e.removeEventListener("webglcontextrestored",wt,!1),e.removeEventListener("webglcontextcreationerror",St,!1),ut.dispose(),ot.dispose(),lt.dispose(),J.dispose(),tt.dispose(),et.dispose(),rt.dispose(),gt.dispose(),vt.dispose(),st.dispose(),bt.dispose(),bt.removeEventListener("sessionstart",Ct),bt.removeEventListener("sessionend",Rt),Pt.stop()},this.renderBufferDirect=function(t,e,n,i,r,s){null===e&&(e=G);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(t,e,n,i,r){!0!==e.isScene&&(e=G);Q.resetTextureUnits();const s=e.fog,a=i.isMeshStandardMaterial?e.environment:null,o=null===w?_.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:qI,l=(i.isMeshStandardMaterial?et:tt).get(i.envMap||a),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,h=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),u=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let f=0;i.toneMapped&&(null!==w&&!0!==w.isXRRenderTarget||(f=_.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,y=J.get(i),x=g.state.lights;if(!0===z&&(!0===V||t!==T)){const e=t===T&&i.id===S;ct.setState(i,t,e)}let b=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==x.state.version||y.outputColorSpace!==o||r.isBatchedMesh&&!1===y.batching?b=!0:r.isBatchedMesh||!0!==y.batching?r.isBatchedMesh&&!0===y.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===y.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===y.instancing?b=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?b=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===y.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===y.instancingMorph&&null!==r.morphTexture||y.envMap!==l||!0===i.fog&&y.fog!==s?b=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===ct.numPlanes&&y.numIntersection===ct.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==h||y.morphTargets!==u||y.morphNormals!==d||y.morphColors!==p||y.toneMapping!==f||y.morphTargetsCount!==v)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,y.__version=i.version);let M=y.currentProgram;!0===b&&(M=Ut(i,e,r));let E=!1,A=!1,C=!1;const R=M.getUniforms(),P=y.uniforms;Z.useProgram(M.program)&&(E=!0,A=!0,C=!0);i.id!==S&&(S=i.id,A=!0);if(E||T!==t){Z.buffers.depth.getReversed()&&!0!==t.reversedDepth&&(t._reversedDepth=!0,t.updateProjectionMatrix()),R.setValue(yt,"projectionMatrix",t.projectionMatrix),R.setValue(yt,"viewMatrix",t.matrixWorldInverse);const e=R.map.cameraPosition;void 0!==e&&e.setValue(yt,W.setFromMatrixPosition(t.matrixWorld)),K.logarithmicDepthBuffer&&R.setValue(yt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(yt,"isOrthographic",!0===t.isOrthographicCamera),T!==t&&(T=t,A=!0,C=!0)}if(r.isSkinnedMesh){R.setOptional(yt,r,"bindMatrix"),R.setOptional(yt,r,"bindMatrixInverse");const t=r.skeleton;t&&(null===t.boneTexture&&t.computeBoneTexture(),R.setValue(yt,"boneTexture",t.boneTexture,Q))}r.isBatchedMesh&&(R.setOptional(yt,r,"batchingTexture"),R.setValue(yt,"batchingTexture",r._matricesTexture,Q),R.setOptional(yt,r,"batchingIdTexture"),R.setValue(yt,"batchingIdTexture",r._indirectTexture,Q),R.setOptional(yt,r,"batchingColorTexture"),null!==r._colorsTexture&&R.setValue(yt,"batchingColorTexture",r._colorsTexture,Q));const O=n.morphAttributes;void 0===O.position&&void 0===O.normal&&void 0===O.color||dt.update(r,n,M);(A||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,R.setValue(yt,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(P.envMap.value=l,P.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==e.environment&&(P.envMapIntensity.value=e.environmentIntensity);A&&(R.setValue(yt,"toneMappingExposure",_.toneMappingExposure),y.needsLights&&(N=C,(L=P).ambientLightColor.needsUpdate=N,L.lightProbe.needsUpdate=N,L.directionalLights.needsUpdate=N,L.directionalLightShadows.needsUpdate=N,L.pointLights.needsUpdate=N,L.pointLightShadows.needsUpdate=N,L.spotLights.needsUpdate=N,L.spotLightShadows.needsUpdate=N,L.rectAreaLights.needsUpdate=N,L.hemisphereLights.needsUpdate=N),s&&!0===i.fog&&at.refreshFogUniforms(P,s),at.refreshMaterialUniforms(P,i,D,I,g.state.transmissionRenderTarget[t.id]),ij.upload(yt,Ft(y),P,Q));var L,N;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(ij.upload(yt,Ft(y),P,Q),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(yt,"center",r.center);if(R.setValue(yt,"modelViewMatrix",r.modelViewMatrix),R.setValue(yt,"normalMatrix",r.normalMatrix),R.setValue(yt,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const t=i.uniformsGroups;for(let e=0,n=t.length;e<n;e++){const n=t[e];vt.update(n,M),vt.bind(n,M)}}return M}(t,e,n,i,r);Z.setMaterial(i,a);let l=n.index,c=1;if(!0===i.wireframe){if(l=it.getWireframeAttribute(n),void 0===l)return;c=2}const h=n.drawRange,u=n.attributes.position;let d=h.start*c,p=(h.start+h.count)*c;null!==s&&(d=Math.max(d,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):null!=u&&(d=Math.max(d,0),p=Math.min(p,u.count));const f=p-d;if(f<0||f===1/0)return;let m;gt.setup(r,i,o,n,l);let v=pt;if(null!==l&&(m=nt.get(l),v=ft,v.setIndex(m)),r.isMesh)!0===i.wireframe?(Z.setLineWidth(i.wireframeLinewidth*q()),v.setMode(yt.LINES)):v.setMode(yt.TRIANGLES);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),Z.setLineWidth(t*q()),r.isLineSegments?v.setMode(yt.LINES):r.isLineLoop?v.setMode(yt.LINE_LOOP):v.setMode(yt.LINE_STRIP)}else r.isPoints?v.setMode(yt.POINTS):r.isSprite&&v.setMode(yt.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)LD("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(Y.get("WEBGL_multi_draw"))v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const t=r._multiDrawStarts,e=r._multiDrawCounts,n=r._multiDrawCount,s=l?nt.get(l).bytesPerElement:1,a=J.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)a.setValue(yt,"_gl_DrawID",i),v.render(t[i]/s,e[i])}else if(r.isInstancedMesh)v.renderInstances(d,f,r.count);else if(n.isInstancedBufferGeometry){const t=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,e=Math.min(n.instanceCount,t);v.renderInstances(d,f,e)}else v.render(d,f)},this.compile=function(t,e,n=null){null===n&&(n=t),g=lt.get(n),g.init(e),y.push(g),n.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(g.pushLight(t),t.castShadow&&g.pushShadow(t))}),t!==n&&t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(g.pushLight(t),t.castShadow&&g.pushShadow(t))}),g.setupLights();const i=new Set;return t.traverse(function(t){if(!(t.isMesh||t.isPoints||t.isLine||t.isSprite))return;const e=t.material;if(e)if(Array.isArray(e))for(let r=0;r<e.length;r++){const s=e[r];Et(s,n,t),i.add(s)}else Et(e,n,t),i.add(e)}),g=y.pop(),i},this.compileAsync=function(t,e,n=null){const i=this.compile(t,e,n);return new Promise(e=>{function n(){i.forEach(function(t){J.get(t).currentProgram.isReady()&&i.delete(t)}),0!==i.size?setTimeout(n,10):e(t)}null!==Y.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let At=null;function Ct(){Pt.stop()}function Rt(){Pt.start()}const Pt=new fH;function Ot(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)g.pushLight(t),t.castShadow&&g.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||B.intersectsSprite(t)){i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(H);const e=rt.update(t),r=t.material;r.visible&&m.push(t,e,r,n,j.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||B.intersectsObject(t))){const e=rt.update(t),r=t.material;if(i&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),j.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),j.copy(e.boundingSphere.center)),j.applyMatrix4(t.matrixWorld).applyMatrix4(H)),Array.isArray(r)){const i=e.groups;for(let s=0,a=i.length;s<a;s++){const a=i[s],o=r[a.materialIndex];o&&o.visible&&m.push(t,e,o,n,j.z,a)}}else r.visible&&m.push(t,e,r,n,j.z,null)}const r=t.children;for(let s=0,a=r.length;s<a;s++)Ot(r[s],e,n,i)}function It(t,e,n,i){const r=t.opaque,s=t.transmissive,a=t.transparent;g.setupLightsView(n),!0===z&&ct.setGlobalState(_.clippingPlanes,n),i&&Z.viewport(E.copy(i)),r.length>0&&Lt(r,e,n),s.length>0&&Lt(s,e,n),a.length>0&&Lt(a,e,n),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1)}function Dt(t,e,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===g.state.transmissionRenderTarget[i.id]&&(g.state.transmissionRenderTarget[i.id]=new $D(1,1,{generateMipmaps:!0,type:Y.has("EXT_color_buffer_half_float")||Y.has("EXT_color_buffer_float")?WO:UO,minFilter:LO,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:kD.workingColorSpace}));const s=g.state.transmissionRenderTarget[i.id],a=i.viewport||E;s.setSize(a.z*_.transmissionResolutionScale,a.w*_.transmissionResolutionScale);const o=_.getRenderTarget(),l=_.getActiveCubeFace(),c=_.getActiveMipmapLevel();_.setRenderTarget(s),_.getClearColor(R),P=_.getClearAlpha(),P<1&&_.setClearColor(16777215,.5),_.clear(),X&&ut.render(n);const h=_.toneMapping;_.toneMapping=0;const u=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),g.setupLightsView(i),!0===z&&ct.setGlobalState(_.clippingPlanes,i),Lt(t,n,i),Q.updateMultisampleRenderTarget(s),Q.updateRenderTargetMipmap(s),!1===Y.has("WEBGL_multisampled_render_to_texture")){let t=!1;for(let r=0,s=e.length;r<s;r++){const s=e[r],a=s.object,o=s.geometry,l=s.material,c=s.group;if(2===l.side&&a.layers.test(i.layers)){const e=l.side;l.side=1,l.needsUpdate=!0,Nt(a,n,i,o,l,c),l.side=e,l.needsUpdate=!0,t=!0}}!0===t&&(Q.updateMultisampleRenderTarget(s),Q.updateRenderTargetMipmap(s))}_.setRenderTarget(o,l,c),_.setClearColor(R,P),void 0!==u&&(i.viewport=u),_.toneMapping=h}function Lt(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],a=s.object,o=s.geometry,l=s.group;let c=s.material;!0===c.allowOverride&&null!==i&&(c=i),a.layers.test(n.layers)&&Nt(a,e,n,o,c,l)}}function Nt(t,e,n,i,r,s){t.onBeforeRender(_,e,n,i,r,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(_,e,n,i,t,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,_.renderBufferDirect(n,e,i,r,t,s),r.side=0,r.needsUpdate=!0,_.renderBufferDirect(n,e,i,r,t,s),r.side=2):_.renderBufferDirect(n,e,i,r,t,s),t.onAfterRender(_,e,n,i,r,s)}function Ut(t,e,n){!0!==e.isScene&&(e=G);const i=J.get(t),r=g.state.lights,s=g.state.shadowsArray,a=r.state.version,o=st.getParameters(t,r.state,s,e,n),l=st.getProgramCacheKey(o);let c=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?et:tt).get(t.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===t.envMap?e.environmentRotation:t.envMapRotation,void 0===c&&(t.addEventListener("dispose",Tt),c=new Map,i.programs=c);let h=c.get(l);if(void 0!==h){if(i.currentProgram===h&&i.lightsStateVersion===a)return kt(t,o),h}else o.uniforms=st.getUniforms(t),t.onBeforeCompile(o,_),h=st.acquireProgram(o,l),c.set(l,h),i.uniforms=o.uniforms;const u=i.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=ct.uniform),kt(t,o),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=a,i.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotLightMatrix.value=r.state.spotLightMatrix,u.spotLightMap.value=r.state.spotLightMap,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=h,i.uniformsList=null,h}function Ft(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=ij.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function kt(t,e){const n=J.get(t);n.outputColorSpace=e.outputColorSpace,n.batching=e.batching,n.batchingColor=e.batchingColor,n.instancing=e.instancing,n.instancingColor=e.instancingColor,n.instancingMorph=e.instancingMorph,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}Pt.setAnimationLoop(function(t){At&&At(t)}),"undefined"!=typeof self&&Pt.setContext(self),this.setAnimationLoop=function(t){At=t,bt.setAnimationLoop(t),null===t?Pt.stop():Pt.start()},bt.addEventListener("sessionstart",Ct),bt.addEventListener("sessionend",Rt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return;if(!0===x)return;if(!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===bt.enabled&&!0===bt.isPresenting&&(!0===bt.cameraAutoUpdate&&bt.updateCamera(e),e=bt.getCamera()),!0===t.isScene&&t.onBeforeRender(_,t,e,w),g=lt.get(t,y.length),g.init(e),y.push(g),H.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),B.setFromProjectionMatrix(H,oD,e.reversedDepth),V=this.localClippingEnabled,z=ct.init(this.clippingPlanes,V),m=ot.get(t,v.length),m.init(),v.push(m),!0===bt.enabled&&!0===bt.isPresenting){const t=_.xr.getDepthSensingMesh();null!==t&&Ot(t,e,-1/0,_.sortObjects)}Ot(t,e,0,_.sortObjects),m.finish(),!0===_.sortObjects&&m.sort(L,N),X=!1===bt.enabled||!1===bt.isPresenting||!1===bt.hasDepthSensing(),X&&ut.addToRenderList(m,t),this.info.render.frame++,!0===z&&ct.beginShadows();const n=g.state.shadowsArray;ht.render(n,t,e),!0===z&&ct.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=m.opaque,r=m.transmissive;if(g.setupLights(),e.isArrayCamera){const n=e.cameras;if(r.length>0)for(let e=0,s=n.length;e<s;e++){Dt(i,r,t,n[e])}X&&ut.render(t);for(let e=0,i=n.length;e<i;e++){const i=n[e];It(m,t,i,i.viewport)}}else r.length>0&&Dt(i,r,t,e),X&&ut.render(t),It(m,t,e);null!==w&&0===M&&(Q.updateMultisampleRenderTarget(w),Q.updateRenderTargetMipmap(w)),!0===t.isScene&&t.onAfterRender(_,t,e),gt.resetDefaultState(),S=-1,T=null,y.pop(),y.length>0?(g=y[y.length-1],!0===z&&ct.setGlobalState(_.clippingPlanes,g.state.camera)):g=null,v.pop(),m=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(t,e,n){const i=J.get(t);i.__autoAllocateDepthBuffer=!1===t.resolveDepthBuffer,!1===i.__autoAllocateDepthBuffer&&(i.__useRenderToTexture=!1),J.get(t.texture).__webglTexture=e,J.get(t.depthTexture).__webglTexture=i.__autoAllocateDepthBuffer?void 0:n,i.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(t,e){const n=J.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e};const Bt=yt.createFramebuffer();this.setRenderTarget=function(t,e=0,n=0){w=t,b=e,M=n;let i=!0,r=null,s=!1,a=!1;if(t){const o=J.get(t);if(void 0!==o.__useDefaultFramebuffer)Z.bindFramebuffer(yt.FRAMEBUFFER,null),i=!1;else if(void 0===o.__webglFramebuffer)Q.setupRenderTarget(t);else if(o.__hasExternalTextures)Q.rebindTextures(t,J.get(t.texture).__webglTexture,J.get(t.depthTexture).__webglTexture);else if(t.depthBuffer){const e=t.depthTexture;if(o.__boundDepthTexture!==e){if(null!==e&&J.has(e)&&(t.width!==e.image.width||t.height!==e.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Q.setupDepthRenderbuffer(t)}}const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=J.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=Array.isArray(c[e])?c[e][n]:c[e],s=!0):r=t.samples>0&&!1===Q.useMultisampledRTT(t)?J.get(t).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,E.copy(t.viewport),A.copy(t.scissor),C=t.scissorTest}else E.copy(U).multiplyScalar(D).floor(),A.copy(F).multiplyScalar(D).floor(),C=k;0!==n&&(r=Bt);if(Z.bindFramebuffer(yt.FRAMEBUFFER,r)&&i&&Z.drawBuffers(t,r),Z.viewport(E),Z.scissor(A),Z.setScissorTest(C),s){const i=J.get(t.texture);yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_CUBE_MAP_POSITIVE_X+e,i.__webglTexture,n)}else if(a){const i=e;for(let e=0;e<t.textures.length;e++){const r=J.get(t.textures[e]);yt.framebufferTextureLayer(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0+e,r.__webglTexture,n,i)}}else if(null!==t&&0!==n){const e=J.get(t.texture);yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,e.__webglTexture,n)}S=-1},this.readRenderTargetPixels=function(t,e,n,i,r,s,a,o=0){if(!t||!t.isWebGLRenderTarget)return;let l=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){Z.bindFramebuffer(yt.FRAMEBUFFER,l);try{const a=t.textures[o],l=a.format,c=a.type;if(!K.textureFormatReadable(l))return;if(!K.textureTypeReadable(c))return;e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&(t.textures.length>1&&yt.readBuffer(yt.COLOR_ATTACHMENT0+o),yt.readPixels(e,n,i,r,mt.convert(l),mt.convert(c),s))}finally{const t=null!==w?J.get(w).__webglFramebuffer:null;Z.bindFramebuffer(yt.FRAMEBUFFER,t)}}},this.readRenderTargetPixelsAsync=async function(t,e,n,i,r,s,a,o=0){if(!t||!t.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){if(e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r){Z.bindFramebuffer(yt.FRAMEBUFFER,l);const a=t.textures[o],c=a.format,h=a.type;if(!K.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!K.textureTypeReadable(h))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const u=yt.createBuffer();yt.bindBuffer(yt.PIXEL_PACK_BUFFER,u),yt.bufferData(yt.PIXEL_PACK_BUFFER,s.byteLength,yt.STREAM_READ),t.textures.length>1&&yt.readBuffer(yt.COLOR_ATTACHMENT0+o),yt.readPixels(e,n,i,r,mt.convert(c),mt.convert(h),0);const d=null!==w?J.get(w).__webglFramebuffer:null;Z.bindFramebuffer(yt.FRAMEBUFFER,d);const p=yt.fenceSync(yt.SYNC_GPU_COMMANDS_COMPLETE,0);return yt.flush(),await function(t,e,n){return new Promise(function(i,r){setTimeout(function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}},n)})}(yt,p,4),yt.bindBuffer(yt.PIXEL_PACK_BUFFER,u),yt.getBufferSubData(yt.PIXEL_PACK_BUFFER,0,s),yt.deleteBuffer(u),yt.deleteSync(p),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(t,e=null,n=0){const i=Math.pow(2,-n),r=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i),a=null!==e?e.x:0,o=null!==e?e.y:0;Q.setTexture2D(t,0),yt.copyTexSubImage2D(yt.TEXTURE_2D,n,0,0,a,o,r,s),Z.unbindTexture()};const zt=yt.createFramebuffer(),Vt=yt.createFramebuffer();this.copyTextureToTexture=function(t,e,n=null,i=null,r=0,s=null){let a,o,l,c,h,u,d,p,f;null===s&&(0!==r?(LD("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),s=r,r=0):s=0);const m=t.isCompressedTexture?t.mipmaps[s]:t.image;if(null!==n)a=n.max.x-n.min.x,o=n.max.y-n.min.y,l=n.isBox3?n.max.z-n.min.z:1,c=n.min.x,h=n.min.y,u=n.isBox3?n.min.z:0;else{const e=Math.pow(2,-r);a=Math.floor(m.width*e),o=Math.floor(m.height*e),l=t.isDataArrayTexture?m.depth:t.isData3DTexture?Math.floor(m.depth*e):1,c=0,h=0,u=0}null!==i?(d=i.x,p=i.y,f=i.z):(d=0,p=0,f=0);const g=mt.convert(e.format),v=mt.convert(e.type);let y;e.isData3DTexture?(Q.setTexture3D(e,0),y=yt.TEXTURE_3D):e.isDataArrayTexture||e.isCompressedArrayTexture?(Q.setTexture2DArray(e,0),y=yt.TEXTURE_2D_ARRAY):(Q.setTexture2D(e,0),y=yt.TEXTURE_2D),yt.pixelStorei(yt.UNPACK_FLIP_Y_WEBGL,e.flipY),yt.pixelStorei(yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),yt.pixelStorei(yt.UNPACK_ALIGNMENT,e.unpackAlignment);const _=yt.getParameter(yt.UNPACK_ROW_LENGTH),x=yt.getParameter(yt.UNPACK_IMAGE_HEIGHT),b=yt.getParameter(yt.UNPACK_SKIP_PIXELS),M=yt.getParameter(yt.UNPACK_SKIP_ROWS),w=yt.getParameter(yt.UNPACK_SKIP_IMAGES);yt.pixelStorei(yt.UNPACK_ROW_LENGTH,m.width),yt.pixelStorei(yt.UNPACK_IMAGE_HEIGHT,m.height),yt.pixelStorei(yt.UNPACK_SKIP_PIXELS,c),yt.pixelStorei(yt.UNPACK_SKIP_ROWS,h),yt.pixelStorei(yt.UNPACK_SKIP_IMAGES,u);const S=t.isDataArrayTexture||t.isData3DTexture,T=e.isDataArrayTexture||e.isData3DTexture;if(t.isDepthTexture){const n=J.get(t),i=J.get(e),m=J.get(n.__renderTarget),g=J.get(i.__renderTarget);Z.bindFramebuffer(yt.READ_FRAMEBUFFER,m.__webglFramebuffer),Z.bindFramebuffer(yt.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<l;v++)S&&(yt.framebufferTextureLayer(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,J.get(t).__webglTexture,r,u+v),yt.framebufferTextureLayer(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,J.get(e).__webglTexture,s,f+v)),yt.blitFramebuffer(c,h,a,o,d,p,a,o,yt.DEPTH_BUFFER_BIT,yt.NEAREST);Z.bindFramebuffer(yt.READ_FRAMEBUFFER,null),Z.bindFramebuffer(yt.DRAW_FRAMEBUFFER,null)}else if(0!==r||t.isRenderTargetTexture||J.has(t)){const n=J.get(t),i=J.get(e);Z.bindFramebuffer(yt.READ_FRAMEBUFFER,zt),Z.bindFramebuffer(yt.DRAW_FRAMEBUFFER,Vt);for(let t=0;t<l;t++)S?yt.framebufferTextureLayer(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,n.__webglTexture,r,u+t):yt.framebufferTexture2D(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,n.__webglTexture,r),T?yt.framebufferTextureLayer(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,i.__webglTexture,s,f+t):yt.framebufferTexture2D(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,i.__webglTexture,s),0!==r?yt.blitFramebuffer(c,h,a,o,d,p,a,o,yt.COLOR_BUFFER_BIT,yt.NEAREST):T?yt.copyTexSubImage3D(y,s,d,p,f+t,c,h,a,o):yt.copyTexSubImage2D(y,s,d,p,c,h,a,o);Z.bindFramebuffer(yt.READ_FRAMEBUFFER,null),Z.bindFramebuffer(yt.DRAW_FRAMEBUFFER,null)}else T?t.isDataTexture||t.isData3DTexture?yt.texSubImage3D(y,s,d,p,f,a,o,l,g,v,m.data):e.isCompressedArrayTexture?yt.compressedTexSubImage3D(y,s,d,p,f,a,o,l,g,m.data):yt.texSubImage3D(y,s,d,p,f,a,o,l,g,v,m):t.isDataTexture?yt.texSubImage2D(yt.TEXTURE_2D,s,d,p,a,o,g,v,m.data):t.isCompressedTexture?yt.compressedTexSubImage2D(yt.TEXTURE_2D,s,d,p,m.width,m.height,g,m.data):yt.texSubImage2D(yt.TEXTURE_2D,s,d,p,a,o,g,v,m);yt.pixelStorei(yt.UNPACK_ROW_LENGTH,_),yt.pixelStorei(yt.UNPACK_IMAGE_HEIGHT,x),yt.pixelStorei(yt.UNPACK_SKIP_PIXELS,b),yt.pixelStorei(yt.UNPACK_SKIP_ROWS,M),yt.pixelStorei(yt.UNPACK_SKIP_IMAGES,w),0===s&&e.generateMipmaps&&yt.generateMipmap(y),Z.unbindTexture()},this.initRenderTarget=function(t){void 0===J.get(t).__webglFramebuffer&&Q.setupRenderTarget(t)},this.initTexture=function(t){t.isCubeTexture?Q.setTextureCube(t,0):t.isData3DTexture?Q.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?Q.setTexture2DArray(t,0):Q.setTexture2D(t,0),Z.unbindTexture()},this.resetState=function(){b=0,M=0,w=null,Z.reset(),gt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return oD}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=kD._getDrawingBufferColorSpace(t),e.unpackColorSpace=kD._getUnpackColorSpace()}}const $j=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:4,AddEquation:jP,AddOperation:2,AdditiveAnimationBlendMode:jI,AdditiveBlending:2,AgXToneMapping:6,AlphaFormat:KO,AlwaysCompare:519,AlwaysDepth:1,AlwaysStencilFunc:519,AmbientLight:qz,AnimationAction:PV,AnimationClip:yz,AnimationLoader:class extends wz{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new Ez(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(n){try{e(r.parse(JSON.parse(n)))}catch(s){i&&i(s),r.manager.itemError(t)}},n,i)}parse(t){const e=[];for(let n=0;n<t.length;n++){const i=yz.parse(t[n]);e.push(i)}return e}},AnimationMixer:class extends cD{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,s=t._propertyBindings,a=t._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let c=l[o];void 0===c&&(c={},l[o]=c);for(let h=0;h!==r;++h){const t=i[h],r=t.name;let l=c[r];if(void 0!==l)++l.referenceCount,s[h]=l;else{if(l=s[h],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,r));continue}const i=e&&e._propertyBindings[h].binding.parsedPath;l=new MV(RV.create(n,r,i),t.ValueTypeName,t.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,r),s[h]=l}a[h].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,r=this._actionsByClip;let s=r[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{const e=s.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,s=this._actionsByClip,a=s[r],o=a.knownActions,l=o[o.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),t._byClipCacheIndex=null;delete a.actionByRoot[(t._localRoot||this._root).uuid],0===o.length&&delete s[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const t=e[n];0===--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[e];void 0===s&&(s={},i[e]=s),s[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,a=s[i],o=e[e.length-1],l=t._cacheIndex;o._cacheIndex=l,e[l]=o,e.pop(),delete a[r],0===Object.keys(a).length&&delete s[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new lz(new Float32Array(2),new Float32Array(2),1,OV),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){const i=e||this._root,r=i.uuid;let s="string"==typeof t?yz.findByName(i,t):t;const a=null!==s?s.uuid:t,o=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:WI),void 0!==o){const t=o.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;l=o.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new PV(this,s,e,n);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(t,e){const n=e||this._root,i=n.uuid,r="string"==typeof t?yz.findByName(n,t):t,s=r?r.uuid:t,a=this._actionsByClip[s];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==n;++l){e[l]._update(i,t,r,s)}const a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,s=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,e[r]=s,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const r in n){const t=n[r].actionByRoot[e];void 0!==t&&(this._deactivateAction(t),this._removeInactiveAction(t))}const i=this._bindingsByRootAndName[e];if(void 0!==i)for(const r in i){const t=i[r];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},AnimationObjectGroup:class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=fD(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,i=arguments.length;n!==i;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let a,o=t.length,l=this.nCachedObjects_;for(let c=0,h=arguments.length;c!==h;++c){const h=arguments[c],u=h.uuid;let d=e[u];if(void 0===d){d=o++,e[u]=d,t.push(h);for(let t=0,e=s;t!==e;++t)r[t].push(new RV(h,n[t],i[t]))}else if(d<l){a=t[d];const o=--l,c=t[o];e[c.uuid]=d,t[d]=c,e[u]=o,t[o]=h;for(let t=0,e=s;t!==e;++t){const e=r[t],s=e[o];let a=e[d];e[d]=s,void 0===a&&(a=new RV(h,n[t],i[t])),e[o]=a}}else t[d]}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s],o=a.uuid,l=e[o];if(void 0!==l&&l>=r){const s=r++,c=t[s];e[c.uuid]=l,t[l]=c,e[o]=s,t[s]=a;for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[s],r=e[l];e[l]=i,e[s]=r}}}this.nCachedObjects_=r}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=t.length;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a].uuid,l=e[o];if(void 0!==l)if(delete e[o],l<r){const a=--r,o=t[a],c=--s,h=t[c];e[o.uuid]=l,t[l]=o,e[h.uuid]=a,t[a]=h,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t],i=e[a],r=e[c];e[l]=i,e[a]=r,e.pop()}}else{const r=--s,a=t[r];r>0&&(e[a.uuid]=l),t[l]=a,t.pop();for(let t=0,e=i;t!==e;++t){const e=n[t];e[l]=e[r],e.pop()}}}this.nCachedObjects_=r}subscribe_(t,e){const n=this._bindingsIndicesByPath;let i=n[t];const r=this._bindings;if(void 0!==i)return r[i];const s=this._paths,a=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,h=new Array(l);i=r.length,n[t]=i,s.push(t),a.push(e),r.push(h);for(let u=c,d=o.length;u!==d;++u){const n=o[u];h[u]=new RV(n,t,e)}return h}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length-1,o=s[a];e[t[a]]=n,s[n]=o,s.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}},AnimationUtils:class{static convertArray(t,e){return ez(t,e)}static isTypedArray(t){return nz(t)}static getKeyframeOrder(t){return iz(t)}static sortedArray(t,e,n){return rz(t,e,n)}static flattenJSON(t,e,n,i){sz(t,e,n,i)}static subclip(t,e,n,i,r=30){return function(t,e,n,i,r=30){const s=t.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const t=s.tracks[l],e=t.getValueSize(),o=[],c=[];for(let s=0;s<t.times.length;++s){const a=t.times[s]*r;if(!(a<n||a>=i)){o.push(t.times[s]);for(let n=0;n<e;++n)c.push(t.values[s*e+n])}}0!==o.length&&(t.times=ez(o,t.times.constructor),t.values=ez(c,t.values.constructor),a.push(t))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}(t,e,n,i,r)}static makeClipAdditive(t,e=0,n=t,i=30){return function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){const e=n.tracks[a],i=e.ValueTypeName;if("bool"===i||"string"===i)continue;const r=t.tracks.find(function(t){return t.name===e.name&&t.ValueTypeName===i});if(void 0===r)continue;let o=0;const l=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);let c=0;const h=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=h/3);const u=e.times.length-1;let d;if(s<=e.times[0]){const t=o,n=l-o;d=e.values.slice(t,n)}else if(s>=e.times[u]){const t=u*l+o,n=t+l-o;d=e.values.slice(t,n)}else{const t=e.createInterpolant(),n=o,i=l-o;t.evaluate(s),d=t.resultBuffer.slice(n,i)}"quaternion"===i&&(new MD).fromArray(d).normalize().conjugate().toArray(d);const p=r.times.length;for(let t=0;t<p;++t){const e=t*h+c;if("quaternion"===i)MD.multiplyQuaternionsFlat(r.values,e,d,0,r.values,e);else{const t=h-2*c;for(let n=0;n<t;++n)r.values[e+n]-=d[n]}}}return t.blendMode=jI,t}(t,e,n,i)}},ArcCurve:Pk,ArrayCamera:hV,ArrowHelper:class extends tN{constructor(t=new wD(0,0,1),e=new wD(0,0,0),n=1,i=16776960,r=.2*n,s=.2*r){super(),this.type="ArrowHelper",void 0===uH&&(uH=new WN,uH.setAttribute("position",new NN([0,0,0,0,1,0],3)),dH=new xk(.5,1,5,1),dH.translate(0,-.5,0)),this.position.copy(e),this.line=new tk(uH,new XF({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new eU(dH,new wN({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,s)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{hH.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(hH,e)}}setLength(t,e=.2*t,n=.2*e){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},AttachedBindMode:yO,Audio:vV,AudioAnalyser:class{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}},AudioContext:aV,AudioListener:class extends tN{constructor(){super(),this.type="AudioListener",this.context=aV.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new uV}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dV,pV,fV),mV.set(0,0,-1).applyQuaternion(pV),gV.set(0,1,0).applyQuaternion(pV),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(dV.x,t),e.positionY.linearRampToValueAtTime(dV.y,t),e.positionZ.linearRampToValueAtTime(dV.z,t),e.forwardX.linearRampToValueAtTime(mV.x,t),e.forwardY.linearRampToValueAtTime(mV.y,t),e.forwardZ.linearRampToValueAtTime(mV.z,t),e.upX.linearRampToValueAtTime(gV.x,t),e.upY.linearRampToValueAtTime(gV.y,t),e.upZ.linearRampToValueAtTime(gV.z,t)}else e.setPosition(dV.x,dV.y,dV.z),e.setOrientation(mV.x,mV.y,mV.z,gV.x,gV.y,gV.z)}},AudioLoader:class extends wz{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new Ez(this.manager);function a(e){i&&i(e),r.manager.itemError(t)}s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(t){try{const n=t.slice(0);aV.getContext().decodeAudioData(n,function(t){e(t)}).catch(a)}catch(n){a(n)}},n,i)}},AxesHelper:class extends rk{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new WN;n.setAttribute("position",new NN(e,3)),n.setAttribute("color",new NN([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new XF({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const i=new _N,r=this.geometry.attributes.color.array;return i.set(t),i.toArray(r,0),i.toArray(r,3),i.set(e),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BackSide:1,BasicDepthPacking:3200,BasicShadowMap:0,BatchedMesh:GF,Bone:nF,BooleanKeyframeTrack:uz,Box2:class{constructor(t=new bD(1/0,1/0),e=new bD(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=VV.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,VV).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Box3:tL,Box3Helper:class extends rk{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new WN;i.setIndex(new IN(n,1)),i.setAttribute("position",new NN([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new XF({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},BoxGeometry:iU,BoxHelper:class extends rk{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new WN;r.setIndex(new IN(n,1)),r.setAttribute("position",new IN(i,3)),super(r,new XF({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&cH.setFromObject(this.object),cH.isEmpty())return;const t=cH.min,e=cH.max,n=this.geometry.attributes.position,i=n.array;i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=t.x,i[4]=e.y,i[5]=e.z,i[6]=t.x,i[7]=t.y,i[8]=e.z,i[9]=e.x,i[10]=t.y,i[11]=e.z,i[12]=e.x,i[13]=e.y,i[14]=t.z,i[15]=t.x,i[16]=e.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=e.x,i[22]=t.y,i[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,e){return super.copy(t,e),this.object=t.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},BufferAttribute:IN,BufferGeometry:WN,BufferGeometryLoader:tV,ByteType:FO,Cache:xz,Camera:cU,CameraHelper:class extends rk{constructor(t){const e=new WN,n=new XF({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function a(t,e){o(t),o(e)}function o(t){i.push(0,0,0),r.push(0,0,0),void 0===s[t]&&(s[t]=[]),s[t].push(i.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),e.setAttribute("position",new NN(i,3)),e.setAttribute("color",new NN(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new _N(16755200),c=new _N(16711680),h=new _N(43775),u=new _N(16777215),d=new _N(3355443);this.setColors(l,c,h,u,d)}setColors(t,e,n,i,r){const s=this.geometry.getAttribute("color");return s.setXYZ(0,t.r,t.g,t.b),s.setXYZ(1,t.r,t.g,t.b),s.setXYZ(2,t.r,t.g,t.b),s.setXYZ(3,t.r,t.g,t.b),s.setXYZ(4,t.r,t.g,t.b),s.setXYZ(5,t.r,t.g,t.b),s.setXYZ(6,t.r,t.g,t.b),s.setXYZ(7,t.r,t.g,t.b),s.setXYZ(8,t.r,t.g,t.b),s.setXYZ(9,t.r,t.g,t.b),s.setXYZ(10,t.r,t.g,t.b),s.setXYZ(11,t.r,t.g,t.b),s.setXYZ(12,t.r,t.g,t.b),s.setXYZ(13,t.r,t.g,t.b),s.setXYZ(14,t.r,t.g,t.b),s.setXYZ(15,t.r,t.g,t.b),s.setXYZ(16,t.r,t.g,t.b),s.setXYZ(17,t.r,t.g,t.b),s.setXYZ(18,t.r,t.g,t.b),s.setXYZ(19,t.r,t.g,t.b),s.setXYZ(20,t.r,t.g,t.b),s.setXYZ(21,t.r,t.g,t.b),s.setXYZ(22,t.r,t.g,t.b),s.setXYZ(23,t.r,t.g,t.b),s.setXYZ(24,e.r,e.g,e.b),s.setXYZ(25,e.r,e.g,e.b),s.setXYZ(26,e.r,e.g,e.b),s.setXYZ(27,e.r,e.g,e.b),s.setXYZ(28,e.r,e.g,e.b),s.setXYZ(29,e.r,e.g,e.b),s.setXYZ(30,e.r,e.g,e.b),s.setXYZ(31,e.r,e.g,e.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0,this}update(){const t=this.geometry,e=this.pointMap;let n,i;if(oH.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),!0===this.camera.reversedDepth)n=1,i=0;else if(this.camera.coordinateSystem===oD)n=-1,i=1;else{if(this.camera.coordinateSystem!==lD)throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);n=0,i=1}lH("c",e,t,oH,0,0,n),lH("t",e,t,oH,0,0,i),lH("n1",e,t,oH,-1,-1,n),lH("n2",e,t,oH,1,-1,n),lH("n3",e,t,oH,-1,1,n),lH("n4",e,t,oH,1,1,n),lH("f1",e,t,oH,-1,-1,i),lH("f2",e,t,oH,1,-1,i),lH("f3",e,t,oH,-1,1,i),lH("f4",e,t,oH,1,1,i),lH("u1",e,t,oH,.7,1.1,n),lH("u2",e,t,oH,-.7,1.1,n),lH("u3",e,t,oH,0,2,n),lH("cf1",e,t,oH,-1,0,i),lH("cf2",e,t,oH,1,0,i),lH("cf3",e,t,oH,0,-1,i),lH("cf4",e,t,oH,0,1,i),lH("cn1",e,t,oH,-1,0,n),lH("cn2",e,t,oH,1,0,n),lH("cn3",e,t,oH,0,-1,n),lH("cn4",e,t,oH,0,1,n),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}},CanvasTexture:class extends YD{constructor(t,e,n,i,r,s,a,o,l){super(t,e,n,i,r,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},CapsuleGeometry:vk,CatmullRomCurve3:Uk,CineonToneMapping:3,CircleGeometry:yk,ClampToEdgeWrapping:AO,Clock:uV,Color:_N,ColorKeyframeTrack:dz,ColorManagement:kD,CompressedArrayTexture:class extends fk{constructor(t,e,n,i,r,s){super(t,e,n,r,s),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=AO,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}},CompressedCubeTexture:class extends fk{constructor(t,e,n){super(void 0,t[0].width,t[0].height,e,n,bO),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=t}},CompressedTexture:fk,CompressedTextureLoader:class extends wz{constructor(t){super(t)}load(t,e,n,i){const r=this,s=[],a=new fk,o=new Ez(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(r.withCredentials);let l=0;function c(c){o.load(t[c],function(t){const n=r.parse(t,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(a.minFilter=IO),a.image=s,a.format=n.format,a.needsUpdate=!0,e&&e(a))},n,i)}if(Array.isArray(t))for(let h=0,u=t.length;h<u;++h)c(h);else o.load(t,function(t){const n=r.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){s[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)s[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),s[e].format=n.format,s[e].width=n.width,s[e].height=n.height}a.image=s}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=IO),a.format=n.format,a.needsUpdate=!0,e&&e(a)},n,i);return a}},ConeGeometry:xk,ConstantAlphaFactor:213,ConstantColorFactor:211,Controls:class extends cD{constructor(t,e=null){super(),this.object=t,this.domElement=e,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(t){void 0!==t&&(null!==this.domElement&&this.disconnect(),this.domElement=t)}disconnect(){}dispose(){}update(){}},CubeCamera:mU,CubeReflectionMapping:bO,CubeRefractionMapping:MO,CubeTexture:gU,CubeTextureLoader:Rz,CubeUVReflectionMapping:TO,CubicBezierCurve:zk,CubicBezierCurve3:Vk,CubicInterpolant:oz,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,CullFaceNone:0,Curve:Ck,CurvePath:Yk,CustomBlending:5,CustomToneMapping:5,CylinderGeometry:_k,Cylindrical:class{constructor(t=1,e=0,n=0){this.radius=t,this.theta=e,this.y=n}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}},Data3DTexture:QD,DataArrayTexture:JD,DataTexture:iF,DataTextureLoader:Pz,DataUtils:CN,DecrementStencilOp:7683,DecrementWrapStencilOp:34056,DefaultLoadingManager:Mz,DepthFormat:JO,DepthStencilFormat:QO,DepthTexture:mk,DetachedBindMode:_O,DirectionalLight:Xz,DirectionalLightHelper:class extends tN{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===e&&(e=1);let i=new WN;i.setAttribute("position",new NN([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const r=new XF({fog:!1,toneMapped:!1});this.lightPlane=new tk(i,r),this.add(this.lightPlane),i=new WN,i.setAttribute("position",new NN([0,0,0,0,0,1],3)),this.targetLine=new tk(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),iH.setFromMatrixPosition(this.light.matrixWorld),rH.setFromMatrixPosition(this.light.target.matrixWorld),sH.subVectors(rH,iH),this.lightPlane.lookAt(rH),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rH),this.targetLine.scale.z=sH.length()}},DiscreteInterpolant:cz,DodecahedronGeometry:Mk,DoubleSide:2,DstAlphaFactor:206,DstColorFactor:208,DynamicCopyUsage:35050,DynamicDrawUsage:35048,DynamicReadUsage:35049,EdgesGeometry:Ak,EllipseCurve:Rk,EqualCompare:514,EqualDepth:4,EqualStencilFunc:514,EquirectangularReflectionMapping:wO,EquirectangularRefractionMapping:SO,Euler:FL,EventDispatcher:cD,ExternalTexture:gk,ExtrudeGeometry:AB,FileLoader:Ez,Float16BufferAttribute:class extends IN{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}getX(t){let e=AN(this.array[t*this.itemSize]);return this.normalized&&(e=yD(e,this.array)),e}setX(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize]=EN(e),this}getY(t){let e=AN(this.array[t*this.itemSize+1]);return this.normalized&&(e=yD(e,this.array)),e}setY(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize+1]=EN(e),this}getZ(t){let e=AN(this.array[t*this.itemSize+2]);return this.normalized&&(e=yD(e,this.array)),e}setZ(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize+2]=EN(e),this}getW(t){let e=AN(this.array[t*this.itemSize+3]);return this.normalized&&(e=yD(e,this.array)),e}setW(t,e){return this.normalized&&(e=_D(e,this.array)),this.array[t*this.itemSize+3]=EN(e),this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array)),this.array[t+0]=EN(e),this.array[t+1]=EN(n),this}setXYZ(t,e,n,i){return t*=this.itemSize,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array),i=_D(i,this.array)),this.array[t+0]=EN(e),this.array[t+1]=EN(n),this.array[t+2]=EN(i),this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.normalized&&(e=_D(e,this.array),n=_D(n,this.array),i=_D(i,this.array),r=_D(r,this.array)),this.array[t+0]=EN(e),this.array[t+1]=EN(n),this.array[t+2]=EN(i),this.array[t+3]=EN(r),this}},Float32BufferAttribute:NN,FloatType:HO,Fog:MU,FogExp2:bU,FramebufferTexture:class extends YD{constructor(t,e){super({width:t,height:e}),this.isFramebufferTexture=!0,this.magFilter=RO,this.minFilter=RO,this.generateMipmaps=!1,this.needsUpdate=!0}},FrontSide:0,Frustum:wF,FrustumArray:EF,GLBufferAttribute:class{constructor(t,e,n,i,r,s=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=i,this.count=r,this.normalized=s,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}},GLSL1:"100",GLSL3:aD,GreaterCompare:516,GreaterDepth:6,GreaterEqualCompare:518,GreaterEqualDepth:5,GreaterEqualStencilFunc:518,GreaterStencilFunc:516,GridHelper:class extends rk{constructor(t=10,e=10,n=4473924,i=8947848){n=new _N(n),i=new _N(i);const r=e/2,s=t/e,a=t/2,o=[],l=[];for(let h=0,u=0,d=-a;h<=e;h++,d+=s){o.push(-a,0,d,a,0,d),o.push(d,0,-a,d,0,a);const t=h===r?n:i;t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3}const c=new WN;c.setAttribute("position",new NN(o,3)),c.setAttribute("color",new NN(l,3));super(c,new XF({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},Group:yU,HalfFloatType:WO,HemisphereLight:Iz,HemisphereLightHelper:class extends tN{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new OB(e);i.rotateY(.5*Math.PI),this.material=new wN({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),s=new Float32Array(3*r.count);i.setAttribute("color",new IN(s,3)),this.add(new eU(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");eH.copy(this.light.color),nH.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const i=t<n/2?eH:nH;e.setXYZ(t,i.r,i.g,i.b)}e.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),t.lookAt(tH.setFromMatrixPosition(this.light.matrixWorld).negate())}},IcosahedronGeometry:RB,ImageBitmapLoader:class extends wz{constructor(t){super(t),this.isImageBitmapLoader=!0,this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=xz.get(`image-bitmap:${t}`);if(void 0!==s)return r.manager.itemStart(t),s.then?void s.then(n=>{if(!0!==rV.has(s))return e&&e(n),r.manager.itemEnd(t),n;i&&i(rV.get(s)),r.manager.itemError(t),r.manager.itemEnd(t)}):(setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s);const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,a.signal="function"==typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const o=fetch(t,a).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(n){return xz.add(`image-bitmap:${t}`,n),e&&e(n),r.manager.itemEnd(t),n}).catch(function(e){i&&i(e),rV.set(o,e),xz.remove(`image-bitmap:${t}`),r.manager.itemError(t),r.manager.itemEnd(t)});xz.add(`image-bitmap:${t}`,o),r.manager.itemStart(t)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}},ImageLoader:Cz,ImageUtils:HD,IncrementStencilOp:7682,IncrementWrapStencilOp:34055,InstancedBufferAttribute:oF,InstancedBufferGeometry:Qz,InstancedInterleavedBuffer:class extends SU{constructor(t,e,n=1){super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}},InstancedMesh:mF,Int16BufferAttribute:class extends IN{constructor(t,e,n){super(new Int16Array(t),e,n)}},Int32BufferAttribute:class extends IN{constructor(t,e,n){super(new Int32Array(t),e,n)}},Int8BufferAttribute:class extends IN{constructor(t,e,n){super(new Int8Array(t),e,n)}},IntType:zO,InterleavedBuffer:SU,InterleavedBufferAttribute:EU,Interpolant:az,InterpolateDiscrete:FI,InterpolateLinear:kI,InterpolateSmooth:BI,InterpolationSamplingMode:{NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"},InterpolationSamplingType:{PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},InvertStencilOp:5386,KeepStencilOp:ZI,KeyframeTrack:hz,LOD:GU,LatheGeometry:PB,Layers:kL,LessCompare:513,LessDepth:2,LessEqualCompare:515,LessEqualDepth:3,LessEqualStencilFunc:515,LessStencilFunc:513,Light:Oz,LightProbe:Zz,Line:tk,Line3:class{constructor(t=new wD,e=new wD){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){HV.subVectors(t,this.start),WV.subVectors(this.end,this.start);const n=WV.dot(WV);let i=WV.dot(HV)/n;return e&&(i=mD(i,0,1)),i}closestPointToPoint(t,e,n){const i=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(i).add(this.start)}distanceSqToLine3(t,e=qV,n=YV){const i=1e-8*1e-8;let r,s;const a=this.start,o=t.start,l=this.end,c=t.end;jV.subVectors(l,a),GV.subVectors(c,o),XV.subVectors(a,o);const h=jV.dot(jV),u=GV.dot(GV),d=GV.dot(XV);if(h<=i&&u<=i)return e.copy(a),n.copy(o),e.sub(n),e.dot(e);if(h<=i)r=0,s=d/u,s=mD(s,0,1);else{const t=jV.dot(XV);if(u<=i)s=0,r=mD(-t/h,0,1);else{const e=jV.dot(GV),n=h*u-e*e;r=0!==n?mD((e*d-t*u)/n,0,1):0,s=(e*r+d)/u,s<0?(s=0,r=mD(-t/h,0,1)):s>1&&(s=1,r=mD((e-t)/h,0,1))}}return e.copy(a).add(jV.multiplyScalar(r)),n.copy(o).add(GV.multiplyScalar(s)),e.sub(n),e.dot(e)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},LineBasicMaterial:XF,LineCurve:Hk,LineCurve3:Wk,LineDashedMaterial:tz,LineLoop:sk,LineSegments:rk,LinearFilter:IO,LinearInterpolant:lz,LinearMipMapLinearFilter:NO,LinearMipMapNearestFilter:1007,LinearMipmapLinearFilter:LO,LinearMipmapNearestFilter:DO,LinearSRGBColorSpace:qI,LinearToneMapping:1,LinearTransfer:YI,Loader:wz,LoaderUtils:Jz,LoadingManager:bz,LoopOnce:2200,LoopPingPong:2202,LoopRepeat:2201,MOUSE:DP,Material:MN,MaterialLoader:$z,MathUtils:xD,Matrix2:zV,Matrix3:ED,Matrix4:AL,MaxEquation:104,Mesh:eU,MeshBasicMaterial:wN,MeshDepthMaterial:$B,MeshDistanceMaterial:JB,MeshLambertMaterial:ZB,MeshMatcapMaterial:QB,MeshNormalMaterial:KB,MeshPhongMaterial:qB,MeshPhysicalMaterial:XB,MeshStandardMaterial:GB,MeshToonMaterial:YB,MinEquation:103,MirroredRepeatWrapping:CO,MixOperation:1,MultiplyBlending:4,MultiplyOperation:0,NearestFilter:RO,NearestMipMapLinearFilter:1005,NearestMipMapNearestFilter:1004,NearestMipmapLinearFilter:OO,NearestMipmapNearestFilter:PO,NeutralToneMapping:7,NeverCompare:512,NeverDepth:0,NeverStencilFunc:512,NoBlending:0,NoColorSpace:GI,NoToneMapping:0,NormalAnimationBlendMode:WI,NormalBlending:1,NotEqualCompare:517,NotEqualDepth:7,NotEqualStencilFunc:517,NumberKeyframeTrack:pz,Object3D:tN,ObjectLoader:class extends wz{constructor(t){super(t)}load(t,e,n,i){const r=this,s=""===this.path?Jz.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||s;const a=new Ez(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(n){let s=null;try{s=JSON.parse(n)}catch(o){return void(void 0!==i&&i(o))}const a=s.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?r.parse(s,e):void 0!==i&&i(new Error("THREE.ObjectLoader: Can't load "+t))},n,i)}async loadAsync(t,e){const n=""===this.path?Jz.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||n;const i=new Ez(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(t,e),s=JSON.parse(r),a=s.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(s)}parse(t,e){const n=this.parseAnimations(t.animations),i=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,i),s=this.parseImages(t.images,function(){void 0!==e&&e(l)}),a=this.parseTextures(t.textures,s),o=this.parseMaterials(t.materials,a),l=this.parseObject(t.object,r,o,a,n),c=this.parseSkeletons(t.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==e){let t=!1;for(const e in s)if(s[e].data instanceof HTMLImageElement){t=!0;break}!1===t&&e(l)}return l}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,n),r=await this.parseImagesAsync(t.images),s=this.parseTextures(t.textures,r),a=this.parseMaterials(t.materials,s),o=this.parseObject(t.object,i,a,s,e),l=this.parseSkeletons(t.skeletons,o);return this.bindSkeletons(o,l),this.bindLightTargets(o),o}parseShapes(t){const e={};if(void 0!==t)for(let n=0,i=t.length;n<i;n++){const i=(new Zk).fromJSON(t[n]);e[i.uuid]=i}return e}parseSkeletons(t,e){const n={},i={};if(e.traverse(function(t){t.isBone&&(i[t.uuid]=t)}),void 0!==t)for(let r=0,s=t.length;r<s;r++){const e=(new aF).fromJSON(t[r],i);n[e.uuid]=e}return n}parseGeometries(t,e){const n={};if(void 0!==t){const i=new tV;for(let r=0,s=t.length;r<s;r++){let s;const a=t[r];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(a);break;default:a.type in HB&&(s=HB[a.type].fromJSON(a,e))}s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.userData&&(s.userData=a.userData),n[a.uuid]=s}}return n}parseMaterials(t,e){const n={},i={};if(void 0!==t){const r=new $z;r.setTextures(e);for(let e=0,s=t.length;e<s;e++){const s=t[e];void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const i=t[n],r=yz.parse(i);e[r.uuid]=r}return e}parseImages(t,e){const n=this,i={};let r;function s(t){if("string"==typeof t){const e=t;return function(t){return n.manager.itemStart(t),r.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t),n.manager.itemEnd(t)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e)}return t.data?{data:PD(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){const n=new bz(e);r=new Cz(n),r.setCrossOrigin(this.crossOrigin);for(let e=0,r=t.length;e<r;e++){const n=t[e],r=n.url;if(Array.isArray(r)){const t=[];for(let e=0,n=r.length;e<n;e++){const n=s(r[e]);null!==n&&(n instanceof HTMLImageElement?t.push(n):t.push(new iF(n.data,n.width,n.height)))}i[n.uuid]=new jD(t)}else{const t=s(n.url);i[n.uuid]=new jD(t)}}}return i}async parseImagesAsync(t){const e=this,n={};let i;async function r(t){if("string"==typeof t){const n=t,r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:e.resourcePath+n;return await i.loadAsync(r)}return t.data?{data:PD(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){i=new Cz(this.manager),i.setCrossOrigin(this.crossOrigin);for(let e=0,i=t.length;e<i;e++){const i=t[e],s=i.url;if(Array.isArray(s)){const t=[];for(let e=0,n=s.length;e<n;e++){const n=s[e],i=await r(n);null!==i&&(i instanceof HTMLImageElement?t.push(i):t.push(new iF(i.data,i.width,i.height)))}n[i.uuid]=new jD(t)}else{const t=await r(i.url);n[i.uuid]=new jD(t)}}}return n}parseTextures(t,e){function n(t,e){return"number"==typeof t?t:e[t]}const i={};if(void 0!==t)for(let r=0,s=t.length;r<s;r++){const s=t[r];s.image,e[s.image];const a=e[s.image],o=a.data;let l;Array.isArray(o)?(l=new gU,6===o.length&&(l.needsUpdate=!0)):(l=o&&o.data?new iF:new YD,o&&(l.needsUpdate=!0)),l.source=a,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,eV)),void 0!==s.channel&&(l.channel=s.channel),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],nV),l.wrapT=n(s.wrap[1],nV)),void 0!==s.format&&(l.format=s.format),void 0!==s.internalFormat&&(l.internalFormat=s.internalFormat),void 0!==s.type&&(l.type=s.type),void 0!==s.colorSpace&&(l.colorSpace=s.colorSpace),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,iV)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,iV)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.generateMipmaps&&(l.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(l.compareFunction=s.compareFunction),void 0!==s.userData&&(l.userData=s.userData),i[s.uuid]=l}return i}parseObject(t,e,n,i,r){let s,a,o;function l(t){return e[t],e[t]}function c(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n[r],e.push(n[r])}return e}return n[t],n[t]}}function h(t){return i[t],i[t]}switch(t.type){case"Scene":s=new wU,void 0!==t.background&&(Number.isInteger(t.background)?s.background=new _N(t.background):s.background=h(t.background)),void 0!==t.environment&&(s.environment=h(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?s.fog=new MU(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(s.fog=new bU(t.fog.color,t.fog.density)),""!==t.fog.name&&(s.fog.name=t.fog.name)),void 0!==t.backgroundBlurriness&&(s.backgroundBlurriness=t.backgroundBlurriness),void 0!==t.backgroundIntensity&&(s.backgroundIntensity=t.backgroundIntensity),void 0!==t.backgroundRotation&&s.backgroundRotation.fromArray(t.backgroundRotation),void 0!==t.environmentIntensity&&(s.environmentIntensity=t.environmentIntensity),void 0!==t.environmentRotation&&s.environmentRotation.fromArray(t.environmentRotation);break;case"PerspectiveCamera":s=new pU(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(s.focus=t.focus),void 0!==t.zoom&&(s.zoom=t.zoom),void 0!==t.filmGauge&&(s.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(s.filmOffset=t.filmOffset),void 0!==t.view&&(s.view=Object.assign({},t.view));break;case"OrthographicCamera":s=new jz(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(s.zoom=t.zoom),void 0!==t.view&&(s.view=Object.assign({},t.view));break;case"AmbientLight":s=new qz(t.color,t.intensity);break;case"DirectionalLight":s=new Xz(t.color,t.intensity),s.target=t.target||"";break;case"PointLight":s=new Wz(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":s=new Yz(t.color,t.intensity,t.width,t.height);break;case"SpotLight":s=new kz(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay),s.target=t.target||"";break;case"HemisphereLight":s=new Iz(t.color,t.groundColor,t.intensity);break;case"LightProbe":s=(new Zz).fromJSON(t);break;case"SkinnedMesh":a=l(t.geometry),o=c(t.material),s=new eF(a,o),void 0!==t.bindMode&&(s.bindMode=t.bindMode),void 0!==t.bindMatrix&&s.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(s.skeleton=t.skeleton);break;case"Mesh":a=l(t.geometry),o=c(t.material),s=new eU(a,o);break;case"InstancedMesh":a=l(t.geometry),o=c(t.material);const e=t.count,n=t.instanceMatrix,i=t.instanceColor;s=new mF(a,o,e),s.instanceMatrix=new oF(new Float32Array(n.array),16),void 0!==i&&(s.instanceColor=new oF(new Float32Array(i.array),i.itemSize));break;case"BatchedMesh":a=l(t.geometry),o=c(t.material),s=new GF(t.maxInstanceCount,t.maxVertexCount,t.maxIndexCount,o),s.geometry=a,s.perObjectFrustumCulled=t.perObjectFrustumCulled,s.sortObjects=t.sortObjects,s._drawRanges=t.drawRanges,s._reservedRanges=t.reservedRanges,s._geometryInfo=t.geometryInfo.map(t=>{let e=null,n=null;return void 0!==t.boundingBox&&(e=(new tL).fromJSON(t.boundingBox)),void 0!==t.boundingSphere&&(n=(new yL).fromJSON(t.boundingSphere)),{...t,boundingBox:e,boundingSphere:n}}),s._instanceInfo=t.instanceInfo,s._availableInstanceIds=t._availableInstanceIds,s._availableGeometryIds=t._availableGeometryIds,s._nextIndexStart=t.nextIndexStart,s._nextVertexStart=t.nextVertexStart,s._geometryCount=t.geometryCount,s._maxInstanceCount=t.maxInstanceCount,s._maxVertexCount=t.maxVertexCount,s._maxIndexCount=t.maxIndexCount,s._geometryInitialized=t.geometryInitialized,s._matricesTexture=h(t.matricesTexture.uuid),s._indirectTexture=h(t.indirectTexture.uuid),void 0!==t.colorsTexture&&(s._colorsTexture=h(t.colorsTexture.uuid)),void 0!==t.boundingSphere&&(s.boundingSphere=(new yL).fromJSON(t.boundingSphere)),void 0!==t.boundingBox&&(s.boundingBox=(new tL).fromJSON(t.boundingBox));break;case"LOD":s=new GU;break;case"Line":s=new tk(l(t.geometry),c(t.material));break;case"LineLoop":s=new sk(l(t.geometry),c(t.material));break;case"LineSegments":s=new rk(l(t.geometry),c(t.material));break;case"PointCloud":case"Points":s=new uk(l(t.geometry),c(t.material));break;case"Sprite":s=new VU(c(t.material));break;case"Group":s=new yU;break;case"Bone":s=new nF;break;default:s=new tN}if(s.uuid=t.uuid,void 0!==t.name&&(s.name=t.name),void 0!==t.matrix?(s.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(s.matrixAutoUpdate=t.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==t.position&&s.position.fromArray(t.position),void 0!==t.rotation&&s.rotation.fromArray(t.rotation),void 0!==t.quaternion&&s.quaternion.fromArray(t.quaternion),void 0!==t.scale&&s.scale.fromArray(t.scale)),void 0!==t.up&&s.up.fromArray(t.up),void 0!==t.castShadow&&(s.castShadow=t.castShadow),void 0!==t.receiveShadow&&(s.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.intensity&&(s.shadow.intensity=t.shadow.intensity),void 0!==t.shadow.bias&&(s.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(s.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(s.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&s.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(s.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(s.visible=t.visible),void 0!==t.frustumCulled&&(s.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(s.renderOrder=t.renderOrder),void 0!==t.userData&&(s.userData=t.userData),void 0!==t.layers&&(s.layers.mask=t.layers),void 0!==t.children){const a=t.children;for(let t=0;t<a.length;t++)s.add(this.parseObject(a[t],e,n,i,r))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];s.animations.push(r[n])}}if("LOD"===t.type){void 0!==t.autoUpdate&&(s.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],i=s.getObjectByProperty("uuid",n.object);void 0!==i&&s.addLevel(i,n.distance,n.hysteresis)}}return s}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse(function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n||t.bind(n,t.bindMatrix)}})}bindLightTargets(t){t.traverse(function(e){if(e.isDirectionalLight||e.isSpotLight){const n=e.target,i=t.getObjectByProperty("uuid",n);e.target=void 0!==i?i:new tN}})}},ObjectSpaceNormalMap:1,OctahedronGeometry:OB,OneFactor:201,OneMinusConstantAlphaFactor:214,OneMinusConstantColorFactor:212,OneMinusDstAlphaFactor:207,OneMinusDstColorFactor:209,OneMinusSrcAlphaFactor:JP,OneMinusSrcColorFactor:203,OrthographicCamera:jz,PCFShadowMap:1,PCFSoftShadowMap:2,PMREMGenerator:zH,Path:Kk,PerspectiveCamera:pU,Plane:_F,PlaneGeometry:IB,PlaneHelper:class extends tk{constructor(t,e=1,n=16776960){const i=n,r=new WN;r.setAttribute("position",new NN([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new XF({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const s=new WN;s.setAttribute("position",new NN([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),s.computeBoundingSphere(),this.add(new eU(s,new wN({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},PointLight:Wz,PointLightHelper:class extends eU{constructor(t,e,n){super(new NB(e,4,2),new wN({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Points:uk,PointsMaterial:ak,PolarGridHelper:class extends rk{constructor(t=10,e=16,n=8,i=64,r=4473924,s=8947848){r=new _N(r),s=new _N(s);const a=[],o=[];if(e>1)for(let c=0;c<e;c++){const n=c/e*(2*Math.PI),i=Math.sin(n)*t,l=Math.cos(n)*t;a.push(0,0,0),a.push(i,0,l);const h=1&c?r:s;o.push(h.r,h.g,h.b),o.push(h.r,h.g,h.b)}for(let c=0;c<n;c++){const e=1&c?r:s,l=t-t/n*c;for(let t=0;t<i;t++){let n=t/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l;a.push(r,0,s),o.push(e.r,e.g,e.b),n=(t+1)/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l,a.push(r,0,s),o.push(e.r,e.g,e.b)}}const l=new WN;l.setAttribute("position",new NN(a,3)),l.setAttribute("color",new NN(o,3));super(l,new XF({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},PolyhedronGeometry:bk,PositionalAudio:class extends vV{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(yV,_V,xV),bV.set(0,0,1).applyQuaternion(_V);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(yV.x,t),e.positionY.linearRampToValueAtTime(yV.y,t),e.positionZ.linearRampToValueAtTime(yV.z,t),e.orientationX.linearRampToValueAtTime(bV.x,t),e.orientationY.linearRampToValueAtTime(bV.y,t),e.orientationZ.linearRampToValueAtTime(bV.z,t)}else e.setPosition(yV.x,yV.y,yV.z),e.setOrientation(bV.x,bV.y,bV.z)}},PropertyBinding:RV,PropertyMixer:MV,QuadraticBezierCurve:jk,QuadraticBezierCurve3:Gk,Quaternion:MD,QuaternionKeyframeTrack:mz,QuaternionLinearInterpolant:fz,RED_GREEN_RGTC2_Format:NI,RED_RGTC1_Format:DI,REVISION:IP,RGBADepthPacking:3201,RGBAFormat:$O,RGBAIntegerFormat:rI,RGBA_ASTC_10x10_Format:AI,RGBA_ASTC_10x5_Format:SI,RGBA_ASTC_10x6_Format:TI,RGBA_ASTC_10x8_Format:EI,RGBA_ASTC_12x10_Format:CI,RGBA_ASTC_12x12_Format:RI,RGBA_ASTC_4x4_Format:gI,RGBA_ASTC_5x4_Format:vI,RGBA_ASTC_5x5_Format:yI,RGBA_ASTC_6x5_Format:_I,RGBA_ASTC_6x6_Format:xI,RGBA_ASTC_8x5_Format:bI,RGBA_ASTC_8x6_Format:MI,RGBA_ASTC_8x8_Format:wI,RGBA_BPTC_Format:PI,RGBA_ETC2_EAC_Format:mI,RGBA_PVRTC_2BPPV1_Format:dI,RGBA_PVRTC_4BPPV1_Format:uI,RGBA_S3TC_DXT1_Format:aI,RGBA_S3TC_DXT3_Format:oI,RGBA_S3TC_DXT5_Format:lI,RGBDepthPacking:3202,RGBFormat:ZO,RGBIntegerFormat:1032,RGB_BPTC_SIGNED_Format:OI,RGB_BPTC_UNSIGNED_Format:II,RGB_ETC1_Format:pI,RGB_ETC2_Format:fI,RGB_PVRTC_2BPPV1_Format:hI,RGB_PVRTC_4BPPV1_Format:cI,RGB_S3TC_DXT1_Format:sI,RGDepthPacking:3203,RGFormat:nI,RGIntegerFormat:iI,RawShaderMaterial:jB,Ray:EL,Raycaster:NV,RectAreaLight:Yz,RedFormat:tI,RedIntegerFormat:eI,ReinhardToneMapping:2,RenderTarget:ZD,RenderTarget3D:class extends ZD{constructor(t=1,e=1,n=1,i={}){super(t,e,i),this.isRenderTarget3D=!0,this.depth=n,this.texture=new QD(null,t,e,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}},RepeatWrapping:EO,ReplaceStencilOp:7681,ReverseSubtractEquation:102,RingGeometry:DB,SIGNED_RED_GREEN_RGTC2_Format:UI,SIGNED_RED_RGTC1_Format:LI,SRGBColorSpace:XI,SRGBTransfer:KI,Scene:wU,ShaderChunk:gH,ShaderLib:yH,ShaderMaterial:lU,ShadowMaterial:WB,Shape:Zk,ShapeGeometry:LB,ShapePath:class{constructor(){this.type="ShapePath",this.color=new _N,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new Kk,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){return this.currentPath.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function e(t,e){const n=e.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=e[r],a=e[s],o=a.x-n.x,l=a.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[s],o=-o,a=e[r],l=-l),t.y<n.y||t.y>a.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-o*(t.y-n.y);if(0===e)return!0;if(e<0)continue;i=!i}}else{if(t.y!==n.y)continue;if(a.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=a.x)return!0}}return i}const n=SB.isClockWise,i=this.subPaths;if(0===i.length)return[];let r,s,a;const o=[];if(1===i.length)return s=i[0],a=new Zk,a.curves=s.curves,o.push(a),o;let l=!n(i[0].getPoints());l=t?!l:l;const c=[],h=[];let u,d,p=[],f=0;h[f]=void 0,p[f]=[];for(let m=0,g=i.length;m<g;m++)s=i[m],u=s.getPoints(),r=n(u),r=t?!r:r,r?(!l&&h[f]&&f++,h[f]={s:new Zk,p:u},h[f].s.curves=s.curves,l&&f++,p[f]=[]):p[f].push({h:s,p:u[0]});if(!h[0])return function(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n],r=new Zk;r.curves=i.curves,e.push(r)}return e}(i);if(h.length>1){let t=!1,n=0;for(let e=0,i=h.length;e<i;e++)c[e]=[];for(let i=0,r=h.length;i<r;i++){const r=p[i];for(let s=0;s<r.length;s++){const a=r[s];let o=!0;for(let r=0;r<h.length;r++)e(a.p,h[r].p)&&(i!==r&&n++,o?(o=!1,c[r].push(a)):t=!0);o&&c[i].push(a)}}n>0&&!1===t&&(p=c)}for(let m=0,g=h.length;m<g;m++){a=h[m].s,o.push(a),d=p[m];for(let t=0,e=d.length;t<e;t++)a.holes.push(d[t].h)}return o}},ShapeUtils:SB,ShortType:kO,Skeleton:aF,SkeletonHelper:class extends rk{constructor(t){const e=QV(t),n=new WN,i=[],r=[];for(let o=0;o<e.length;o++){const t=e[o];t.parent&&t.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}n.setAttribute("position",new NN(i,3)),n.setAttribute("color",new NN(r,3));super(n,new XF({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;const s=new _N(255),a=new _N(65280);this.setColors(s,a)}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");JV.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<e.length;r++){const t=e[r];t.parent&&t.parent.isBone&&($V.multiplyMatrices(JV,t.matrixWorld),ZV.setFromMatrixPosition($V),i.setXYZ(s,ZV.x,ZV.y,ZV.z),$V.multiplyMatrices(JV,t.parent.matrixWorld),ZV.setFromMatrixPosition($V),i.setXYZ(s+1,ZV.x,ZV.y,ZV.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}setColors(t,e){const n=this.geometry.getAttribute("color");for(let i=0;i<n.count;i+=2)n.setXYZ(i,t.r,t.g,t.b),n.setXYZ(i+1,e.r,e.g,e.b);return n.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},SkinnedMesh:eF,Source:jD,Sphere:yL,SphereGeometry:NB,Spherical:BV,SphericalHarmonics3:Kz,SplineCurve:Xk,SpotLight:kz,SpotLightHelper:class extends tN{constructor(t,e){super(),this.light=t,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";const n=new WN,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){const t=s/o*Math.PI*2,e=a/o*Math.PI*2;i.push(Math.cos(t),Math.sin(t),1,Math.cos(e),Math.sin(e),1)}n.setAttribute("position",new NN(i,3));const r=new XF({fog:!1,toneMapped:!1});this.cone=new rk(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),KV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(KV),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Sprite:VU,SpriteMaterial:AU,SrcAlphaFactor:$P,SrcAlphaSaturateFactor:210,SrcColorFactor:202,StaticCopyUsage:35046,StaticDrawUsage:sD,StaticReadUsage:35045,StereoCamera:class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new pU,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new pU,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,cV.copy(t.projectionMatrix);const n=e.eyeSep/2,i=n*e.near/e.focus,r=e.near*Math.tan(dD*e.fov*.5)/e.zoom;let s,a;lV.elements[12]=-n,oV.elements[12]=n,s=-r*e.aspect+i,a=r*e.aspect+i,cV.elements[0]=2*e.near/(a-s),cV.elements[8]=(a+s)/(a-s),this.cameraL.projectionMatrix.copy(cV),s=-r*e.aspect-i,a=r*e.aspect-i,cV.elements[0]=2*e.near/(a-s),cV.elements[8]=(a+s)/(a-s),this.cameraR.projectionMatrix.copy(cV)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(lV),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(oV)}},StreamCopyUsage:35042,StreamDrawUsage:35040,StreamReadUsage:35041,StringKeyframeTrack:gz,SubtractEquation:101,SubtractiveBlending:3,TOUCH:LP,TangentSpaceNormalMap:0,TetrahedronGeometry:UB,Texture:YD,TextureLoader:class extends wz{constructor(t){super(t)}load(t,e,n,i){const r=new YD,s=new Cz(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r}},TextureUtils:class{static contain(t,e){return function(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}(t,e)}static cover(t,e){return function(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}(t,e)}static fill(t){return function(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}(t)}static getByteLength(t,e,n,i){return pH(t,e,n,i)}},Timer:class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(t){this._document=t,void 0!==t.hidden&&(this._pageVisibilityHandler=kV.bind(this),t.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){null!==this._pageVisibilityHandler&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(t){return this._timescale=t,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(t){return null!==this._pageVisibilityHandler&&!0===this._document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==t?t:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}},TimestampQuery:{COMPUTE:"compute",RENDER:"render"},TorusGeometry:FB,TorusKnotGeometry:kB,Triangle:fN,TriangleFanDrawMode:2,TriangleStripDrawMode:1,TrianglesDrawMode:0,TubeGeometry:BB,UVMapping:xO,Uint16BufferAttribute:DN,Uint32BufferAttribute:LN,Uint8BufferAttribute:class extends IN{constructor(t,e,n){super(new Uint8Array(t),e,n)}},Uint8ClampedBufferAttribute:class extends IN{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}},Uniform:IV,UniformsGroup:class extends cD{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:DV++}),this.name="",this.usage=sD,this.uniforms=[]}add(t){return this.uniforms.push(t),this}remove(t){const e=this.uniforms.indexOf(t);return-1!==e&&this.uniforms.splice(e,1),this}setName(t){return this.name=t,this}setUsage(t){return this.usage=t,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(t){this.name=t.name,this.usage=t.usage;const e=t.uniforms;this.uniforms.length=0;for(let n=0,i=e.length;n<i;n++){const t=Array.isArray(e[n])?e[n]:[e[n]];for(let e=0;e<t.length;e++)this.uniforms.push(t[e].clone())}return this}clone(){return(new this.constructor).copy(this)}},UniformsLib:vH,UniformsUtils:oU,UnsignedByteType:UO,UnsignedInt101111Type:YO,UnsignedInt248Type:XO,UnsignedInt5999Type:qO,UnsignedIntType:VO,UnsignedShort4444Type:jO,UnsignedShort5551Type:GO,UnsignedShortType:BO,VSMShadowMap:3,Vector2:bD,Vector3:wD,Vector4:KD,VectorKeyframeTrack:vz,VideoFrameTexture:class extends pk{constructor(t,e,n,i,r,s,a,o){super({},t,e,n,i,r,s,a,o),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(t){this.image=t,this.needsUpdate=!0}},VideoTexture:pk,WebGL3DRenderTarget:class extends $D{constructor(t=1,e=1,n=1,i={}){super(t,e,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new QD(null,t,e,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}},WebGLArrayRenderTarget:class extends $D{constructor(t=1,e=1,n=1,i={}){super(t,e,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new JD(null,t,e,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}},WebGLCoordinateSystem:oD,WebGLCubeRenderTarget:vU,WebGLRenderTarget:$D,WebGLRenderer:Zj,WebGLUtils:Wj,WebGPUCoordinateSystem:lD,WebXRController:xU,WireframeGeometry:zB,WrapAroundEnding:HI,ZeroCurvatureEnding:zI,ZeroFactor:200,ZeroSlopeEnding:VI,ZeroStencilOp:0,createCanvasElement:ID},Symbol.toStringTag,{value:"Module"}));var Jj,Qj,tG={exports:{}},eG={};var nG=(Qj||(Qj=1,tG.exports=function(){if(Jj)return eG;Jj=1;var t=Ft(),e=Re(),n="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},i=e.useSyncExternalStore,r=t.useRef,s=t.useEffect,a=t.useMemo,o=t.useDebugValue;return eG.useSyncExternalStoreWithSelector=function(t,e,l,c,h){var u=r(null);if(null===u.current){var d={hasValue:!1,value:null};u.current=d}else d=u.current;u=a(function(){function t(t){if(!s){if(s=!0,i=t,t=c(t),void 0!==h&&d.hasValue){var e=d.value;if(h(e,t))return r=e}return r=t}if(e=r,n(i,t))return e;var a=c(t);return void 0!==h&&h(e,a)?(i=t,e):(i=t,r=a)}var i,r,s=!1,a=void 0===l?null:l;return[function(){return t(e())},null===a?void 0:function(){return t(a())}]},[e,l,c,h]);var p=i(t,u[0],u[1]);return s(function(){d.hasValue=!0,d.value=p},[p]),o(p),p},eG}()),tG.exports);const iG=Vt(nG),{useSyncExternalStoreWithSelector:rG}=iG,sG=t=>t;const aG=(t,e)=>{const n=mm(t),i=(t,i=e)=>function(t,e=sG,n){const i=rG(t.subscribe,t.getState,t.getInitialState,e,n);return Bt.useDebugValue(i),i}(n,t,i);return Object.assign(i,n),i},oG=(t,e)=>t?aG(t,e):aG;var lG,cG,hG={exports:{}},uG={};function dG(){return cG||(cG=1,hG.exports=(lG||(lG=1,function(t){function e(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,s=t[i];if(!(0<r(s,e)))break t;t[i]=e,t[n]=s,n=i}}function n(t){return 0===t.length?null:t[0]}function i(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,s=t.length,a=s>>>1;i<a;){var o=2*(i+1)-1,l=t[o],c=o+1,h=t[c];if(0>r(l,n))c<s&&0>r(h,l)?(t[i]=h,t[c]=n,i=c):(t[i]=l,t[o]=n,i=o);else{if(!(c<s&&0>r(h,n)))break t;t[i]=h,t[c]=n,i=c}}}return e}function r(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if(t.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],h=1,u=null,d=3,p=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function _(t){for(var r=n(c);null!==r;){if(null===r.callback)i(c);else{if(!(r.startTime<=t))break;i(c),r.sortIndex=r.expirationTime,e(l,r)}r=n(c)}}function x(t){if(m=!1,_(t),!f)if(null!==n(l))f=!0,P();else{var e=n(c);null!==e&&O(x,e.startTime-t)}}var b,M=!1,w=-1,S=5,T=-1;function E(){return!(t.unstable_now()-T<S)}function A(){if(M){var e=t.unstable_now();T=e;var r=!0;try{t:{f=!1,m&&(m=!1,v(w),w=-1),p=!0;var s=d;try{e:{for(_(e),u=n(l);null!==u&&!(u.expirationTime>e&&E());){var a=u.callback;if("function"==typeof a){u.callback=null,d=u.priorityLevel;var o=a(u.expirationTime<=e);if(e=t.unstable_now(),"function"==typeof o){u.callback=o,_(e),r=!0;break e}u===n(l)&&i(l),_(e)}else i(l);u=n(l)}if(null!==u)r=!0;else{var h=n(c);null!==h&&O(x,h.startTime-e),r=!1}}break t}finally{u=null,d=s,p=!1}r=void 0}}finally{r?b():M=!1}}}if("function"==typeof y)b=function(){y(A)};else if("undefined"!=typeof MessageChannel){var C=new MessageChannel,R=C.port2;C.port1.onmessage=A,b=function(){R.postMessage(null)}}else b=function(){g(A,0)};function P(){M||(M=!0,b())}function O(e,n){w=g(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(t){t.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,P())},t.unstable_forceFrameRate=function(t){0>t||125<t||(S=0<t?Math.floor(1e3/t):5)},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_scheduleCallback=function(i,r,s){var a=t.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?a+s:a,i){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return i={id:h++,callback:r,priorityLevel:i,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(i.sortIndex=s,e(c,i),null===n(l)&&i===n(c)&&(m?(v(w),w=-1):m=!0,O(x,s-a))):(i.sortIndex=o,e(l,i),f||p||(f=!0,P())),i},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(t){var e=d;return function(){var n=d;d=e;try{return t.apply(this,arguments)}finally{d=n}}}}(uG)),uG)),hG.exports}var pG=dG();function fG(t,e,n){if(!t)return;if(!0===n(t))return t;let i=e?t.return:t.child;for(;i;){const t=fG(i,e,n);if(t)return t;i=e?null:i.sibling}}function mG(t){try{return Object.defineProperties(t,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(e){return t}}const gG=mG(kt.createContext(null));class vG extends kt.Component{render(){return kt.createElement(gG.Provider,{value:this._reactInternals},this.props.children)}}function yG(){const t=kt.useContext(gG);if(null===t)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=kt.useId();return kt.useMemo(()=>{for(const n of[t,null==t?void 0:t.alternate]){if(!n)continue;const t=fG(n,!1,t=>{let n=t.memoizedState;for(;n;){if(n.memoizedState===e)return!0;n=n.next}});if(t)return t}},[t,e])}const _G=Symbol.for("react.context"),xG=t=>null!==t&&"object"==typeof t&&"$$typeof"in t&&t.$$typeof===_G;function bG(){const t=function(){const t=yG(),[e]=kt.useState(()=>new Map);e.clear();let n=t;for(;n;){const t=n.type;xG(t)&&t!==gG&&!e.has(t)&&e.set(t,kt.use(mG(t))),n=n.return}return e}();return kt.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>kt.createElement(e,null,kt.createElement(n.Provider,{...i,value:t.get(n)})),t=>kt.createElement(vG,{...t})),[t])}const MG=(()=>parseInt(IP.replace(/\D+/g,"")))();var wG=Uint8Array,SG=Uint16Array,TG=Uint32Array,EG=new wG([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),AG=new wG([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),CG=new wG([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),RG=function(t,e){for(var n=new SG(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new TG(n[30]);for(i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)r[s]=s-n[i]<<5|i;return[n,r]},PG=RG(EG,2),OG=PG[0],IG=PG[1];OG[28]=258,IG[258]=28;for(var DG=RG(AG,0)[0],LG=new SG(32768),NG=0;NG<32768;++NG){var UG=(43690&NG)>>>1|(21845&NG)<<1;UG=(61680&(UG=(52428&UG)>>>2|(13107&UG)<<2))>>>4|(3855&UG)<<4,LG[NG]=((65280&UG)>>>8|(255&UG)<<8)>>>1}var FG=function(t,e,n){for(var i=t.length,r=0,s=new SG(e);r<i;++r)++s[t[r]-1];var a,o=new SG(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;if(n){a=new SG(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],h=e-t[r],u=o[t[r]-1]++<<h,d=u|(1<<h)-1;u<=d;++u)a[LG[u]>>>l]=c}else for(a=new SG(i),r=0;r<i;++r)t[r]&&(a[r]=LG[o[t[r]-1]++]>>>15-t[r]);return a},kG=new wG(288);for(NG=0;NG<144;++NG)kG[NG]=8;for(NG=144;NG<256;++NG)kG[NG]=9;for(NG=256;NG<280;++NG)kG[NG]=7;for(NG=280;NG<288;++NG)kG[NG]=8;var BG=new wG(32);for(NG=0;NG<32;++NG)BG[NG]=5;var zG=FG(kG,9,1),VG=FG(BG,5,1),HG=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},WG=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(7&e)&n},jG=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},GG=function(t){return(t/8|0)+(7&t&&1)},XG=function(t,e,n){var i=t.length;if(!i||n&&!n.l&&i<5)return e||new wG(0);var r=!e||n,s=!n||n.i;n||(n={}),e||(e=new wG(3*i));var a=function(t){var n=e.length;if(t>n){var i=new wG(Math.max(2*n,t));i.set(e),e=i}},o=n.f||0,l=n.p||0,c=n.b||0,h=n.l,u=n.d,d=n.m,p=n.n,f=8*i;do{if(!h){n.f=o=WG(t,l,1);var m=WG(t,l+1,3);if(l+=3,!m){var g=t[(A=GG(l)+4)-4]|t[A-3]<<8,v=A+g;if(v>i){if(s)throw"unexpected EOF";break}r&&a(c+g),e.set(t.subarray(A,v),c),n.b=c+=g,n.p=l=8*v;continue}if(1==m)h=zG,u=VG,d=9,p=5;else{if(2!=m)throw"invalid block type";var y=WG(t,l,31)+257,_=WG(t,l+10,15)+4,x=y+WG(t,l+5,31)+1;l+=14;for(var b=new wG(x),M=new wG(19),w=0;w<_;++w)M[CG[w]]=WG(t,l+3*w,7);l+=3*_;var S=HG(M),T=(1<<S)-1,E=FG(M,S,1);for(w=0;w<x;){var A,C=E[WG(t,l,T)];if(l+=15&C,(A=C>>>4)<16)b[w++]=A;else{var R=0,P=0;for(16==A?(P=3+WG(t,l,3),l+=2,R=b[w-1]):17==A?(P=3+WG(t,l,7),l+=3):18==A&&(P=11+WG(t,l,127),l+=7);P--;)b[w++]=R}}var O=b.subarray(0,y),I=b.subarray(y);d=HG(O),p=HG(I),h=FG(O,d,1),u=FG(I,p,1)}if(l>f){if(s)throw"unexpected EOF";break}}r&&a(c+131072);for(var D=(1<<d)-1,L=(1<<p)-1,N=l;;N=l){var U=(R=h[jG(t,l)&D])>>>4;if((l+=15&R)>f){if(s)throw"unexpected EOF";break}if(!R)throw"invalid length/literal";if(U<256)e[c++]=U;else{if(256==U){N=l,h=null;break}var F=U-254;if(U>264){var k=EG[w=U-257];F=WG(t,l,(1<<k)-1)+OG[w],l+=k}var B=u[jG(t,l)&L],z=B>>>4;if(!B)throw"invalid distance";l+=15&B;I=DG[z];if(z>3){k=AG[z];I+=jG(t,l)&(1<<k)-1,l+=k}if(l>f){if(s)throw"unexpected EOF";break}r&&a(c+131072);for(var V=c+F;c<V;c+=4)e[c]=e[c-I],e[c+1]=e[c+1-I],e[c+2]=e[c+2-I],e[c+3]=e[c+3-I];c=V}}n.l=h,n.p=N,n.b=c,h&&(o=1,n.m=d,n.d=u,n.n=p)}while(!o);return c==e.length?e:function(t,e,n){(null==n||n>t.length)&&(n=t.length);var i=new(t instanceof SG?SG:t instanceof TG?TG:wG)(n-e);return i.set(t.subarray(e,n)),i}(e,0,c)},qG=new wG(0);function YG(t,e){return XG((function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"}(t),t.subarray(2,-4)),e)}var KG="undefined"!=typeof TextDecoder&&new TextDecoder;try{KG.decode(qG,{stream:!0})}catch(EX){}class ZG extends eU{constructor(t,e){var n,i;const r=(s=t)&&s.isCubeTexture;var s;const a=(null!=(i=r?null==(n=t.image[0])?void 0:n.width:t.image.width)?i:1024)/4,o=Math.floor(Math.log2(a)),l=Math.pow(2,o),c=[r?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH "+1/(3*Math.max(l,112)),"#define CUBEUV_TEXEL_HEIGHT "+1/(4*l),`#define CUBEUV_MAX_MIP ${o}.0`].join("\n")+`\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <${MG>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n        `,h={map:{value:t},height:{value:(null==e?void 0:e.height)||15},radius:{value:(null==e?void 0:e.radius)||100}};super(new RB(1,16),new lU({uniforms:h,fragmentShader:c,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:2}))}set radius(t){this.material.uniforms.radius.value=t}get radius(){return this.material.uniforms.radius.value}set height(t){this.material.uniforms.height.value=t}get height(){return this.material.uniforms.height.value}}var $G=Object.defineProperty,JG=(t,e,n)=>(((t,e,n)=>{e in t?$G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,e+"",n),n);class QG{constructor(){JG(this,"_listeners")}addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}var tX=Object.defineProperty,eX=(t,e,n)=>(((t,e,n)=>{e in t?tX(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const nX=new EL,iX=new _F,rX=Math.cos(Math.PI/180*70),sX=(t,e)=>(t%e+e)%e;class aX extends QG{constructor(t,e){super(),eX(this,"object"),eX(this,"domElement"),eX(this,"enabled",!0),eX(this,"target",new wD),eX(this,"minDistance",0),eX(this,"maxDistance",1/0),eX(this,"minZoom",0),eX(this,"maxZoom",1/0),eX(this,"minPolarAngle",0),eX(this,"maxPolarAngle",Math.PI),eX(this,"minAzimuthAngle",-1/0),eX(this,"maxAzimuthAngle",1/0),eX(this,"enableDamping",!1),eX(this,"dampingFactor",.05),eX(this,"enableZoom",!0),eX(this,"zoomSpeed",1),eX(this,"enableRotate",!0),eX(this,"rotateSpeed",1),eX(this,"enablePan",!0),eX(this,"panSpeed",1),eX(this,"screenSpacePanning",!0),eX(this,"keyPanSpeed",7),eX(this,"zoomToCursor",!1),eX(this,"autoRotate",!1),eX(this,"autoRotateSpeed",2),eX(this,"reverseOrbit",!1),eX(this,"reverseHorizontalOrbit",!1),eX(this,"reverseVerticalOrbit",!1),eX(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),eX(this,"mouseButtons",{LEFT:DP.ROTATE,MIDDLE:DP.DOLLY,RIGHT:DP.PAN}),eX(this,"touches",{ONE:LP.ROTATE,TWO:LP.DOLLY_PAN}),eX(this,"target0"),eX(this,"position0"),eX(this,"zoom0"),eX(this,"_domElementKeyEvents",null),eX(this,"getPolarAngle"),eX(this,"getAzimuthalAngle"),eX(this,"setPolarAngle"),eX(this,"setAzimuthalAngle"),eX(this,"getDistance"),eX(this,"getZoomScale"),eX(this,"listenToKeyEvents"),eX(this,"stopListenToKeyEvents"),eX(this,"saveState"),eX(this,"reset"),eX(this,"update"),eX(this,"connect"),eX(this,"dispose"),eX(this,"dollyIn"),eX(this,"dollyOut"),eX(this,"getScale"),eX(this,"setScale"),this.object=t,this.domElement=e,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=t=>{let e=sX(t,2*Math.PI),i=c.phi;i<0&&(i+=2*Math.PI),e<0&&(e+=2*Math.PI);let r=Math.abs(e-i);2*Math.PI-r<r&&(e<i?e+=2*Math.PI:i+=2*Math.PI),h.phi=e-i,n.update()},this.setAzimuthalAngle=t=>{let e=sX(t,2*Math.PI),i=c.theta;i<0&&(i+=2*Math.PI),e<0&&(e+=2*Math.PI);let r=Math.abs(e-i);2*Math.PI-r<r&&(e<i?e+=2*Math.PI:i+=2*Math.PI),h.theta=e-i,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",Z),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Z),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),o=a.NONE},this.update=(()=>{const e=new wD,r=new wD(0,1,0),s=(new MD).setFromUnitVectors(t.up,r),p=s.clone().invert(),f=new wD,m=new MD,g=2*Math.PI;return function(){const v=n.object.position;s.setFromUnitVectors(t.up,r),p.copy(s).invert(),e.copy(v).sub(n.target),e.applyQuaternion(s),c.setFromVector3(e),n.autoRotate&&o===a.NONE&&C(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=h.theta*n.dampingFactor,c.phi+=h.phi*n.dampingFactor):(c.theta+=h.theta,c.phi+=h.phi);let y=n.minAzimuthAngle,_=n.maxAzimuthAngle;isFinite(y)&&isFinite(_)&&(y<-Math.PI?y+=g:y>Math.PI&&(y-=g),_<-Math.PI?_+=g:_>Math.PI&&(_-=g),c.theta=y<=_?Math.max(y,Math.min(_,c.theta)):c.theta>(y+_)/2?Math.max(y,c.theta):Math.min(_,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),n.zoomToCursor&&S||n.object.isOrthographicCamera?c.radius=F(c.radius):c.radius=F(c.radius*u),e.setFromSpherical(c),e.applyQuaternion(p),v.copy(n.target).add(e),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(h.theta*=1-n.dampingFactor,h.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(h.set(0,0,0),d.set(0,0,0));let x=!1;if(n.zoomToCursor&&S){let i=null;if(n.object instanceof pU&&n.object.isPerspectiveCamera){const t=e.length();i=F(t*u);const r=t-i;n.object.position.addScaledVector(M,r),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const t=new wD(w.x,w.y,0);t.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix(),x=!0;const r=new wD(w.x,w.y,0);r.unproject(n.object),n.object.position.sub(r).add(t),n.object.updateMatrixWorld(),i=e.length()}else n.zoomToCursor=!1;null!==i&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(i).add(n.object.position):(nX.origin.copy(n.object.position),nX.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(nX.direction))<rX?t.lookAt(n.target):(iX.setFromNormalAndCoplanarPoint(n.object.up,n.target),nX.intersectPlane(iX,n.target))))}else n.object instanceof jz&&n.object.isOrthographicCamera&&(x=1!==u,x&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix()));return u=1,S=!1,!!(x||f.distanceToSquared(n.object.position)>l||8*(1-m.dot(n.object.quaternion))>l)&&(n.dispatchEvent(i),f.copy(n.object.position),m.copy(n.object.quaternion),x=!1,!0)}})(),this.connect=t=>{n.domElement=t,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",$),n.domElement.addEventListener("pointerdown",X),n.domElement.addEventListener("pointercancel",Y),n.domElement.addEventListener("wheel",K)},this.dispose=()=>{var t,e,i,r,s,a;n.domElement&&(n.domElement.style.touchAction="auto"),null==(t=n.domElement)||t.removeEventListener("contextmenu",$),null==(e=n.domElement)||e.removeEventListener("pointerdown",X),null==(i=n.domElement)||i.removeEventListener("pointercancel",Y),null==(r=n.domElement)||r.removeEventListener("wheel",K),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointermove",q),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointerup",Y),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",Z)};const n=this,i={type:"change"},r={type:"start"},s={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=a.NONE;const l=1e-6,c=new BV,h=new BV;let u=1;const d=new wD,p=new bD,f=new bD,m=new bD,g=new bD,v=new bD,y=new bD,_=new bD,x=new bD,b=new bD,M=new wD,w=new bD;let S=!1;const T=[],E={};function A(){return Math.pow(.95,n.zoomSpeed)}function C(t){n.reverseOrbit||n.reverseHorizontalOrbit?h.theta+=t:h.theta-=t}function R(t){n.reverseOrbit||n.reverseVerticalOrbit?h.phi+=t:h.phi-=t}const P=(()=>{const t=new wD;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),d.add(t)}})(),O=(()=>{const t=new wD;return function(e,i){!0===n.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),d.add(t)}})(),I=(()=>{const t=new wD;return function(e,i){const r=n.domElement;if(r&&n.object instanceof pU&&n.object.isPerspectiveCamera){const s=n.object.position;t.copy(s).sub(n.target);let a=t.length();a*=Math.tan(n.object.fov/2*Math.PI/180),P(2*e*a/r.clientHeight,n.object.matrix),O(2*i*a/r.clientHeight,n.object.matrix)}else r&&n.object instanceof jz&&n.object.isOrthographicCamera?(P(e*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),O(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):n.enablePan=!1}})();function D(t){n.object instanceof pU&&n.object.isPerspectiveCamera||n.object instanceof jz&&n.object.isOrthographicCamera?u=t:n.enableZoom=!1}function L(t){D(u/t)}function N(t){D(u*t)}function U(t){if(!n.zoomToCursor||!n.domElement)return;S=!0;const e=n.domElement.getBoundingClientRect(),i=t.clientX-e.left,r=t.clientY-e.top,s=e.width,a=e.height;w.x=i/s*2-1,w.y=-r/a*2+1,M.set(w.x,w.y,1).unproject(n.object).sub(n.object.position).normalize()}function F(t){return Math.max(n.minDistance,Math.min(n.maxDistance,t))}function k(t){p.set(t.clientX,t.clientY)}function B(t){g.set(t.clientX,t.clientY)}function z(){if(1==T.length)p.set(T[0].pageX,T[0].pageY);else{const t=.5*(T[0].pageX+T[1].pageX),e=.5*(T[0].pageY+T[1].pageY);p.set(t,e)}}function V(){if(1==T.length)g.set(T[0].pageX,T[0].pageY);else{const t=.5*(T[0].pageX+T[1].pageX),e=.5*(T[0].pageY+T[1].pageY);g.set(t,e)}}function H(){const t=T[0].pageX-T[1].pageX,e=T[0].pageY-T[1].pageY,n=Math.sqrt(t*t+e*e);_.set(0,n)}function W(t){if(1==T.length)f.set(t.pageX,t.pageY);else{const e=Q(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);f.set(n,i)}m.subVectors(f,p).multiplyScalar(n.rotateSpeed);const e=n.domElement;e&&(C(2*Math.PI*m.x/e.clientHeight),R(2*Math.PI*m.y/e.clientHeight)),p.copy(f)}function j(t){if(1==T.length)v.set(t.pageX,t.pageY);else{const e=Q(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);v.set(n,i)}y.subVectors(v,g).multiplyScalar(n.panSpeed),I(y.x,y.y),g.copy(v)}function G(t){const e=Q(t),i=t.pageX-e.x,r=t.pageY-e.y,s=Math.sqrt(i*i+r*r);x.set(0,s),b.set(0,Math.pow(x.y/_.y,n.zoomSpeed)),L(b.y),_.copy(x)}function X(t){var e,i;!1!==n.enabled&&(0===T.length&&(null==(e=n.domElement)||e.ownerDocument.addEventListener("pointermove",q),null==(i=n.domElement)||i.ownerDocument.addEventListener("pointerup",Y)),function(t){T.push(t)}(t),"touch"===t.pointerType?function(t){switch(J(t),T.length){case 1:switch(n.touches.ONE){case LP.ROTATE:if(!1===n.enableRotate)return;z(),o=a.TOUCH_ROTATE;break;case LP.PAN:if(!1===n.enablePan)return;V(),o=a.TOUCH_PAN;break;default:o=a.NONE}break;case 2:switch(n.touches.TWO){case LP.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&H(),n.enablePan&&V(),o=a.TOUCH_DOLLY_PAN;break;case LP.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&H(),n.enableRotate&&z(),o=a.TOUCH_DOLLY_ROTATE;break;default:o=a.NONE}break;default:o=a.NONE}o!==a.NONE&&n.dispatchEvent(r)}(t):function(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case DP.DOLLY:if(!1===n.enableZoom)return;!function(t){U(t),_.set(t.clientX,t.clientY)}(t),o=a.DOLLY;break;case DP.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;B(t),o=a.PAN}else{if(!1===n.enableRotate)return;k(t),o=a.ROTATE}break;case DP.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;k(t),o=a.ROTATE}else{if(!1===n.enablePan)return;B(t),o=a.PAN}break;default:o=a.NONE}o!==a.NONE&&n.dispatchEvent(r)}(t))}function q(t){!1!==n.enabled&&("touch"===t.pointerType?function(t){switch(J(t),o){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;W(t),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;j(t),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(t){n.enableZoom&&G(t),n.enablePan&&j(t)}(t),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(t){n.enableZoom&&G(t),n.enableRotate&&W(t)}(t),n.update();break;default:o=a.NONE}}(t):function(t){if(!1===n.enabled)return;switch(o){case a.ROTATE:if(!1===n.enableRotate)return;!function(t){f.set(t.clientX,t.clientY),m.subVectors(f,p).multiplyScalar(n.rotateSpeed);const e=n.domElement;e&&(C(2*Math.PI*m.x/e.clientHeight),R(2*Math.PI*m.y/e.clientHeight)),p.copy(f),n.update()}(t);break;case a.DOLLY:if(!1===n.enableZoom)return;!function(t){x.set(t.clientX,t.clientY),b.subVectors(x,_),b.y>0?L(A()):b.y<0&&N(A()),_.copy(x),n.update()}(t);break;case a.PAN:if(!1===n.enablePan)return;!function(t){v.set(t.clientX,t.clientY),y.subVectors(v,g).multiplyScalar(n.panSpeed),I(y.x,y.y),g.copy(v),n.update()}(t)}}(t))}function Y(t){var e,i,r;!function(t){delete E[t.pointerId];for(let e=0;e<T.length;e++)if(T[e].pointerId==t.pointerId)return void T.splice(e,1)}(t),0===T.length&&(null==(e=n.domElement)||e.releasePointerCapture(t.pointerId),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",q),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointerup",Y)),n.dispatchEvent(s),o=a.NONE}function K(t){!1===n.enabled||!1===n.enableZoom||o!==a.NONE&&o!==a.ROTATE||(t.preventDefault(),n.dispatchEvent(r),function(t){U(t),t.deltaY<0?N(A()):t.deltaY>0&&L(A()),n.update()}(t),n.dispatchEvent(s))}function Z(t){!1!==n.enabled&&!1!==n.enablePan&&function(t){let e=!1;switch(t.code){case n.keys.UP:I(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:I(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:I(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:I(-n.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),n.update())}(t)}function $(t){!1!==n.enabled&&t.preventDefault()}function J(t){let e=E[t.pointerId];void 0===e&&(e=new bD,E[t.pointerId]=e),e.set(t.pageX,t.pageY)}function Q(t){const e=t.pointerId===T[0].pointerId?T[1]:T[0];return E[e.pointerId]}this.dollyIn=(t=A())=>{N(t),n.update()},this.dollyOut=(t=A())=>{L(t),n.update()},this.getScale=()=>u,this.setScale=t=>{D(t),n.update()},this.getZoomScale=()=>A(),void 0!==e&&this.connect(e),this.update()}}const oX={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},lX={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "};class cX extends Pz{constructor(t){super(t),this.type=WO}parse(t){const e=function(t,e){switch(t){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(e||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(e||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(e||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(e||""))}},n=function(t,e,n){e=e||1024;let i=t.pos,r=-1,s=0,a="",o=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));for(;0>(r=o.indexOf("\n"))&&s<e&&i<t.byteLength;)a+=o,s+=o.length,i+=128,o+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));return-1<r&&(t.pos+=s+r+1,a+o.slice(0,r))},i=function(t,e,n,i){const r=t[e+3],s=Math.pow(2,r-128)/255;n[i+0]=t[e+0]*s,n[i+1]=t[e+1]*s,n[i+2]=t[e+2]*s,n[i+3]=1},r=function(t,e,n,i){const r=t[e+3],s=Math.pow(2,r-128)/255;n[i+0]=CN.toHalfFloat(Math.min(t[e+0]*s,65504)),n[i+1]=CN.toHalfFloat(Math.min(t[e+1]*s,65504)),n[i+2]=CN.toHalfFloat(Math.min(t[e+2]*s,65504)),n[i+3]=CN.toHalfFloat(1)},s=new Uint8Array(t);s.pos=0;const a=function(t){const i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,o={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;for((t.pos>=t.byteLength||!(l=n(t)))&&e(1,"no header found"),(c=l.match(/^#\?(\S+)/))||e(3,"bad initial token"),o.valid|=1,o.programtype=c[1],o.string+=l+"\n";l=n(t),!1!==l;)if(o.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(i))&&(o.gamma=parseFloat(c[1])),(c=l.match(r))&&(o.exposure=parseFloat(c[1])),(c=l.match(s))&&(o.valid|=2,o.format=c[1]),(c=l.match(a))&&(o.valid|=4,o.height=parseInt(c[1],10),o.width=parseInt(c[2],10)),2&o.valid&&4&o.valid)break}else o.comments+=l+"\n";return 2&o.valid||e(3,"missing format specifier"),4&o.valid||e(3,"missing image size specifier"),o}(s),o=a.width,l=a.height,c=function(t,n,i){const r=n;if(r<8||r>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);r!==(t[2]<<8|t[3])&&e(3,"wrong scanline width");const s=new Uint8Array(4*n*i);s.length||e(4,"unable to allocate buffer space");let a=0,o=0;const l=4*r,c=new Uint8Array(4),h=new Uint8Array(l);let u=i;for(;u>0&&o<t.byteLength;){o+4>t.byteLength&&e(1),c[0]=t[o++],c[1]=t[o++],c[2]=t[o++],c[3]=t[o++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==r||e(3,"bad rgbe scanline format");let n,i=0;for(;i<l&&o<t.byteLength;){n=t[o++];const r=n>128;if(r&&(n-=128),(0===n||i+n>l)&&e(3,"bad scanline data"),r){const e=t[o++];for(let t=0;t<n;t++)h[i++]=e}else h.set(t.subarray(o,o+n),i),i+=n,o+=n}const d=r;for(let t=0;t<d;t++){let e=0;s[a]=h[t+e],e+=r,s[a+1]=h[t+e],e+=r,s[a+2]=h[t+e],e+=r,s[a+3]=h[t+e],a+=4}u--}return s}(s.subarray(s.pos),o,l);let h,u,d;switch(this.type){case HO:d=c.length/4;const t=new Float32Array(4*d);for(let n=0;n<d;n++)i(c,4*n,t,4*n);h=t,u=HO;break;case WO:d=c.length/4;const e=new Uint16Array(4*d);for(let n=0;n<d;n++)r(c,4*n,e,4*n);h=e,u=WO;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:o,height:l,data:h,header:a.string,gamma:a.gamma,exposure:a.exposure,type:u}}setDataType(t){return this.type=t,this}load(t,e,n,i){return super.load(t,function(t,n){switch(t.type){case HO:case WO:"colorSpace"in t?t.colorSpace="srgb-linear":t.encoding=3e3,t.minFilter=IO,t.magFilter=IO,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,n)},n,i)}}const hX=MG>=152;class uX extends Pz{constructor(t){super(t),this.type=WO}parse(t){const e=65536,n=14,i=65537,r=16384,s=Math.pow(2.7182818,2.2);const a={l:0,c:0,lc:0};function o(t,e,n,i,r){for(;n<t;)e=e<<8|V(i,r),n+=8;n-=t,a.l=e>>n&(1<<t)-1,a.c=e,a.lc=n}const l=new Array(59);function c(t,e,n,r,s,c,h){for(var u=n,d=0,p=0;s<=c;s++){if(u.value-n.value>r)return!1;o(6,d,p,t,u);var f=a.l;if(d=a.c,p=a.lc,h[s]=f,63==f){if(u.value-n.value>r)throw"Something wrong with hufUnpackEncTable";o(8,d,p,t,u);var m=a.l+6;if(d=a.c,p=a.lc,s+m>c+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)h[s++]=0;s--}else if(f>=59){if(s+(m=f-59+2)>c+1)throw"Something wrong with hufUnpackEncTable";for(;m--;)h[s++]=0;s--}}!function(t){for(var e=0;e<=58;++e)l[e]=0;for(e=0;e<i;++e)l[t[e]]+=1;var n=0;for(e=58;e>0;--e){var r=n+l[e]>>1;l[e]=n,n=r}for(e=0;e<i;++e){var s=t[e];s>0&&(t[e]=s|l[s]++<<6)}}(h)}function h(t){return 63&t}function u(t){return t>>6}const d={c:0,lc:0};function p(t,e,n,i){t=t<<8|V(n,i),e+=8,d.c=t,d.lc=e}const f={c:0,lc:0};function m(t,e,n,i,r,s,a,o,l,c){if(t==e){i<8&&(p(n,i,r,a),n=d.c,i=d.lc);var h=n>>(i-=8);h=new Uint8Array([h])[0];if(l.value+h>c)return!1;for(var u=o[l.value-1];h-- >0;)o[l.value++]=u}else{if(!(l.value<c))return!1;o[l.value++]=t}f.c=n,f.lc=i}function g(t){return 65535&t}function v(t){var e=g(t);return e>32767?e-65536:e}const y={a:0,b:0};function _(t,e){var n=v(t),i=v(e),r=n+(1&i)+(i>>1),s=r,a=r-i;y.a=s,y.b=a}function x(t,e){var n=g(t),i=g(e),r=n-(i>>1)&65535,s=i+r-32768&65535;y.a=s,y.b=r}function b(t,e,n,i,r,s,a){for(var o,l=a<16384,c=n>r?r:n,h=1;h<=c;)h<<=1;for(o=h>>=1,h>>=1;h>=1;){for(var u,d,p,f,m=0,g=m+s*(r-o),v=s*h,b=s*o,M=i*h,w=i*o;m<=g;m+=b){for(var S=m,T=m+i*(n-o);S<=T;S+=w){var E=S+M,A=(C=S+v)+M;l?(_(t[S+e],t[C+e]),u=y.a,p=y.b,_(t[E+e],t[A+e]),d=y.a,f=y.b,_(u,d),t[S+e]=y.a,t[E+e]=y.b,_(p,f),t[C+e]=y.a,t[A+e]=y.b):(x(t[S+e],t[C+e]),u=y.a,p=y.b,x(t[E+e],t[A+e]),d=y.a,f=y.b,x(u,d),t[S+e]=y.a,t[E+e]=y.b,x(p,f),t[C+e]=y.a,t[A+e]=y.b)}if(n&h){var C=S+v;l?_(t[S+e],t[C+e]):x(t[S+e],t[C+e]),u=y.a,t[C+e]=y.b,t[S+e]=u}}if(r&h)for(S=m,T=m+i*(n-o);S<=T;S+=w){E=S+M;l?_(t[S+e],t[E+e]):x(t[S+e],t[E+e]),u=y.a,t[E+e]=y.b,t[S+e]=u}o=h,h>>=1}return m}function M(t,e,s,a,o,l){var g=s.value,v=z(e,s),y=z(e,s);s.value+=4;var _=z(e,s);if(s.value+=4,v<0||v>=i||y<0||y>=i)throw"Something wrong with HUF_ENCSIZE";var x=new Array(i),b=new Array(r);if(function(t){for(var e=0;e<r;e++)t[e]={},t[e].len=0,t[e].lit=0,t[e].p=null}(b),c(t,0,s,a-(s.value-g),v,y,x),_>8*(a-(s.value-g)))throw"Something wrong with hufUncompress";!function(t,e,i,r){for(;e<=i;e++){var s=u(t[e]),a=h(t[e]);if(s>>a)throw"Invalid table entry";if(a>n){if((d=r[s>>a-n]).len)throw"Invalid table entry";if(d.lit++,d.p){var o=d.p;d.p=new Array(d.lit);for(var l=0;l<d.lit-1;++l)d.p[l]=o[l]}else d.p=new Array(1);d.p[d.lit-1]=e}else if(a){var c=0;for(l=1<<n-a;l>0;l--){var d;if((d=r[(s<<n-a)+c]).len||d.p)throw"Invalid table entry";d.len=a,d.lit=e,c++}}}}(x,v,y,b),function(t,e,i,r,s,a,o,l,c,g){for(var v=0,y=0,_=l,x=Math.trunc(s.value+(a+7)/8);s.value<x;)for(p(v,y,i,s),v=d.c,y=d.lc;y>=n;)if((S=e[v>>y-n&16383]).len)y-=S.len,m(S.lit,o,v,y,i,0,s,c,g,_),v=f.c,y=f.lc;else{if(!S.p)throw"hufDecode issues";var b;for(b=0;b<S.lit;b++){for(var M=h(t[S.p[b]]);y<M&&s.value<x;)p(v,y,i,s),v=d.c,y=d.lc;if(y>=M&&u(t[S.p[b]])==(v>>y-M&(1<<M)-1)){y-=M,m(S.p[b],o,v,y,i,0,s,c,g,_),v=f.c,y=f.lc;break}}if(b==S.lit)throw"hufDecode issues"}var w=8-a&7;for(v>>=w,y-=w;y>0;){var S;if(!(S=e[v<<n-y&16383]).len)throw"hufDecode issues";y-=S.len,m(S.lit,o,v,y,i,0,s,c,g,_),v=f.c,y=f.lc}}(x,b,t,0,s,_,y,l,o,{value:0})}function w(t){for(var e=1;e<t.length;e++){var n=t[e-1]+t[e]-128;t[e]=n}}function S(t,e){for(var n=0,i=Math.floor((t.length+1)/2),r=0,s=t.length-1;!(r>s||(e[r++]=t[n++],r>s));)e[r++]=t[i++]}function T(t){for(var e=t.byteLength,n=new Array,i=0,r=new DataView(t);e>0;){var s=r.getInt8(i++);if(s<0){e-=(o=-s)+1;for(var a=0;a<o;a++)n.push(r.getUint8(i++))}else{var o=s;e-=2;var l=r.getUint8(i++);for(a=0;a<o+1;a++)n.push(l)}}return n}function E(t,e,n){for(var i,r=1;r<64;)65280==(i=e[t.value])?r=64:i>>8==255?r+=255&i:(n[r]=i,r++),t.value++}function A(t,e){e[0]=X(t[0]),e[1]=X(t[1]),e[2]=X(t[5]),e[3]=X(t[6]),e[4]=X(t[14]),e[5]=X(t[15]),e[6]=X(t[27]),e[7]=X(t[28]),e[8]=X(t[2]),e[9]=X(t[4]),e[10]=X(t[7]),e[11]=X(t[13]),e[12]=X(t[16]),e[13]=X(t[26]),e[14]=X(t[29]),e[15]=X(t[42]),e[16]=X(t[3]),e[17]=X(t[8]),e[18]=X(t[12]),e[19]=X(t[17]),e[20]=X(t[25]),e[21]=X(t[30]),e[22]=X(t[41]),e[23]=X(t[43]),e[24]=X(t[9]),e[25]=X(t[11]),e[26]=X(t[18]),e[27]=X(t[24]),e[28]=X(t[31]),e[29]=X(t[40]),e[30]=X(t[44]),e[31]=X(t[53]),e[32]=X(t[10]),e[33]=X(t[19]),e[34]=X(t[23]),e[35]=X(t[32]),e[36]=X(t[39]),e[37]=X(t[45]),e[38]=X(t[52]),e[39]=X(t[54]),e[40]=X(t[20]),e[41]=X(t[22]),e[42]=X(t[33]),e[43]=X(t[38]),e[44]=X(t[46]),e[45]=X(t[51]),e[46]=X(t[55]),e[47]=X(t[60]),e[48]=X(t[21]),e[49]=X(t[34]),e[50]=X(t[37]),e[51]=X(t[47]),e[52]=X(t[50]),e[53]=X(t[56]),e[54]=X(t[59]),e[55]=X(t[61]),e[56]=X(t[35]),e[57]=X(t[36]),e[58]=X(t[48]),e[59]=X(t[49]),e[60]=X(t[57]),e[61]=X(t[58]),e[62]=X(t[62]),e[63]=X(t[63])}function C(t){const e=.5*Math.cos(.7853975),n=.5*Math.cos(3.14159/16),i=.5*Math.cos(3.14159/8),r=.5*Math.cos(3*3.14159/16),s=.5*Math.cos(.981746875),a=.5*Math.cos(3*3.14159/8),o=.5*Math.cos(1.374445625);for(var l=new Array(4),c=new Array(4),h=new Array(4),u=new Array(4),d=0;d<8;++d){var p=8*d;l[0]=i*t[p+2],l[1]=a*t[p+2],l[2]=i*t[p+6],l[3]=a*t[p+6],c[0]=n*t[p+1]+r*t[p+3]+s*t[p+5]+o*t[p+7],c[1]=r*t[p+1]-o*t[p+3]-n*t[p+5]-s*t[p+7],c[2]=s*t[p+1]-n*t[p+3]+o*t[p+5]+r*t[p+7],c[3]=o*t[p+1]-s*t[p+3]+r*t[p+5]-n*t[p+7],h[0]=e*(t[p+0]+t[p+4]),h[3]=e*(t[p+0]-t[p+4]),h[1]=l[0]+l[3],h[2]=l[1]-l[2],u[0]=h[0]+h[1],u[1]=h[3]+h[2],u[2]=h[3]-h[2],u[3]=h[0]-h[1],t[p+0]=u[0]+c[0],t[p+1]=u[1]+c[1],t[p+2]=u[2]+c[2],t[p+3]=u[3]+c[3],t[p+4]=u[3]-c[3],t[p+5]=u[2]-c[2],t[p+6]=u[1]-c[1],t[p+7]=u[0]-c[0]}for(var f=0;f<8;++f)l[0]=i*t[16+f],l[1]=a*t[16+f],l[2]=i*t[48+f],l[3]=a*t[48+f],c[0]=n*t[8+f]+r*t[24+f]+s*t[40+f]+o*t[56+f],c[1]=r*t[8+f]-o*t[24+f]-n*t[40+f]-s*t[56+f],c[2]=s*t[8+f]-n*t[24+f]+o*t[40+f]+r*t[56+f],c[3]=o*t[8+f]-s*t[24+f]+r*t[40+f]-n*t[56+f],h[0]=e*(t[f]+t[32+f]),h[3]=e*(t[f]-t[32+f]),h[1]=l[0]+l[3],h[2]=l[1]-l[2],u[0]=h[0]+h[1],u[1]=h[3]+h[2],u[2]=h[3]-h[2],u[3]=h[0]-h[1],t[0+f]=u[0]+c[0],t[8+f]=u[1]+c[1],t[16+f]=u[2]+c[2],t[24+f]=u[3]+c[3],t[32+f]=u[3]-c[3],t[40+f]=u[2]-c[2],t[48+f]=u[1]-c[1],t[56+f]=u[0]-c[0]}function R(t){for(var e=0;e<64;++e){var n=t[0][e],i=t[1][e],r=t[2][e];t[0][e]=n+1.5747*r,t[1][e]=n-.1873*i-.4682*r,t[2][e]=n+1.8556*i}}function P(t,e,n){for(var i=0;i<64;++i)e[n+i]=CN.toHalfFloat(O(t[i]))}function O(t){return t<=1?Math.sign(t)*Math.pow(Math.abs(t),2.2):Math.sign(t)*Math.pow(s,Math.abs(t)-1)}function I(t){return new DataView(t.array.buffer,t.offset.value,t.size)}function D(t){var e=t.viewer.buffer.slice(t.offset.value,t.offset.value+t.size),n=new Uint8Array(T(e)),i=new Uint8Array(n.length);return w(n),S(n,i),new DataView(i.buffer)}function L(t){var e=YG(t.array.slice(t.offset.value,t.offset.value+t.size)),n=new Uint8Array(e.length);return w(e),S(e,n),new DataView(n.buffer)}function N(t){for(var n=t.viewer,i={value:t.offset.value},r=new Uint16Array(t.width*t.scanlineBlockSize*(t.channels*t.type)),s=new Uint8Array(8192),a=0,o=new Array(t.channels),l=0;l<t.channels;l++)o[l]={},o[l].start=a,o[l].end=o[l].start,o[l].nx=t.width,o[l].ny=t.lines,o[l].size=t.type,a+=o[l].nx*o[l].ny*o[l].size;var c=q(n,i),h=q(n,i);if(h>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=h)for(l=0;l<h-c+1;l++)s[l+c]=H(n,i);var u=new Uint16Array(e),d=function(t,n){for(var i=0,r=0;r<e;++r)(0==r||t[r>>3]&1<<(7&r))&&(n[i++]=r);for(var s=i-1;i<e;)n[i++]=0;return s}(s,u),p=z(n,i);M(t.array,n,i,p,r,a);for(l=0;l<t.channels;++l)for(var f=o[l],m=0;m<o[l].size;++m)b(r,f.start+m,f.nx,f.size,f.ny,f.nx*f.size,d);!function(t,e,n){for(var i=0;i<n;++i)e[i]=t[e[i]]}(u,r,a);for(var g=0,v=new Uint8Array(r.buffer.byteLength),y=0;y<t.lines;y++)for(var _=0;_<t.channels;_++){var x=(f=o[_]).nx*f.size,w=new Uint8Array(r.buffer,2*f.end,2*x);v.set(w,g),g+=2*x,f.end+=x}return new DataView(v.buffer)}function U(t){var e=YG(t.array.slice(t.offset.value,t.offset.value+t.size));const n=t.lines*t.channels*t.width,i=1==t.type?new Uint16Array(n):new Uint32Array(n);let r=0,s=0;const a=new Array(4);for(let o=0;o<t.lines;o++)for(let n=0;n<t.channels;n++){let n=0;switch(t.type){case 1:a[0]=r,a[1]=a[0]+t.width,r=a[1]+t.width;for(let r=0;r<t.width;++r){n+=e[a[0]++]<<8|e[a[1]++],i[s]=n,s++}break;case 2:a[0]=r,a[1]=a[0]+t.width,a[2]=a[1]+t.width,r=a[2]+t.width;for(let r=0;r<t.width;++r){n+=e[a[0]++]<<24|e[a[1]++]<<16|e[a[2]++]<<8,i[s]=n,s++}}}return new DataView(i.buffer)}function F(t){var e=t.viewer,n={value:t.offset.value},i=new Uint8Array(t.width*t.lines*(t.channels*t.type*2)),r={version:W(e,n),unknownUncompressedSize:W(e,n),unknownCompressedSize:W(e,n),acCompressedSize:W(e,n),dcCompressedSize:W(e,n),rleCompressedSize:W(e,n),rleUncompressedSize:W(e,n),rleRawSize:W(e,n),totalAcUncompressedCount:W(e,n),totalDcUncompressedCount:W(e,n),acCompression:W(e,n)};if(r.version<2)throw"EXRLoader.parse: "+Q.compression+" version "+r.version+" is unsupported";for(var s=new Array,a=q(e,n)-2;a>0;){var o=k(e.buffer,n),l=H(e,n),c=l>>2&3,h=new Int8Array([(l>>4)-1])[0],u=H(e,n);s.push({name:o,index:h,type:u,compression:c}),a-=o.length+3}for(var d=Q.channels,p=new Array(t.channels),f=0;f<t.channels;++f){var m=p[f]={},g=d[f];m.name=g.name,m.compression=0,m.decoded=!1,m.type=g.pixelType,m.pLinear=g.pLinear,m.width=t.width,m.height=t.lines}for(var v={idx:new Array(3)},y=0;y<t.channels;++y)for(m=p[y],f=0;f<s.length;++f){var _=s[f];m.name==_.name&&(m.compression=_.compression,_.index>=0&&(v.idx[_.index]=y),m.offset=y)}if(r.acCompressedSize>0)switch(r.acCompression){case 0:var x=new Uint16Array(r.totalAcUncompressedCount);M(t.array,e,n,r.acCompressedSize,x,r.totalAcUncompressedCount);break;case 1:var b=YG(t.array.slice(n.value,n.value+r.totalAcUncompressedCount));x=new Uint16Array(b.buffer);n.value+=r.totalAcUncompressedCount}if(r.dcCompressedSize>0){var w={array:t.array,offset:n,size:r.dcCompressedSize},S=new Uint16Array(L(w).buffer);n.value+=r.dcCompressedSize}if(r.rleRawSize>0){var O=T((b=YG(t.array.slice(n.value,n.value+r.rleCompressedSize))).buffer);n.value+=r.rleCompressedSize}var I=0,D=new Array(p.length);for(f=0;f<D.length;++f)D[f]=new Array;for(var N=0;N<t.lines;++N)for(var U=0;U<p.length;++U)D[U].push(I),I+=p[U].width*t.type*2;!function(t,e,n,i,r,s){var a=new DataView(s.buffer),o=n[t.idx[0]].width,l=n[t.idx[0]].height,c=Math.floor(o/8),h=Math.ceil(o/8),u=Math.ceil(l/8),d=o-8*(h-1),p=l-8*(u-1),f={value:0},m=new Array(3),g=new Array(3),v=new Array(3),y=new Array(3),_=new Array(3);for(let E=0;E<3;++E)_[E]=e[t.idx[E]],m[E]=E<1?0:m[E-1]+h*u,g[E]=new Float32Array(64),v[E]=new Uint16Array(64),y[E]=new Uint16Array(64*h);for(let I=0;I<u;++I){var x=8;I==u-1&&(x=p);var b=8;for(let t=0;t<h;++t){t==h-1&&(b=d);for(let t=0;t<3;++t)v[t].fill(0),v[t][0]=r[m[t]++],E(f,i,v[t]),A(v[t],g[t]),C(g[t]);R(g);for(let e=0;e<3;++e)P(g[e],y[e],64*t)}let e=0;for(let i=0;i<3;++i){const r=n[t.idx[i]].type;for(let t=8*I;t<8*I+x;++t){e=_[i][t];for(let n=0;n<c;++n){const s=64*n+8*(7&t);a.setUint16(e+0*r,y[i][s+0],!0),a.setUint16(e+2*r,y[i][s+1],!0),a.setUint16(e+4*r,y[i][s+2],!0),a.setUint16(e+6*r,y[i][s+3],!0),a.setUint16(e+8*r,y[i][s+4],!0),a.setUint16(e+10*r,y[i][s+5],!0),a.setUint16(e+12*r,y[i][s+6],!0),a.setUint16(e+14*r,y[i][s+7],!0),e+=16*r}}if(c!=h)for(let t=8*I;t<8*I+x;++t){const e=_[i][t]+8*c*2*r,n=64*c+8*(7&t);for(let t=0;t<b;++t)a.setUint16(e+2*t*r,y[i][n+t],!0)}}}for(var M=new Uint16Array(o),w=(a=new DataView(s.buffer),0);w<3;++w){n[t.idx[w]].decoded=!0;var S=n[t.idx[w]].type;if(2==n[w].type)for(var T=0;T<l;++T){const t=_[w][T];for(var O=0;O<o;++O)M[O]=a.getUint16(t+2*O*S,!0);for(O=0;O<o;++O)a.setFloat32(t+2*O*S,X(M[O]),!0)}}}(v,D,p,x,S,i);for(f=0;f<p.length;++f){if(!(m=p[f]).decoded){if(2!==m.compression)throw"EXRLoader.parse: unsupported channel compression";var F=0,B=0;for(N=0;N<t.lines;++N){for(var z=D[f][F],V=0;V<m.width;++V){for(var j=0;j<2*m.type;++j)i[z++]=O[B+j*m.width*m.height];B++}F++}}}return new DataView(i.buffer)}function k(t,e){for(var n=new Uint8Array(t),i=0;0!=n[e.value+i];)i+=1;var r=(new TextDecoder).decode(n.slice(e.value,e.value+i));return e.value=e.value+i+1,r}function B(t,e){var n=t.getInt32(e.value,!0);return e.value=e.value+4,n}function z(t,e){var n=t.getUint32(e.value,!0);return e.value=e.value+4,n}function V(t,e){var n=t[e.value];return e.value=e.value+1,n}function H(t,e){var n=t.getUint8(e.value);return e.value=e.value+1,n}const W=function(t,e){let n;return n="getBigInt64"in DataView.prototype?Number(t.getBigInt64(e.value,!0)):t.getUint32(e.value+4,!0)+Number(t.getUint32(e.value,!0)<<32),e.value+=8,n};function j(t,e){var n=t.getFloat32(e.value,!0);return e.value+=4,n}function G(t,e){return CN.toHalfFloat(j(t,e))}function X(t){var e=(31744&t)>>10,n=1023&t;return(t>>15?-1:1)*(e?31===e?n?NaN:1/0:Math.pow(2,e-15)*(1+n/1024):n/1024*6103515625e-14)}function q(t,e){var n=t.getUint16(e.value,!0);return e.value+=2,n}function Y(t,e){return X(q(t,e))}function K(t,e,n,i,r){return"string"===i||"stringvector"===i||"iccProfile"===i?function(t,e,n){var i=(new TextDecoder).decode(new Uint8Array(t).slice(e.value,e.value+n));return e.value=e.value+n,i}(e,n,r):"chlist"===i?function(t,e,n,i){for(var r=n.value,s=[];n.value<r+i-1;){var a=k(e,n),o=B(t,n),l=H(t,n);n.value+=3;var c=B(t,n),h=B(t,n);s.push({name:a,pixelType:o,pLinear:l,xSampling:c,ySampling:h})}return n.value+=1,s}(t,e,n,r):"chromaticities"===i?function(t,e){return{redX:j(t,e),redY:j(t,e),greenX:j(t,e),greenY:j(t,e),blueX:j(t,e),blueY:j(t,e),whiteX:j(t,e),whiteY:j(t,e)}}(t,n):"compression"===i?function(t,e){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][H(t,e)]}(t,n):"box2i"===i?function(t,e){return{xMin:z(t,e),yMin:z(t,e),xMax:z(t,e),yMax:z(t,e)}}(t,n):"lineOrder"===i?function(t,e){return["INCREASING_Y"][H(t,e)]}(t,n):"float"===i?j(t,n):"v2f"===i?function(t,e){return[j(t,e),j(t,e)]}(t,n):"v3f"===i?function(t,e){return[j(t,e),j(t,e),j(t,e)]}(t,n):"int"===i?B(t,n):"rational"===i?function(t,e){return[B(t,e),z(t,e)]}(t,n):"timecode"===i?function(t,e){return[z(t,e),z(t,e)]}(t,n):"preview"===i?(n.value+=r,"skipped"):void(n.value+=r)}const Z=new DataView(t),$=new Uint8Array(t),J={value:0},Q=function(t,e,n){const i={};if(20000630!=t.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";i.version=t.getUint8(4);const r=t.getUint8(5);i.spec={singleTile:!!(2&r),longName:!!(4&r),deepFormat:!!(8&r),multiPart:!!(16&r)},n.value=8;for(var s=!0;s;){var a=k(e,n);if(0==a)s=!1;else{var o=K(t,e,n,k(e,n),z(t,n));void 0===o||(i[a]=o)}}if(-5&r)throw"THREE.EXRLoader: provided file is currently unsupported.";return i}(Z,t,J),tt=function(t,e,n,i,r){const s={size:0,viewer:e,array:n,offset:i,width:t.dataWindow.xMax-t.dataWindow.xMin+1,height:t.dataWindow.yMax-t.dataWindow.yMin+1,channels:t.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:t.channels[0].pixelType,uncompress:null,getter:null,format:null,[hX?"colorSpace":"encoding"]:null};switch(t.compression){case"NO_COMPRESSION":s.lines=1,s.uncompress=I;break;case"RLE_COMPRESSION":s.lines=1,s.uncompress=D;break;case"ZIPS_COMPRESSION":s.lines=1,s.uncompress=L;break;case"ZIP_COMPRESSION":s.lines=16,s.uncompress=L;break;case"PIZ_COMPRESSION":s.lines=32,s.uncompress=N;break;case"PXR24_COMPRESSION":s.lines=16,s.uncompress=U;break;case"DWAA_COMPRESSION":s.lines=32,s.uncompress=F;break;case"DWAB_COMPRESSION":s.lines=256,s.uncompress=F;break;default:throw"EXRLoader.parse: "+t.compression+" is unsupported"}if(s.scanlineBlockSize=s.lines,1==s.type)switch(r){case HO:s.getter=Y,s.inputSize=2;break;case WO:s.getter=q,s.inputSize=2}else{if(2!=s.type)throw"EXRLoader.parse: unsupported pixelType "+s.type+" for "+t.compression+".";switch(r){case HO:s.getter=j,s.inputSize=4;break;case WO:s.getter=G,s.inputSize=4}}s.blockCount=(t.dataWindow.yMax+1)/s.scanlineBlockSize;for(var a=0;a<s.blockCount;a++)W(e,i);s.outputChannels=3==s.channels?4:s.channels;const o=s.width*s.height*s.outputChannels;switch(r){case HO:s.byteArray=new Float32Array(o),s.channels<s.outputChannels&&s.byteArray.fill(1,0,o);break;case WO:s.byteArray=new Uint16Array(o),s.channels<s.outputChannels&&s.byteArray.fill(15360,0,o)}return s.bytesPerLine=s.width*s.inputSize*s.channels,4==s.outputChannels?s.format=$O:s.format=tI,hX?s.colorSpace="srgb-linear":s.encoding=3e3,s}(Q,Z,$,J,this.type),et={value:0},nt={R:0,G:1,B:2,A:3,Y:0};for(let it=0;it<tt.height/tt.scanlineBlockSize;it++){const t=z(Z,J);tt.size=z(Z,J),tt.lines=t+tt.scanlineBlockSize>tt.height?tt.height-t:tt.scanlineBlockSize;const e=tt.size<tt.lines*tt.bytesPerLine?tt.uncompress(tt):I(tt);J.value+=tt.size;for(let n=0;n<tt.scanlineBlockSize;n++){const t=n+it*tt.scanlineBlockSize;if(t>=tt.height)break;for(let i=0;i<tt.channels;i++){const r=nt[Q.channels[i].name];for(let s=0;s<tt.width;s++){et.value=(n*(tt.channels*tt.width)+i*tt.width+s)*tt.inputSize;const a=(tt.height-1-t)*(tt.width*tt.outputChannels)+s*tt.outputChannels+r;tt.byteArray[a]=tt.getter(e,et)}}}}return{header:Q,width:tt.width,height:tt.height,data:tt.byteArray,format:tt.format,[hX?"colorSpace":"encoding"]:tt[hX?"colorSpace":"encoding"],type:this.type}}setDataType(t){return this.type=t,this}load(t,e,n,i){return super.load(t,function(t,n){hX?t.colorSpace=n.colorSpace:t.encoding=n.encoding,t.minFilter=IO,t.magFilter=IO,t.generateMipmaps=!1,t.flipY=!1,e&&e(t,n)},n,i)}}const dX=(t,e,n)=>{let i;switch(t){case UO:i=new Uint8ClampedArray(e*n*4);break;case WO:i=new Uint16Array(e*n*4);break;case VO:i=new Uint32Array(e*n*4);break;case FO:i=new Int8Array(e*n*4);break;case kO:i=new Int16Array(e*n*4);break;case zO:i=new Int32Array(e*n*4);break;case HO:i=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return i};let pX;class fX{constructor(t){var e,n,i,r,s,a,o,l,c,h,u,d,p,f,m,g;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(EX){throw this._renderer.setRenderTarget(null),EX}this._renderer.setRenderTarget(null)},this._width=t.width,this._height=t.height,this._type=t.type,this._colorSpace=t.colorSpace;const v={format:$O,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:void 0!==(null===(e=t.renderTargetOptions)||void 0===e?void 0:e.anisotropy)?null===(n=t.renderTargetOptions)||void 0===n?void 0:n.anisotropy:1,generateMipmaps:void 0!==(null===(i=t.renderTargetOptions)||void 0===i?void 0:i.generateMipmaps)&&(null===(r=t.renderTargetOptions)||void 0===r?void 0:r.generateMipmaps),magFilter:void 0!==(null===(s=t.renderTargetOptions)||void 0===s?void 0:s.magFilter)?null===(a=t.renderTargetOptions)||void 0===a?void 0:a.magFilter:IO,minFilter:void 0!==(null===(o=t.renderTargetOptions)||void 0===o?void 0:o.minFilter)?null===(l=t.renderTargetOptions)||void 0===l?void 0:l.minFilter:IO,samples:void 0!==(null===(c=t.renderTargetOptions)||void 0===c?void 0:c.samples)?null===(h=t.renderTargetOptions)||void 0===h?void 0:h.samples:void 0,wrapS:void 0!==(null===(u=t.renderTargetOptions)||void 0===u?void 0:u.wrapS)?null===(d=t.renderTargetOptions)||void 0===d?void 0:d.wrapS:AO,wrapT:void 0!==(null===(p=t.renderTargetOptions)||void 0===p?void 0:p.wrapT)?null===(f=t.renderTargetOptions)||void 0===f?void 0:f.wrapT:AO};if(this._material=t.material,t.renderer?this._renderer=t.renderer:(this._renderer=fX.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new wU,this._camera=new jz,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!((t,e,n,i)=>{if(void 0!==pX)return pX;const r=new $D(1,1,i);e.setRenderTarget(r);const s=new eU(new IB,new wN({color:16777215}));e.render(s,n),e.setRenderTarget(null);const a=dX(t,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),s.geometry.dispose(),s.material.dispose(),pX=0!==a[0],pX})(this._type,this._renderer,this._camera,v)){let t;if(this._type===WO)t=this._renderer.extensions.has("EXT_color_buffer_float")?HO:void 0;void 0!==t?this._type=t:this._supportsReadPixels=!1}this._quad=new eU(new IB,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new $D(this.width,this.height,v),this._renderTarget.texture.mapping=void 0!==(null===(m=t.renderTargetOptions)||void 0===m?void 0:m.mapping)?null===(g=t.renderTargetOptions)||void 0===g?void 0:g.mapping:xO}static instantiateRenderer(){const t=new Zj;return t.setSize(128,128),t}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const t=dX(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,t),t}toDataTexture(t){const e=new iF(this.toArray(),this.width,this.height,$O,this._type,(null==t?void 0:t.mapping)||xO,(null==t?void 0:t.wrapS)||AO,(null==t?void 0:t.wrapT)||AO,(null==t?void 0:t.magFilter)||IO,(null==t?void 0:t.minFilter)||IO,(null==t?void 0:t.anisotropy)||1,qI);return e.generateMipmaps=void 0!==(null==t?void 0:t.generateMipmaps)&&(null==t?void 0:t.generateMipmaps),e}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(t){this.disposeOnDemandRenderer(),t&&this.renderTarget.dispose(),this.material instanceof lU&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof YD&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof YD&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(t){this._width=t,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(t){this._height=t,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(t){this._renderTarget=t,this._width=t.width,this._height=t.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class mX extends lU{constructor({gamma:t,offsetHdr:e,offsetSdr:n,gainMapMin:i,gainMapMax:r,maxDisplayBoost:s,hdrCapacityMin:a,hdrCapacityMax:o,sdr:l,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:l},gainMap:{value:c},gamma:{value:new wD(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:(new wD).fromArray(e)},offsetSdr:{value:(new wD).fromArray(n)},gainMapMin:{value:(new wD).fromArray(i)},gainMapMax:{value:(new wD).fromArray(r)},weightFactor:{value:(Math.log2(s)-a)/(o-a)}},blending:0,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=s,this._hdrCapacityMin=a,this._hdrCapacityMax=o,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const e=this.uniforms.gamma.value;e.x=1/t[0],e.y=1/t[1],e.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class gX extends Error{}class vX extends Error{}const yX=(t,e,n)=>{const i=new RegExp(`${e}="([^"]*)"`,"i").exec(t);if(i)return i[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(t);if(r){const t=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return t&&3===t.length?t.map(t=>t.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(void 0!==n)return n;throw new Error(`Can't find ${e} in gainmap metadata`)};class _X{constructor(t){this.options={debug:!(!t||void 0===t.debug)&&t.debug,extractFII:!t||void 0===t.extractFII||t.extractFII,extractNonFII:!t||void 0===t.extractNonFII||t.extractNonFII}}extract(t){return new Promise((e,n)=>{this.options.debug;const i=new DataView(t.buffer);if(65496!==i.getUint16(0))return void n(new Error("Not a valid jpeg"));const r=i.byteLength;let s,a=2,o=0;for(;a<r;){if(++o>250)return void n(new Error(`Found no marker after ${o} loops 😵`));if(255!==i.getUint8(a))return void n(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${i.getUint8(a).toString(16)}`));if(s=i.getUint8(a+1),226===s){const t=a+4;if(1297106432===i.getUint32(t)){const r=t+4;let s;if(18761===i.getUint16(r))s=!1;else{if(19789!==i.getUint16(r))return void n(new Error("No valid endianness marker found in TIFF header"));s=!0}if(42!==i.getUint16(r+2,!s))return void n(new Error("Not valid TIFF data! (no 0x002A marker)"));const a=i.getUint32(r+4,!s);if(a<8)return void n(new Error("Not valid TIFF data! (First offset less than 8)"));const o=r+a,l=i.getUint16(o,!s),c=o+2;let h=0;for(let t=c;t<c+12*l;t+=12)45057===i.getUint16(t,!s)&&(h=i.getUint32(t+8,!s));const u=o+2+12*l+4,d=[];for(let t=u;t<u+16*h;t+=16){const e={MPType:i.getUint32(t,!s),size:i.getUint32(t+4,!s),dataOffset:i.getUint32(t+8,!s),dependantImages:i.getUint32(t+12,!s),start:-1,end:-1,isFII:!1};e.dataOffset?(e.start=r+e.dataOffset,e.isFII=!1):(e.start=0,e.isFII=!0),e.end=e.start+e.size,d.push(e)}if(this.options.extractNonFII&&d.length){const t=new Blob([i]),n=[];for(const e of d){if(e.isFII&&!this.options.extractFII)continue;const i=t.slice(e.start,e.end+1,"image/jpeg");n.push(i)}e(n)}}}a+=2+i.getUint16(a+2)}})}}const xX=async t=>{const e=(t=>{let e;e="undefined"!=typeof TextDecoder?(new TextDecoder).decode(t):t.toString();let n=e.indexOf("<x:xmpmeta");for(;-1!==n;){const t=e.indexOf("x:xmpmeta>",n),i=e.slice(n,t+10);try{const t=yX(i,"hdrgm:GainMapMin","0"),e=yX(i,"hdrgm:GainMapMax"),n=yX(i,"hdrgm:Gamma","1"),r=yX(i,"hdrgm:OffsetSDR","0.015625"),s=yX(i,"hdrgm:OffsetHDR","0.015625"),a=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),o=a?a[1]:"0",l=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!l)throw new Error("Incomplete gainmap metadata");const c=l[1];return{gainMapMin:Array.isArray(t)?t.map(t=>parseFloat(t)):[parseFloat(t),parseFloat(t),parseFloat(t)],gainMapMax:Array.isArray(e)?e.map(t=>parseFloat(t)):[parseFloat(e),parseFloat(e),parseFloat(e)],gamma:Array.isArray(n)?n.map(t=>parseFloat(t)):[parseFloat(n),parseFloat(n),parseFloat(n)],offsetSdr:Array.isArray(r)?r.map(t=>parseFloat(t)):[parseFloat(r),parseFloat(r),parseFloat(r)],offsetHdr:Array.isArray(s)?s.map(t=>parseFloat(t)):[parseFloat(s),parseFloat(s),parseFloat(s)],hdrCapacityMin:parseFloat(o),hdrCapacityMax:parseFloat(c)}}catch(EX){}n=e.indexOf("<x:xmpmeta",t)}})(t);if(!e)throw new vX("Gain map XMP metadata not found");const n=new _X({extractFII:!0,extractNonFII:!0}),i=await n.extract(t);if(2!==i.length)throw new gX("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:e}},bX=t=>new Promise((e,n)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=t=>{n(t)},i.src=URL.createObjectURL(t)});class MX extends wz{constructor(t,e){super(e),t&&(this._renderer=t),this._internalLoadingManager=new bz}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer;const t=new mX({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new YD,sdr:new YD});return new fX({width:16,height:16,type:WO,colorSpace:qI,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(t,e,n,i){const r=i?new Blob([i],{type:"image/jpeg"}):void 0,s=new Blob([n],{type:"image/jpeg"});let a,o,l=!1;if("undefined"==typeof createImageBitmap){const t=await Promise.all([r?bX(r):Promise.resolve(void 0),bX(s)]);o=t[0],a=t[1],l=!0}else{const t=await Promise.all([r?createImageBitmap(r,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:"flipY"})]);o=t[0],a=t[1]}const c=new YD(o||new ImageData(2,2),xO,AO,AO,IO,NO,$O,UO,1,qI);c.flipY=l,c.needsUpdate=!0;const h=new YD(a,xO,AO,AO,IO,NO,$O,UO,1,XI);h.flipY=l,h.needsUpdate=!0,t.width=a.width,t.height=a.height,t.material.gainMap=c,t.material.sdr=h,t.material.gainMapMin=e.gainMapMin,t.material.gainMapMax=e.gainMapMax,t.material.offsetHdr=e.offsetHdr,t.material.offsetSdr=e.offsetSdr,t.material.gamma=e.gamma,t.material.hdrCapacityMin=e.hdrCapacityMin,t.material.hdrCapacityMax=e.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,e.hdrCapacityMax),t.material.needsUpdate=!0,t.render()}}class wX extends MX{load([t,e,n],i,r,s){const a=this.prepareQuadRenderer();let o,l,c;const h=async()=>{if(o&&l&&c){try{await this.render(a,c,o,l)}catch(r){return this.manager.itemError(t),this.manager.itemError(e),this.manager.itemError(n),"function"==typeof s&&s(r),void a.disposeOnDemandRenderer()}"function"==typeof i&&i(a),this.manager.itemEnd(t),this.manager.itemEnd(e),this.manager.itemEnd(n),a.disposeOnDemandRenderer()}};let u=!0,d=0,p=0,f=!0,m=0,g=0,v=!0,y=0,_=0;const x=()=>{if("function"==typeof r){r(new ProgressEvent("progress",{lengthComputable:u&&f&&v,loaded:p+g+_,total:d+m+y}))}};this.manager.itemStart(t),this.manager.itemStart(e),this.manager.itemStart(n);const b=new Ez(this._internalLoadingManager);b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(t,async t=>{if("string"==typeof t)throw new Error("Invalid sdr buffer");o=t,await h()},t=>{u=t.lengthComputable,p=t.loaded,d=t.total,x()},e=>{this.manager.itemError(t),"function"==typeof s&&s(e)});const M=new Ez(this._internalLoadingManager);M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(this.withCredentials),M.load(e,async t=>{if("string"==typeof t)throw new Error("Invalid gainmap buffer");l=t,await h()},t=>{f=t.lengthComputable,g=t.loaded,m=t.total,x()},t=>{this.manager.itemError(e),"function"==typeof s&&s(t)});const w=new Ez(this._internalLoadingManager);return w.setRequestHeader(this.requestHeader),w.setPath(this.path),w.setWithCredentials(this.withCredentials),w.load(n,async t=>{if("string"!=typeof t)throw new Error("Invalid metadata string");c=JSON.parse(t),await h()},t=>{v=t.lengthComputable,_=t.loaded,y=t.total,x()},t=>{this.manager.itemError(n),"function"==typeof s&&s(t)}),a}}class SX extends MX{load(t,e,n,i){const r=this.prepareQuadRenderer(),s=new Ez(this._internalLoadingManager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(this.withCredentials),this.manager.itemStart(t),s.load(t,async n=>{if("string"==typeof n)throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const s=new Uint8Array(n);let a,o,l;try{const t=await xX(s);a=t.sdr,o=t.gainMap,l=t.metadata}catch(EX){if(!(EX instanceof vX||EX instanceof gX))throw EX;l={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},a=s}try{await this.render(r,l,a,o)}catch(c){return this.manager.itemError(t),"function"==typeof i&&i(c),void r.disposeOnDemandRenderer()}"function"==typeof e&&e(r),this.manager.itemEnd(t),r.disposeOnDemandRenderer()},n,e=>{this.manager.itemError(t),"function"==typeof i&&i(e)}),r}}export{Xb as $,_f as A,Jf as B,Ku as C,kf as D,Mu as E,Eu as F,wu as G,fu as H,qf as I,Pp as J,tf as K,yd as L,mu as M,xu as N,du as O,pu as P,Fu as Q,sm as R,Su as S,am as T,Zu as U,Zf as V,rm as W,Vf as X,om as Y,cm as Z,Fb as _,ed as a,kP as a$,Gb as a0,Ob as a1,Lb as a2,Bb as a3,kb as a4,dM as a5,OT as a6,LE as a7,ZE as a8,$E as a9,Qi as aA,pr as aB,dr as aC,mr as aD,fr as aE,mm as aF,bm as aG,Pm as aH,Qm as aI,Bc as aJ,hl as aK,ul as aL,cl as aM,ll as aN,iC as aO,sR as aP,rR as aQ,dG as aR,yG as aS,bG as aT,fG as aU,Zj as aV,NV as aW,jz as aX,pU as aY,wU as aZ,FP as a_,JA as aa,eC as ab,fA as ac,lA as ad,_A as ae,MA as af,nC as ag,oC as ah,hC as ai,mC as aj,yC as ak,RC as al,XC as am,BC as an,iR as ao,nR as ap,LC as aq,ni as ar,$n as as,kn as at,zn as au,Ci as av,Ii as aw,oi as ax,ai as ay,Hi as az,Hp as b,te as b$,UP as b0,NP as b1,kD as b2,qI as b3,XI as b4,gO as b5,vO as b6,oG as b7,kL as b8,_N as b9,AL as bA,KD as bB,JO as bC,BO as bD,bO as bE,wO as bF,Rz as bG,cX as bH,uX as bI,SX as bJ,wX as bK,vU as bL,ZG as bM,IB as bN,$B as bO,oX as bP,lX as bQ,_k as bR,WP as bS,BV as bT,xD as bU,Xt as bV,ve as bW,ge as bX,Et as bY,$t as bZ,fe as b_,$O as ba,UO as bb,bD as bc,wD as bd,uV as be,pG as bf,vG as bg,$j as bh,rC as bi,VP as bj,IP as bk,$D as bl,WO as bm,IO as bn,mk as bo,HO as bp,aX as bq,lU as br,HP as bs,IV as bt,cU as bu,WN as bv,IN as bw,eU as bx,GB as by,_F as bz,lm as c,ye as c0,Me as c1,Gt as c2,Zt as c3,$h as c4,eu as c5,nh as c6,th as c7,ch as c8,Gc as c9,Dh as ca,Yh as cb,Oh as cc,Ah as cd,cu as ce,ym as cf,gm as cg,er as ch,Wy as ci,lR as cj,kg as ck,OP as cl,Wf as d,Qu as e,qu as f,Bf as g,Yu as h,zf as i,gu as j,yu as k,pm as l,Ud as m,Df as n,Dd as o,_d as p,Uf as q,jf as r,kp as s,Wp as t,zp as u,Nf as v,Mf as w,Tu as x,gf as y,wf as z};
