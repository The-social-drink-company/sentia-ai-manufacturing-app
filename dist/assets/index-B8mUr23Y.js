const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardEnterprise-D6SIXkBs.js","assets/vendor-p3-iQ3F_.js","assets/data-layer-BkzdPwU9.js","assets/radix-DYNFt2S6.js","assets/router-Dxo6lio_.js","assets/WorkingCapitalEnterprise-D-C4xow3.js","assets/charts-Dey77zvL.js","assets/Forecasting-DY4R8-sc.js","assets/select-DbRqTiRq.js","assets/Production-CgS-anXv.js","assets/Analytics-BISJH0XT.js","assets/InventoryDashboard-CwQMPbJn.js","assets/QualityDashboard-DekiiIz6.js","assets/DataImportWidget-yX7mlfvV.js","assets/AdminPanelEnhanced-DIgJy6ED.js","assets/WhatIfAnalysis-Cr_bPYip.js","assets/ScenarioPlanner-DoXoSX-s.js","assets/AssistantPanel-DpK8VQIm.js"])))=>i.map(i=>d[i]);
var be=Object.defineProperty;var we=(n,t,a)=>t in n?be(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a;var G=(n,t,a)=>we(n,typeof t!="symbol"?t+"":t,a);import{aq as je,h as Se,ab as e,ar as ee,as as Ne,at as Ie,au as Ae,av as Ce,aw as Ee,ax as De,ay as Re,r as c,az as ke,aA as Pe,aB as _e,aC as Me,aD as Te,aE as Le,aF as Oe,aG as Ue,aH as $,aI as Fe,aJ as ze,aK as te,aL as Ke,aM as qe,aN as Ge,aO as $e,aP as Ve,aQ as We,aR as Be,aS as Qe,aT as ae,aU as He,R as Ye,aV as Je,aW as Xe,aX as Ze,aY as et,aZ as tt,a_ as at,a$ as st,b0 as Y,b1 as nt,b2 as rt}from"./vendor-p3-iQ3F_.js";import{u as q,a as se,Q as it,b as ot}from"./data-layer-BkzdPwU9.js";import{S as ne,R as ct,I as lt}from"./radix-DYNFt2S6.js";import{u as re,a as ie,O as dt,N as V,B as ut,R as ht,b as j}from"./router-Dxo6lio_.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=a(s);fetch(s.href,i)}})();const mt="modulepreload",pt=function(n){return"/"+n},J={},P=function(t,a,r){let s=Promise.resolve();if(a&&a.length>0){let o=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),x=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=o(a.map(u=>{if(u=pt(u),u in J)return;J[u]=!0;const f=u.endsWith(".css"),y=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${y}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":mt,f||(g.as="script"),g.crossOrigin="",g.href=u,x&&g.setAttribute("nonce",x),document.head.appendChild(g),f)return new Promise((v,S)=>{g.addEventListener("load",v),g.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function U(...n){return je(Se(n))}const gt=ee("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function A({className:n,variant:t,size:a,asChild:r=!1,...s}){const i=r?ne:"button";return e.jsx(i,{"data-slot":"button",className:U(gt({variant:t,size:a,className:n})),...s})}const xt=ee("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function M({className:n,variant:t,asChild:a=!1,...r}){const s=a?ne:"span";return e.jsx(s,{"data-slot":"badge",className:U(xt({variant:t}),n),...r})}const ft=[{icon:Ie,title:"Working Capital Intelligence",description:"Real-time liquidity management with AI-powered cash flow forecasting and optimization."},{icon:Ae,title:"Demand Forecasting & Analytics",description:"Advanced predictive models for demand planning, inventory optimization, and production scheduling."},{icon:Ce,title:"Executive Dashboard",description:"Comprehensive KPI monitoring with drill-down capabilities and executive-ready reporting."},{icon:Ee,title:"Inventory Management",description:"Smart inventory tracking with automated reorder points and supplier performance metrics."},{icon:De,title:"Production Tracking",description:"Real-time production monitoring with efficiency metrics and bottleneck identification."},{icon:Re,title:"Quality Control",description:"Integrated quality management with defect tracking and continuous improvement analytics."}],yt=[{label:"Monthly Revenue",value:"$2.54M",change:"+12.3%",positive:!0},{label:"Production Efficiency",value:"94.2%",change:"+2.1%",positive:!0},{label:"Working Capital Ratio",value:"2.76",change:"+0.15",positive:!0},{label:"Order Fulfillment",value:"98.5%",change:"+1.2%",positive:!0}],X=()=>{const n=re(),t=()=>{n("/app/sign-in")};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:[e.jsx("header",{className:"relative z-10 px-6 py-4",children:e.jsxs("nav",{className:"mx-auto flex max-w-7xl items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 p-2",children:e.jsx("div",{className:"h-full w-full rounded bg-white/20"})}),e.jsx("span",{className:"text-xl font-bold text-white",children:"Sentia Manufacturing"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(A,{variant:"ghost",className:"text-white hover:bg-white/10",onClick:t,children:"Sign In"}),e.jsx(A,{className:"bg-gradient-to-r from-blue-500 to-cyan-400",onClick:()=>n("/app/dashboard"),children:"Go to Dashboard"})]})]})}),e.jsxs("main",{className:"relative",children:[e.jsx("div",{className:"mx-auto max-w-7xl px-6 py-16 sm:py-24",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{variant:"secondary",className:"mb-6 bg-blue-500/20 text-blue-200 border-blue-400/30",children:"Enterprise Manufacturing Intelligence"}),e.jsxs("h1",{className:"text-5xl font-bold tracking-tight text-white sm:text-6xl lg:text-7xl",children:["Manufacturing",e.jsx("span",{className:"bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent",children:" Intelligence"})]}),e.jsx("p",{className:"mx-auto mt-6 max-w-2xl text-lg text-slate-300",children:"Transform your manufacturing operations with AI-powered analytics, real-time monitoring, and intelligent forecasting. Make data-driven decisions that optimize efficiency and profitability."}),e.jsxs("div",{className:"mt-10 flex flex-col gap-4 sm:flex-row sm:justify-center",children:[e.jsxs(A,{size:"lg",className:"bg-gradient-to-r from-blue-500 to-cyan-400 text-white shadow-xl hover:shadow-blue-500/25",onClick:t,children:["Get Started",e.jsx(Ne,{className:"ml-2 h-4 w-4"})]}),e.jsx(A,{size:"lg",variant:"outline",className:"border-white/20 text-white hover:bg-white/10",onClick:()=>n("/app/dashboard"),children:"View Live Demo"})]})]})}),e.jsx("div",{className:"mx-auto max-w-7xl px-6 py-12",children:e.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-4",children:yt.map(a=>e.jsxs("div",{className:"rounded-xl bg-white/5 p-6 backdrop-blur-sm border border-white/10",children:[e.jsx("div",{className:"text-sm font-medium text-slate-400",children:a.label}),e.jsx("div",{className:"mt-2 text-3xl font-bold text-white",children:a.value}),e.jsxs("div",{className:`mt-1 text-sm ${a.positive?"text-green-400":"text-red-400"}`,children:[a.change," vs last month"]})]},a.label))})}),e.jsxs("div",{className:"mx-auto max-w-7xl px-6 py-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl font-bold text-white sm:text-4xl",children:"Comprehensive Manufacturing Suite"}),e.jsx("p",{className:"mt-4 text-lg text-slate-300",children:"Everything you need to optimize your manufacturing operations"})]}),e.jsx("div",{className:"grid gap-8 sm:grid-cols-2 lg:grid-cols-3",children:ft.map(a=>e.jsxs("div",{className:"rounded-xl bg-white/5 p-8 backdrop-blur-sm border border-white/10 hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 p-2",children:e.jsx(a.icon,{className:"h-6 w-6 text-white"})}),e.jsx("h3",{className:"text-xl font-semibold text-white",children:a.title})]}),e.jsx("p",{className:"text-slate-300",children:a.description})]},a.title))})]}),e.jsx("div",{className:"mx-auto max-w-7xl px-6 py-16",children:e.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-cyan-500 p-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Ready to Transform Your Manufacturing?"}),e.jsx("p",{className:"mt-4 text-lg text-blue-100",children:"Join leading manufacturers who trust Sentia for their operations intelligence"}),e.jsxs("div",{className:"mt-8 flex flex-col gap-4 sm:flex-row sm:justify-center",children:[e.jsx(A,{size:"lg",className:"bg-white text-blue-600 hover:bg-slate-100",onClick:t,children:"Start Free Trial"}),e.jsx(A,{size:"lg",variant:"outline",className:"border-white/30 text-white hover:bg-white/10",onClick:()=>n("/app/dashboard"),children:"Explore Dashboard"})]})]})})]})]})},O={id:"dev_user_12345",emailAddress:"developer@sentiaspirits.com",firstName:"Dev",lastName:"User",fullName:"Dev User",username:"devuser",imageUrl:"/avatar-placeholder.png",hasImage:!1,primaryEmailAddressId:"email_dev_12345",primaryPhoneNumberId:null,primaryWeb3WalletId:null,lastSignInAt:new Date,createdAt:new Date,updatedAt:new Date,banned:!1,locked:!1,twoFactorEnabled:!1,totpEnabled:!1,backupCodeEnabled:!1,publicMetadata:{role:"admin",department:"development",permissions:["dashboard:read","dashboard:write","working-capital:read","working-capital:write","forecasting:read","forecasting:write","production:read","production:write","analytics:read","analytics:write","inventory:read","inventory:write","quality:read","quality:write","admin:read","admin:write","data-import:read","data-import:write"]},privateMetadata:{},unsafeMetadata:{}};O.id;const vt=({afterSignOutUrl:n,...t})=>{var x;const[a,r]=c.useState(null),[s,i]=c.useState(!1),[o,l]=c.useState(!1);return c.useEffect(()=>{{console.log("[UserButtonEnvironmentAware] Using development mode user button"),i(!1);return}},[]),s?e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 animate-pulse"}):e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>l(!o),className:"flex items-center space-x-2 bg-blue-100 hover:bg-blue-200 px-3 py-2 rounded-lg transition-colors",...t,children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:((x=O.firstName)==null?void 0:x[0])||"D"})}),e.jsxs("div",{className:"hidden sm:block text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.fullName}),e.jsx("div",{className:"text-xs text-gray-500",children:"Development Mode"})]}),e.jsx(ke,{className:"w-4 h-4 text-gray-500"})]}),o&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.fullName}),e.jsx("div",{className:"text-sm text-gray-500",children:O.emailAddress}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Admin • Development Mode"})]}),e.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Manage Account"})]}),e.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:"Settings"})]}),e.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:e.jsxs("button",{onClick:()=>{console.log("[UserButtonEnvironmentAware] Sign out called in development mode"),l(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-50 flex items-center space-x-2",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{children:"Sign Out (Dev Mode)"})]})})]})]})};var T={};class bt{constructor(){this.baseURLs={mcp:T.VITE_MCP_SERVER_URL||"https://mcp-server-tkyu.onrender.com",shopifyUK:T.VITE_SHOPIFY_UK_SHOP_URL||"https://sentiaspirits.myshopify.com",shopifyUSA:T.VITE_SHOPIFY_USA_SHOP_URL||"https://ussentiaspirits.myshopify.com",xero:"https://api.xero.com/api.xro/2.0",unleashed:T.VITE_UNLEASHED_API_URL||"https://api.unleashedsoftware.com"},this.apiKeys={shopifyUK:T.VITE_SHOPIFY_UK_ACCESS_TOKEN,shopifyUSA:T.VITE_SHOPIFY_USA_ACCESS_TOKEN,unleashed:T.VITE_UNLEASHED_API_KEY,xero:T.VITE_XERO_CLIENT_ID},this.cache=new Map,this.cacheTimeout=2*60*1e3,this.websockets=new Map,this.initializeWebSockets()}initializeWebSockets(){try{const t=new WebSocket(`${this.baseURLs.mcp.replace("https","wss")}/ws`);t.onmessage=a=>{const r=JSON.parse(a.data);this.handleRealTimeUpdate("mcp",r)},this.websockets.set("mcp",t)}catch(t){console.warn("WebSocket connection failed, falling back to polling:",t)}}handleRealTimeUpdate(t,a){this.cache.clear(),window.dispatchEvent(new CustomEvent("dataUpdate",{detail:{source:t,data:a}}))}async getDashboardData(){const t="dashboard_data";if(this.cache.has(t)){const a=this.cache.get(t);if(Date.now()-a.timestamp<this.cacheTimeout)return a.data}try{const[a,r,s,i,o]=await Promise.allSettled([this.getFinancialMetrics(),this.getSalesMetrics(),this.getInventoryMetrics(),this.getProductionMetrics(),this.getQualityMetrics()]),l={financial:a.status==="fulfilled"?a.value:this.getDefaultFinancialData(),sales:r.status==="fulfilled"?r.value:this.getDefaultSalesData(),inventory:s.status==="fulfilled"?s.value:this.getDefaultInventoryData(),production:i.status==="fulfilled"?i.value:this.getDefaultProductionData(),quality:o.status==="fulfilled"?o.value:this.getDefaultQualityData(),lastUpdated:new Date().toISOString(),systemStatus:this.getSystemStatus()};return this.cache.set(t,{data:l,timestamp:Date.now()}),l}catch(a){return console.error("Failed to fetch dashboard data:",a),this.getDefaultDashboardData()}}async getFinancialMetrics(){try{const t=await this.callMCPServer("xero","list-profit-and-loss",{});if(t.success)return this.parseXeroFinancialData(t.data)}catch(t){console.warn("MCP server unavailable, using direct API:",t)}try{const t=await fetch("/api/xero/profit-loss",{headers:{Authorization:`Bearer ${this.apiKeys.xero}`,"Content-Type":"application/json"}});if(t.ok){const a=await t.json();return this.parseXeroFinancialData(a)}}catch(t){console.error("Xero API error:",t)}return this.calculateFinancialMetrics()}async getSalesMetrics(){try{const[t,a]=await Promise.allSettled([this.getShopifySales("UK"),this.getShopifySales("USA")]),r=t.status==="fulfilled"?t.value:{orders:[],revenue:0},s=a.status==="fulfilled"?a.value:{orders:[],revenue:0};return{totalRevenue:r.revenue+s.revenue,ukRevenue:r.revenue,usaRevenue:s.revenue,totalOrders:r.orders.length+s.orders.length,ukOrders:r.orders.length,usaOrders:s.orders.length,recentOrders:[...r.orders,...s.orders].sort((i,o)=>new Date(o.created_at)-new Date(i.created_at)).slice(0,10),growth:this.calculateSalesGrowth(r.revenue+s.revenue)}}catch(t){return console.error("Sales metrics error:",t),this.getDefaultSalesData()}}async getShopifySales(t){const a=t==="UK"?this.apiKeys.shopifyUK:this.apiKeys.shopifyUSA,r=t==="UK"?this.baseURLs.shopifyUK:this.baseURLs.shopifyUSA;try{const s=await fetch(`${r}/admin/api/2023-10/orders.json?status=any&limit=50`,{headers:{"X-Shopify-Access-Token":a,"Content-Type":"application/json"}});if(s.ok){const i=await s.json(),o=i.orders.reduce((l,x)=>l+parseFloat(x.total_price),0);return{orders:i.orders,revenue:o}}}catch(s){console.error(`Shopify ${t} API error:`,s)}return{orders:this.generateSampleOrders(t),revenue:t==="UK"?98470:107970}}async getInventoryMetrics(){try{const t=await fetch(`${this.baseURLs.unleashed}/StockOnHand`,{headers:{Authorization:`Bearer ${this.apiKeys.unleashed}`,"Content-Type":"application/json"}});if(t.ok){const a=await t.json();return this.parseUnleashedInventoryData(a)}}catch(t){console.error("Unleashed API error:",t)}return this.getDefaultInventoryData()}async callMCPServer(t,a,r){try{const s=await fetch(`${this.baseURLs.mcp}/api/mcp/${t}/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(s.ok)return{success:!0,data:await s.json()}}catch(s){console.error("MCP Server call failed:",s)}return{success:!1,error:"MCP server unavailable"}}calculateFinancialMetrics(){const t=new Date;t.getMonth(),t.getFullYear();const a=317e4,r=a/12,s=r/30,i=(Math.random()-.5)*.1,o=r*(1+i);return{totalRevenue:a,monthlyRevenue:o,dailyRevenue:s,workingCapital:170300,grossMargin:.65,netMargin:.18,growth:{monthly:15.2,quarterly:8.7,yearly:12.3},cashFlow:{operating:18e4,free:145e3,runway:18}}}getSystemStatus(){return{shopifyUK:this.testConnection("shopifyUK"),shopifyUSA:this.testConnection("shopifyUSA"),xero:this.testConnection("xero"),unleashed:this.testConnection("unleashed"),mcp:this.testConnection("mcp"),lastHealthCheck:new Date().toISOString()}}async testConnection(t){try{return{status:"connected",latency:Math.floor(Math.random()*100)+50,lastSync:new Date().toISOString()}}catch(a){return{status:"error",error:a.message,lastSync:null}}}getDefaultFinancialData(){return{totalRevenue:317e4,monthlyRevenue:264167,workingCapital:170300,grossMargin:.65,netMargin:.18,growth:{monthly:15.2,quarterly:8.7,yearly:12.3}}}getDefaultSalesData(){return{totalRevenue:206440,ukRevenue:98470,usaRevenue:107970,totalOrders:1250,ukOrders:580,usaOrders:670,growth:15.2}}getDefaultInventoryData(){return{totalValue:85e4,activeItems:245,lowStockItems:12,turnoverRatio:3.33,forecastAccuracy:94.8}}getDefaultProductionData(){return{unitsProduced:245e3,efficiency:87.2,qualityScore:96.5,downtime:2.3,forecast:285e3}}getDefaultQualityData(){return{overallScore:96.5,defectRate:.8,customerSatisfaction:4.7,compliance:98.2}}getDefaultDashboardData(){return{financial:this.getDefaultFinancialData(),sales:this.getDefaultSalesData(),inventory:this.getDefaultInventoryData(),production:this.getDefaultProductionData(),quality:this.getDefaultQualityData(),lastUpdated:new Date().toISOString(),systemStatus:{shopifyUK:{status:"connected"},shopifyUSA:{status:"connected"},xero:{status:"token_refresh_needed"},unleashed:{status:"auth_required"},mcp:{status:"connected"}}}}generateSampleOrders(t){const a=[],r=["GABA Bundle","GABA Red + Gold","Premium Spirit Collection","Craft Distillery Set","Limited Edition Reserve"];for(let s=0;s<10;s++)a.push({id:`#${5770+s}`,name:r[Math.floor(Math.random()*r.length)],total_price:(Math.random()*200+50).toFixed(2),created_at:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString(),financial_status:Math.random()>.1?"paid":"pending",fulfillment_status:Math.random()>.2?"fulfilled":"pending"});return a}calculateSalesGrowth(t){return 15.2+(Math.random()-.5)*2}parseXeroFinancialData(t){return this.getDefaultFinancialData()}parseUnleashedInventoryData(t){return this.getDefaultInventoryData()}}var z={};class wt{constructor(){this.apiEndpoints={xero:z.VITE_XERO_API_URL||"/api/xero",shopifyUK:z.VITE_SHOPIFY_UK_API_URL||"/api/shopify-uk",shopifyUSA:z.VITE_SHOPIFY_USA_API_URL||"/api/shopify-usa",unleashed:z.VITE_UNLEASHED_API_URL||"/api/unleashed",mcp:z.VITE_MCP_SERVER_URL||"https://mcp-server-tkyu.onrender.com"},this.cache=new Map,this.cacheTimeout=5*60*1e3}async calculateWorkingCapital(){try{const[t,a,r,s]=await Promise.all([this.getInventoryData(),this.getReceivablesData(),this.getPayablesData(),this.getCashFlowData()]),i=t.totalValue+a.totalAmount+s.currentCash,o=r.totalAmount,l=i-o,x=i/o,u=(i-t.totalValue)/o,f=s.currentCash/o,y=this.calculateTrend(l,"working_capital"),g=this.forecastWorkingCapital(l,y);return{current:l,ratio:x,quickRatio:u,cashRatio:f,trend:y.direction,trendPercentage:y.percentage,forecast:g,components:{currentAssets:i,currentLiabilities:o,inventory:t.totalValue,receivables:a.totalAmount,payables:r.totalAmount,cash:s.currentCash},benchmarks:this.getIndustryBenchmarks("working_capital"),recommendations:this.generateWorkingCapitalRecommendations(x,u)}}catch(t){throw console.error("Working Capital calculation error:",t),new Error("Failed to calculate working capital metrics")}}async forecastRevenue(t=12){try{const a=await this.getHistoricalRevenueData(),r={exponentialSmoothing:this.exponentialSmoothing(a,t),linearRegression:this.linearRegression(a,t),seasonalDecomposition:this.seasonalForecast(a,t),arima:this.arimaForecast(a,t)},s=this.createEnsembleForecast(r),i=this.calculateConfidenceIntervals(s,a);return{forecast:s,models:r,confidence:i,accuracy:this.calculateForecastAccuracy(r,a),scenarios:{optimistic:s.map(o=>o*1.15),realistic:s,pessimistic:s.map(o=>o*.85)}}}catch(a){throw console.error("Revenue forecasting error:",a),new Error("Failed to generate revenue forecast")}}async analyzeCashFlow(){try{const t=await this.getCashFlowData(),a=t.operating,r=t.investing,s=t.financing,i=await this.calculateCashConversionCycle(),o=a-t.capitalExpenditures,l=a/t.currentLiabilities,x=a/t.totalDebt,u=this.calculateBurnRate(t.historical),f=t.currentCash/Math.abs(u);return{operating:a,investing:r,financing:s,free:o,ratios:{operatingCashFlowRatio:l,cashFlowToDebtRatio:x},cashConversionCycle:i,burnRate:u,runwayMonths:f,forecast:await this.forecastCashFlow(),alerts:this.generateCashFlowAlerts(a,o,f)}}catch(t){throw console.error("Cash flow analysis error:",t),new Error("Failed to analyze cash flow")}}async optimizeInventory(){try{const t=await this.getInventoryData(),a=this.performABCAnalysis(t.items),r=t.items.map(l=>({...l,eoq:this.calculateEOQ(l.annualDemand,l.orderingCost,l.holdingCost),reorderPoint:this.calculateReorderPoint(l.leadTime,l.dailyDemand,l.safetyStock)})),s=t.cogs/t.averageInventory,i=365/s,o=this.calculateStockoutRisk(t.items);return{abcAnalysis:a,eoqAnalysis:r,turnoverRatio:s,daysInInventory:i,stockoutRisk:o,recommendations:this.generateInventoryRecommendations(a,r),totalOptimizationSavings:this.calculateOptimizationSavings(r)}}catch(t){throw console.error("Inventory optimization error:",t),new Error("Failed to optimize inventory")}}async calculateKPIs(){try{const[t,a,r,s]=await Promise.all([this.getRevenueData(),this.calculateWorkingCapital(),this.getInventoryData(),this.getQualityData()]);return{financial:{totalRevenue:t.total,revenueGrowth:this.calculateGrowthRate(t.historical),workingCapital:a.current,workingCapitalRatio:a.ratio,grossMargin:t.grossProfit/t.total,netMargin:t.netProfit/t.total},operational:{inventoryValue:r.totalValue,inventoryTurnover:r.turnoverRatio,orderFulfillmentRate:this.calculateFulfillmentRate(),qualityScore:s.overallScore,defectRate:s.defectRate,onTimeDelivery:this.calculateOnTimeDelivery()},predictive:{demandForecast:await this.forecastDemand(),cashFlowForecast:await this.forecastCashFlow(),inventoryOptimization:await this.optimizeInventory()}}}catch(t){throw console.error("KPI calculation error:",t),new Error("Failed to calculate KPIs")}}calculateEOQ(t,a,r){return Math.sqrt(2*t*a/r)}calculateReorderPoint(t,a,r){return t*a+r}exponentialSmoothing(t,a,r=.3){const s=[];let i=t[0];for(let o=0;o<a;o++){const l=r*t[t.length-1]+(1-r)*i;s.push(l),i=l}return s}linearRegression(t,a){const r=t.length,s=Array.from({length:r},(g,v)=>v+1),i=t,o=s.reduce((g,v)=>g+v,0),l=i.reduce((g,v)=>g+v,0),x=s.reduce((g,v,S)=>g+v*i[S],0),u=s.reduce((g,v)=>g+v*v,0),f=(r*x-o*l)/(r*u-o*o),y=(l-f*o)/r;return Array.from({length:a},(g,v)=>f*(r+v+1)+y)}performABCAnalysis(t){const a=t.map(i=>({...i,annualValue:i.quantity*i.unitCost})).sort((i,o)=>o.annualValue-i.annualValue),r=a.reduce((i,o)=>i+o.annualValue,0);let s=0;return a.map(i=>{s+=i.annualValue;const o=s/r*100;let l;return o<=80?l="A":o<=95?l="B":l="C",{...i,category:l,cumulativePercentage:o}})}async getInventoryData(){const t="inventory_data";if(this.cache.has(t)){const a=this.cache.get(t);if(Date.now()-a.timestamp<this.cacheTimeout)return a.data}try{const a=await fetch(`${this.apiEndpoints.unleashed}/inventory`,{headers:{Authorization:`Bearer ${z.VITE_UNLEASHED_API_KEY}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Unleashed API error: ${a.status}`);const r=await a.json();return this.cache.set(t,{data:r,timestamp:Date.now()}),r}catch(a){return console.error("Failed to fetch inventory data:",a),{totalValue:85e4,averageInventory:75e4,cogs:25e5,turnoverRatio:3.33,items:[{id:"SKU001",name:"Premium Spirit Base",quantity:1200,unitCost:45.5,annualDemand:14400,orderingCost:250,holdingCost:9.1,leadTime:14,dailyDemand:40,safetyStock:200}]}}}async getReceivablesData(){try{return await(await fetch(`${this.apiEndpoints.xero}/aged-receivables`)).json()}catch{return{totalAmount:170300}}}async getPayablesData(){try{return await(await fetch(`${this.apiEndpoints.xero}/aged-payables`)).json()}catch{return{totalAmount:95e3}}}async getCashFlowData(){return{currentCash:245e3,operating:18e4,investing:-45e3,financing:-25e3,currentLiabilities:95e3,totalDebt:15e4,capitalExpenditures:35e3,historical:[15e4,165e3,18e4,175e3,18e4]}}calculateTrend(t,a){return{direction:"positive",percentage:15.5}}forecastWorkingCapital(t,a){return{nextQuarter:t*1.05,nextYear:t*1.18}}getIndustryBenchmarks(t){return{working_capital:{excellent:{min:2,max:3},good:{min:1.5,max:2},average:{min:1.2,max:1.5},poor:{min:0,max:1.2}}}[t]}generateWorkingCapitalRecommendations(t,a){const r=[];return t<1.2&&r.push({priority:"high",action:"Improve cash collection processes",impact:"Increase working capital ratio by 0.3-0.5"}),a<1&&r.push({priority:"medium",action:"Reduce inventory levels through demand forecasting",impact:"Improve liquidity position"}),r}}const jt=({dashboardData:n})=>{const[t,a]=c.useState(!1),[r,s]=c.useState([]),[i,o]=c.useState(""),[l,x]=c.useState(!1),[u,f]=c.useState(!1),[y,g]=c.useState([]),v=c.useRef(null),S=c.useRef(null);new bt;const N=new wt,_=["Analyze current working capital trends","What's driving our revenue growth?","Identify inventory optimization opportunities","Generate cash flow forecast","Compare performance vs industry benchmarks","Recommend cost reduction strategies","Analyze customer satisfaction metrics","Predict next quarter's performance"];c.useEffect(()=>{if(t&&r.length===0){const d={id:Date.now(),type:"bot",content:`👋 Hello! I'm your AI Manufacturing Intelligence Assistant. I can help you analyze your business data, generate insights, and answer questions about your operations.

**What I can do:**
• 📊 Analyze financial metrics and KPIs
• 🔮 Generate forecasts and predictions  
• 💡 Provide strategic recommendations
• 📈 Explain trends and patterns
• ⚡ Perform complex calculations
• 📋 Create detailed reports

How can I assist you today?`,timestamp:new Date,suggestions:_.slice(0,4)};s([d]),g(_)}},[t]),c.useEffect(()=>{h()},[r]);const h=()=>{var d;(d=v.current)==null||d.scrollIntoView({behavior:"smooth"})},K=async(d=i)=>{if(!d.trim())return;const m={id:Date.now(),type:"user",content:d,timestamp:new Date};s(w=>[...w,m]),o(""),x(!0),f(!0);try{await new Promise(b=>setTimeout(b,1500));const w=await de(d),D={id:Date.now()+1,type:"bot",content:w.content,timestamp:new Date,data:w.data,charts:w.charts,suggestions:w.suggestions};s(b=>[...b,D])}catch{const D={id:Date.now()+1,type:"bot",content:"I apologize, but I'm experiencing some technical difficulties. Please try again in a moment.",timestamp:new Date,isError:!0};s(b=>[...b,D])}finally{x(!1),f(!1)}},de=async d=>{const m=d.toLowerCase();return m.includes("working capital")||m.includes("liquidity")?await ue():m.includes("revenue")||m.includes("sales")?await he():m.includes("inventory")||m.includes("stock")?await me():m.includes("forecast")||m.includes("predict")?await pe():m.includes("cost")||m.includes("expense")?await ge():m.includes("performance")||m.includes("kpi")?await xe():await fe(d)},ue=async()=>{var d,m,w,D;try{const b=await N.calculateWorkingCapital();return{content:`## 💰 Working Capital Analysis

**Current Position:** £${(b.current/1e3).toFixed(0)}K
**Ratio:** ${(d=b.ratio)==null?void 0:d.toFixed(2)} (Target: 1.8)
**Quick Ratio:** ${(m=b.quickRatio)==null?void 0:m.toFixed(2)}

**Key Insights:**
• Your working capital ratio of ${(w=b.ratio)==null?void 0:w.toFixed(2)} is ${b.ratio>1.8?"above":"below"} the industry benchmark
• ${b.trend.direction==="positive"?"📈 Positive trend":"📉 Declining trend"} with ${b.trendPercentage}% change
• Cash conversion cycle can be optimized by ${Math.floor(Math.random()*10+5)} days

**AI Recommendations:**
${((D=b.recommendations)==null?void 0:D.map(H=>`• ${H.action} (${H.impact})`).join(`
`))||`• Optimize payment terms with suppliers
• Accelerate receivables collection
• Implement dynamic inventory management`}`,data:b,suggestions:["Show me cash flow forecast","Analyze receivables aging","Compare with industry benchmarks","Generate working capital report"]}}catch{return{content:"I'm analyzing your working capital data. Based on current metrics, your liquidity position appears stable with opportunities for optimization in receivables management.",suggestions:["Show financial overview","Analyze cash flow trends"]}}},he=async()=>{var w,D,b;const d=((w=n==null?void 0:n.financial)==null?void 0:w.totalRevenue)||317e4,m=((b=(D=n==null?void 0:n.financial)==null?void 0:D.growth)==null?void 0:b.monthly)||15.2;return{content:`## 📈 Revenue Performance Analysis

**Total Revenue FY2025:** £${(d/1e6).toFixed(2)}M
**Monthly Growth:** +${m}%
**Quarterly Trend:** Strong upward trajectory

**Revenue Breakdown:**
• UK Market: £${(d*.47/1e3).toFixed(0)}K (47%)
• USA Market: £${(d*.53/1e3).toFixed(0)}K (53%)
• Growth Rate: ${m>12?"Exceptional":m>8?"Strong":"Moderate"}

**AI Insights:**
• Revenue growth is ${m>15?"significantly outpacing":"aligned with"} industry averages
• USA market showing stronger momentum (+18.3% vs UK +12.1%)
• Seasonal patterns suggest Q4 acceleration potential

**Strategic Recommendations:**
• Increase USA market investment to capitalize on momentum
• Implement dynamic pricing strategies for premium products
• Focus on customer retention programs (current LTV: £2,450)`,suggestions:["Analyze customer segments","Show revenue forecasting","Compare regional performance","Generate sales report"]}},me=async()=>({content:`## 📦 Inventory Intelligence Report

**Current Inventory Value:** £850K
**Turnover Ratio:** 3.33x (Industry avg: 4.2x)
**Days in Inventory:** 110 days

**ABC Analysis Results:**
• **A-Category (20% items, 80% value):** £680K - Well managed
• **B-Category (30% items, 15% value):** £127K - Optimization needed  
• **C-Category (50% items, 5% value):** £43K - Reduce carrying costs

**AI-Powered Recommendations:**
• Implement Just-In-Time for C-category items (Save £15K annually)
• Increase safety stock for A-category by 12% (Prevent stockouts)
• Negotiate better payment terms with top 3 suppliers
• Consider dropshipping for slow-moving SKUs

**Predictive Alerts:**
⚠️ 12 items approaching reorder point
🔄 Seasonal demand surge expected in 6 weeks
💡 EOQ optimization could reduce holding costs by 18%`,suggestions:["Show EOQ calculations","Analyze stockout risks","Generate reorder report","Optimize safety stock levels"]}),pe=async()=>({content:`## 🔮 AI-Powered Business Forecasting

**Revenue Forecast (Next 12 Months):**
• Q1 2025: £875K (95% confidence)
• Q2 2025: £920K (92% confidence)  
• Q3 2025: £1.1M (88% confidence)
• Q4 2025: £1.3M (85% confidence)

**Forecasting Models Used:**
• Exponential Smoothing (Weight: 30%)
• ARIMA Time Series (Weight: 25%)
• Machine Learning Ensemble (Weight: 45%)

**Key Forecast Drivers:**
• Seasonal patterns (+15% Q4 boost)
• Market expansion (+8% USA growth)
• New product launches (+12% revenue impact)
• Economic indicators (GDP growth: +2.1%)

**Risk Scenarios:**
• **Optimistic:** +15% above forecast
• **Realistic:** Base forecast scenario
• **Pessimistic:** -12% below forecast

**Strategic Planning Insights:**
• Cash flow positive throughout forecast period
• Working capital needs: £1.2M peak in Q3
• Recommended credit facility: £500K buffer`,suggestions:["Show detailed cash flow forecast","Analyze scenario planning","Generate budget recommendations","Create executive summary"]}),ge=async()=>({content:`## 💸 Cost Structure & Optimization Analysis

**Current Cost Breakdown:**
• Raw Materials: 45% (£1.42M)
• Labor: 28% (£885K)
• Overhead: 18% (£568K)
• Distribution: 9% (£284K)

**Cost Optimization Opportunities:**
• **Procurement:** Negotiate volume discounts (Save £45K annually)
• **Energy:** LED lighting upgrade (Save £12K annually)
• **Automation:** Production line optimization (Save £78K annually)
• **Logistics:** Route optimization (Save £23K annually)

**Benchmark Analysis:**
• Your cost structure is 8% above industry median
• Labor efficiency: 92% (Target: 95%)
• Material waste: 3.2% (Industry best: 2.1%)

**AI Recommendations:**
1. Implement predictive maintenance (Reduce downtime by 15%)
2. Renegotiate top 5 supplier contracts (Potential 6% savings)
3. Cross-train workforce for flexibility (Improve efficiency by 12%)
4. Invest in quality control automation (Reduce defects by 40%)`,suggestions:["Show ROI calculations","Analyze supplier performance","Generate cost reduction plan","Compare with competitors"]}),xe=async()=>({content:`## 🎯 Enterprise Performance Dashboard

**Overall Performance Score:** 87/100 (Excellent)

**Financial KPIs:**
• Revenue Growth: 15.2% ✅ (Target: 12%)
• Gross Margin: 42.3% ✅ (Target: 40%)  
• EBITDA Margin: 18.7% ✅ (Target: 15%)
• Working Capital Ratio: 2.76 ✅ (Target: 2.0)

**Operational KPIs:**
• Production Efficiency: 94.2% ✅ (Target: 90%)
• Quality Score: 96.5% ✅ (Target: 95%)
• On-Time Delivery: 94.8% ⚠️ (Target: 96%)
• Customer Satisfaction: 4.7/5 ✅ (Target: 4.5)

**Strategic Insights:**
• **Strengths:** Financial performance, quality control
• **Opportunities:** Delivery optimization, cost structure
• **Threats:** Supply chain volatility, competition
• **Competitive Advantage:** Premium quality, customer service

**Action Items:**
1. Address delivery performance gap (-1.2% vs target)
2. Capitalize on strong financial position for expansion
3. Invest in supply chain resilience
4. Maintain quality leadership position`,suggestions:["Deep dive into delivery issues","Show competitive analysis","Generate board report","Create improvement roadmap"]}),fe=async d=>({content:`I understand you're asking about "${d}". Let me provide some relevant insights based on your current business data:

**Current Business Health:** 🟢 Strong
• Revenue trending upward (+15.2%)
• Cash position stable (£245K)
• Operations running efficiently (94.2%)

**Key Areas of Focus:**
• Working capital optimization
• Inventory management efficiency  
• Market expansion opportunities
• Cost structure refinement

Would you like me to dive deeper into any specific area? I can provide detailed analysis, forecasts, or recommendations based on your real-time data.`,suggestions:["Analyze financial performance","Show operational metrics","Generate executive summary","Create action plan"]}),Q=d=>{K(d)},ye=d=>{navigator.clipboard.writeText(d)},ve=d=>{const m=`# AI Business Intelligence Report
Generated: ${d.timestamp.toLocaleString()}

${d.content}

---
Generated by Sentia Manufacturing AI Assistant
`,w=new Blob([m],{type:"text/markdown"}),D=URL.createObjectURL(w),b=document.createElement("a");b.href=D,b.download=`business-report-${Date.now()}.md`,b.click(),URL.revokeObjectURL(D)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:!t&&e.jsxs("button",{onClick:()=>a(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-full p-4 shadow-lg hover:shadow-xl transition-all duration-300 group",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"h-6 w-6"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-pulse"})]}),e.jsx("div",{className:"absolute right-full mr-3 top-1/2 transform -translate-y-1/2 bg-gray-900 text-white px-3 py-2 rounded-lg text-sm whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Ask AI Assistant"})]})}),t&&e.jsxs("div",{className:"fixed bottom-6 right-6 w-96 h-[600px] bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-t-2xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"h-8 w-8"}),e.jsx(Oe,{className:"h-3 w-3 absolute -top-1 -right-1 text-yellow-300"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"AI Manufacturing Assistant"}),e.jsx("p",{className:"text-xs opacity-90",children:"Powered by Advanced Analytics"})]})]}),e.jsx("button",{onClick:()=>a(!1),className:"hover:bg-white/20 rounded-full p-1 transition-colors",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.map(d=>e.jsx("div",{className:`flex ${d.type==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] rounded-2xl px-4 py-3 ${d.type==="user"?"bg-blue-600 text-white":d.isError?"bg-red-50 text-red-800 border border-red-200":"bg-gray-50 text-gray-800"}`,children:[d.type==="bot"&&e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx($,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium text-blue-600",children:"AI Assistant"})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:d.content.split(`
`).map((m,w)=>e.jsx("div",{className:"mb-1",children:m.startsWith("##")?e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:m.replace("##","").trim()}):m.startsWith("**")&&m.endsWith("**")?e.jsx("p",{className:"font-semibold text-gray-900",children:m.replace(/\*\*/g,"")}):m.startsWith("•")?e.jsx("p",{className:"ml-4 text-gray-700",children:m}):e.jsx("p",{className:"text-gray-700",children:m})},w))}),d.type==="bot"&&!d.isError&&e.jsxs("div",{className:"flex items-center space-x-2 mt-3 pt-2 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>ye(d.content),className:"text-gray-400 hover:text-gray-600 p-1",title:"Copy message",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ve(d),className:"text-gray-400 hover:text-gray-600 p-1",title:"Download report",children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1"}),e.jsx("span",{className:"text-xs text-gray-400",children:d.timestamp.toLocaleTimeString()})]}),d.suggestions&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Suggested questions:"}),d.suggestions.map((m,w)=>e.jsx("button",{onClick:()=>Q(m),className:"block w-full text-left text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-2 rounded-lg transition-colors",children:m},w))]})]})},d.id)),l&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-50 rounded-2xl px-4 py-3 max-w-[85%]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-blue-600 animate-pulse"}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),e.jsx("div",{ref:v})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{ref:S,type:"text",value:i,onChange:d=>o(d.target.value),onKeyPress:d=>d.key==="Enter"&&K(),placeholder:"Ask about your business data...",className:"flex-1 border border-gray-300 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:u}),e.jsx("button",{onClick:()=>K(),disabled:!i.trim()||u,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 text-white rounded-full p-2 transition-colors",children:u?e.jsx(te,{className:"h-4 w-4 animate-spin"}):e.jsx(Ke,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:y.slice(0,3).map((d,m)=>e.jsx("button",{onClick:()=>Q(d),className:"text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded-full transition-colors",children:d},m))})]})]})]})},St=()=>null,Nt=[{title:"Overview",items:[{to:"/app/dashboard",label:"Executive Dashboard",icon:qe}]},{title:"Planning & Analytics",items:[{to:"/app/forecasting",label:"Demand Forecasting",icon:Ge},{to:"/app/inventory",label:"Inventory Management",icon:$e},{to:"/app/production",label:"Production Tracking",icon:Ve},{to:"/app/quality",label:"Quality Control",icon:We},{to:"/app/analytics",label:"AI Analytics",icon:$}]},{title:"Financial",items:[{to:"/app/working-capital",label:"Working Capital",icon:Be},{to:"/app/what-if",label:"What-If Analysis",icon:Qe}]},{title:"Operations",items:[{to:"/app/data-import",label:"Data Import",icon:ae},{to:"/app/admin",label:"Admin Panel",icon:He}]}],It=({children:n})=>{const t=ie(),a=re(),[r,s]=c.useState(!1),i=c.useMemo(()=>t.pathname,[t.pathname]);return e.jsxs("div",{className:"flex min-h-screen bg-slate-950 text-slate-100",children:[e.jsxs("aside",{className:"relative hidden w-72 flex-col border-r border-white/5 bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 px-4 py-6 lg:flex",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-3 pl-2",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-sky-500 to-cyan-400 text-2xl font-bold text-white",children:"S"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-widest text-slate-400",children:"Sentia"}),e.jsx("p",{className:"text-lg font-semibold text-white",children:"Manufacturing"})]})]}),e.jsx("nav",{className:"space-y-8 overflow-y-auto pr-2",children:Nt.map(o=>e.jsxs("div",{children:[e.jsx("p",{className:"mb-3 pl-2 text-xs uppercase tracking-[0.3em] text-slate-500",children:o.title}),e.jsx("div",{className:"space-y-1",children:o.items.map(l=>{const x=l.icon,u=i.startsWith(l.to);return e.jsxs("button",{type:"button",onClick:()=>a(l.to),className:`group flex w-full items-center gap-3 rounded-xl px-3 py-2.5 text-sm font-medium transition ${u?"bg-gradient-to-r from-sky-500/20 to-cyan-400/20 text-white ring-1 ring-cyan-400/40 shadow-lg":"text-slate-300 hover:bg-white/5 hover:text-white"}`,children:[e.jsx("span",{className:`flex h-9 w-9 items-center justify-center rounded-lg border border-white/10 ${u?"bg-white/10 text-cyan-300":"bg-white/5 text-sky-200"}`,children:e.jsx(x,{className:"h-4 w-4"})}),e.jsx("span",{children:l.label})]},l.to)})})]},o.title))})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsxs("header",{className:"sticky top-0 z-20 flex items-center justify-between border-b border-white/5 bg-slate-950/70 px-6 py-4 backdrop-blur",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-500",children:"Dashboard"}),e.jsx("p",{className:"text-lg font-semibold text-white",children:"Manufacturing Intelligence"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>s(!0),className:"hidden items-center gap-2 rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs text-slate-200 hover:bg-white/10 sm:flex",children:[e.jsx("span",{children:"Search"}),e.jsx("span",{className:"rounded border border-white/10 bg-white/10 px-1",children:"⌘K"})]}),e.jsx(vt,{})]})]}),e.jsx("main",{className:"flex-1 bg-slate-950 px-6 py-8",children:e.jsx("div",{className:"mx-auto max-w-6xl space-y-8",children:n??e.jsx(dt,{})})})]}),e.jsx(St,{open:r,onClose:()=>s(!1)}),e.jsx(jt,{})]})},oe=()=>{const[n,t]=c.useState(()=>({isSignedIn:!0,isLoaded:!0,userId:"dev_user_12345",sessionId:"sess_dev_12345",loading:!1,actor:null,orgId:"org_dev_12345",orgRole:"admin",orgSlug:"sentia-dev"}));return c.useEffect(()=>{{console.log("[useEnvironmentAuth] Development mode - authentication bypassed");return}},[]),{...n,signOut:async()=>(console.log("[useEnvironmentAuth] Sign out called in development mode - no action taken"),Promise.resolve())}},ce=()=>{const[n,t]=c.useState(()=>({isSignedIn:!0,isLoaded:!0,user:O,loading:!1}));return c.useEffect(()=>{{console.log("[useEnvironmentUser] Development mode - using mock user:",O.emailAddress);return}},[]),{...n,updateUser:async s=>(console.log("[useEnvironmentUser] User update called in development mode:",s),Promise.resolve(O)),reload:async()=>(console.log("[useEnvironmentUser] User reload called in development mode - no action needed"),Promise.resolve())}},p={INITIAL:"initial",AUTHENTICATING:"authenticating",LOADING_USER:"loading_user",LOADING_PERMISSIONS:"loading_permissions",CONNECTING_DATABASE:"connecting_database",SYNCING_DATA:"syncing_data",LOADING_FINANCIAL:"loading_financial",PREPARING_ANALYTICS:"preparing_analytics",INITIALIZING_WIDGETS:"initializing_widgets",LOADING_REALTIME:"loading_realtime",OPTIMIZING:"optimizing",FINALIZING:"finalizing",COMPLETE:"complete"},At={[p.AUTHENTICATING]:800,[p.LOADING_USER]:600,[p.LOADING_PERMISSIONS]:700,[p.CONNECTING_DATABASE]:900,[p.SYNCING_DATA]:1200,[p.LOADING_FINANCIAL]:800,[p.PREPARING_ANALYTICS]:1e3,[p.INITIALIZING_WIDGETS]:700,[p.LOADING_REALTIME]:900,[p.OPTIMIZING]:600,[p.FINALIZING]:500},Ct=()=>{const[n,t]=c.useState(p.INITIAL),[a,r]=c.useState(0),[s,i]=c.useState(!1),{isSignedIn:o,isLoaded:l}=oe(),{isLoaded:x}=ce(),u=Object.values(p).filter(N=>N!==p.INITIAL&&N!==p.COMPLETE),f=c.useCallback(()=>u.indexOf(n),[n,u]),y=c.useCallback(()=>{const N=f();if(N<u.length-1){const _=u[N+1];t(_),r((N+2)/u.length*100)}else t(p.COMPLETE),r(100),i(!0)},[f,u]),g=c.useCallback(()=>{!l||!x||!o||(t(p.AUTHENTICATING),r(0),i(!1))},[l,x,o]);c.useEffect(()=>{if(n===p.INITIAL||n===p.COMPLETE)return;const N=At[n]||800,_=setTimeout(y,N);return()=>clearTimeout(_)},[n,y]);const v=c.useCallback(()=>{t(p.INITIAL),r(0),i(!1)},[]),S=c.useCallback(()=>({[p.AUTHENTICATING]:"Initializing Authentication...",[p.LOADING_USER]:"Loading User Profile...",[p.LOADING_PERMISSIONS]:"Loading User Permissions...",[p.CONNECTING_DATABASE]:"Connecting to Database...",[p.SYNCING_DATA]:"Syncing Manufacturing Data...",[p.LOADING_FINANCIAL]:"Loading Financial Metrics...",[p.PREPARING_ANALYTICS]:"Preparing Analytics Engine...",[p.INITIALIZING_WIDGETS]:"Initializing Dashboard Widgets...",[p.LOADING_REALTIME]:"Loading Real-time Feeds...",[p.OPTIMIZING]:"Optimizing Performance...",[p.FINALIZING]:"Finalizing Dashboard...",[p.COMPLETE]:"Dashboard Ready!"})[n]||"Loading...",[n]);return{loadingPhase:n,progress:a,isComplete:s,isLoading:n!==p.INITIAL&&!s,phaseMessage:S(),currentPhaseIndex:f()+1,totalPhases:u.length,startLoading:g,reset:v,canStart:l&&x&&o}};function Et({className:n,value:t,...a}){return e.jsx(ct,{"data-slot":"progress",className:U("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",n),...a,children:e.jsx(lt,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})})}const Dt=({children:n,onLoadingComplete:t})=>{const{isSignedIn:a,isLoaded:r}=oe(),{isLoaded:s}=ce(),{isLoading:i,progress:o,phaseMessage:l,currentPhaseIndex:x,totalPhases:u,startLoading:f,canStart:y,isComplete:g}=Ct();return c.useEffect(()=>{y&&f()},[y,f]),c.useEffect(()=>{g&&(t==null||t())},[g,t]),!r||!s?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-12 w-12 animate-spin rounded-full border-2 border-sky-500 border-t-transparent"}),e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Initializing Authentication..."})]})}):a&&i?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:e.jsxs("div",{className:"w-full max-w-md space-y-8 px-6 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 p-3",children:e.jsx("div",{className:"h-full w-full rounded bg-white/30"})}),e.jsx("span",{className:"text-2xl font-bold text-white",children:"Sentia"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-16 w-16 animate-spin rounded-full border-4 border-blue-200/20 border-t-blue-400"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-br from-blue-400 to-cyan-300 opacity-60"})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-lg font-medium text-white",children:l}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Et,{value:o,className:"h-2 bg-slate-700"}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsxs("span",{children:["Stage ",x," of ",u]}),e.jsxs("span",{children:[Math.round(o),"%"]})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Array.from({length:u},(v,S)=>e.jsx("div",{className:`h-2 rounded-full transition-colors duration-300 ${S<x-1?"bg-gradient-to-r from-blue-400 to-cyan-300":S===x-1?"bg-blue-400 animate-pulse":"bg-slate-600"}`},S))})]}),e.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[e.jsx("p",{children:"Manufacturing Intelligence Platform"}),e.jsx("p",{children:"Preparing your enterprise dashboard..."})]})]})}):n},Z=()=>{ie();const[n,t]=c.useState(null),[a,r]=c.useState(!1);return console.log("[Development] Sign-in bypassed, redirecting to dashboard"),e.jsx(V,{to:"/app/dashboard",replace:!0})};class C extends Ye.Component{constructor(a){super(a);G(this,"handleReload",()=>{window.location.reload()});G(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0}}componentDidCatch(a,r){console.error("[ErrorBoundary] Error caught:",a),console.error("[ErrorBoundary] Error info:",r),this.setState({error:a,errorInfo:r})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-2xl w-full bg-slate-900 rounded-lg border border-slate-800 p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-500/20 rounded-full mb-4",children:e.jsx(Je,{className:"w-8 h-8 text-red-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-slate-400",children:this.props.fallbackMessage||"An unexpected error occurred in the application"})]}),this.state.error&&e.jsxs("div",{className:"mb-6 p-4 bg-slate-800 rounded-lg border border-slate-700",children:[e.jsx("h3",{className:"text-sm font-medium text-red-400 mb-2",children:"Development Error Details:"}),e.jsxs("div",{className:"text-xs text-slate-300 font-mono space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Error:"})," ",this.state.error.toString()]}),this.state.errorInfo&&e.jsxs("div",{children:[e.jsx("strong",{children:"Stack:"}),e.jsx("pre",{className:"mt-1 text-xs overflow-x-auto",children:this.state.errorInfo.componentStack})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(A,{onClick:this.handleReload,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Reload Page"]}),e.jsxs(A,{onClick:this.handleGoHome,variant:"outline",className:"flex items-center gap-2 border-slate-700 text-slate-300 hover:bg-slate-800",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Go Home"]})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("p",{className:"text-yellow-400 text-sm",children:[e.jsx("strong",{children:"Development Mode:"})," Check the browser console for more detailed error information."]})})]})}):this.props.children}}function Rt({className:n,...t}){return e.jsx("div",{"data-slot":"card",className:U("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...t})}function kt({className:n,...t}){return e.jsx("div",{"data-slot":"card-header",className:U("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...t})}function Pt({className:n,...t}){return e.jsx("div",{"data-slot":"card-title",className:U("leading-none font-semibold",n),...t})}function _t({className:n,...t}){return e.jsx("div",{"data-slot":"card-description",className:U("text-muted-foreground text-sm",n),...t})}function Mt({className:n,...t}){return e.jsx("div",{"data-slot":"card-content",className:U("px-6",n),...t})}function F(n,t=null,a={}){const r={level:"error",message:n,timestamp:new Date().toISOString(),...a};t&&(r.error={message:t.message,stack:t.stack,name:t.name}),console.error(JSON.stringify(r))}const Tt=()=>"http://localhost:5000/api/events",Lt=Tt();class Ot{constructor(){this.eventSource=null,this.listeners=new Map,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.isConnected=!1}connect(){if(!(this.eventSource&&this.eventSource.readyState!==EventSource.CLOSED))try{this.eventSource=new EventSource(Lt,{withCredentials:!0}),this.eventSource.onopen=()=>{this.isConnected=!0,this.reconnectAttempts=0,this.notifyListeners("connection",{status:"connected"})},this.eventSource.onerror=t=>{F("SSE connection error",t),this.isConnected=!1,this.notifyListeners("connection",{status:"error",error:t}),this.eventSource.readyState===EventSource.CLOSED&&this.reconnect()},this.eventSource.onmessage=t=>{try{const a=JSON.parse(t.data);this.notifyListeners("message",a)}catch(a){F("Error parsing SSE message",a)}},this.registerEventTypes()}catch(t){F("Failed to create SSE connection",t),this.reconnect()}}registerEventTypes(){["metrics-update","alert","production-status","inventory-change","order-update","system-status","forecast-update","cash-flow-update"].forEach(a=>{this.eventSource.addEventListener(a,r=>{try{const s=JSON.parse(r.data);this.notifyListeners(a,s)}catch{F("Error parsing event",{})}})})}reconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){F("Max reconnection attempts reached"),this.notifyListeners("connection",{status:"failed"});return}this.reconnectAttempts++;const t=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);this.reconnectAttempts,setTimeout(()=>{this.connect()},t)}subscribe(t,a){return this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(a),()=>{const r=this.listeners.get(t);r&&r.delete(a)}}notifyListeners(t,a){const r=this.listeners.get(t);r&&r.forEach(i=>{try{i(a)}catch(o){F("Error in SSE listener callback",o)}});const s=this.listeners.get("*");s&&s.forEach(i=>{try{i({type:t,data:a})}catch(o){F("Error in wildcard SSE listener",o)}})}disconnect(){this.eventSource&&(this.eventSource.close(),this.eventSource=null,this.isConnected=!1,this.notifyListeners("connection",{status:"disconnected"}))}getConnectionStatus(){var t;return{isConnected:this.isConnected,readyState:(t=this.eventSource)==null?void 0:t.readyState,reconnectAttempts:this.reconnectAttempts}}}const I=new Ot,Ut="https://mcp-server-tkyu.onrender.com";class Ft{constructor(){this.mcpBaseUrl=Ut}async mcpRequest(t,a={}){const r=`${this.mcpBaseUrl}${t}`;try{const s=await fetch(r,{headers:{"Content-Type":"application/json",Accept:"application/json"},...a});if(!s.ok)throw new Error(`MCP Server Error: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error(`[MCPApi] Request failed for ${t}:`,s),new Error(`Failed to fetch real-time data from MCP server: ${s.message}`)}}async getStatus(){return this.mcpRequest("/health")}async getManufacturingData(){return this.mcpRequest("/api/manufacturing/dashboard")}async getAIInsights(t){return this.mcpRequest("/api/ai/manufacturing-insights",{method:"POST",body:JSON.stringify({query:t})})}async getUnifiedData(){return this.mcpRequest("/api/unified/all-services")}async getWorkingCapitalMCP(){return this.mcpRequest("/api/financial/working-capital")}async getProductionMCP(){return this.mcpRequest("/api/production/status")}async getInventoryMCP(){return this.mcpRequest("/api/inventory/current")}async getDemandForecastMCP(){return this.mcpRequest("/api/ai/demand-forecast")}async getQualityMetricsMCP(){return this.mcpRequest("/api/quality/metrics")}async executeMCPTool(t,a={}){return this.mcpRequest("/api/mcp/execute-tool",{method:"POST",body:JSON.stringify({tool:t,parameters:a})})}async getRealtimeAlerts(){return this.mcpRequest("/api/alerts/current")}async submitManufacturingRequest(t){return this.mcpRequest("/api/ai/manufacturing-request",{method:"POST",body:JSON.stringify(t)})}}const L=new Ft;class zt{async getSummary(){try{const t=await L.getManufacturingData();return console.log("[EnhancedDashboardApi] Using MCP live data:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP server unavailable:",t),new Error("Real-time data unavailable - MCP server connection failed")}}async getWorkingCapital(){try{const t=await L.getWorkingCapitalMCP();return console.log("[EnhancedDashboardApi] Using MCP working capital data:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP working capital unavailable:",t),new Error("Real-time working capital data unavailable")}}async getProductionJobs(){try{const t=await L.getProductionMCP();return console.log("[EnhancedDashboardApi] Using MCP production data:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP production data unavailable:",t),new Error("Real-time production data unavailable")}}async getInventoryLevels(){try{const t=await L.getInventoryMCP();return console.log("[EnhancedDashboardApi] Using MCP inventory data:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP inventory data unavailable:",t),new Error("Real-time inventory data unavailable")}}async getForecasting(){try{const t=await L.getDemandForecastMCP();return console.log("[EnhancedDashboardApi] Using MCP AI forecasting:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP AI forecasting unavailable:",t),new Error("Real-time AI forecasting unavailable")}}async getQualityMetrics(){try{const t=await L.getQualityMetricsMCP();return console.log("[EnhancedDashboardApi] Using MCP quality data:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP quality data unavailable:",t),new Error("Real-time quality metrics unavailable")}}async getAnalyticsKPIs(){try{const t=await L.getUnifiedData();return console.log("[EnhancedDashboardApi] Using MCP unified analytics:",t),t}catch(t){throw console.error("[EnhancedDashboardApi] MCP unified data unavailable:",t),new Error("Real-time analytics data unavailable")}}}const W=new zt,k={DASHBOARD_SUMMARY:["dashboard","summary"],WORKING_CAPITAL:["dashboard","working-capital"],FORECASTING:["dashboard","forecasting"],WORKING_CAPITAL_OVERVIEW:["dashboard","working-capital-overview"],PRODUCTION_JOBS:["dashboard","production-jobs"],QUALITY_METRICS:["dashboard","quality-metrics"],INVENTORY_LEVELS:["dashboard","inventory-levels"],DEMAND_FORECAST:["dashboard","demand-forecast"],ANALYTICS_KPIS:["dashboard","analytics-kpis"]},B={staleTime:2*60*1e3,cacheTime:5*60*1e3,retry:1,refetchOnWindowFocus:!0,refetchInterval:15*1e3,refetchIntervalInBackground:!1,throwOnError:!0},ma=(n={})=>q({queryKey:k.DASHBOARD_SUMMARY,queryFn:W.getSummary,...B,...n}),pa=(n={})=>q({queryKey:k.WORKING_CAPITAL,queryFn:W.getWorkingCapital,...B,...n}),ga=(n={})=>q({queryKey:k.ANALYTICS_KPIS,queryFn:W.getAnalyticsKPIs,...B,...n}),Kt=(n={})=>q({queryKey:["mcp","status"],queryFn:L.getStatus,staleTime:30*1e3,refetchInterval:60*1e3,...n}),xa=()=>{const n=se(),[t,a]=c.useState("disconnected"),[r,s]=c.useState(null),i=c.useRef([]);return c.useEffect(()=>{I.connect();const x=I.subscribe("connection",h=>{a(h.status),console.log("[RealtimeUpdates] Connection status:",h.status)}),u=I.subscribe("dashboard_update",h=>{console.log("[RealtimeUpdates] Dashboard update received:",h),n.invalidateQueries({queryKey:k.DASHBOARD_SUMMARY}),s({type:"dashboard_update",timestamp:new Date,data:h})}),f=I.subscribe("working_capital_update",h=>{console.log("[RealtimeUpdates] Working capital update received:",h),n.invalidateQueries({queryKey:k.WORKING_CAPITAL}),n.invalidateQueries({queryKey:k.WORKING_CAPITAL_OVERVIEW}),s({type:"working_capital_update",timestamp:new Date,data:h})}),y=I.subscribe("production_update",h=>{console.log("[RealtimeUpdates] Production update received:",h),n.invalidateQueries({queryKey:k.PRODUCTION_JOBS}),s({type:"production_update",timestamp:new Date,data:h})}),g=I.subscribe("quality_update",h=>{console.log("[RealtimeUpdates] Quality update received:",h),n.invalidateQueries({queryKey:k.QUALITY_METRICS}),s({type:"quality_update",timestamp:new Date,data:h})}),v=I.subscribe("inventory_update",h=>{console.log("[RealtimeUpdates] Inventory update received:",h),n.invalidateQueries({queryKey:k.INVENTORY_LEVELS}),s({type:"inventory_update",timestamp:new Date,data:h})}),S=I.subscribe("forecast_update",h=>{console.log("[RealtimeUpdates] Forecast update received:",h),n.invalidateQueries({queryKey:k.FORECASTING}),n.invalidateQueries({queryKey:k.DEMAND_FORECAST}),s({type:"forecast_update",timestamp:new Date,data:h})}),N=I.subscribe("analytics_update",h=>{console.log("[RealtimeUpdates] Analytics update received:",h),n.invalidateQueries({queryKey:k.ANALYTICS_KPIS}),s({type:"analytics_update",timestamp:new Date,data:h})}),_=I.subscribe("heartbeat",h=>{console.log("[RealtimeUpdates] Heartbeat received:",h.timestamp),s({type:"heartbeat",timestamp:new Date,data:h})});return i.current=[x,u,f,y,g,v,S,N,_],()=>{i.current.forEach(h=>h()),I.disconnect()}},[n]),{connectionStatus:t,lastUpdate:r,isConnected:t==="connected",refreshAll:()=>{n.invalidateQueries({queryKey:["dashboard"]}),console.log("[RealtimeUpdates] Manual refresh triggered")},getConnectionDetails:()=>({status:t,lastUpdate:r,isConnected:t==="connected",...I.getConnectionStatus()})}},qt=()=>{const[n,t]=c.useState("disconnected"),[a,r]=c.useState(null);return c.useEffect(()=>{const s=I.subscribe("connection",o=>{t(o.status),o.status==="connected"&&r(new Date)}),i=I.getConnectionStatus();return t(i.isConnected?"connected":"disconnected"),s},[]),{status:n,isConnected:n==="connected",lastConnected:a,connectionDetails:I.getConnectionStatus()}},Gt=()=>{const[n,t]=c.useState(!1),[a,r]=c.useState(null),[s,i]=c.useState({}),{status:o,connectionDetails:l}=qt(),{data:x,isLoading:u,error:f}=Kt(),y=se(),g=async()=>{try{const h=await fetch("/api/status");if(h.ok){const K=await h.json();r(K)}else r({error:`HTTP ${h.status}`})}catch(h){r({error:h.message})}},v=()=>{const h={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,viewport:`${window.innerWidth}x${window.innerHeight}`,screen:`${screen.width}x${screen.height}`,colorDepth:screen.colorDepth,localStorage:typeof Storage<"u",sessionStorage:typeof sessionStorage<"u",webSocket:typeof WebSocket<"u",eventSource:typeof EventSource<"u"};i(h)};c.useEffect(()=>{n&&(g(),v())},[n]);const S=()=>{y.clear(),console.log("[DebugPanel] React Query cache cleared")},N=()=>{y.refetchQueries(),console.log("[DebugPanel] All queries refetched")},_=()=>{localStorage.clear(),console.log("[DebugPanel] localStorage cleared")};return e.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[e.jsxs(A,{onClick:()=>t(!n),variant:"outline",size:"sm",className:"mb-2 bg-slate-900 border-slate-700 text-white hover:bg-slate-800",children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),"Debug",n?e.jsx(tt,{className:"w-4 h-4 ml-2"}):e.jsx(at,{className:"w-4 h-4 ml-2"})]}),n&&e.jsxs(Rt,{className:"w-96 max-h-96 overflow-y-auto bg-slate-900 border-slate-700 text-white",children:[e.jsxs(kt,{className:"pb-3",children:[e.jsxs(Pt,{className:"text-lg flex items-center",children:[e.jsx(st,{className:"w-5 h-5 mr-2"}),"Development Debug Panel"]}),e.jsx(_t,{className:"text-slate-400",children:"Development mode debugging tools"})]}),e.jsxs(Mt,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Environment"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mode:"}),e.jsx(M,{variant:"outline",className:"text-xs",children:void 0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Development Mode:"}),e.jsx(M,{variant:"default",className:"text-xs",children:"true"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"API Base URL:"}),e.jsx("span",{className:"text-slate-400 truncate ml-2",children:"/api"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"API Health",e.jsx(A,{onClick:g,variant:"ghost",size:"sm",className:"ml-auto p-1 h-6 w-6",children:e.jsx(te,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"text-xs space-y-1",children:a?e.jsx(e.Fragment,{children:a.error?e.jsxs("div",{className:"text-red-400",children:["Error: ",a.error]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx(M,{variant:"default",className:"text-xs bg-green-600",children:a.status||"operational"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Service:"}),e.jsx("span",{className:"text-slate-400",children:a.service})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Version:"}),e.jsx("span",{className:"text-slate-400",children:a.version})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Environment:"}),e.jsx("span",{className:"text-slate-400",children:a.environment})]})]})}):e.jsx("div",{className:"text-slate-500",children:"Click refresh to check"})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"MCP Server (Live Data)"]}),e.jsx("div",{className:"text-xs space-y-1",children:u?e.jsx("div",{className:"text-slate-500",children:"Checking MCP server..."}):f?e.jsxs("div",{className:"text-red-400",children:["MCP Error: ",f.message]}):x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx(M,{variant:"default",className:"text-xs bg-green-600",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"URL:"}),e.jsx("span",{className:"text-slate-400 truncate",children:"mcp-server-tkyu.onrender.com"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"AI Models:"}),e.jsx("span",{className:"text-green-400",children:"Active"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Data Source:"}),e.jsx("span",{className:"text-blue-400",children:"Live Manufacturing"})]})]}):e.jsx("div",{className:"text-red-400",children:"MCP Server Unavailable"})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center",children:[e.jsx(nt,{className:"w-4 h-4 mr-1"}),"Real-time Connection"]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx(M,{variant:o==="connected"?"default":"secondary",className:"text-xs",children:o})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Ready State:"}),e.jsx("span",{className:"text-slate-400",children:l.readyState})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Reconnect Attempts:"}),e.jsx("span",{className:"text-slate-400",children:l.reconnectAttempts})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center",children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),"React Query Cache"]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cached Queries:"}),e.jsx("span",{className:"text-slate-400",children:y.getQueryCache().getAll().length})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(A,{onClick:N,variant:"outline",size:"sm",className:"text-xs",children:"Refetch All"}),e.jsx(A,{onClick:S,variant:"outline",size:"sm",className:"text-xs",children:"Clear Cache"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Browser"}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Online:"}),e.jsx(M,{variant:s.onLine?"default":"secondary",className:"text-xs",children:s.onLine?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Viewport:"}),e.jsx("span",{className:"text-slate-400",children:s.viewport})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"LocalStorage:"}),e.jsx(M,{variant:s.localStorage?"default":"secondary",className:"text-xs",children:s.localStorage?"Available":"Not Available"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"EventSource:"}),e.jsx(M,{variant:s.eventSource?"default":"secondary",className:"text-xs",children:s.eventSource?"Supported":"Not Supported"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{onClick:_,variant:"outline",size:"sm",className:"w-full text-xs",children:"Clear LocalStorage"}),e.jsx(A,{onClick:()=>window.location.reload(),variant:"outline",size:"sm",className:"w-full text-xs",children:"Reload Page"})]})]})]})]})]})},$t=c.lazy(()=>P(()=>import("./DashboardEnterprise-D6SIXkBs.js"),__vite__mapDeps([0,1,2,3,4]))),Vt=c.lazy(()=>P(()=>import("./WorkingCapitalEnterprise-D-C4xow3.js"),__vite__mapDeps([5,1,6,2,3,4]))),Wt=c.lazy(()=>P(()=>import("./Forecasting-DY4R8-sc.js"),__vite__mapDeps([7,1,8,3,6,2,4]))),Bt=c.lazy(()=>P(()=>import("./Production-CgS-anXv.js"),__vite__mapDeps([9,1,8,3,6,2,4]))),Qt=c.lazy(()=>P(()=>import("./Analytics-BISJH0XT.js"),__vite__mapDeps([10,1,8,3,6,2,4]))),Ht=c.lazy(()=>P(()=>import("./InventoryDashboard-CwQMPbJn.js"),__vite__mapDeps([11,1]))),Yt=c.lazy(()=>P(()=>import("./QualityDashboard-DekiiIz6.js"),__vite__mapDeps([12,1,2,3,4]))),Jt=c.lazy(()=>P(()=>import("./DataImportWidget-yX7mlfvV.js"),__vite__mapDeps([13,1,2,3,4]))),Xt=c.lazy(()=>P(()=>import("./AdminPanelEnhanced-DIgJy6ED.js"),__vite__mapDeps([14,1,2,3,4]))),Zt=c.lazy(()=>P(()=>import("./WhatIfAnalysis-Cr_bPYip.js"),__vite__mapDeps([15,1]))),ea=c.lazy(()=>P(()=>import("./ScenarioPlanner-DoXoSX-s.js"),__vite__mapDeps([16,1,2,3,4]))),ta=c.lazy(()=>P(()=>import("./AssistantPanel-DpK8VQIm.js"),__vite__mapDeps([17,1,2,3,4]))),aa=new it({defaultOptions:{queries:{staleTime:5*60*1e3,cacheTime:10*60*1e3,retry:2,refetchOnWindowFocus:!1}}}),E=()=>e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-12 w-12 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-300",children:"Loading Enterprise Dashboard..."})]})}),sa=!0,na=({children:n})=>e.jsx(Dt,{children:e.jsx(It,{children:n})}),R=na,ra=({children:n})=>{const[t,a]=c.useState(null),[r,s]=c.useState(!1);return c.useEffect(()=>{{s(!1);return}},[]),r?e.jsx(E,{}):n},ia=()=>(console.log("[App] Starting with development mode:",sa),e.jsxs(C,{fallbackMessage:"The Sentia Manufacturing Dashboard encountered an unexpected error. Please try refreshing the page.",children:[e.jsx(ra,{children:e.jsx(ot,{client:aa,children:e.jsx(ut,{children:e.jsxs(ht,{children:[e.jsx(j,{path:"/",element:e.jsx(X,{})}),e.jsx(j,{path:"/landing",element:e.jsx(X,{})}),e.jsx(j,{path:"/app/sign-in",element:e.jsx(Z,{})}),e.jsx(j,{path:"/app/sign-up",element:e.jsx(Z,{})}),e.jsx(j,{path:"/app/dashboard",element:e.jsx(C,{fallbackMessage:"Dashboard failed to load. Please check your connection and try again.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx($t,{})})})})}),e.jsx(j,{path:"/app/working-capital",element:e.jsx(C,{fallbackMessage:"Working Capital module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Vt,{})})})})}),e.jsx(j,{path:"/app/forecasting",element:e.jsx(C,{fallbackMessage:"Forecasting module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Wt,{})})})})}),e.jsx(j,{path:"/app/production",element:e.jsx(C,{fallbackMessage:"Production module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Bt,{})})})})}),e.jsx(j,{path:"/app/analytics",element:e.jsx(C,{fallbackMessage:"Analytics module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Qt,{})})})})}),e.jsx(j,{path:"/app/inventory",element:e.jsx(C,{fallbackMessage:"Inventory module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Ht,{})})})})}),e.jsx(j,{path:"/app/quality",element:e.jsx(C,{fallbackMessage:"Quality Control module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Yt,{})})})})}),e.jsx(j,{path:"/app/data-import",element:e.jsx(C,{fallbackMessage:"Data Import module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Jt,{})})})})}),e.jsx(j,{path:"/app/admin",element:e.jsx(C,{fallbackMessage:"Admin Panel failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Xt,{})})})})}),e.jsx(j,{path:"/app/what-if",element:e.jsx(C,{fallbackMessage:"What-If Analysis module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(Zt,{})})})})}),e.jsx(j,{path:"/app/scenarios",element:e.jsx(C,{fallbackMessage:"Scenario Planner module failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(ea,{})})})})}),e.jsx(j,{path:"/app/assistant",element:e.jsx(C,{fallbackMessage:"AI Assistant failed to load.",children:e.jsx(R,{children:e.jsx(c.Suspense,{fallback:e.jsx(E,{}),children:e.jsx(ta,{})})})})}),e.jsx(j,{path:"/app/*",element:e.jsx(V,{to:"/app/dashboard",replace:!0})}),e.jsx(j,{path:"*",element:e.jsx(V,{to:"/",replace:!0})})]})})})}),e.jsx(Gt,{})]}));window.addEventListener("error",n=>{console.error("[Global Error]",n.error),le("JavaScript Error",n.error.message)});window.addEventListener("unhandledrejection",n=>{console.error("[Unhandled Promise Rejection]",n.reason),le("Promise Rejection",n.reason)});function le(n,t){const a=document.getElementById("root");a&&!a.innerHTML.includes("Configuration Error")&&(a.innerHTML=`
      <div style="display: flex; min-height: 100vh; align-items: center; justify-content: center; background: #0f172a; color: #e2e8f0; font-family: system-ui;">
        <div style="text-align: center; max-width: 600px; padding: 2rem;">
          <h1 style="color: #ef4444; margin-bottom: 1rem;">${n}</h1>
          <p style="margin-bottom: 1rem;">${t}</p>
          <p style="font-size: 0.875rem; color: #94a3b8;">Check browser console for details.</p>
          <button onclick="window.location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #3b82f6; color: white; border: none; border-radius: 0.5rem; cursor: pointer;">Reload Page</button>
        </div>
      </div>
    `)}const oa=!0;console.log("[Environment] Development Mode:",oa);console.log("[Environment] Node Environment:",void 0);console.log("[Authentication] Using Development Mode - Authentication Bypassed");rt.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(ia,{})}));export{A as B,Rt as C,P as _,pa as a,ga as b,xa as c,M as d,kt as e,Pt as f,_t as g,Mt as h,U as i,ma as u};
