import{ag as e,bR as t,at as a,j as r,q as s,ba as i,c3 as n,as as o}from"./chunk-DPRQcyFe.js";import{W as l,a as d,b as c,M as x,D as g}from"./chunk-CNx-Pgws.js";import"./chunk-BfmujUnw.js";import"./chunk-B5P-aYZ_.js";import"./chunk-BS6JJXKa.js";import"./chunk-DC45jon4.js";import"./chunk-pU9d5F3v.js";import"./chunk-C7vLRJrk.js";import"./chunk-Dozjk7Op.js";const h=()=>{const{getToken:h}=e(),m=t(),{data:p,isLoading:b,error:u,refetch:y,isRefetching:v}=a({queryKey:["working-capital"],queryFn:async()=>{const e=await h(),t=await fetch("https://your-production-domain.up.railway.app/api/api/financial/working-capital",{headers:{Authorization:e?`Bearer ${e}`:"","Content-Type":"application/json"}});if(!t.ok){if(404===t.status||500===t.status)return j();throw new Error(`Failed to fetch working capital data: ${t.statusText}`)}return t.json()},refetchInterval:6e4,retry:2,retryDelay:1e3}),j=()=>({summary:{workingCapital:789200,currentAssets:2345600,currentLiabilities:1556400,cashConversionCycle:45,operatingCashFlow:423500,freeCashFlow:312400,liquidityRatio:1.51,quickRatio:1.18},components:{cash:456e3,accountsReceivable:892300,inventory:997300,accountsPayable:645200,shortTermDebt:32e4,otherCurrentLiabilities:591200},trends:{labels:["Jan","Feb","Mar","Apr","May","Jun"],workingCapital:[72e4,745e3,76e4,775e3,78e4,789200],currentRatio:[1.42,1.44,1.47,1.49,1.5,1.51],cashFlow:[38e4,395e3,41e4,415e3,42e4,423500]},receivables:{total:892300,current:65e4,overdue30:15e4,overdue60:75e3,overdue90:17300,dso:42},payables:{total:645200,current:52e4,due30:95e3,due60:30200,dpo:38},inventory:{rawMaterials:35e4,wip:247300,finishedGoods:4e5,turnoverRatio:8.5,dio:43},cashManagement:{operatingActivities:423500,investingActivities:-111100,financingActivities:-85e3,netChange:227400,beginningCash:228600,endingCash:456e3},forecast:{nextMonth:{workingCapital:805e3,change:15800,percentChange:2},nextQuarter:{workingCapital:845e3,change:55800,percentChange:7.1}}});if(b&&!p)return r.jsx(l,{title:"Working Capital Management",height:"400px"});if(u&&!p)return r.jsx(d,{error:u,onRetry:y,title:"Working Capital Management"});const k=p||j(),C={labels:["Cash","A/R","Inventory","A/P","Short-Term Debt","Other Liabilities"],datasets:[{data:[k.components?.cash||0,k.components?.accountsReceivable||0,k.components?.inventory||0,k.components?.accountsPayable||0,k.components?.shortTermDebt||0,k.components?.otherCurrentLiabilities||0],backgroundColor:["rgba(16, 185, 129, 0.8)","rgba(59, 130, 246, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)","rgba(168, 85, 247, 0.8)","rgba(107, 114, 128, 0.8)"],borderColor:["rgb(16, 185, 129)","rgb(59, 130, 246)","rgb(245, 158, 11)","rgb(239, 68, 68)","rgb(168, 85, 247)","rgb(107, 114, 128)"],borderWidth:1}]},N={labels:k.trends?.labels||[],datasets:[{label:"Working Capital",data:k.trends?.workingCapital||[],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,yAxisID:"y"},{label:"Operating Cash Flow",data:k.trends?.cashFlow||[],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4,yAxisID:"y"}]},f=e=>e>=1e6?`$${(e/1e6).toFixed(2)}M`:`$${(e/1e3).toFixed(0)}k`,w=[{key:"aging",label:"Aging"},{key:"amount",label:"Amount",render:e=>f(e)},{key:"percentage",label:"%",render:e=>`${e}%`}],R=[{aging:"Current",amount:k.receivables?.current||0,percentage:((k.receivables?.current||0)/(k.receivables?.total||1)*100).toFixed(1)},{aging:"30 Days",amount:k.receivables?.overdue30||0,percentage:((k.receivables?.overdue30||0)/(k.receivables?.total||1)*100).toFixed(1)},{aging:"60 Days",amount:k.receivables?.overdue60||0,percentage:((k.receivables?.overdue60||0)/(k.receivables?.total||1)*100).toFixed(1)},{aging:"90+ Days",amount:k.receivables?.overdue90||0,percentage:((k.receivables?.overdue90||0)/(k.receivables?.total||1)*100).toFixed(1)}];return r.jsxs(c,{title:"Working Capital Management",onRefresh:()=>{m.invalidateQueries(["working-capital"]),y()},isRefreshing:v,className:"col-span-2",children:[r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[r.jsx(x,{label:"Working Capital",value:f(k.summary?.workingCapital||0),trend:{direction:k.summary?.workingCapital>75e4?"up":"down",value:3.5},icon:s}),r.jsx(x,{label:"Current Ratio",value:k.summary?.liquidityRatio||0,trend:{direction:k.summary?.liquidityRatio>1.5?"up":"down",value:2.1}}),r.jsx(x,{label:"Cash Conversion",value:k.summary?.cashConversionCycle||0,unit:"days",icon:i}),r.jsx(x,{label:"Operating Cash",value:f(k.summary?.operatingCashFlow||0),trend:{direction:"up",value:5.2}})]}),r.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Cash Conversion Cycle Components"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:k.receivables?.dso||0}),r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Days Sales Outstanding"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:k.inventory?.dio||0}),r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Days Inventory Outstanding"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:k.payables?.dpo||0}),r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Days Payables Outstanding"})]})]}),r.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 text-center",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Net Cash Conversion Cycle"}),r.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[(k.receivables?.dso||0)+(k.inventory?.dio||0)-(k.payables?.dpo||0)," days"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Working Capital Components"}),r.jsx("div",{style:{height:"250px"},children:r.jsx(n,{data:C,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{boxWidth:12}}}}})})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Working Capital Trend"}),r.jsx("div",{style:{height:"250px"},children:r.jsx(o,{data:N,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"}},scales:{y:{type:"linear",display:!0,position:"left",ticks:{callback:function(e){return"$"+(e/1e3).toFixed(0)+"k"}}}}}})})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Accounts Receivable Aging"}),r.jsx(g,{columns:w,data:R}),r.jsxs("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["Total Receivables: ",f(k.receivables?.total||0)]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Inventory Analysis"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Raw Materials"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f(k.inventory?.rawMaterials||0)})]}),r.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Work in Progress"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f(k.inventory?.wip||0)})]}),r.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Finished Goods"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f(k.inventory?.finishedGoods||0)})]})]}),r.jsxs("div",{className:"mt-2 flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[r.jsxs("span",{children:["Turnover Ratio: ",k.inventory?.turnoverRatio||0,"x"]}),r.jsxs("span",{children:["Total: ",f((k.inventory?.rawMaterials||0)+(k.inventory?.wip||0)+(k.inventory?.finishedGoods||0))]})]})]}),r.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Working Capital Forecast"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Next Month"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f(k.forecast?.nextMonth?.workingCapital||0)}),r.jsxs("p",{className:"text-sm "+(k.forecast?.nextMonth?.percentChange>0?"text-green-600":"text-red-600"),children:[k.forecast?.nextMonth?.percentChange>0?"+":"",k.forecast?.nextMonth?.percentChange,"%"]})]}),r.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded",children:[r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Next Quarter"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:f(k.forecast?.nextQuarter?.workingCapital||0)}),r.jsxs("p",{className:"text-sm "+(k.forecast?.nextQuarter?.percentChange>0?"text-green-600":"text-red-600"),children:[k.forecast?.nextQuarter?.percentChange>0?"+":"",k.forecast?.nextQuarter?.percentChange,"%"]})]})]})]}),r.jsxs("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:["Last updated: ",(new Date).toLocaleTimeString()]})]})};export{h as default};
