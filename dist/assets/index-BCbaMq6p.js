import{r as D,e as m,bE as ne,O as se,K as re,aW as oe,H as ce,J as le,aM as ue,bF as de,bG as me,aD as he,n as pe}from"./1-react-core-C8GbWHu9.js";import{bW as B,c7 as ge,b0 as ye,c8 as x,c9 as h,ca as d,cb as L,cc as fe,cd as Y,ce as ve,bX as R}from"./5-vendor-misc-C5RqYkRe.js";import"./app-core-efHrKPlz.js";import{p as Se,e as we,d as be}from"./4-state-routing-DMZL8WVV.js";import"./2-clerk-auth-Dkwi32AD.js";import"./index-BCbaMq6p.js";import"./app-features-ClEPl2iF.js";import"./3-ui-libs-ZWsMBXX9.js";import"./app-ui-BFXUVz2N.js";import"./app-auth-CyHI18Al.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();var Xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ze(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function et(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function a(){var i=!1;try{i=this instanceof a}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(a){var i=Object.getOwnPropertyDescriptor(s,a);Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:function(){return s[a]}})}),t}const De="modulepreload",Ce=function(s){return"/"+s},J={},tt=function(e,t,a){let i=Promise.resolve();if(t&&t.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),o=r?.nonce||r?.getAttribute("nonce");i=c(t.map(l=>{if(l=Ce(l),l in J)return;J[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const v=document.createElement("link");if(v.rel=u?"stylesheet":De,u||(v.as="script"),v.crossOrigin="",v.href=l,o&&v.setAttribute("nonce",o),document.head.appendChild(v),u)return new Promise((S,b)=>{v.addEventListener("load",S),v.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return i.then(r=>{for(const o of r||[])o.status==="rejected"&&n(o.reason);return e().catch(n)})},at=({onGetStarted:s})=>{const[e,t]=D.useState(!1),a=[{icon:se,title:"Real-time Analytics",description:"Monitor KPIs and metrics with live dashboard updates"},{icon:re,title:"Working Capital",description:"Optimize cash flow and financial operations"},{icon:oe,title:"AI-Powered Insights",description:"Machine learning forecasting and predictions"},{icon:ce,title:"Production Tracking",description:"End-to-end manufacturing visibility"},{icon:le,title:"Inventory Management",description:"Smart stock control and optimization"},{icon:ue,title:"MCP Integration",description:"Enterprise AI orchestration system"}],i=["99.99% Uptime SLA","Bank-grade Security","ISO 27001 Certified","24/7 Support","GDPR Compliant","SOC 2 Type II"];return m.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900",children:[m.jsxDEV("header",{className:"border-b border-gray-800 bg-gray-900/50 backdrop-blur-xl",children:m.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m.jsxDEV("div",{className:"flex justify-between items-center h-16",children:[m.jsxDEV("div",{className:"flex items-center space-x-3",children:[m.jsxDEV("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg flex items-center justify-center",children:m.jsxDEV("span",{className:"text-white font-bold text-xl",children:"S"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:67,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:66,columnNumber:15},void 0),m.jsxDEV("span",{className:"text-white font-semibold text-xl",children:"Sentia Manufacturing"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:69,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:65,columnNumber:13},void 0),m.jsxDEV("div",{className:"text-blue-400 text-sm font-mono",children:"Enterprise Platform v1.0.5"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:71,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:64,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:63,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:62,columnNumber:7},void 0),m.jsxDEV("main",{className:"relative",children:[m.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-16",children:m.jsxDEV("div",{className:"text-center",children:[m.jsxDEV(B.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-5xl md:text-6xl font-bold text-white mb-6",children:["Manufacturing Intelligence",m.jsxDEV("span",{className:"block text-3xl md:text-4xl text-blue-400 mt-2",children:"Powered by AI"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:89,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:82,columnNumber:13},void 0),m.jsxDEV(B.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"text-xl text-gray-300 mb-12 max-w-3xl mx-auto",children:"Enterprise-grade manufacturing operations platform with real-time analytics, AI-powered insights, and comprehensive business intelligence."},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:94,columnNumber:13},void 0),m.jsxDEV(B.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.4},children:m.jsxDEV("button",{onClick:s,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),className:"group relative inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-500 text-white font-semibold text-lg rounded-xl shadow-2xl hover:shadow-blue-500/25 transition-all duration-300 transform hover:scale-105",children:[m.jsxDEV("span",{className:"mr-2",children:"Enter Dashboard"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:116,columnNumber:17},void 0),m.jsxDEV(B.div,{animate:{x:e?5:0},transition:{duration:.2},children:m.jsxDEV(ne,{className:"w-5 h-5"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:121,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:117,columnNumber:17},void 0),m.jsxDEV("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-600 to-blue-500 opacity-0 group-hover:opacity-100 blur-xl transition-opacity duration-300"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:123,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:110,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:105,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:81,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:80,columnNumber:9},void 0),m.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:m.jsxDEV(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map((n,r)=>m.jsxDEV(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.7+r*.1},whileHover:{scale:1.02,transition:{duration:.2}},className:"bg-gray-800/50 backdrop-blur border border-gray-700 rounded-xl p-6 hover:border-blue-500/50 transition-colors duration-300",children:[m.jsxDEV(n.icon,{className:"w-12 h-12 text-blue-400 mb-4"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:146,columnNumber:17},void 0),m.jsxDEV("h3",{className:"text-xl font-semibold text-white mb-2",children:n.title},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:147,columnNumber:17},void 0),m.jsxDEV("p",{className:"text-gray-400",children:n.description},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:150,columnNumber:17},void 0)]},r,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:138,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:131,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:130,columnNumber:9},void 0),m.jsxDEV(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:1.2},className:"bg-gray-800/30 backdrop-blur border-y border-gray-700",children:m.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:m.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:i.map((n,r)=>m.jsxDEV("div",{className:"flex items-center justify-center space-x-2",children:[m.jsxDEV(de,{className:"w-5 h-5 text-green-400"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:169,columnNumber:19},void 0),m.jsxDEV("span",{className:"text-gray-300 text-sm",children:n},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:170,columnNumber:19},void 0)]},r,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:168,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:166,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:165,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:159,columnNumber:9},void 0),m.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:m.jsxDEV(B.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:1.4},className:"grid grid-cols-1 md:grid-cols-4 gap-8 text-center",children:[m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-4xl font-bold text-blue-400",children:"269+"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:186,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-gray-400 mt-2",children:"Components"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:187,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:185,columnNumber:13},void 0),m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-4xl font-bold text-green-400",children:"138+"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:190,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-gray-400 mt-2",children:"API Endpoints"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:191,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:189,columnNumber:13},void 0),m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-4xl font-bold text-purple-400",children:"92%"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:194,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-gray-400 mt-2",children:"AI Accuracy"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:195,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:193,columnNumber:13},void 0),m.jsxDEV("div",{children:[m.jsxDEV("div",{className:"text-4xl font-bold text-orange-400",children:"99.99%"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:198,columnNumber:15},void 0),m.jsxDEV("div",{className:"text-gray-400 mt-2",children:"Uptime SLA"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:199,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:197,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:179,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:178,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:79,columnNumber:7},void 0),m.jsxDEV("footer",{className:"border-t border-gray-800 bg-gray-900/50 backdrop-blur-xl",children:m.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:m.jsxDEV("div",{className:"flex justify-between items-center",children:[m.jsxDEV("div",{className:"text-gray-400 text-sm",children:"© 2025 The Social Drink Company. All rights reserved."},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:209,columnNumber:13},void 0),m.jsxDEV("div",{className:"flex space-x-6 text-sm",children:[m.jsxDEV("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:"Privacy"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:213,columnNumber:15},void 0),m.jsxDEV("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:"Terms"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:214,columnNumber:15},void 0),m.jsxDEV("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors",children:"Support"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:215,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:212,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:208,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:207,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:206,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/LandingPage.jsx",lineNumber:60,columnNumber:5},void 0)};function it(...s){return ge(ye(s))}const nt={log:(...s)=>{},info:(...s)=>{},warn:(...s)=>{},error:(...s)=>{},debug:(...s)=>{},table:s=>{},time:s=>{},timeEnd:s=>{},group:s=>{},groupCollapsed:s=>{},groupEnd:()=>{}},Ae={CFO_PRESET:!1,GLOBAL_TABS:!1,BOARD_EXPORT:!1,TRUST_BADGES:!1,BENCHMARKS:!1,VIRTUALIZATION:!0,MEMOIZATION:!0,CODE_SPLITTING:!0,A11Y_ENHANCEMENTS:!0,KEYBOARD_NAVIGATION:!0,SCREEN_READER:!0},_e=parseInt("60",10),st=()=>{const s=D.useMemo(()=>Ae,[]),e=n=>s[n]===!0,t=n=>n.every(r=>s[r]===!0);return{flags:s,isEnabled:e,areEnabled:t,getEnabledFeatures:n=>n.filter(r=>s[r]===!0),groups:{cfoFeatures:["CFO_PRESET","BOARD_EXPORT","BENCHMARKS"],globalFeatures:["GLOBAL_TABS","TRUST_BADGES"],performanceFeatures:["VIRTUALIZATION","MEMOIZATION","CODE_SPLITTING"],accessibilityFeatures:["A11Y_ENHANCEMENTS","KEYBOARD_NAVIGATION","SCREEN_READER"]},shareLinkTTL:_e,get hasCFOPreset(){return s.CFO_PRESET},get hasGlobalTabs(){return s.GLOBAL_TABS},get hasBoardExport(){return s.BOARD_EXPORT},get hasTrustBadges(){return s.TRUST_BADGES},get hasBenchmarks(){return s.BENCHMARKS},get hasVirtualization(){return s.VIRTUALIZATION},get hasMemoization(){return s.MEMOIZATION},get hasCodeSplitting(){return s.CODE_SPLITTING},get hasA11yEnhancements(){return s.A11Y_ENHANCEMENTS},get hasKeyboardNavigation(){return s.KEYBOARD_NAVIGATION},get hasScreenReader(){return s.SCREEN_READER},get hasCFOFeatures(){return t(["CFO_PRESET","BOARD_EXPORT"])},get hasGlobalFeatures(){return t(["GLOBAL_TABS","TRUST_BADGES"])},get hasAdvancedFeatures(){return t(["CFO_PRESET","GLOBAL_TABS","BOARD_EXPORT"])}}},V={cfo_global:{lg:[{i:"cfo-kpi-strip",x:0,y:0,w:12,h:2,minH:2,maxH:2},{i:"forecast-consolidated",x:0,y:2,w:12,h:5,minH:4},{i:"stock-optimization-heatmap",x:0,y:7,w:6,h:6,minH:4},{i:"working-capital-runway",x:6,y:7,w:6,h:6,minH:4}],md:[{i:"cfo-kpi-strip",x:0,y:0,w:8,h:2,minH:2,maxH:2},{i:"forecast-consolidated",x:0,y:2,w:8,h:6,minH:4},{i:"stock-optimization-heatmap",x:0,y:8,w:8,h:6,minH:4},{i:"working-capital-runway",x:0,y:14,w:8,h:6,minH:4}],sm:[{i:"cfo-kpi-strip",x:0,y:0,w:4,h:3,minH:3},{i:"forecast-consolidated",x:0,y:3,w:4,h:8,minH:6},{i:"stock-optimization-heatmap",x:0,y:11,w:4,h:8,minH:6},{i:"working-capital-runway",x:0,y:19,w:4,h:8,minH:6}]},admin:{lg:[{i:"kpi-strip",x:0,y:0,w:12,h:2,minH:2,maxH:2},{i:"working-capital",x:0,y:2,w:4,h:6,minH:4},{i:"demand-forecast",x:4,y:2,w:4,h:6,minH:4},{i:"stock-status",x:8,y:2,w:4,h:6,minH:4},{i:"capacity-util",x:0,y:8,w:4,h:4,minH:3},{i:"recent-jobs",x:4,y:8,w:4,h:4,minH:3},{i:"system-health",x:8,y:8,w:4,h:4,minH:3}],md:[{i:"kpi-strip",x:0,y:0,w:8,h:2,minH:2,maxH:2},{i:"working-capital",x:0,y:2,w:4,h:6,minH:4},{i:"demand-forecast",x:4,y:2,w:4,h:6,minH:4},{i:"stock-status",x:0,y:8,w:4,h:6,minH:4},{i:"capacity-util",x:4,y:8,w:4,h:4,minH:3},{i:"recent-jobs",x:0,y:14,w:4,h:4,minH:3},{i:"system-health",x:4,y:12,w:4,h:4,minH:3}],sm:[{i:"kpi-strip",x:0,y:0,w:4,h:3,minH:3},{i:"working-capital",x:0,y:3,w:4,h:8,minH:6},{i:"demand-forecast",x:0,y:11,w:4,h:8,minH:6},{i:"stock-status",x:0,y:19,w:4,h:8,minH:6},{i:"capacity-util",x:0,y:27,w:4,h:6,minH:4},{i:"recent-jobs",x:0,y:33,w:4,h:6,minH:4},{i:"system-health",x:0,y:39,w:4,h:6,minH:4}]},manager:{lg:[{i:"kpi-strip",x:0,y:0,w:12,h:2,minH:2,maxH:2},{i:"demand-forecast",x:0,y:2,w:8,h:6,minH:4},{i:"control-panel",x:8,y:2,w:4,h:6,minH:4},{i:"stock-status",x:0,y:8,w:6,h:5,minH:4},{i:"capacity-util",x:6,y:8,w:6,h:5,minH:4}],md:[{i:"kpi-strip",x:0,y:0,w:8,h:2,minH:2,maxH:2},{i:"demand-forecast",x:0,y:2,w:8,h:6,minH:4},{i:"control-panel",x:0,y:8,w:4,h:6,minH:4},{i:"stock-status",x:4,y:8,w:4,h:6,minH:4},{i:"capacity-util",x:0,y:14,w:8,h:4,minH:3}],sm:[{i:"kpi-strip",x:0,y:0,w:4,h:3,minH:3},{i:"demand-forecast",x:0,y:3,w:4,h:8,minH:6},{i:"control-panel",x:0,y:11,w:4,h:6,minH:4},{i:"stock-status",x:0,y:17,w:4,h:8,minH:6},{i:"capacity-util",x:0,y:25,w:4,h:6,minH:4}]},operator:{lg:[{i:"kpi-strip",x:0,y:0,w:12,h:2,minH:2,maxH:2},{i:"stock-status",x:0,y:2,w:6,h:6,minH:4},{i:"capacity-util",x:6,y:2,w:6,h:6,minH:4},{i:"recent-jobs",x:0,y:8,w:12,h:4,minH:3}],md:[{i:"kpi-strip",x:0,y:0,w:8,h:2,minH:2,maxH:2},{i:"stock-status",x:0,y:2,w:8,h:6,minH:4},{i:"capacity-util",x:0,y:8,w:8,h:6,minH:4},{i:"recent-jobs",x:0,y:14,w:8,h:4,minH:3}],sm:[{i:"kpi-strip",x:0,y:0,w:4,h:3,minH:3},{i:"stock-status",x:0,y:3,w:4,h:8,minH:6},{i:"capacity-util",x:0,y:11,w:4,h:6,minH:4},{i:"recent-jobs",x:0,y:17,w:4,h:6,minH:4}]},viewer:{lg:[{i:"kpi-strip",x:0,y:0,w:12,h:2,minH:2,maxH:2},{i:"demand-forecast",x:0,y:2,w:6,h:8,minH:6},{i:"stock-status",x:6,y:2,w:6,h:8,minH:6}],md:[{i:"kpi-strip",x:0,y:0,w:8,h:2,minH:2,maxH:2},{i:"demand-forecast",x:0,y:2,w:8,h:8,minH:6},{i:"stock-status",x:0,y:10,w:8,h:8,minH:6}],sm:[{i:"kpi-strip",x:0,y:0,w:4,h:3,minH:3},{i:"demand-forecast",x:0,y:3,w:4,h:8,minH:6},{i:"stock-status",x:0,y:11,w:4,h:8,minH:6}]}},q={cfo_global:["cfo-kpi-strip","forecast-consolidated","stock-optimization-heatmap","working-capital-runway"],admin:["kpi-strip","working-capital","demand-forecast","stock-status","capacity-util","recent-jobs","system-health","control-panel"],manager:["kpi-strip","demand-forecast","stock-status","capacity-util","recent-jobs","control-panel"],operator:["kpi-strip","stock-status","capacity-util","recent-jobs"],viewer:["kpi-strip","demand-forecast","stock-status"]},rt=me(Se((s,e)=>({currentLayout:{},savedLayouts:{},currentBreakpoint:"lg",isEditing:!1,theme:"light",sidebarCollapsed:!1,gridSnap:!0,visibleWidgets:[],widgetSettings:{},setLayout:(t,a)=>s(i=>({currentLayout:{...i.currentLayout,[t]:a}})),saveLayout:(t,a,i)=>s(n=>({savedLayouts:{...n.savedLayouts,[`${i}_${t}`]:{name:t,role:i,layout:a,createdAt:new Date().toISOString(),isDefault:!1}}})),loadLayout:t=>{const i=e().savedLayouts[t];i&&s({currentLayout:i.layout})},deleteLayout:t=>s(a=>{const i={...a.savedLayouts};return delete i[t],{savedLayouts:i}}),setBreakpoint:t=>s({currentBreakpoint:t}),setEditing:t=>s({isEditing:t}),toggleTheme:()=>s(t=>({theme:t.theme==="light"?"dark":"light"})),setTheme:t=>s({theme:t}),toggleSidebar:()=>s(t=>({sidebarCollapsed:!t.sidebarCollapsed})),setSidebarCollapsed:t=>s({sidebarCollapsed:t}),toggleGridSnap:()=>s(t=>({gridSnap:!t.gridSnap})),initializeLayout:t=>{e();const a=V[t]||V.viewer,i=q[t]||q.viewer;s({currentLayout:a,visibleWidgets:i,widgetSettings:i.reduce((n,r)=>({...n,[r]:{visible:!0,minimized:!1}}),{})})},updateWidgetSettings:(t,a)=>s(i=>({widgetSettings:{...i.widgetSettings,[t]:{...i.widgetSettings[t],...a}}})),toggleWidgetVisibility:t=>s(a=>({widgetSettings:{...a.widgetSettings,[t]:{...a.widgetSettings[t],visible:!a.widgetSettings[t]?.visible}}})),switchToCFOPreset:()=>{const t=V.cfo_global,a=q.cfo_global;s({currentLayout:t,visibleWidgets:a,widgetSettings:a.reduce((i,n)=>({...i,[n]:{visible:!0,minimized:!1}}),{}),isEditing:!1})},isCFOPreset:()=>{const t=e(),a=q.cfo_global;return t.visibleWidgets.length===a.length&&t.visibleWidgets.every(i=>a.includes(i))},resetLayout:t=>{const a=V[t]||V.viewer,i=q[t]||q.viewer;s({currentLayout:a,visibleWidgets:i,widgetSettings:i.reduce((n,r)=>({...n,[r]:{visible:!0,minimized:!1}}),{}),isEditing:!1})},shortcutsEnabled:!0,toggleShortcuts:()=>s(t=>({shortcutsEnabled:!t.shortcutsEnabled})),generateShareableLayout:()=>{const t=e();return{layout:t.currentLayout,theme:t.theme,widgetSettings:t.widgetSettings,timestamp:new Date().toISOString()}},importLayout:t=>{s({currentLayout:t.layout,theme:t.theme||"light",widgetSettings:t.widgetSettings||{}})}}),{name:"sentia-dashboard-layout",storage:we(()=>localStorage),partialize:s=>({savedLayouts:s.savedLayouts,theme:s.theme,sidebarCollapsed:s.sidebarCollapsed,gridSnap:s.gridSnap,widgetSettings:s.widgetSettings,shortcutsEnabled:s.shortcutsEnabled})})),ee={STOCK_LEVELS:1e3*60*10},te={MEDIUM:1e3*60*30},E={kpi:{metrics:(s,e)=>["kpi-metrics",{timeRange:s,filters:e}],alerts:()=>["kpi-alerts"]},kpiMetrics:(s,e)=>["kpi-metrics",{timeRange:s,filters:e}],systemHealth:()=>["system-health"],forecasts:()=>["forecasts"],forecast:s=>["forecast",s],forecastJob:s=>["forecast-job",s],forecastSeries:(s,e)=>["forecast-series",s,e],forecastAccuracy:(s,e)=>["forecast-accuracy",s,e],stockOptimization:()=>["stock-optimization"],stockOptimizationJob:s=>["stock-optimization-job",s],stockPlans:s=>["stock-plans",s],stockLevels:s=>["stock-levels",s],reorderSuggestions:s=>["reorder-suggestions",s],workingCapital:{diagnostics:()=>["working-capital","diagnostics"],projections:(s,e)=>["working-capital","projections",{timeRange:s,scenario:e}],kpis:()=>["working-capital","kpis"],policies:s=>["working-capital","policies",s],job:s=>["working-capital","job",s]},workingCapitalJob:s=>["working-capital-job",s],workingCapitalProjections:s=>["wc-projections",s],workingCapitalKpis:s=>["wc-kpis",s],workingCapitalPolicies:s=>["wc-policies",s],sales:{multiChannel:s=>["sales","multi-channel",{timeRange:s}],amazon:(s,e)=>["sales","amazon",{timeRange:s,filters:e}],shopify:(s,e,t)=>["sales","shopify",s,{timeRange:e,filters:t}]},capacityUtilization:(s,e)=>["capacity-utilization",s,e],productionJobs:(s,e)=>["production-jobs",s,e],userProfile:s=>["user-profile",s],userPermissions:s=>["user-permissions",s],dashboardLayouts:s=>["dashboard-layouts",s],systemConfig:()=>["system-config"],importJobs:(s,e)=>["import-jobs",s,e],importJob:s=>["import-job",s],validationRules:s=>["validation-rules",s]},Ie={retry:(s,e)=>e?.response?.status>=400&&e?.response?.status<500?e?.response?.status===408||e?.response?.status===429:s<3,retryDelay:s=>Math.min(1e3*2**s,3e4),refetchOnWindowFocus:!1,refetchOnMount:!0,refetchOnReconnect:!0},U=new be({defaultOptions:{queries:{...Ie,staleTime:ee.STOCK_LEVELS,cacheTime:te.MEDIUM,refetchInterval:!1,refetchIntervalInBackground:!1},mutations:{retry:1,retryDelay:1e3,onError:(s,e,t)=>{}}}}),ot={operational:{staleTime:ee.STOCK_LEVELS,cacheTime:te.MEDIUM,refetchInterval:1e3*60*5,refetchIntervalInBackground:!1}},Ee={invalidateQueries:s=>U.invalidateQueries({queryKey:[s]}),clearCache:()=>U.clear(),removeQuery:s=>U.removeQueries({queryKey:s}),prefetchQuery:(s,e,t={})=>U.prefetchQuery({queryKey:s,queryFn:e,...t}),setQueryData:(s,e)=>U.setQueryData(s,e),getQueryData:s=>U.getQueryData(s),updateQueryData:(s,e)=>U.setQueryData(s,t=>e(t))};window.queryClient=U,window.queryKeys=E,window.cacheUtils=Ee;const X={"job.forecast.started":(s,e)=>{e.setQueryData(E.forecastJob(s.jobId),{...s,status:"running",startedAt:new Date().toISOString()})},"job.forecast.progress":(s,e)=>{e.setQueryData(E.forecastJob(s.jobId),t=>({...t,...s,updatedAt:new Date().toISOString()}))},"job.forecast.completed":(s,e)=>{e.setQueryData(E.forecastJob(s.jobId),{...s,status:"completed",completedAt:new Date().toISOString()}),e.invalidateQueries({queryKey:["forecasts"]}),e.invalidateQueries({queryKey:["forecast-series"]})},"job.forecast.failed":(s,e)=>{e.setQueryData(E.forecastJob(s.jobId),{...s,status:"failed",failedAt:new Date().toISOString()})},"job.stock.started":(s,e)=>{e.setQueryData(E.stockOptimizationJob(s.jobId),{...s,status:"running",startedAt:new Date().toISOString()})},"job.stock.completed":(s,e)=>{e.setQueryData(E.stockOptimizationJob(s.jobId),{...s,status:"completed",completedAt:new Date().toISOString()}),e.invalidateQueries({queryKey:["stock-optimization"]}),e.invalidateQueries({queryKey:["stock-levels"]}),e.invalidateQueries({queryKey:["reorder-suggestions"]})},"job.stock.failed":(s,e)=>{e.setQueryData(E.stockOptimizationJob(s.jobId),{...s,status:"failed",failedAt:new Date().toISOString()})},"job.workingcapital.completed":(s,e)=>{e.setQueryData(E.workingCapitalJob(s.jobId),{...s,status:"completed",completedAt:new Date().toISOString()}),e.invalidateQueries({queryKey:["working-capital"]}),e.invalidateQueries({queryKey:["wc-projections"]}),e.invalidateQueries({queryKey:["wc-kpis"]})},"metrics.kpi.updated":(s,e)=>{e.setQueryData(E.kpiMetrics(s.timeRange,s.filters),t=>({...t,...s.metrics,updatedAt:new Date().toISOString()}))},"metrics.capacity.updated":(s,e)=>{e.setQueryData(E.capacityUtilization(s.facilities,s.timeRange),t=>({...t,...s.utilization,updatedAt:new Date().toISOString()}))},"metrics.system.health":(s,e)=>{e.setQueryData(E.systemHealth(),{...s,timestamp:new Date().toISOString()})},"alert.stock.low":(s,e)=>{e.invalidateQueries({queryKey:["stock-levels"]}),e.invalidateQueries({queryKey:["reorder-suggestions"]})},"alert.stock.critical":(s,e)=>{e.invalidateQueries({queryKey:["stock-levels"]}),e.invalidateQueries({queryKey:["reorder-suggestions"]})},"alert.workingcapital.breach":(s,e)=>{e.invalidateQueries({queryKey:["wc-projections"]}),e.invalidateQueries({queryKey:["wc-kpis"]})},"job.import.started":(s,e)=>{e.setQueryData(E.importJob(s.jobId),{...s,status:"running",startedAt:new Date().toISOString()})},"job.import.completed":(s,e)=>{e.setQueryData(E.importJob(s.jobId),{...s,status:"completed",completedAt:new Date().toISOString()}),e.invalidateQueries({queryKey:["import-jobs"]})},"job.import.failed":(s,e)=>{e.setQueryData(E.importJob(s.jobId),{...s,status:"failed",failedAt:new Date().toISOString()})},"system.maintenance.start":(s,e)=>{e.setQueryData(E.systemHealth(),t=>({...t,maintenance:!0,maintenanceMessage:s.message}))},"system.maintenance.end":(s,e)=>{e.setQueryData(E.systemHealth(),t=>({...t,maintenance:!1,maintenanceMessage:null}))}},ct=({endpoint:s="/api/events",enabled:e=!0,reconnectDelay:t=3e3,maxReconnectAttempts:a=10,onConnect:i=null,onDisconnect:n=null,onError:r=null,onMessage:o=null}={})=>{const[c,l]=D.useState({connected:!1,connecting:!1,error:null,reconnectAttempts:0}),u=D.useRef(null),f=D.useRef(null),v=he(),[S,b]=D.useState([]),T=D.useCallback(_=>{b(g=>[{type:_.type,data:_.data,timestamp:new Date().toISOString()},...g.slice(0,99)])},[]),k=D.useCallback(_=>{try{const g=JSON.parse(_.data);T({type:_.type,data:g}),o&&o(_.type,g);const w=X[_.type];w&&w(g,v),window.dispatchEvent(new CustomEvent("sse-message",{detail:{type:_.type,data:g}}))}catch{}},[o,v,T]),M=D.useCallback(()=>{if(!(!e||u.current)){l(_=>({..._,connecting:!0,error:null}));try{const _=new EventSource(s);u.current=_,_.onopen=()=>{l({connected:!0,connecting:!1,error:null,reconnectAttempts:0}),i&&i(),f.current&&(clearTimeout(f.current),f.current=null)},_.onerror=g=>{l(w=>({connected:!1,connecting:!1,error:g,reconnectAttempts:w.reconnectAttempts+1})),r&&r(g),_.close(),u.current=null,c.reconnectAttempts<a&&(f.current=setTimeout(()=>{M()},t))},_.onmessage=g=>{k({type:"message",data:g.data})},Object.keys(X).forEach(g=>{_.addEventListener(g,k)})}catch(_){l(g=>({...g,connecting:!1,error:_}))}}},[e,s,a,t,i,r,k,c.reconnectAttempts]),I=D.useCallback(()=>{u.current&&(u.current.close(),u.current=null),f.current&&(clearTimeout(f.current),f.current=null),l({connected:!1,connecting:!1,error:null,reconnectAttempts:0}),n&&n()},[n]),N=D.useCallback(()=>{I(),setTimeout(M,100)},[I,M]);return D.useEffect(()=>(e&&M(),()=>{I()}),[e,M,I]),D.useEffect(()=>()=>{I()},[I]),{connectionState:c,eventLog:S,connect:M,disconnect:I,reconnect:N,isConnected:c.connected,isConnecting:c.connecting,hasError:!!c.error,canReconnect:c.reconnectAttempts<a}};class Re{constructor(){this.currentDate=new Date,this.businessCalendar=new ke,this.seasonalPatterns=new Oe}getCurrentContext(){const e=new Date;return{currentDate:e.toISOString().split("T")[0],currentMonth:e.getMonth()+1,currentQuarter:Math.floor(e.getMonth()/3)+1,currentYear:e.getFullYear(),dayOfWeek:e.getDay(),dayOfMonth:e.getDate(),weekOfYear:this.getWeekOfYear(e),isBusinessDay:this.businessCalendar.isBusinessDay(e),nextBusinessDay:this.businessCalendar.getNextBusinessDay(e)}}generateDateRange(e,t,a=!1){const i=new Date(e),n=[];let r=new Date(i);for(let o=0;o<t;o++)(!a||this.businessCalendar.isBusinessDay(r))&&n.push({date:new Date(r),dateString:r.toISOString().split("T")[0],dayOfWeek:r.getDay(),weekOfMonth:Math.ceil(r.getDate()/7),month:r.getMonth()+1,quarter:Math.floor(r.getMonth()/3)+1,isBusinessDay:this.businessCalendar.isBusinessDay(r),isMonthEnd:this.isLastBusinessDayOfMonth(r),isQuarterEnd:this.isLastBusinessDayOfQuarter(r)}),r.setDate(r.getDate()+1);return n}calculateWorkingCapitalByPeriod(e,t,a={}){const{dsoTarget:i=45,dpoTarget:n=60,inventoryDays:r=30,currentRevenue:o=4e7}=a,c=this.generateDateRange(new Date,t,!0),l=[];return c.forEach((u,f)=>{const v=this.seasonalPatterns.getBusinessSeasonality(u.month,u.quarter),S=o/365*v,b=S*i,T=S*.6*r,k=S*.4*n,M=b+T-k,I=this.calculateCashInflows(u,S,i),N=this.calculateCashOutflows(u,S,n);l.push({date:u.dateString,dateInfo:u,projectedRevenue:Math.round(S),receivables:Math.round(b),inventory:Math.round(T),payables:Math.round(k),workingCapital:Math.round(M),cashIn:Math.round(I),cashOut:Math.round(N),netCashFlow:Math.round(I-N),seasonalMultiplier:v.toFixed(3),businessDaysInMonth:this.businessCalendar.getBusinessDaysInMonth(u.date.getFullYear(),u.date.getMonth())})}),{projections:l,summary:this.calculatePeriodSummary(l),metadata:{periodDays:t,startDate:c[0]?.dateString,endDate:c[c.length-1]?.dateString,businessDaysCount:c.filter(u=>u.isBusinessDay).length,generatedAt:new Date().toISOString()}}}calculateCashInflows(e,t,a){const i={currentMonth:.3},n=t,r=Math.max(.7,Math.min(1.3,a/45));return n*i.currentMonth*r}calculateCashOutflows(e,t,a){const i=t*.65,n=Math.max(.8,Math.min(1.2,a/60));let r=0;return e.dayOfWeek===5&&(r+=t*.15),e.isMonthEnd&&(r+=t*.05),i*n+r}calculatePeriodSummary(e){const t=e.reduce((c,l)=>c+l.cashIn,0),a=e.reduce((c,l)=>c+l.cashOut,0),i=e.reduce((c,l)=>c+l.workingCapital,0)/e.length,n=Math.min(...e.map(c=>c.netCashFlow)),r=Math.max(...e.map(c=>c.netCashFlow)),o=e.filter(c=>c.netCashFlow<0);return{totalCashIn:Math.round(t),totalCashOut:Math.round(a),netCashFlow:Math.round(t-a),averageWorkingCapital:Math.round(i),minDailyCashFlow:Math.round(n),maxDailyCashFlow:Math.round(r),negativeCashDays:o.length,riskDays:o.map(c=>c.date)}}getWeekOfYear(e){const t=new Date(e.getFullYear(),0,1),a=(e-t)/864e5;return Math.ceil((a+t.getDay()+1)/7)}isLastBusinessDayOfMonth(e){const t=new Date(e.getFullYear(),e.getMonth()+1,0);for(;!this.businessCalendar.isBusinessDay(t)&&t.getDate()>1;)t.setDate(t.getDate()-1);return e.toDateString()===t.toDateString()}isLastBusinessDayOfQuarter(e){const a=(Math.floor(e.getMonth()/3)+1)*3-1,i=new Date(e.getFullYear(),a+1,0);for(;!this.businessCalendar.isBusinessDay(i)&&i.getDate()>1;)i.setDate(i.getDate()-1);return e.toDateString()===i.toDateString()}}class ke{constructor(){this.holidays={UK:this.getUKHolidays(),EU:this.getEUHolidays(),US:this.getUSHolidays()}}isBusinessDay(e,t="UK"){const a=e.getDay();if(a===0||a===6)return!1;const i=e.toISOString().split("T")[0];return!this.holidays[t].includes(i)}getNextBusinessDay(e,t="UK"){let a=new Date(e);for(a.setDate(a.getDate()+1);!this.isBusinessDay(a,t);)a.setDate(a.getDate()+1);return a}getBusinessDaysInMonth(e,t,a="UK"){let i=0;const n=new Date(e,t+1,0).getDate();for(let r=1;r<=n;r++){const o=new Date(e,t,r);this.isBusinessDay(o,a)&&i++}return i}getUKHolidays(){const e=new Date().getFullYear();return[`${e}-01-01`,`${e}-03-29`,`${e}-04-01`,`${e}-05-06`,`${e}-05-27`,`${e}-08-26`,`${e}-12-25`,`${e}-12-26`]}getEUHolidays(){const e=new Date().getFullYear();return[`${e}-01-01`,`${e}-03-29`,`${e}-04-01`,`${e}-05-01`,`${e}-12-25`,`${e}-12-26`]}getUSHolidays(){const e=new Date().getFullYear();return[`${e}-01-01`,`${e}-01-15`,`${e}-02-19`,`${e}-05-27`,`${e}-07-04`,`${e}-09-02`,`${e}-10-14`,`${e}-11-11`,`${e}-11-28`,`${e}-12-25`]}}class Oe{constructor(){this.monthlyMultipliers={1:.85,2:.88,3:.95,4:.92,5:.96,6:1,7:.89,8:.87,9:1.05,10:1.08,11:1.12,12:1.15},this.quarterlyTrends={1:.92,2:.96,3:.94,4:1.08}}getBusinessSeasonality(e,t){const a=this.monthlyMultipliers[e]||1,i=this.quarterlyTrends[t]||1;return a*.7+i*.3}getSeasonalCashflowPattern(e){const t=e>1?e-1:12;return this.monthlyMultipliers[t]||1}}const lt=()=>{const[s,e]=D.useState(()=>{const a=localStorage.getItem("theme");return a||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});return D.useEffect(()=>{const a=window.document.documentElement;s==="dark"?a.classList.add("dark"):a.classList.remove("dark"),localStorage.setItem("theme",s)},[s]),{theme:s,toggleTheme:()=>{e(a=>a==="light"?"dark":"light")},setTheme:e}},ut=()=>{const{data:s}=pe({queryKey:["production-metrics"],queryFn:async()=>({oee:85.2+Math.random()*5,hourlyProduction:Array.from({length:24},(e,t)=>({time:`${String(t).padStart(2,"0")}:00`,units:Math.floor(Math.random()*50)+100+Math.sin(t/3)*20,target:130,efficiency:Math.floor(Math.random()*10)+85})),history:Array.from({length:30},()=>Math.random()*100+50)}),refetchInterval:3e4});return s||{oee:85.2,hourlyProduction:[],history:[]}},dt=()=>({rate:98.7,metrics:[{metric:"First Pass Yield",value:98.5,benchmark:95},{metric:"Defect Rate",value:99.2,benchmark:98},{metric:"Customer Returns",value:99.8,benchmark:99},{metric:"Process Capability",value:96.3,benchmark:94},{metric:"Inspection Pass",value:97.8,benchmark:96},{metric:"Supplier Quality",value:95.4,benchmark:93}],history:Array.from({length:30},()=>Math.random()*5+95)}),mt=()=>({turns:12.4,inventory:[{category:"Raw Materials",current:450,optimal:500,min:200},{category:"WIP",current:280,optimal:250,min:150},{category:"Finished Goods",current:620,optimal:600,min:400},{category:"Spare Parts",current:150,optimal:180,min:100},{category:"Packaging",current:320,optimal:350,min:200}],history:Array.from({length:30},()=>Math.random()*5+10)}),ht=()=>({workingCapital:245e4,monthly:Array.from({length:12},(s,e)=>({month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e],receivables:Math.floor(Math.random()*200)+800,payables:Math.floor(Math.random()*150)+600,inventory:Math.floor(Math.random()*100)+400,workingCapital:Math.floor(Math.random()*300)+2e3})),history:Array.from({length:30},()=>Math.random()*5e5+2e6)});class Pe{constructor(e={}){this.level=e.level||"info",this.service=e.service||"sentia-manufacturing",this.version=e.version||"1.0.0",this.environment=e.environment||"development",this.enableConsole=e.enableConsole!==!1,this.enableStorage=e.enableStorage!==!1,this.maxStoredLogs=e.maxStoredLogs||1e3,this.levels={error:0,warn:1,info:2,debug:3,trace:4},this.logBuffer=[],this.metrics={logsGenerated:0,errorCount:0,warnCount:0,infoCount:0,debugCount:0}}log(e,t,a={},i=null){if(this.levels[e]>this.levels[this.level])return;const r={timestamp:new Date().toISOString(),level:e.toUpperCase(),service:this.service,version:this.version,environment:this.environment,message:t,context:this.sanitizeContext(a),...i&&{error:{message:i.message,stack:i.stack,name:i.name}},...typeof window<"u"&&{userAgent:window.navigator?.userAgent,url:window.location?.href}};return this.updateMetrics(e),this.enableStorage&&this.storeLog(r),this.enableConsole&&this.outputToConsole(r),this.sendToExternalService(r),r}error(e,t={},a=null){return this.log("error",e,t,a)}warn(e,t={}){return this.log("warn",e,t)}info(e,t={}){return this.log("info",e,t)}debug(e,t={}){return this.log("debug",e,t)}trace(e,t={}){return this.log("trace",e,t)}sanitizeContext(e){if(!e||typeof e!="object")return e;const t={...e},a=["password","token","apiKey","secret","authorization","credit_card","ssn","social_security","auth","bearer"];for(const i of Object.keys(t)){const n=i.toLowerCase();a.some(r=>n.includes(r))&&(t[i]="[REDACTED]")}return t}storeLog(e){this.logBuffer.push(e),this.logBuffer.length>this.maxStoredLogs&&this.logBuffer.shift()}outputToConsole(e){const t=this.formatConsoleMessage(e);switch(e.level){case"ERROR":break;case"WARN":break;case"INFO":break;case"DEBUG":console.debug(t);break;case"TRACE":console.trace(t);break}}formatConsoleMessage(e){const{timestamp:t,level:a,message:i,context:n,error:r}=e;let c=`[${new Date(t).toLocaleTimeString()}] ${a}: ${i}`;return n&&Object.keys(n).length>0&&(c+=`
Context: ${JSON.stringify(n,null,2)}`),r&&(c+=`
Error: ${r.message}`,(this.level==="debug"||this.level==="trace")&&(c+=`
Stack: ${r.stack}`)),c}async sendToExternalService(e){}updateMetrics(e){switch(this.metrics.logsGenerated++,e){case"error":this.metrics.errorCount++;break;case"warn":this.metrics.warnCount++;break;case"info":this.metrics.infoCount++;break;case"debug":this.metrics.debugCount++;break}}time(e){const t=performance.now();return{end:(a=`Timer ${e} completed`,i={})=>{const n=performance.now(),r=Math.round(n-t);return this.info(a,{...i,duration:`${r}ms`,label:e}),r}}}logRequest(e,t,a={}){return this.info("API Request",{method:e.toUpperCase(),url:t,...a,type:"request"})}logResponse(e,t,a,i,n={}){const r=a>=400?"error":a>=300?"warn":"info";return this.log(r,"API Response",{method:e.toUpperCase(),url:t,status:a,responseTime:`${i}ms`,...n,type:"response"})}logUserAction(e,t={}){return this.info("User Action",{action:e,...t,type:"user_action",userId:t.userId||"anonymous"})}logBusinessEvent(e,t={}){return this.info("Business Event",{event:e,...t,type:"business_event"})}logError(e,t={}){return this.error("Application Error",{...t,componentStack:t.componentStack,errorBoundary:!0},e)}searchLogs(e,t={}){const{level:a,startDate:i,endDate:n,limit:r=100}=t;let o=[...this.logBuffer];if(a&&(o=o.filter(c=>c.level.toLowerCase()===a.toLowerCase())),i&&(o=o.filter(c=>new Date(c.timestamp)>=new Date(i))),n&&(o=o.filter(c=>new Date(c.timestamp)<=new Date(n))),e){const c=e.toLowerCase();o=o.filter(l=>l.message.toLowerCase().includes(c)||JSON.stringify(l.context).toLowerCase().includes(c))}return o.sort((c,l)=>new Date(l.timestamp)-new Date(c.timestamp)),o.slice(0,r)}getMetrics(){return{...this.metrics,bufferSize:this.logBuffer.length,maxBufferSize:this.maxStoredLogs,currentLevel:this.level,environment:this.environment,service:this.service}}exportLogs(e="json"){switch(e){case"csv":return this.exportAsCSV();case"json":default:return JSON.stringify(this.logBuffer,null,2)}}exportAsCSV(){if(this.logBuffer.length===0)return"";const e=["timestamp","level","message","context","error"],t=this.logBuffer.map(a=>[a.timestamp,a.level,a.message,JSON.stringify(a.context||{}),a.error?a.error.message:""]);return[e,...t].map(a=>a.map(i=>`"${i}"`).join(",")).join(`
`)}clearLogs(){const e=this.logBuffer.length;return this.logBuffer=[],e}setLevel(e){return this.levels.hasOwnProperty(e)?(this.level=e,!0):!1}}const W=new Pe({service:"sentia-manufacturing",environment:typeof window<"u"?"browser":"server"}),C=(s,e,t)=>W.error(s,e,t),j=(s,e)=>W.warn(s,e),y=(s,e)=>W.info(s,e),$={debug:0,info:1,warn:2,error:3},Te=()=>$["info"]??$.info,Me=s=>{const e=Te();return($[s]??$.info)>=e},xe=(s,e,t={})=>{const a={timestamp:new Date().toISOString(),level:s,message:e,environment:"production",url:window.location?.href,userAgent:navigator.userAgent,...t};return window.correlationId&&(a.correlationId=window.correlationId),a},Ne=async s=>{},ae=(s,e,t={})=>{Me(s)&&(xe(s,e,t),(console[s]||console.log)(`[${s.toUpperCase()}] ${e}`,t),Ne())},pt=(s,e={})=>{ae("info",s,e)},gt=(s,e=null,t={})=>{const a=e?{error:{message:e.message,name:e.name,stack:e.stack}}:{};ae("error",s,{...a,...t})};class yt{constructor(e={}){this.dateEngine=new Re,this.config={targetDSO:e.targetDSO||45,targetDPO:e.targetDPO||60,targetDIO:e.targetDIO||30,creditTerms:e.creditTerms||{net15:.1,net30:.5,net45:.25,net60:.15},paymentTerms:e.paymentTerms||{net30:.3,net60:.45,net90:.25},inventoryCategories:e.inventoryCategories||{rawMaterials:{turnoverDays:21,percentage:.4},workInProcess:{turnoverDays:7,percentage:.15},finishedGoods:{turnoverDays:35,percentage:.45}}}}calculateCashConversionCycle(e={}){const t=this.dateEngine.getCurrentContext(),a={annualRevenue:e.annualRevenue||4e7,annualCOGS:e.annualCOGS||26e6,averageReceivables:e.averageReceivables||null,averageInventory:e.averageInventory||null,averagePayables:e.averagePayables||null,...e},i=a.annualRevenue/365,n=a.annualCOGS/365,r=a.averageReceivables||this.calculateReceivables(i),o=a.averageInventory||this.calculateInventory(n),c=a.averagePayables||this.calculatePayables(n),l=this.calculateDSO(r,i,t),u=this.calculateDIO(o,n,t),f=this.calculateDPO(c,n,t),v=l+u-f;return{cashConversionCycle:Math.round(v*10)/10,components:{dso:Math.round(l*10)/10,dio:Math.round(u*10)/10,dpo:Math.round(f*10)/10},balanceSheetItems:{receivables:Math.round(r),inventory:Math.round(o),payables:Math.round(c)},benchmarks:{targetDSO:this.config.targetDSO,targetDIO:this.config.targetDIO,targetDPO:this.config.targetDPO,targetCCC:this.config.targetDSO+this.config.targetDIO-this.config.targetDPO},performance:{dsoVariance:Math.round((l-this.config.targetDSO)*10)/10,dioVariance:Math.round((u-this.config.targetDIO)*10)/10,dpoVariance:Math.round((f-this.config.targetDPO)*10)/10},workingCapitalImpact:this.calculateWorkingCapitalImpact(v,i),recommendations:this.generateRecommendations(l,u,f),calculatedAt:t.currentDate}}calculateDSO(e,t,a){const i=e/t;let n=1;return a.dayOfMonth>25&&[3,6,9,12].includes(a.currentMonth)&&(n=1.15),[12,1].includes(a.currentMonth)&&(n=1.08),[7,8].includes(a.currentMonth)&&(n=1.05),i*n}calculateDIO(e,t,a){const i=e/t;let n=1;return[10,11].includes(a.currentMonth)&&(n=1.2),[1,2].includes(a.currentMonth)&&(n=.85),[6,7,8].includes(a.currentMonth)&&(n=.95),i*n}calculateDPO(e,t,a){const i=e/t;let n=1;return a.dayOfMonth<=15&&(n=1.1),a.dayOfMonth>25&&[3,6,9,12].includes(a.currentMonth)&&(n=1.08),i*n}calculateReceivables(e){let t=0;return Object.entries(this.config.creditTerms).forEach(([a,i])=>{const r=parseInt(a.replace("net",""))+7;t+=r*i}),e*t}calculateInventory(e){let t=0;return Object.entries(this.config.inventoryCategories).forEach(([a,i])=>{const n=e*i.turnoverDays*i.percentage;t+=n}),t}calculatePayables(e){let t=0;return Object.entries(this.config.paymentTerms).forEach(([a,i])=>{const n=parseInt(a.replace("net",""));t+=n*i}),e*.7*t}calculateWorkingCapitalImpact(e,t){const a=this.config.targetDSO+this.config.targetDIO-this.config.targetDPO,i=e-a,n=i*t;return{cccVarianceDays:Math.round(i*10)/10,workingCapitalImpact:Math.round(n),annualInterestCost:Math.round(n*.055),optimizationPotential:Math.round(Math.abs(n))}}generateRecommendations(e,t,a){const i=[];e>this.config.targetDSO+5&&i.push({area:"Collections",priority:"high",issue:`DSO of ${e.toFixed(1)} days exceeds target by ${(e-this.config.targetDSO).toFixed(1)} days`,recommendation:"Implement automated collections processes, offer early payment discounts, review credit terms",impact:`Could free up £${Math.round((e-this.config.targetDSO)*4e7/365).toLocaleString()} in working capital`}),t>this.config.targetDIO+5&&i.push({area:"Inventory",priority:"medium",issue:`Inventory days of ${t.toFixed(1)} exceeds target by ${(t-this.config.targetDIO).toFixed(1)} days`,recommendation:"Implement just-in-time ordering, improve demand forecasting, reduce safety stock levels",impact:`Could free up £${Math.round((t-this.config.targetDIO)*26e6/365).toLocaleString()} in working capital`}),a<this.config.targetDPO-5&&i.push({area:"Payables",priority:"low",issue:`Payable days of ${a.toFixed(1)} below target by ${(this.config.targetDPO-a).toFixed(1)} days`,recommendation:"Negotiate extended payment terms with suppliers, optimize payment timing",impact:`Could improve cash flow by £${Math.round((this.config.targetDPO-a)*26e6/365).toLocaleString()}`});const n=e+t-a,r=this.config.targetDSO+this.config.targetDIO-this.config.targetDPO;return n>r+10&&i.push({area:"Cash Conversion Cycle",priority:"high",issue:`CCC of ${n.toFixed(1)} days significantly exceeds target of ${r.toFixed(1)} days`,recommendation:"Comprehensive working capital optimization program focusing on collections and inventory",impact:`Total optimization potential: £${Math.round((n-r)*4e7/365).toLocaleString()}`}),i}projectCCCOverTime(e=12){const t=[],a=this.calculateCashConversionCycle();for(let i=0;i<e;i++){const n=new Date;n.setMonth(n.getMonth()+i);const r={currentMonth:n.getMonth()+1,dayOfMonth:n.getDate(),currentDate:n.toISOString().split("T")[0]};let o=a.components.dso,c=a.components.dio,l=a.components.dpo;[12,1].includes(r.currentMonth)&&(o*=1.08),[7,8].includes(r.currentMonth)&&(o*=1.05),[10,11].includes(r.currentMonth)&&(c*=1.2),[1,2].includes(r.currentMonth)&&(c*=.85),[3,6,9,12].includes(r.currentMonth)&&(l*=1.08);const u=o+c-l;t.push({month:n.toLocaleDateString("en-US",{month:"short",year:"numeric"}),date:r.currentDate,ccc:Math.round(u*10)/10,dso:Math.round(o*10)/10,dio:Math.round(c*10)/10,dpo:Math.round(l*10)/10,workingCapitalImpact:Math.round((u-a.benchmarks.targetCCC)*4e7/365)})}return t}analyzeCCCTrends(e){if(!e||e.length<3)return{trend:"insufficient_data",message:"Need at least 3 data points for trend analysis"};const t=e.length;let a=0,i=0,n=0,r=0;e.forEach((S,b)=>{a+=b,i+=S.ccc,n+=b*S.ccc,r+=b*b});const o=(t*n-a*i)/(t*r-a*a),c=o>1?"deteriorating":o<-1?"improving":"stable",l=e.map(S=>S.ccc),u=l.reduce((S,b)=>S+b,0)/l.length,f=l.reduce((S,b)=>S+Math.pow(b-u,2),0)/l.length,v=f>25?"high":f>10?"medium":"low";return{trend:c,slope:Math.round(o*100)/100,volatility:v,variance:Math.round(f*10)/10,averageCCC:Math.round(u*10)/10,recommendation:this.getTrendRecommendation(c,v,u)}}getTrendRecommendation(e,t,a){return e==="deteriorating"?"CCC is worsening over time. Immediate action needed on collections, inventory management, or supplier terms.":e==="improving"?"CCC is improving. Continue current optimization efforts and identify additional opportunities.":t==="high"?"CCC is highly volatile. Focus on stabilizing working capital processes and improving predictability.":"CCC is stable. Monitor for seasonal patterns and optimization opportunities."}}class ft{constructor(){this.apiBaseUrl="https://api.sentia-manufacturing.com",this.refreshInterval=3e5,this.cache=new Map,this.cacheTimestamps=new Map}async calculateWorkingCapitalRequirements(e={}){const{period:t=12,currency:a="GBP",includeForecasts:i=!0}=e;try{const[n,r,o,c,l]=await Promise.all([this.fetchAccountsReceivable(t),this.fetchInventoryData(t),this.fetchAccountsPayable(t),this.fetchCashFlowData(t),this.fetchSalesData(t)]),u={cash:c.currentCash||0,accountsReceivable:n.totalOutstanding||0,inventory:r.totalValue||0,prepaidExpenses:await this.fetchPrepaidExpenses()||0,otherCurrentAssets:await this.fetchOtherCurrentAssets()||0},f={accountsPayable:o.totalPayable||0,shortTermDebt:await this.fetchShortTermDebt()||0,accruedExpenses:await this.fetchAccruedExpenses()||0,taxesPayable:await this.fetchTaxesPayable()||0,otherCurrentLiabilities:await this.fetchOtherCurrentLiabilities()||0},v=Object.values(u).reduce((Q,K)=>Q+K,0),S=Object.values(f).reduce((Q,K)=>Q+K,0),b=v-S,T=S>0?v/S:0,k=S>0?(v-u.inventory-u.prepaidExpenses)/S:0,M=S>0?u.cash/S:0,I=l.annualRevenue||0,N=l.annualCOGS||I*.65,_=I>0?u.accountsReceivable*365/I:0,g=N>0?u.inventory*365/N:0,w=N>0?f.accountsPayable*365/N:0,A=_+g-w,O=I>0&&b>0?I/b:0,G=v>0?I/v:0,H={currentRatio:{target:1.5,good:1.8,excellent:2},quickRatio:{target:1,good:1.2,excellent:1.5},cashConversionCycle:{target:45,good:35,excellent:25},workingCapitalTurnover:{target:6,good:8,excellent:10}},F=await this.calculateRequirementsByCategory({currentAssets:u,currentLiabilities:f,salesData:l,period:t}),ie=this.generateOptimizationRecommendations({currentRatio:T,quickRatio:k,cashConversionCycle:A,workingCapitalTurnover:O,benchmarks:H,requirements:F});let z=null;return i&&(z=await this.generateWorkingCapitalForecasts({workingCapital:b,currentAssets:u,currentLiabilities:f,salesData:l,period:12})),{calculationDate:new Date().toISOString(),currency:a,period:t,currentAssets:u,currentLiabilities:f,workingCapital:{total:b,percentage:I>0?b/I*100:0,perEmployee:F.employeeCount>0?b/F.employeeCount:0},ratios:{current:T,quick:k,cash:M,workingCapitalTurnover:O,assetTurnover:G},cashConversionCycle:{total:A,components:{daysReceivableOutstanding:_,daysInventoryOutstanding:g,daysPayableOutstanding:w}},requirements:F,benchmarks:H,recommendations:ie,forecasts:z,performanceScore:this.calculatePerformanceScore({currentRatio:T,quickRatio:k,cashConversionCycle:A,workingCapitalTurnover:O,benchmarks:H}),riskAssessment:this.assessWorkingCapitalRisk({workingCapital:b,ratios:{current:T,quick:k},cashConversionCycle:A,forecasts:z})}}catch(n){throw console.error("Enhanced working capital calculation failed:",n),new Error(`Working capital calculation failed: ${n.message}`)}}async fetchAccountsReceivable(e){const t=`ar_${e}`;if(this.isValidCache(t))return this.cache.get(t);try{const n=await fetch(`${this.apiBaseUrl}/financial/accounts-receivable?period=${e}`);if(n.ok){const r=await n.json();return this.setCache(t,r),r}}catch{}const a=await this.fetchSalesData(e),i={totalOutstanding:a.monthlyAverage*1.5,aged30Days:a.monthlyAverage*.8,aged60Days:a.monthlyAverage*.5,aged90Plus:a.monthlyAverage*.2,currency:"GBP"};return this.setCache(t,i),i}async fetchInventoryData(e){const t=`inventory_${e}`;if(this.isValidCache(t))return this.cache.get(t);try{const n=await fetch(`${this.apiBaseUrl}/inventory/valuation?period=${e}`);if(n.ok){const r=await n.json();return this.setCache(t,r),r}}catch{}const a=await this.fetchSalesData(e),i={totalValue:a.annualCOGS*.15,rawMaterials:a.annualCOGS*.06,workInProcess:a.annualCOGS*.04,finishedGoods:a.annualCOGS*.05,currency:"GBP"};return this.setCache(t,i),i}async fetchAccountsPayable(e){const t=`ap_${e}`;if(this.isValidCache(t))return this.cache.get(t);try{const n=await fetch(`${this.apiBaseUrl}/financial/accounts-payable?period=${e}`);if(n.ok){const r=await n.json();return this.setCache(t,r),r}}catch{}const a=await this.fetchSalesData(e),i={totalPayable:a.annualCOGS*.12,aged30Days:a.annualCOGS*.08,aged60Days:a.annualCOGS*.03,aged90Plus:a.annualCOGS*.01,currency:"GBP"};return this.setCache(t,i),i}async fetchCashFlowData(e){const t=`cashflow_${e}`;if(this.isValidCache(t))return this.cache.get(t);try{const n=await fetch(`${this.apiBaseUrl}/financial/cash-flow?period=${e}`);if(n.ok){const r=await n.json();return this.setCache(t,r),r}}catch{}const a=await this.fetchSalesData(e),i={currentCash:a.monthlyAverage*2,operatingCashFlow:a.monthlyAverage*.15,freeCashFlow:a.monthlyAverage*.08,currency:"GBP"};return this.setCache(t,i),i}async fetchSalesData(e){const t=`sales_${e}`;if(this.isValidCache(t))return this.cache.get(t);try{const i=await fetch(`${this.apiBaseUrl}/financial/sales-data?period=${e}`);if(i.ok){const n=await i.json();return this.setCache(t,n),n}}catch{}const a={annualRevenue:4e7,annualCOGS:26e6,monthlyAverage:3333333,growthRate:.08,seasonality:.15,currency:"GBP"};return this.setCache(t,a),a}async calculateRequirementsByCategory(e){const{salesData:t}=e,a=await this.fetchEmployeeCount(),i=await this.fetchFacilityCount();return{operational:{description:"Day-to-day operations funding",amount:t.monthlyAverage*.25,daysOfSales:7.5,priority:"critical"},seasonal:{description:"Seasonal inventory and sales variations",amount:t.annualRevenue*(t.seasonality||.15),daysOfSales:(t.seasonality||.15)*365,priority:"high"},growth:{description:"Supporting business growth initiatives",amount:t.annualRevenue*(t.growthRate||.08),daysOfSales:(t.growthRate||.08)*365,priority:"medium"},contingency:{description:"Emergency cash reserves",amount:t.monthlyAverage*1.5,daysOfSales:45,priority:"high"},employeeCount:a,facilityCount:i}}async generateWorkingCapitalForecasts(e){const{workingCapital:t,salesData:a,period:i}=e,n=[];let r=t;for(let o=1;o<=i;o++){const c=1+a.growthRate/12,l=1+Math.sin(o/12*2*Math.PI)*a.seasonality,u=a.monthlyAverage*c*l,f=u*1.5,v=u*.65*1.8,S=u*.65*1.4;r=f+v-S,n.push({month:o,date:new Date(Date.now()+o*30*24*60*60*1e3).toISOString(),workingCapital:r,accountsReceivable:f,inventory:v,accountsPayable:S,revenue:u,cashFlow:u*.12,requirements:r})}return n}generateOptimizationRecommendations(e){const{currentRatio:t,cashConversionCycle:a,workingCapitalTurnover:i,benchmarks:n,requirements:r}=e,o=[];return t<n.currentRatio.target&&o.push({category:"Liquidity",priority:"high",issue:"Low current ratio indicates potential liquidity stress",recommendation:"Increase current assets or reduce short-term liabilities",potentialImpact:"Improved financial stability",targetValue:n.currentRatio.target,currentValue:t}),a>n.cashConversionCycle.target&&o.push({category:"Efficiency",priority:"high",issue:"Extended cash conversion cycle ties up working capital",recommendation:"Accelerate collections, optimize inventory levels, extend payment terms",potentialImpact:`£${Math.round((a-n.cashConversionCycle.target)*r.operational.amount/30)}K in freed capital`,targetValue:n.cashConversionCycle.target,currentValue:a}),i<n.workingCapitalTurnover.target&&o.push({category:"Efficiency",priority:"medium",issue:"Low working capital turnover indicates inefficient capital utilization",recommendation:"Optimize working capital levels relative to sales volume",potentialImpact:"Improved return on working capital investment",targetValue:n.workingCapitalTurnover.target,currentValue:i}),o}calculatePerformanceScore(e){const{currentRatio:t,quickRatio:a,cashConversionCycle:i,workingCapitalTurnover:n,benchmarks:r}=e;let o=0,c=0;return c+=25,t>=r.currentRatio.excellent?o+=25:t>=r.currentRatio.good?o+=20:t>=r.currentRatio.target?o+=15:o+=Math.max(0,t/r.currentRatio.target*10),c+=25,a>=r.quickRatio.excellent?o+=25:a>=r.quickRatio.good?o+=20:a>=r.quickRatio.target?o+=15:o+=Math.max(0,a/r.quickRatio.target*10),c+=25,i<=r.cashConversionCycle.excellent?o+=25:i<=r.cashConversionCycle.good?o+=20:i<=r.cashConversionCycle.target?o+=15:o+=Math.max(0,10-(i-r.cashConversionCycle.target)/10),c+=25,n>=r.workingCapitalTurnover.excellent?o+=25:n>=r.workingCapitalTurnover.good?o+=20:n>=r.workingCapitalTurnover.target?o+=15:o+=Math.max(0,n/r.workingCapitalTurnover.target*10),Math.round(o/c*100)}assessWorkingCapitalRisk(e){const{workingCapital:t,ratios:a,cashConversionCycle:i,forecasts:n}=e,r=[];return a.current<1.2&&r.push({level:"high",category:"Liquidity Risk",description:"Current ratio below safe threshold",impact:"Difficulty meeting short-term obligations"}),a.quick<.8&&r.push({level:"high",category:"Quick Liquidity Risk",description:"Quick ratio indicates potential cash shortfall",impact:"May need to liquidate inventory to meet obligations"}),i>60&&r.push({level:"medium",category:"Efficiency Risk",description:"Extended cash conversion cycle",impact:"Excessive working capital tied up in operations"}),n&&n.some(c=>c.workingCapital<t*.8)&&r.push({level:"medium",category:"Forecast Risk",description:"Working capital projected to decline significantly",impact:"Future liquidity constraints possible"}),{overall:r.some(c=>c.level==="high")?"high":r.some(c=>c.level==="medium")?"medium":"low",risks:r,riskScore:r.length*15}}async fetchEmployeeCount(){try{const e=await fetch(`${this.apiBaseUrl}/company/employees/count`);if(e.ok)return(await e.json()).count||150}catch{}return 150}async fetchFacilityCount(){try{const e=await fetch(`${this.apiBaseUrl}/company/facilities/count`);if(e.ok)return(await e.json()).count||3}catch{}return 3}async fetchPrepaidExpenses(){return(await this.fetchSalesData(12)).annualRevenue*.02}async fetchOtherCurrentAssets(){return(await this.fetchSalesData(12)).annualRevenue*.01}async fetchShortTermDebt(){return(await this.fetchSalesData(12)).annualRevenue*.05}async fetchAccruedExpenses(){return(await this.fetchSalesData(12)).annualRevenue*.03}async fetchTaxesPayable(){return(await this.fetchSalesData(12)).annualRevenue*.15/4}async fetchOtherCurrentLiabilities(){return(await this.fetchSalesData(12)).annualRevenue*.015}isValidCache(e){const t=this.cacheTimestamps.get(e);return t&&Date.now()-t<this.refreshInterval}setCache(e,t){this.cache.set(e,t),this.cacheTimestamps.set(e,Date.now())}clearCache(){this.cache.clear(),this.cacheTimestamps.clear()}}class Le{constructor(){this.connections=new Map,this.productionLines=new Map,this.equipmentStatus=new Map,this.productionMetrics=new Map,this.isConnected=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=5}async initialize(){try{return y("Initializing production integration service"),await this.loadProductionLineConfigs(),await this.connectToMES(),await this.startDataCollection(),this.isConnected=!0,y("Production integration service initialized successfully"),{success:!0,message:"Production systems connected"}}catch(e){throw C("Failed to initialize production integration",e),new Error(`Production integration failed: ${e.message}`)}}async getRealTimeProductionStatus(){try{const e={timestamp:new Date().toISOString(),overallStatus:"operational",totalLines:this.productionLines.size,activeLines:0,totalOutput:0,efficiency:0,lines:[]};for(const[t,a]of this.productionLines){const i=await this.getProductionLineStatus(t);e.lines.push(i),i.status==="running"&&e.activeLines++,e.totalOutput+=i.currentOutput,e.efficiency+=i.efficiency}return e.lines.length>0&&(e.efficiency=e.efficiency/e.lines.length),e}catch(e){throw C("Failed to get production status",e),e}}async getProductionLineStatus(e){try{const t=this.productionLines.get(e);if(!t)throw new Error(`Production line ${e} not found`);return{id:e,name:t.name,location:t.location,status:this.calculateLineStatus(e),currentProduct:await this.getCurrentProduct(e),plannedOutput:t.plannedOutput,currentOutput:await this.getCurrentOutput(e),efficiency:await this.calculateEfficiency(e),oee:await this.calculateOEE(e),quality:await this.getQualityMetrics(e),equipment:await this.getEquipmentStatus(e),alerts:await this.getActiveAlerts(e),lastUpdate:new Date().toISOString()}}catch(t){throw C(`Failed to get status for line ${e}`,t),t}}async calculateOEE(e){try{const t=await this.calculateAvailability(e),a=await this.calculatePerformance(e),i=await this.calculateQualityRate(e),n=t*a*i/1e4;return{overall:Math.round(n*100)/100,availability:Math.round(t*100)/100,performance:Math.round(a*100)/100,quality:Math.round(i*100)/100,target:85,status:n>=85?"excellent":n>=60?"good":"needs_improvement"}}catch(t){return C(`Failed to calculate OEE for line ${e}`,t),{overall:0,availability:0,performance:0,quality:0}}}async getProductionSchedule(e="24h"){try{const t={timeframe:e,generatedAt:new Date().toISOString(),schedules:[]};for(const[a,i]of this.productionLines){const n={lineId:a,lineName:i.name,shifts:await this.getShiftSchedule(a,e),products:await this.getScheduledProducts(a,e),plannedDowntime:await this.getPlannedDowntime(a,e)};t.schedules.push(n)}return t}catch(t){throw C("Failed to get production schedule",t),t}}async updateProductionSchedule(e,t){try{y(`Updating production schedule for line ${e}`,t),await this.validateScheduleUpdate(t);const a=await this.applyScheduleChanges(e,t);return await this.notifyScheduleChange(e,t),y(`Production schedule updated successfully for line ${e}`),a}catch(a){throw C(`Failed to update production schedule for line ${e}`,a),a}}async getMaintenanceStatus(){try{const e={timestamp:new Date().toISOString(),upcomingMaintenance:[],overdueMaintenance:[],criticalAlerts:[],maintenanceSchedule:[]};for(const[t,a]of this.productionLines){const i=await this.getEquipmentStatus(t);for(const n of i)if(n.nextMaintenance){const r=this.calculateDaysUntil(n.nextMaintenance);r<=7&&e.upcomingMaintenance.push({lineId:t,lineName:a.name,equipment:n.name,daysUntil:r,maintenanceType:n.maintenanceType,priority:r<=3?"high":"medium"})}}return e}catch(e){throw C("Failed to get maintenance status",e),e}}async loadProductionLineConfigs(){const e=[{id:"line_01",name:"GABA Red Production Line A",location:"Factory Floor 1",type:"supplement_capsule",capacity:1e4,plannedOutput:8500,equipment:["mixer_01","encapsulator_01","packaging_01"]},{id:"line_02",name:"Protein Powder Line B",location:"Factory Floor 1",type:"powder_processing",capacity:5e3,plannedOutput:4200,equipment:["blender_02","filler_02","sealer_02"]},{id:"line_03",name:"Liquid Supplement Line C",location:"Factory Floor 2",type:"liquid_filling",capacity:8e3,plannedOutput:6800,equipment:["mixer_03","filler_03","capper_03","labeler_03"]}];e.forEach(t=>{this.productionLines.set(t.id,t)}),y(`Loaded ${e.length} production line configurations`)}async connectToMES(){y("Connecting to MES/ERP systems"),await this.delay(1e3),y("MES/ERP connections established")}async startDataCollection(){y("Starting real-time data collection"),setInterval(()=>this.collectProductionMetrics(),3e4),setInterval(()=>this.collectEquipmentStatus(),6e4),setInterval(()=>this.collectQualityData(),12e4)}calculateLineStatus(e){const t=["running","idle","maintenance","fault"],a=[.7,.15,.1,.05];return this.weightedRandomChoice(t,a)}async getCurrentProduct(e){return{line_01:{id:"GABA_RED_500",name:"GABA Red 500mg Capsules",batchId:"GR2025090801"},line_02:{id:"WHEY_VANILLA",name:"Whey Protein Vanilla 2kg",batchId:"WV2025090801"},line_03:{id:"OMEGA3_LIQUID",name:"Omega-3 Liquid 500ml",batchId:"O3L2025090801"}}[e]||{id:"UNKNOWN",name:"No product scheduled"}}async getCurrentOutput(e){if(!this.productionLines.get(e))return 0;throw new Error("REAL DATA REQUIRED: Connect to MES/SCADA for actual production output")}async calculateEfficiency(e){const t=this.productionLines.get(e)?.plannedOutput||1,a=await this.getCurrentOutput(e);return Math.min(100,Math.round(a/t*100*100)/100)}async calculateAvailability(e){throw new Error("REAL DATA REQUIRED: Connect to MES for actual availability metrics")}async calculatePerformance(e){throw new Error("REAL DATA REQUIRED: Connect to production systems for performance data")}async calculateQualityRate(e){throw new Error("REAL DATA REQUIRED: Connect to LIMS for actual quality metrics")}weightedRandomChoice(e,t){throw new Error("REAL DATA REQUIRED: Connect to PLCs/SCADA for real equipment status")}calculateDaysUntil(e){const t=new Date,i=new Date(e).getTime()-t.getTime();return Math.ceil(i/(1e3*60*60*24))}delay(e){return new Promise(t=>setTimeout(t,e))}async getQualityMetrics(e){return{passRate:98.2,defectRate:1.8}}async getEquipmentStatus(e){return[]}async getActiveAlerts(e){return[]}async getShiftSchedule(e,t){return[]}async getScheduledProducts(e,t){return[]}async getPlannedDowntime(e,t){return[]}async validateScheduleUpdate(e){return!0}async applyScheduleChanges(e,t){return{success:!0}}async notifyScheduleChange(e,t){}async collectProductionMetrics(){}async collectEquipmentStatus(){}async collectQualityData(){}}const vt=new Le;class Be{constructor(){this.testingStations=new Map,this.qualityChecks=new Map,this.batches=new Map,this.testResults=new Map,this.complianceRules=new Map,this.instrumentCalibration=new Map,this.qualityMetrics=new Map,this.isConnected=!1,this.lastSync=null}async initialize(){try{return y("Initializing quality control service"),await this.loadQualityStandardsAndProcedures(),await this.connectToTestingInstruments(),await this.initializeBatchTracking(),await this.startQualityMonitoring(),this.isConnected=!0,this.lastSync=new Date,y("Quality control service initialized successfully"),{success:!0,message:"Quality control systems connected"}}catch(e){throw C("Failed to initialize quality control service",e),new Error(`Quality control integration failed: ${e.message}`)}}async getRealTimeQualityStatus(){try{const e={timestamp:new Date().toISOString(),overallQualityScore:0,totalBatches:this.batches.size,passedBatches:0,failedBatches:0,pendingTests:0,activeStations:0,stations:[],recentTests:[],complianceAlerts:[]};for(const[t,a]of this.testingStations){const i=await this.getStationQualityStatus(t);e.stations.push(i),i.status==="active"&&e.activeStations++,e.overallQualityScore+=i.qualityScore}e.stations.length>0&&(e.overallQualityScore=e.overallQualityScore/e.stations.length);for(const[t,a]of this.batches)a.status==="passed"&&e.passedBatches++,a.status==="failed"&&e.failedBatches++,a.status==="testing"&&e.pendingTests++;return e.recentTests=await this.getRecentTestResults(10),e.complianceAlerts=await this.getComplianceAlerts(),e}catch(e){throw C("Failed to get quality status",e),e}}async getStationQualityStatus(e){try{const t=this.testingStations.get(e);if(!t)throw new Error(`Testing station ${e} not found`);return{id:e,name:t.name,type:t.type,location:t.location,status:await this.getStationOperationalStatus(e),qualityScore:await this.calculateStationQualityScore(e),currentBatch:await this.getCurrentBatchBeingTested(e),testsCompleted:await this.getTestsCompletedToday(e),passRate:await this.calculatePassRate(e),instruments:await this.getStationInstruments(e),calibrationStatus:await this.getCalibrationStatus(e),activeTests:await this.getActiveTests(e),alerts:await this.getStationAlerts(e),lastUpdate:new Date().toISOString()}}catch(t){throw C(`Failed to get status for station ${e}`,t),t}}async processBatchForTesting(e){try{y("Processing new batch for quality testing",e),await this.validateBatchData(e);const t={id:e.batchId,productCode:e.productCode,productName:e.productName,quantity:e.quantity,productionDate:e.productionDate,productionLine:e.productionLine,status:"pending",createdAt:new Date().toISOString(),testResults:[],qualityChecks:await this.getRequiredQualityChecks(e.productCode),complianceRequirements:await this.getComplianceRequirements(e.productCode)};this.batches.set(e.batchId,t);const a=await this.assignToTestingStation(e);return await this.initiateTestingProcess(e.batchId,a),y(`Batch ${e.batchId} assigned to station ${a} for testing`),t}catch(t){throw C("Failed to process batch for testing",t),t}}async recordTestResult(e){try{y("Recording test result",{batchId:e.batchId,testType:e.testType,stationId:e.stationId}),await this.validateTestData(e);const t={id:`TEST_${Date.now()}_${crypto.randomUUID().substr(2,9)}`,batchId:e.batchId,stationId:e.stationId,testType:e.testType,testName:e.testName,result:e.result,unit:e.unit,specification:e.specification,passed:await this.evaluateTestResult(e),timestamp:new Date().toISOString(),operator:e.operator||"system",instrumentId:e.instrumentId,comments:e.comments};return this.testResults.set(t.id,t),await this.updateBatchWithTestResult(e.batchId,t),await this.checkBatchTestingCompletion(e.batchId),await this.checkQualityAlerts(t),y(`Test result recorded for batch ${e.batchId}`,{testType:e.testType,result:e.result,passed:t.passed}),t}catch(t){throw C("Failed to record test result",t),t}}async getQualityControlDashboard(e="24h"){try{const t={timeframe:e,generatedAt:new Date().toISOString(),summary:{totalBatches:0,passedBatches:0,failedBatches:0,pendingBatches:0,overallPassRate:0,averageTestTime:0,criticalAlerts:0},stationMetrics:[],recentFailures:[],trendData:[],complianceStatus:{iso:"compliant",fda:"compliant",haccp:"compliant",gmp:"compliant"}},a=Array.from(this.batches.values());t.summary.totalBatches=a.length,t.summary.passedBatches=a.filter(i=>i.status==="passed").length,t.summary.failedBatches=a.filter(i=>i.status==="failed").length,t.summary.pendingBatches=a.filter(i=>i.status==="pending"||i.status==="testing").length,t.summary.totalBatches>0&&(t.summary.overallPassRate=t.summary.passedBatches/t.summary.totalBatches*100);for(const[i,n]of this.testingStations){const r={stationId:i,stationName:n.name,testsCompleted:await this.getTestsCompletedToday(i),passRate:await this.calculatePassRate(i),averageTestTime:await this.calculateAverageTestTime(i),utilization:await this.calculateStationUtilization(i)};t.stationMetrics.push(r)}return t.recentFailures=await this.getRecentFailures(e),t.trendData=await this.getQualityTrendData(e),t}catch(t){throw C("Failed to get quality control dashboard",t),t}}async getComplianceReport(e="all"){try{const t={standard:e,generatedAt:new Date().toISOString(),overallStatus:"compliant",standards:{iso22000:{status:"compliant",lastAudit:"2025-08-15",nextAudit:"2025-11-15"},fda:{status:"compliant",lastInspection:"2025-07-20",nextInspection:"2026-01-20"},haccp:{status:"compliant",lastReview:"2025-09-01",nextReview:"2025-12-01"},gmp:{status:"compliant",lastAudit:"2025-08-10",nextAudit:"2025-11-10"}},violations:[],corrective_actions:[],documentation:{procedures_current:!0,records_complete:!0,training_current:!0,calibration_current:await this.checkCalibrationCurrency()}};return t.violations=await this.getComplianceViolations(),t.corrective_actions=await this.getCorrectiveActions(),t.violations.length>0&&(t.overallStatus="non_compliant"),t}catch(t){throw C("Failed to generate compliance report",t),t}}async loadQualityStandardsAndProcedures(){const e=[{id:"QC_STATION_01",name:"Microbiological Testing Lab",type:"microbiological",location:"Quality Lab - Room A",instruments:["incubator_01","microscope_01","autoclave_01"]},{id:"QC_STATION_02",name:"Chemical Analysis Lab",type:"chemical",location:"Quality Lab - Room B",instruments:["hplc_01","spectrophotometer_01","balance_01"]},{id:"QC_STATION_03",name:"Physical Testing Station",type:"physical",location:"Quality Lab - Room C",instruments:["tablet_hardness_01","dissolution_01","ph_meter_01"]},{id:"QC_STATION_04",name:"Packaging Inspection",type:"packaging",location:"Packaging Area",instruments:["vision_system_01","leak_tester_01","label_inspector_01"]}];e.forEach(a=>{this.testingStations.set(a.id,a)});const t=[{standard:"ISO22000",category:"food_safety",requirements:["temperature_control","contamination_prevention"]},{standard:"FDA",category:"supplement_safety",requirements:["identity_testing","potency_testing"]},{standard:"HACCP",category:"hazard_analysis",requirements:["critical_control_points","monitoring"]},{standard:"GMP",category:"manufacturing_practices",requirements:["personnel_hygiene","equipment_maintenance"]}];t.forEach(a=>{this.complianceRules.set(a.standard,a)}),y(`Loaded ${e.length} testing stations and ${t.length} compliance standards`)}async connectToTestingInstruments(){y("Connecting to quality control testing instruments"),await this.delay(800),y("Testing instrument connections established")}async initializeBatchTracking(){y("Initializing batch tracking systems"),await this.delay(500),y("Batch tracking systems initialized")}async startQualityMonitoring(){y("Starting real-time quality monitoring"),setInterval(()=>this.updateQualityMetrics(),6e4),setInterval(()=>this.checkCalibrationStatus(),18e5),setInterval(()=>this.generateHourlyQualityReport(),36e5)}async getStationOperationalStatus(e){const t=["active","idle","maintenance","calibration"],a=[.6,.25,.1,.05];return this.weightedRandomChoice(t,a)}async calculateStationQualityScore(e){return Math.round((85+Math.random()*12)*100)/100}async getCurrentBatchBeingTested(e){return{QC_STATION_01:{id:"BATCH_2025090801",product:"GABA Red 500mg",stage:"microbiological_testing"},QC_STATION_02:{id:"BATCH_2025090802",product:"Whey Protein Vanilla",stage:"potency_analysis"},QC_STATION_03:{id:"BATCH_2025090803",product:"Omega-3 Liquid",stage:"physical_testing"},QC_STATION_04:{id:"BATCH_2025090804",product:"Vitamin D3 Capsules",stage:"packaging_inspection"}}[e]||null}weightedRandomChoice(e,t){const a=Math.random();let i=0;for(let n=0;n<t.length;n++)if(i+=t[n],a<=i)return e[n];return e[0]}delay(e){return new Promise(t=>setTimeout(t,e))}async getTestsCompletedToday(e){return Math.floor(Math.random()*100)+5}async calculatePassRate(e){return Math.round((92+Math.random()*6)*100)/100}async getStationInstruments(e){return[]}async getCalibrationStatus(e){return"current"}async getActiveTests(e){return[]}async getStationAlerts(e){return[]}async getRecentTestResults(e){return[]}async getComplianceAlerts(){return[]}async validateBatchData(e){return!0}async getRequiredQualityChecks(e){return[]}async getComplianceRequirements(e){return[]}async assignToTestingStation(e){return"QC_STATION_01"}async initiateTestingProcess(e,t){}async validateTestData(e){return!0}async evaluateTestResult(e){return e.result>=e.specification?.min&&e.result<=e.specification?.max}async updateBatchWithTestResult(e,t){}async checkBatchTestingCompletion(e){}async checkQualityAlerts(e){}async calculateAverageTestTime(e){return 45}async calculateStationUtilization(e){return 78}async getRecentFailures(e){return[]}async getQualityTrendData(e){return[]}async checkCalibrationCurrency(){return!0}async getComplianceViolations(){return[]}async getCorrectiveActions(){return[]}async updateQualityMetrics(){}async checkCalibrationStatus(){}async generateHourlyQualityReport(){}}const St=new Be,wt=()=>{const[s,e]=D.useState(!1),[t,a]=D.useState("disconnected"),[i,n]=D.useState(null),[r,o]=D.useState([]),[c,l]=D.useState(null),u="https://sentia-manufacturing-mcp.onrender.com",f="sentia-mcp-secret",v=D.useCallback(async()=>{try{const g=await fetch(`${u}/health`,{method:"GET",headers:{"Content-Type":"application/json"}});if(g.ok){const w=await g.json();return n(w),a("connected"),e(!0),l(null),y("MCP server health check successful",{health:w}),w}else throw new Error(`Health check failed: ${g.status}`)}catch(g){return C("MCP server health check failed",g),a("disconnected"),e(!1),l(g.message),null}},[u]),S=D.useCallback(async()=>{try{const g=await fetch(`${u}/mcp/tools`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`}});if(g.ok){const w=await g.json();return o(w.tools||[]),y("MCP tools retrieved successfully",{toolCount:w.tools?.length||0}),w.tools||[]}else throw new Error(`Failed to get tools: ${g.status}`)}catch(g){return C("Failed to get MCP tools",g),o([]),[]}},[u,f]),b=D.useCallback(async(g,w={})=>{try{y("Executing MCP tool",{toolName:g,parameters:w});const A=await fetch(`${u}/mcp/execute`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({tool:g,parameters:w})});if(A.ok){const O=await A.json();return y("MCP tool executed successfully",{toolName:g,result:O}),O}else{const O=await A.json();throw new Error(O.error||`Tool execution failed: ${A.status}`)}}catch(A){throw C("MCP tool execution failed",{toolName:g,error:A.message}),A}},[u,f]),T=D.useCallback(async(g={})=>{const w={horizon:30,confidence:.95,seasonality:!0,...g};try{return await b("demand_forecast",w)}catch(A){return j("Demand forecast failed, using fallback",A),{forecast:{predictions:Array.from({length:30},(O,G)=>({date:new Date(Date.now()+G*24*60*60*1e3).toISOString().split("T")[0],value:1e3+Math.random()*500,confidence:.85+Math.random()*.1})),accuracy:.87,trend:"increasing"},insights:[{type:"trend",message:"Demand showing upward trend with 87% confidence",impact:"positive"}]}}},[b]),k=D.useCallback(async(g={})=>{const w={timeHorizon:7,resourceConstraints:!0,qualityTargets:!0,...g};try{return await b("production_optimization",w)}catch(A){return j("Production optimization failed, using fallback",A),{optimization:{efficiency:.94,recommendations:[{action:"Increase Line 2 capacity",impact:"+12% throughput",cost:5e3},{action:"Optimize shift scheduling",impact:"+8% efficiency",cost:0}]},metrics:{currentEfficiency:.87,projectedEfficiency:.94,costSavings:15e3}}}},[b]),M=D.useCallback(async(g={})=>{const w={predictionHorizon:24,includeRiskFactors:!0,...g};try{return await b("quality_prediction",w)}catch(A){return j("Quality prediction failed, using fallback",A),{predictions:[{time:new Date().toISOString(),qualityScore:.92,riskLevel:"low",factors:["temperature","humidity","operator_experience"]}],riskFactors:[{factor:"Temperature variance",risk:.15,recommendation:"Maintain ±2°C control"},{factor:"Operator fatigue",risk:.08,recommendation:"Implement rotation schedule"}]}}},[b]),I=D.useCallback(async(g={})=>{const w={optimizationPeriod:30,includeCarryingCosts:!0,demandUncertainty:!0,...g};try{return await b("inventory_optimization",w)}catch(A){return j("Inventory optimization failed, using fallback",A),{optimization:{currentInventoryValue:18e5,optimalInventoryValue:165e4,savings:15e4,recommendations:[{sku:"SKU-001",currentStock:1e3,optimalStock:750,reason:"High carrying cost"},{sku:"SKU-002",currentStock:500,optimalStock:800,reason:"Demand increase predicted"}]},metrics:{turnoverImprovement:.12,carryingCostReduction:.18,stockoutRiskReduction:.25}}}},[b]),N=D.useCallback(g=>{if(!s)return j("Cannot subscribe to real-time data: MCP server not connected"),null;try{const w=new EventSource(`${u}/mcp/stream`);return w.onmessage=A=>{try{const O=JSON.parse(A.data);g(O)}catch(O){C("Failed to parse real-time data",O)}},w.onerror=A=>{C("Real-time data stream error",A),w.close()},w}catch(w){return C("Failed to establish real-time data stream",w),null}},[s,u]);D.useEffect(()=>{(async()=>{y("Initializing MCP server connection"),await v()&&await S();const A=setInterval(v,3e4);return()=>{clearInterval(A)}})()},[v,S]);const _=D.useCallback(()=>{switch(t){case"connected":return{status:"connected",color:"green",message:"MCP Server Connected",icon:"✓"};case"connecting":return{status:"connecting",color:"yellow",message:"Connecting to MCP Server...",icon:"⟳"};case"disconnected":default:return{status:"disconnected",color:"red",message:c||"MCP Server Disconnected",icon:"✗"}}},[t,c]);return{isConnected:s,connectionStatus:t,serverHealth:i,error:c,availableTools:r,checkServerHealth:v,getAvailableTools:S,executeTool:b,runDemandForecast:T,optimizeProduction:k,predictQuality:M,optimizeInventory:I,subscribeToRealTimeData:N,getConnectionStatusInfo:_}};class Ue{constructor(){this.isInitialized=!1,this.suppliers=new Map,this.purchaseOrders=new Map,this.shipments=new Map,this.inventory=new Map,this.demandForecasts=new Map,this.riskAssessments=new Map,this.performanceMetrics=new Map}async initialize(){if(!this.isInitialized)try{await this.setupSupplierDatabase(),await this.initializePurchaseOrders(),await this.setupInventoryTracking(),await this.calculateRiskAssessments(),await this.generatePerformanceMetrics(),this.isInitialized=!0,console.log("Supply Chain Service initialized successfully")}catch(e){throw console.error("Failed to initialize Supply Chain Service:",e),e}}async setupSupplierDatabase(){[{id:"SUP_001",name:"Premium Raw Materials Ltd",category:"Raw Materials",location:"Melbourne, Australia",status:"active",rating:4.8,tier:"strategic",leadTime:7,minimumOrder:1e3,paymentTerms:"Net 30",qualityCertifications:["ISO 9001","HACCP","Organic"],sustainabilityScore:92,riskLevel:"low",contact:{name:"Sarah Mitchell",email:"sarah@premiumraw.com.au",phone:"+61 3 9123 4567"},products:[{id:"RM_001",name:"Premium Base Spirit",unitPrice:45.5,currency:"AUD"},{id:"RM_002",name:"Botanical Extract Blend",unitPrice:125,currency:"AUD"},{id:"RM_003",name:"Natural Flavoring",unitPrice:89.75,currency:"AUD"}],performance:{onTimeDelivery:96.5,qualityRating:4.9,priceCompetitiveness:4.2,responsiveness:4.7}},{id:"SUP_002",name:"Australian Packaging Solutions",category:"Packaging",location:"Sydney, Australia",status:"active",rating:4.6,tier:"preferred",leadTime:14,minimumOrder:5e3,paymentTerms:"Net 45",qualityCertifications:["FSC","BRC"],sustainabilityScore:88,riskLevel:"low",contact:{name:"James Thompson",email:"james@auspack.com.au",phone:"+61 2 8765 4321"},products:[{id:"PKG_001",name:"Premium Glass Bottles",unitPrice:2.45,currency:"AUD"},{id:"PKG_002",name:"Custom Labels",unitPrice:.35,currency:"AUD"},{id:"PKG_003",name:"Cork Stoppers",unitPrice:1.25,currency:"AUD"}],performance:{onTimeDelivery:94.2,qualityRating:4.8,priceCompetitiveness:4.5,responsiveness:4.3}},{id:"SUP_003",name:"Global Logistics Partners",category:"Logistics",location:"Brisbane, Australia",status:"active",rating:4.4,tier:"approved",leadTime:3,minimumOrder:1,paymentTerms:"Net 15",qualityCertifications:["ISO 14001"],sustainabilityScore:75,riskLevel:"medium",contact:{name:"Maria Santos",email:"maria@globallogistics.com.au",phone:"+61 7 3456 7890"},products:[{id:"LOG_001",name:"Domestic Shipping",unitPrice:25,currency:"AUD"},{id:"LOG_002",name:"Express Delivery",unitPrice:45,currency:"AUD"},{id:"LOG_003",name:"International Freight",unitPrice:150,currency:"AUD"}],performance:{onTimeDelivery:91.8,qualityRating:4.2,priceCompetitiveness:4.6,responsiveness:4.5}},{id:"SUP_004",name:"Equipment Maintenance Co",category:"Services",location:"Adelaide, Australia",status:"active",rating:4.7,tier:"strategic",leadTime:2,minimumOrder:1,paymentTerms:"Net 30",qualityCertifications:["ISO 45001"],sustainabilityScore:82,riskLevel:"low",contact:{name:"David Wilson",email:"david@equipmentmaint.com.au",phone:"+61 8 8234 5678"},products:[{id:"SRV_001",name:"Preventive Maintenance",unitPrice:250,currency:"AUD"},{id:"SRV_002",name:"Emergency Repair",unitPrice:450,currency:"AUD"},{id:"SRV_003",name:"Equipment Calibration",unitPrice:175,currency:"AUD"}],performance:{onTimeDelivery:98.1,qualityRating:4.9,priceCompetitiveness:3.8,responsiveness:4.8}}].forEach(t=>{this.suppliers.set(t.id,t)})}async initializePurchaseOrders(){[{id:"PO_2024_001",supplierId:"SUP_001",supplierName:"Premium Raw Materials Ltd",orderDate:new Date("2024-01-15").toISOString(),expectedDelivery:new Date("2024-01-22").toISOString(),status:"delivered",priority:"high",totalAmount:12750,currency:"AUD",items:[{productId:"RM_001",quantity:200,unitPrice:45.5,totalPrice:9100},{productId:"RM_002",quantity:20,unitPrice:125,totalPrice:2500},{productId:"RM_003",quantity:15,unitPrice:89.75,totalPrice:1346.25}],deliveryAddress:"Sentia Manufacturing Facility, Melbourne",paymentStatus:"paid",qualityCheck:"passed"},{id:"PO_2024_002",supplierId:"SUP_002",supplierName:"Australian Packaging Solutions",orderDate:new Date("2024-01-20").toISOString(),expectedDelivery:new Date("2024-02-03").toISOString(),status:"in_transit",priority:"medium",totalAmount:18950,currency:"AUD",items:[{productId:"PKG_001",quantity:5e3,unitPrice:2.45,totalPrice:12250},{productId:"PKG_002",quantity:5e3,unitPrice:.35,totalPrice:1750},{productId:"PKG_003",quantity:5e3,unitPrice:1.25,totalPrice:6250}],deliveryAddress:"Sentia Manufacturing Facility, Melbourne",paymentStatus:"pending",qualityCheck:"pending"},{id:"PO_2024_003",supplierId:"SUP_004",supplierName:"Equipment Maintenance Co",orderDate:new Date("2024-01-25").toISOString(),expectedDelivery:new Date("2024-01-27").toISOString(),status:"confirmed",priority:"high",totalAmount:1750,currency:"AUD",items:[{productId:"SRV_001",quantity:4,unitPrice:250,totalPrice:1e3},{productId:"SRV_003",quantity:3,unitPrice:175,totalPrice:525},{productId:"SRV_002",quantity:1,unitPrice:450,totalPrice:450}],deliveryAddress:"Sentia Manufacturing Facility, Melbourne",paymentStatus:"approved",qualityCheck:"n/a"}].forEach(t=>{this.purchaseOrders.set(t.id,t)})}async setupInventoryTracking(){[{id:"INV_001",productId:"RM_001",productName:"Premium Base Spirit",category:"Raw Materials",supplierId:"SUP_001",currentStock:450,unit:"liters",reorderPoint:200,maxStock:1e3,averageDailyUsage:15.5,leadTime:7,lastOrderDate:new Date("2024-01-15").toISOString(),unitCost:45.5,stockValue:20475,expiryDate:new Date("2024-12-31").toISOString(),location:"Warehouse A - Section 1",batchNumber:"RM001-240115"},{id:"INV_002",productId:"PKG_001",productName:"Premium Glass Bottles",category:"Packaging",supplierId:"SUP_002",currentStock:12500,unit:"pieces",reorderPoint:5e3,maxStock:25e3,averageDailyUsage:85,leadTime:14,lastOrderDate:new Date("2024-01-20").toISOString(),unitCost:2.45,stockValue:30625,expiryDate:null,location:"Warehouse B - Section 3",batchNumber:"PKG001-240120"},{id:"INV_003",productId:"RM_002",productName:"Botanical Extract Blend",category:"Raw Materials",supplierId:"SUP_001",currentStock:75,unit:"kg",reorderPoint:50,maxStock:200,averageDailyUsage:3.2,leadTime:7,lastOrderDate:new Date("2024-01-15").toISOString(),unitCost:125,stockValue:9375,expiryDate:new Date("2025-01-15").toISOString(),location:"Warehouse A - Section 2",batchNumber:"RM002-240115"}].forEach(t=>{this.inventory.set(t.id,t)})}async calculateRiskAssessments(){Array.from(this.suppliers.values()).forEach(t=>{const a={geographic:this.assessGeographicRisk(t.location),financial:this.assessFinancialRisk(t.rating),operational:this.assessOperationalRisk(t.performance),supply:this.assessSupplyRisk(t.leadTime,t.tier),quality:this.assessQualityRisk(t.qualityCertifications),sustainability:this.assessSustainabilityRisk(t.sustainabilityScore)},i=this.calculateOverallRisk(a);this.riskAssessments.set(t.id,{supplierId:t.id,supplierName:t.name,overallRisk:i,riskLevel:this.categorizeRisk(i),riskFactors:a,mitigation:this.generateMitigationStrategies(a),lastAssessment:new Date().toISOString(),nextReview:new Date(Date.now()+2160*60*60*1e3).toISOString()})})}assessGeographicRisk(e){return e.includes("Australia")?2:e.includes("New Zealand")?3:6}assessFinancialRisk(e){return e>=4.5?1:e>=4?2:e>=3.5?4:7}assessOperationalRisk(e){const t=(e.onTimeDelivery+e.qualityRating*20+e.responsiveness*20)/3;return t>=90?1:t>=80?3:t>=70?5:8}assessSupplyRisk(e,t){let a=e>14?5:e>7?3:1;return t==="strategic"&&(a=Math.max(1,a-1)),t==="approved"&&(a=Math.min(8,a+1)),a}assessQualityRisk(e){const t=e.length;return t>=3?1:t>=2?2:t>=1?4:7}assessSustainabilityRisk(e){return e>=90?1:e>=80?2:e>=70?4:6}calculateOverallRisk(e){const t={geographic:.15,financial:.25,operational:.25,supply:.2,quality:.1,sustainability:.05};return Object.entries(e).reduce((a,[i,n])=>a+n*t[i],0)}categorizeRisk(e){return e<=2?"low":e<=4?"medium":e<=6?"high":"critical"}generateMitigationStrategies(e){const t=[];return e.geographic>4&&t.push("Develop local supplier alternatives"),e.financial>4&&t.push("Implement supplier financial monitoring"),e.operational>4&&t.push("Establish performance improvement plans"),e.supply>4&&t.push("Increase safety stock levels"),e.quality>4&&t.push("Implement additional quality audits"),e.sustainability>4&&t.push("Develop sustainability improvement program"),t}async generatePerformanceMetrics(){const e=Array.from(this.suppliers.values()),t=Array.from(this.purchaseOrders.values()),a={totalSuppliers:e.length,activeSuppliers:e.filter(i=>i.status==="active").length,strategicSuppliers:e.filter(i=>i.tier==="strategic").length,averageRating:e.reduce((i,n)=>i+n.rating,0)/e.length,averageLeadTime:e.reduce((i,n)=>i+n.leadTime,0)/e.length,totalSpend:t.reduce((i,n)=>i+n.totalAmount,0),averageOrderValue:t.reduce((i,n)=>i+n.totalAmount,0)/t.length,onTimeDeliveryRate:e.reduce((i,n)=>i+n.performance.onTimeDelivery,0)/e.length,qualityScore:e.reduce((i,n)=>i+n.performance.qualityRating,0)/e.length,sustainabilityScore:e.reduce((i,n)=>i+n.sustainabilityScore,0)/e.length};this.performanceMetrics.set("overall",{...a,lastUpdated:new Date().toISOString()})}async getSupplyChainDashboard(){this.isInitialized||await this.initialize();const e=Array.from(this.suppliers.values()),t=Array.from(this.purchaseOrders.values()),a=Array.from(this.inventory.values()),i=Array.from(this.riskAssessments.values()),n=this.performanceMetrics.get("overall"),r=a.filter(l=>l.currentStock<=l.reorderPoint),o=i.filter(l=>l.riskLevel==="critical"),c=t.filter(l=>["pending","confirmed","in_transit"].includes(l.status));return{timestamp:new Date().toISOString(),summary:{...n,alerts:{lowStock:r.length,criticalRisks:o.length,pendingOrders:c.length,overdueDeliveries:t.filter(l=>new Date(l.expectedDelivery)<new Date&&l.status!=="delivered").length}},suppliers:e.slice(0,5),purchaseOrders:t.slice(0,10),inventory:a.slice(0,8),risks:i.slice(0,5),recommendations:this.generateSupplyChainRecommendations(r,o,c)}}generateSupplyChainRecommendations(e,t,a){const i=[];return e.forEach(n=>{i.push({type:"urgent",category:"Inventory",title:"Low Stock Alert",description:`${n.productName} stock is below reorder point`,impact:"High",action:`Reorder ${n.reorderPoint*2-n.currentStock} units immediately`,dueDate:new Date(Date.now()+1440*60*1e3).toISOString()})}),t.forEach(n=>{i.push({type:"warning",category:"Risk Management",title:"Critical Supplier Risk",description:`${n.supplierName} has critical risk level`,impact:"High",action:n.mitigation[0]||"Develop alternative supplier",dueDate:new Date(Date.now()+10080*60*1e3).toISOString()})}),a.length>0&&i.push({type:"info",category:"Order Management",title:"Pending Order Follow-up",description:`${a.length} purchase orders require follow-up`,impact:"Medium",action:"Contact suppliers for delivery status updates",dueDate:new Date(Date.now()+4320*60*1e3).toISOString()}),i}async getSupplierDetails(e){const t=this.suppliers.get(e),a=this.riskAssessments.get(e),i=Array.from(this.purchaseOrders.values()).filter(n=>n.supplierId===e);if(!t)throw new Error(`Supplier ${e} not found`);return{supplier:t,riskAssessment:a,orderHistory:i,performanceTrend:this.calculatePerformanceTrend(e),recommendations:this.getSupplierRecommendations(t,a)}}calculatePerformanceTrend(e){const a=[],i=this.suppliers.get(e)?.performance||{};for(let n=6;n>=0;n--){const r=new Date;r.setMonth(r.getMonth()-n),a.push({month:r.toLocaleDateString("en-AU",{year:"numeric",month:"short"}),onTimeDelivery:i.onTimeDelivery+.5*10,qualityRating:i.qualityRating+.5*.8,responsiveness:i.responsiveness+.5*.6})}return a}getSupplierRecommendations(e,t){const a=[];return e.performance.onTimeDelivery<95&&a.push("Implement delivery performance improvement plan"),(t?.riskLevel==="high"||t?.riskLevel==="critical")&&a.push("Develop backup supplier for critical items"),e.sustainabilityScore<80&&a.push("Collaborate on sustainability improvement initiatives"),a}}const bt=new Ue;class qe{constructor(){this.isInitialized=!1,this.analyticsData=new Map,this.oeeCalculations=new Map,this.varianceData=new Map,this.performanceMetrics=new Map,this.historicalData=[]}async initialize(){if(!this.isInitialized)try{await this.setupBaselineData(),await this.calculateInitialMetrics(),this.isInitialized=!0,console.log("Manufacturing Analytics Service initialized successfully")}catch(e){throw console.error("Failed to initialize Manufacturing Analytics Service:",e),e}}async setupBaselineData(){throw new Error("Real API connection required - Manufacturing analytics must be sourced from actual production data systems, SCADA, and IoT sensors")}async generateHistoricalData(){throw new Error("Real API connection required - Historical manufacturing data must be retrieved from production databases and data historians")}async calculateInitialMetrics(){throw new Error("Real API connection required - Manufacturing metrics must be calculated from actual production line data")}calculateOEE(e){const t=e.actualRunTime/e.plannedProductionTime*100,a=e.totalProduced*e.idealCycleTime/e.actualRunTime*100,i=e.qualityUnits/e.totalProduced*100,n=t*a*i/1e4;return{stationId:e.id,stationName:e.name,availability:Math.round(t*10)/10,performance:Math.round(a*10)/10,quality:Math.round(i*10)/10,oee:Math.round(n*10)/10,benchmarks:{worldClass:85,good:70,fair:60},classification:this.classifyOEE(n),losses:{availabilityLoss:(100-t)*(a/100)*(i/100),performanceLoss:t*(100-a)*(i/100)/100,qualityLoss:t*a*(100-i)/1e4}}}classifyOEE(e){return e>=85?"World Class":e>=70?"Good":e>=60?"Fair":"Needs Improvement"}calculateVarianceAnalysis(e){const t=Math.floor(e.plannedProductionTime/e.idealCycleTime),a=e.totalProduced,i=a-t,n=i/t*100,r=90,o=e.efficiency-r,c=30,l=e.downtime.planned+e.downtime.unplanned,u=l-c;return{stationId:e.id,stationName:e.name,production:{planned:t,actual:a,variance:i,variancePercent:Math.round(n*10)/10,status:i>=0?"favorable":"unfavorable"},efficiency:{planned:r,actual:e.efficiency,variance:Math.round(o*10)/10,status:o>=0?"favorable":"unfavorable"},downtime:{planned:c,actual:l,variance:u,status:u<=0?"favorable":"unfavorable"},quality:{planned:98,actual:e.qualityUnits/e.totalProduced*100,variance:e.qualityUnits/e.totalProduced*100-98,status:e.qualityUnits/e.totalProduced*100>=98?"favorable":"unfavorable"}}}calculatePerformanceMetrics(e){return{stationId:e.id,stationName:e.name,productivity:{unitsPerHour:Math.round(e.totalProduced/(e.actualRunTime/60)*10)/10,unitsPerMinute:Math.round(e.totalProduced/e.actualRunTime*10)/10,cycleTime:Math.round(e.actualRunTime/e.totalProduced*10)/10,idealCycleTime:e.idealCycleTime,cycleTimeVariance:Math.round((e.actualRunTime/e.totalProduced-e.idealCycleTime)*10)/10},utilization:{timeUtilization:Math.round(e.actualRunTime/e.plannedProductionTime*1e3)/10,equipmentEffectiveness:Math.round(e.oee*10)/10,capacityUtilization:Math.round(e.totalProduced/(e.plannedProductionTime/e.idealCycleTime)*1e3)/10},quality:{yieldRate:Math.round(e.qualityUnits/e.totalProduced*1e3)/10,defectRate:Math.round((e.totalProduced-e.qualityUnits)/e.totalProduced*1e3)/10,firstPassYield:Math.round(e.qualityUnits/e.totalProduced*1e3)/10}}}async getAnalyticsDashboard(){throw new Error("Real API connection required - Manufacturing analytics dashboard must integrate with actual production systems and real-time data feeds")}getTrendAnalysis(){const e=new Date;e.setDate(e.getDate()-7);const t=this.historicalData.filter(n=>new Date(n.timestamp)>=e),a=[...new Set(t.map(n=>n.stationId))],i={};return a.forEach(n=>{const r=t.filter(u=>u.stationId===n),o=r[0]?.stationName||n,c=r.map(u=>u.oee),l=this.calculateTrend(c);i[n]={stationName:o,oee:{current:c[c.length-1]||0,trend:l>.1?"improving":l<-.1?"declining":"stable",change:Math.round(l*100)/100},availability:{current:r[r.length-1]?.availability||0,trend:this.calculateTrend(r.map(u=>u.availability))>0?"improving":"stable"},performance:{current:r[r.length-1]?.performance||0,trend:this.calculateTrend(r.map(u=>u.performance))>0?"improving":"stable"}}}),i}calculateTrend(e){if(e.length<2)return 0;const t=e.length,a=t*(t-1)/2,i=e.reduce((c,l)=>c+l,0),n=e.reduce((c,l,u)=>c+l*u,0),r=t*(t-1)*(2*t-1)/6;return(t*n-a*i)/(t*r-a*a)}generateRecommendations(e,t){const a=[];return e.forEach(i=>{i.oee<70&&a.push({type:"critical",stationId:i.stationId,stationName:i.stationName,category:"OEE",title:"Low OEE Performance",description:`OEE of ${i.oee}% is below industry standard`,impact:"High",actions:["Investigate root causes of downtime","Review maintenance schedules","Analyze quality issues"]}),i.availability<85&&a.push({type:"warning",stationId:i.stationId,stationName:i.stationName,category:"Availability",title:"Low Equipment Availability",description:`Availability of ${i.availability}% indicates excessive downtime`,impact:"Medium",actions:["Implement preventive maintenance","Reduce setup times","Minimize unplanned stops"]}),i.performance<80&&a.push({type:"warning",stationId:i.stationId,stationName:i.stationName,category:"Performance",title:"Performance Below Target",description:`Performance efficiency of ${i.performance}% needs improvement`,impact:"Medium",actions:["Optimize cycle times","Reduce minor stops","Improve operator training"]})}),a}async getHistoricalAnalytics(e=30){throw new Error("Real API connection required - Historical analytics must query actual production databases and time-series data")}async getStationAnalytics(e){throw new Error("Real API connection required - Station analytics must be retrieved from actual SCADA systems and production line monitoring")}}const Dt=new qe;class Ct{constructor(){this.supportedDataTypes=["financial_metrics","cash_flow_transactions","receivables_aging","payables_schedule","inventory_data","sales_forecast","expense_budget","customer_data","supplier_data","seasonal_patterns","industry_benchmarks","growth_scenarios"],this.validationSchemas=this.initializeValidationSchemas(),this.csvTemplates=this.initializeCSVTemplates()}initializeValidationSchemas(){return{financial_metrics:x({date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),revenue:d().min(0,"Revenue must be positive"),gross_profit:d().min(0,"Gross profit must be positive"),operating_expenses:d().min(0,"Operating expenses must be positive"),ebitda:d(),net_income:d(),cash_balance:d().min(0,"Cash balance must be positive"),accounts_receivable:d().min(0,"AR must be positive"),accounts_payable:d().min(0,"AP must be positive"),inventory:d().min(0,"Inventory must be positive"),working_capital:d(),employee_count:d().int().min(1,"Employee count must be at least 1").optional()}),cash_flow_transactions:x({date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid date format"),transaction_id:h().min(1,"Transaction ID required"),type:L(["inflow","outflow"],"Type must be inflow or outflow"),category:L(["revenue","expense","receivable_collection","payable_payment","investment","financing"],"Invalid category"),amount:d().min(0,"Amount must be positive"),description:h().min(1,"Description required"),customer_supplier:h().optional(),payment_method:h().optional(),reference:h().optional()}),receivables_aging:x({customer_id:h().min(1,"Customer ID required"),customer_name:h().min(1,"Customer name required"),invoice_number:h().min(1,"Invoice number required"),invoice_date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid invoice date"),due_date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid due date"),amount:d().min(0,"Amount must be positive"),outstanding_amount:d().min(0,"Outstanding amount must be positive"),days_outstanding:d().int().min(0,"Days outstanding must be non-negative"),aging_bucket:L(["current","1-30","31-60","61-90","90+"],"Invalid aging bucket"),payment_terms:h().optional(),credit_limit:d().min(0).optional()}),payables_schedule:x({supplier_id:h().min(1,"Supplier ID required"),supplier_name:h().min(1,"Supplier name required"),invoice_number:h().min(1,"Invoice number required"),invoice_date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid invoice date"),due_date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid due date"),amount:d().min(0,"Amount must be positive"),outstanding_amount:d().min(0,"Outstanding amount must be positive"),payment_terms:h().min(1,"Payment terms required"),priority:L(["high","medium","low"],"Invalid priority"),category:L(["raw_materials","services","utilities","rent","other"],"Invalid category"),early_payment_discount:d().min(0).max(100).optional()}),inventory_data:x({sku:h().min(1,"SKU required"),product_name:h().min(1,"Product name required"),category:h().min(1,"Category required"),current_stock:d().int().min(0,"Current stock must be non-negative"),unit_cost:d().min(0,"Unit cost must be positive"),selling_price:d().min(0,"Selling price must be positive"),reorder_point:d().int().min(0,"Reorder point must be non-negative"),lead_time_days:d().int().min(0,"Lead time must be non-negative"),annual_demand:d().int().min(0,"Annual demand must be non-negative"),supplier:h().optional(),last_order_date:h().refine(e=>!isNaN(Date.parse(e)),"Invalid last order date").optional()}),sales_forecast:x({period:h().min(1,"Period required (e.g., 2024-Q1, 2024-01)"),product_category:h().min(1,"Product category required"),forecasted_revenue:d().min(0,"Forecasted revenue must be positive"),forecasted_units:d().int().min(0,"Forecasted units must be non-negative"),confidence_level:L(["high","medium","low"],"Invalid confidence level"),seasonality_factor:d().min(0,"Seasonality factor must be positive").optional(),growth_rate:d().optional(),market_conditions:h().optional(),assumptions:h().optional()}),expense_budget:x({period:h().min(1,"Period required"),expense_category:h().min(1,"Expense category required"),budgeted_amount:d().min(0,"Budgeted amount must be positive"),actual_amount:d().min(0,"Actual amount must be positive").optional(),variance:d().optional(),payment_timing:L(["monthly","quarterly","annually","one-time"],"Invalid payment timing"),fixed_variable:L(["fixed","variable","semi-variable"],"Invalid expense type"),department:h().optional(),approval_required:fe().optional()}),customer_data:x({customer_id:h().min(1,"Customer ID required"),customer_name:h().min(1,"Customer name required"),industry:h().min(1,"Industry required"),annual_revenue:d().min(0,"Annual revenue must be positive"),credit_rating:L(["AAA","AA","A","BBB","BB","B","CCC","CC","C","D"],"Invalid credit rating").optional(),payment_terms:h().min(1,"Payment terms required"),average_order_value:d().min(0,"AOV must be positive"),order_frequency:h().min(1,"Order frequency required"),ltv:d().min(0,"LTV must be positive").optional(),acquisition_cost:d().min(0,"Acquisition cost must be positive").optional(),region:h().optional()}),supplier_data:x({supplier_id:h().min(1,"Supplier ID required"),supplier_name:h().min(1,"Supplier name required"),category:h().min(1,"Category required"),payment_terms:h().min(1,"Payment terms required"),lead_time_days:d().int().min(0,"Lead time must be non-negative"),reliability_score:d().min(0).max(100,"Reliability score must be 0-100"),annual_spend:d().min(0,"Annual spend must be positive"),early_payment_discount:d().min(0).max(100).optional(),strategic_importance:L(["critical","important","standard"],"Invalid strategic importance"),backup_supplier:h().optional(),location:h().optional()}),seasonal_patterns:x({month:d().int().min(1).max(12,"Month must be 1-12"),revenue_multiplier:d().min(0,"Revenue multiplier must be positive"),expense_multiplier:d().min(0,"Expense multiplier must be positive"),cash_flow_multiplier:d().min(0,"Cash flow multiplier must be positive"),inventory_multiplier:d().min(0,"Inventory multiplier must be positive"),description:h().optional(),historical_data_years:d().int().min(1,"Historical years must be at least 1").optional()}),industry_benchmarks:x({industry:h().min(1,"Industry required"),metric_name:h().min(1,"Metric name required"),metric_value:d(),percentile_25:d().optional(),percentile_50:d().optional(),percentile_75:d().optional(),best_in_class:d().optional(),unit:h().min(1,"Unit required"),data_source:h().optional(),last_updated:h().refine(e=>!isNaN(Date.parse(e)),"Invalid date").optional()}),growth_scenarios:x({scenario_name:h().min(1,"Scenario name required"),growth_rate:d(),timeframe_months:d().int().min(1,"Timeframe must be at least 1 month"),revenue_impact:d(),cost_impact:d(),working_capital_impact:d(),funding_required:d().min(0,"Funding required must be positive"),probability:d().min(0).max(100,"Probability must be 0-100"),key_assumptions:h().optional(),risk_factors:h().optional()})}}initializeCSVTemplates(){return{financial_metrics:{filename:"financial_metrics_template.csv",headers:["date","revenue","gross_profit","operating_expenses","ebitda","net_income","cash_balance","accounts_receivable","accounts_payable","inventory","working_capital","employee_count"],sampleData:[["2024-01-31","500000","200000","150000","50000","30000","100000","80000","60000","120000","140000","25"],["2024-02-29","520000","210000","155000","55000","35000","135000","85000","65000","125000","145000","25"],["2024-03-31","480000","190000","148000","42000","25000","160000","75000","58000","115000","132000","26"]],description:"Monthly financial metrics including revenue, expenses, cash position, and working capital components"},cash_flow_transactions:{filename:"cash_flow_transactions_template.csv",headers:["date","transaction_id","type","category","amount","description","customer_supplier","payment_method","reference"],sampleData:[["2024-01-15","TXN001","inflow","revenue","25000","Product sales","Customer ABC Ltd","Bank Transfer","INV-001"],["2024-01-16","TXN002","outflow","expense","5000","Raw materials","Supplier XYZ","Credit Card","PO-001"],["2024-01-17","TXN003","inflow","receivable_collection","15000","Invoice payment","Customer DEF Ltd","Check","INV-002"]],description:"Individual cash flow transactions for detailed cash flow analysis"},receivables_aging:{filename:"receivables_aging_template.csv",headers:["customer_id","customer_name","invoice_number","invoice_date","due_date","amount","outstanding_amount","days_outstanding","aging_bucket","payment_terms","credit_limit"],sampleData:[["CUST001","ABC Manufacturing Ltd","INV-001","2024-01-01","2024-01-31","10000","10000","45","31-60","Net 30","50000"],["CUST002","XYZ Retail Corp","INV-002","2024-01-15","2024-02-14","15000","7500","20","1-30","Net 30","75000"],["CUST003","DEF Services Ltd","INV-003","2023-12-01","2023-12-31","8000","8000","75","61-90","Net 30","25000"]],description:"Outstanding receivables with aging analysis for DSO optimization"},payables_schedule:{filename:"payables_schedule_template.csv",headers:["supplier_id","supplier_name","invoice_number","invoice_date","due_date","amount","outstanding_amount","payment_terms","priority","category","early_payment_discount"],sampleData:[["SUPP001","Raw Materials Inc","SUPP-001","2024-01-01","2024-02-01","12000","12000","Net 30","high","raw_materials","2"],["SUPP002","Office Supplies Ltd","SUPP-002","2024-01-15","2024-02-15","3000","3000","Net 30","low","services","0"],["SUPP003","Utilities Company","SUPP-003","2024-01-20","2024-02-20","5000","5000","Net 30","medium","utilities","0"]],description:"Outstanding payables schedule for DPO optimization and cash flow planning"},inventory_data:{filename:"inventory_data_template.csv",headers:["sku","product_name","category","current_stock","unit_cost","selling_price","reorder_point","lead_time_days","annual_demand","supplier","last_order_date"],sampleData:[["SKU001","Product A","Category 1","500","10.50","25.00","100","14","2400","Supplier ABC","2024-01-01"],["SKU002","Product B","Category 1","250","15.75","35.00","50","21","1200","Supplier XYZ","2024-01-10"],["SKU003","Product C","Category 2","750","8.25","20.00","150","7","3600","Supplier ABC","2024-01-15"]],description:"Inventory data for working capital optimization and demand planning"},sales_forecast:{filename:"sales_forecast_template.csv",headers:["period","product_category","forecasted_revenue","forecasted_units","confidence_level","seasonality_factor","growth_rate","market_conditions","assumptions"],sampleData:[["2024-Q2","Category 1","600000","2400","high","1.1","15","Stable","Based on historical trends"],["2024-Q3","Category 1","550000","2200","medium","0.9","10","Declining","Summer slowdown expected"],["2024-Q4","Category 2","750000","3000","high","1.3","25","Growing","Holiday season boost"]],description:"Sales forecasts for cash flow planning and working capital requirements"},expense_budget:{filename:"expense_budget_template.csv",headers:["period","expense_category","budgeted_amount","actual_amount","variance","payment_timing","fixed_variable","department","approval_required"],sampleData:[["2024-Q2","Salaries","150000","148000","-2000","monthly","fixed","All","false"],["2024-Q2","Raw Materials","200000","210000","10000","monthly","variable","Production","true"],["2024-Q2","Marketing","50000","45000","-5000","quarterly","semi-variable","Marketing","true"]],description:"Expense budgets and actuals for cash flow forecasting"},customer_data:{filename:"customer_data_template.csv",headers:["customer_id","customer_name","industry","annual_revenue","credit_rating","payment_terms","average_order_value","order_frequency","ltv","acquisition_cost","region"],sampleData:[["CUST001","ABC Manufacturing","Manufacturing","5000000","A","Net 30","25000","Monthly","300000","5000","UK"],["CUST002","XYZ Retail","Retail","2000000","BBB","Net 45","15000","Bi-weekly","180000","3000","EU"],["CUST003","DEF Services","Services","1000000","AA","Net 15","8000","Weekly","120000","2000","US"]],description:"Customer data for receivables analysis and credit risk assessment"},supplier_data:{filename:"supplier_data_template.csv",headers:["supplier_id","supplier_name","category","payment_terms","lead_time_days","reliability_score","annual_spend","early_payment_discount","strategic_importance","backup_supplier","location"],sampleData:[["SUPP001","Raw Materials Inc","Raw Materials","Net 30","14","95","500000","2","critical","SUPP004","UK"],["SUPP002","Packaging Ltd","Packaging","Net 45","7","88","150000","1.5","important","SUPP005","EU"],["SUPP003","Logistics Corp","Services","Net 60","1","92","200000","0","standard","","Global"]],description:"Supplier data for payables optimization and supply chain analysis"},seasonal_patterns:{filename:"seasonal_patterns_template.csv",headers:["month","revenue_multiplier","expense_multiplier","cash_flow_multiplier","inventory_multiplier","description","historical_data_years"],sampleData:[["1","0.8","1.0","0.7","1.2","Post-holiday slowdown","3"],["2","0.9","1.0","0.8","1.1","Winter period","3"],["3","1.1","1.0","1.2","1.0","Spring uptick","3"],["11","1.3","1.1","1.4","1.3","Holiday preparation","3"],["12","1.5","1.2","1.6","0.8","Holiday peak","3"]],description:"Seasonal patterns for accurate cash flow forecasting"},industry_benchmarks:{filename:"industry_benchmarks_template.csv",headers:["industry","metric_name","metric_value","percentile_25","percentile_50","percentile_75","best_in_class","unit","data_source","last_updated"],sampleData:[["Manufacturing","DSO","35","25","35","45","20","days","Industry Report","2024-01-01"],["Manufacturing","DPO","40","30","40","50","55","days","Industry Report","2024-01-01"],["Manufacturing","Inventory Turns","8","6","8","12","15","turns/year","Industry Report","2024-01-01"]],description:"Industry benchmarks for performance comparison and target setting"},growth_scenarios:{filename:"growth_scenarios_template.csv",headers:["scenario_name","growth_rate","timeframe_months","revenue_impact","cost_impact","working_capital_impact","funding_required","probability","key_assumptions","risk_factors"],sampleData:[["Conservative Growth","10","12","1000000","600000","150000","200000","80","Market stability","Economic downturn"],["Aggressive Growth","25","12","2500000","1800000","400000","600000","40","Market expansion","Competition, funding"],["Moderate Growth","15","12","1500000","1000000","200000","300000","70","Steady demand","Supply chain issues"]],description:"Growth scenarios for strategic planning and funding requirements"}}}generateCSVTemplate(e){if(!this.csvTemplates[e])throw new Error(`Unsupported data type: ${e}`);const t=this.csvTemplates[e],a=Y.unparse({fields:t.headers,data:t.sampleData});return{filename:t.filename,content:a,description:t.description,mimeType:"text/csv"}}async validateAndParseCSV(e,t){return new Promise((a,i)=>{if(!this.validationSchemas[t]){i(new Error(`Unsupported data type: ${t}`));return}Y.parse(e,{header:!0,skipEmptyLines:!0,transformHeader:n=>n.toLowerCase().replace(/\s+/g,"_"),complete:n=>{try{const o=ve(this.validationSchemas[t]).parse(n.data);a({success:!0,data:o,rowCount:o.length,errors:[],warnings:this.generateDataQualityWarnings(o,t)})}catch(r){const o=this.parseValidationErrors(r,n.data);a({success:!1,data:[],rowCount:n.data.length,errors:o,warnings:[]})}},error:n=>{i(new Error(`CSV parsing error: ${n.message}`))}})})}parseValidationErrors(e,t){const a=[];return e.errors&&e.errors.forEach(i=>{const n=i.path.join("."),r=parseInt(n.split(".")[0])+1,o=n.split(".")[1];a.push({row:r,field:o,value:i.received,message:i.message,code:i.code})}),a}generateDataQualityWarnings(e,t){const a=[];if(t==="financial_metrics"){const i=e.filter(n=>!n.employee_count).length;i>0&&a.push({type:"missing_optional_data",message:`${i} rows missing employee count - this data improves revenue per employee analysis`,impact:"medium",suggestion:"Consider adding employee count data for better benchmarking"})}if(t==="receivables_aging"){const i=e.filter(n=>!n.credit_limit).length;i>0&&a.push({type:"missing_optional_data",message:`${i} customers missing credit limits - this affects risk analysis`,impact:"medium",suggestion:"Add credit limits for better credit risk assessment"})}if(t==="cash_flow_transactions"){const i=e.filter(n=>new Date(n.date)>new Date).length;i>0&&a.push({type:"data_consistency",message:`${i} transactions have future dates`,impact:"high",suggestion:"Verify transaction dates are correct"})}return a}identifyMissingDataRequirements(e,t="comprehensive"){const a={comprehensive:["financial_metrics","cash_flow_transactions","receivables_aging","payables_schedule","inventory_data"],cash_flow_analysis:["financial_metrics","cash_flow_transactions","receivables_aging","payables_schedule"],working_capital_optimization:["financial_metrics","receivables_aging","payables_schedule","inventory_data"],growth_planning:["financial_metrics","sales_forecast","expense_budget","growth_scenarios"],benchmarking:["financial_metrics","industry_benchmarks","customer_data","supplier_data"]},i=a[t]||a.comprehensive,n=i.filter(r=>!e.includes(r));return{required:i,available:e,missing:n,completeness:(i.length-n.length)/i.length*100,recommendations:this.generateDataRecommendations(n,t)}}generateDataRecommendations(e,t){const a=[];return e.forEach(i=>{const n={dataType:i,priority:this.getDataTypePriority(i,t),impact:this.getDataTypeImpact(i,t),description:this.getDataTypeDescription(i),sources:this.getDataTypeSources(i),template:this.csvTemplates[i]?.filename};a.push(n)}),a.sort((i,n)=>{const r={critical:3,high:2,medium:1,low:0};return r[n.priority]-r[i.priority]})}getDataTypePriority(e,t){return{comprehensive:{financial_metrics:"critical",cash_flow_transactions:"high",receivables_aging:"high",payables_schedule:"high",inventory_data:"medium",sales_forecast:"medium",expense_budget:"medium",customer_data:"low",supplier_data:"low",seasonal_patterns:"low",industry_benchmarks:"low",growth_scenarios:"low"},cash_flow_analysis:{financial_metrics:"critical",cash_flow_transactions:"critical",receivables_aging:"high",payables_schedule:"high"},working_capital_optimization:{financial_metrics:"critical",receivables_aging:"critical",payables_schedule:"critical",inventory_data:"high"}}[t]?.[e]||"medium"}getDataTypeImpact(e,t){return{financial_metrics:"Essential for all financial analysis and benchmarking",cash_flow_transactions:"Critical for accurate cash flow forecasting and trend analysis",receivables_aging:"Required for DSO optimization and credit risk assessment",payables_schedule:"Needed for DPO optimization and cash flow timing",inventory_data:"Important for working capital optimization and demand planning",sales_forecast:"Enables growth planning and funding requirement calculations",expense_budget:"Supports cash flow forecasting and variance analysis",customer_data:"Enhances receivables analysis and credit risk assessment",supplier_data:"Improves payables optimization and supply chain analysis",seasonal_patterns:"Increases forecast accuracy for seasonal businesses",industry_benchmarks:"Provides context for performance evaluation",growth_scenarios:"Essential for strategic planning and funding decisions"}[e]||"Provides additional context for analysis"}getDataTypeDescription(e){return this.csvTemplates[e]?.description||"Additional data for enhanced analysis"}getDataTypeSources(e){return{financial_metrics:["Accounting system","ERP system","Financial statements","Management reports"],cash_flow_transactions:["Bank statements","Accounting system","Payment processors"],receivables_aging:["Accounting system","CRM system","Invoicing software"],payables_schedule:["Accounting system","ERP system","Supplier portals"],inventory_data:["Inventory management system","ERP system","Warehouse management"],sales_forecast:["CRM system","Sales team","Market research","Historical data"],expense_budget:["Budgeting software","Financial planning system","Department budgets"],customer_data:["CRM system","Sales database","Customer service system"],supplier_data:["Procurement system","ERP system","Supplier database"],seasonal_patterns:["Historical sales data","Industry reports","Market analysis"],industry_benchmarks:["Industry associations","Market research","Financial databases"],growth_scenarios:["Strategic planning","Market analysis","Financial modeling"]}[e]||["Manual entry","External sources"]}generateUserPrompts(e){const t=[];return e.recommendations.forEach(a=>{(a.priority==="critical"||a.priority==="high")&&t.push({type:"data_required",priority:a.priority,title:`${a.dataType.replace(/_/g," ").toUpperCase()} Data Required`,message:`To provide accurate ${a.dataType.replace(/_/g," ")} analysis, we need additional data.`,description:a.description,impact:a.impact,actions:[{type:"download_template",label:"Download CSV Template",filename:a.template},{type:"upload_data",label:"Upload Data File",acceptedFormats:[".csv"]},{type:"skip",label:"Skip for Now",warning:"Analysis accuracy will be reduced"}],sources:a.sources})}),t}getAllTemplates(){return Object.keys(this.csvTemplates).map(e=>({dataType:e,filename:this.csvTemplates[e].filename,description:this.csvTemplates[e].description,headers:this.csvTemplates[e].headers,sampleRowCount:this.csvTemplates[e].sampleData.length}))}validateDataCompleteness(e,t){const a=this.identifyMissingDataRequirements(Object.keys(e),t),i=a.completeness;let n="poor";return i>=90?n="excellent":i>=75?n="good":i>=50&&(n="fair"),{completenessScore:i,analysisQuality:n,canProceed:i>=50,requirements:a,recommendations:a.recommendations.filter(r=>r.priority==="critical"||r.priority==="high")}}}var Z={};class At{constructor(){this.mcpServerUrl=Z.MCP_SERVER_URL||"https://mcp-server-tkyu.onrender.com",this.apiKey=Z.MCP_API_KEY,this.initializeMCPConnection(),this.responseCache=new Map,this.cacheExpiry=1800*1e3}async initializeMCPConnection(){try{const e=await R.get(`${this.mcpServerUrl}/health`);console.log("MCP Server connected:",e.data),this.mcpConnected=!0}catch(e){console.warn("MCP Server connection failed:",e.message),this.mcpConnected=!1}}async analyzeWorkingCapitalWithMCP(e){const t=`wc-analysis-${JSON.stringify(e).slice(0,100)}`,a=this.getCachedResponse(t);if(a)return a;try{const n=(await R.post(`${this.mcpServerUrl}/ai/working-capital-analysis`,{data:e,analysisType:"comprehensive",includeForecasting:!0,includeBenchmarking:!0,includeOptimization:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data;return this.cacheResponse(t,n),n}catch(i){return console.error("MCP working capital analysis error:",i),this.getFallbackAnalysis(e)}}async getIndustryBenchmarksViaMCP(e){const{industry:t,revenue:a,employees:i,region:n,dataSource:r}=e,o=`benchmarks-${t}-${a}-${i}-${n}`,c=this.getCachedResponse(o);if(c)return c;try{const u=(await R.post(`${this.mcpServerUrl}/ai/industry-benchmarks`,{industry:t,revenue:a,employees:i,region:n,dataSource:r||"comprehensive",includeCompetitiveAnalysis:!0,includeOptimizationRecommendations:!0,outputFormat:"executive_summary"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data;return this.cacheResponse(o,u),u}catch(l){return console.error("MCP benchmarking error:",l),this.getFallbackBenchmarks(e)}}async generateCashFlowForecastMCP(e){const{historicalData:t,timeHorizon:a,scenarios:i,includeSeasonality:n}=e;try{return(await R.post(`${this.mcpServerUrl}/ai/cash-flow-forecast`,{historicalData:t,timeHorizon:a,scenarios:i,includeSeasonality:n,modelType:"ensemble",confidenceIntervals:!0,riskAssessment:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP cash flow forecast error:",r),this.getFallbackForecast(e)}}async generateExecutiveInsightsMCP(e){try{return(await R.post(`${this.mcpServerUrl}/ai/executive-insights`,{financialData:e.financialMetrics,workingCapitalData:e.workingCapital,benchmarkData:e.benchmarks,insightType:"board_ready",audience:"c_suite",includeActionItems:!0,includeRiskAssessment:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP executive insights error:",t),this.getFallbackInsights(e)}}async runScenarioAnalysisMCP(e){try{return(await R.post(`${this.mcpServerUrl}/ai/scenario-analysis`,{scenarios:e,analysisDepth:"comprehensive",includeRiskModeling:!0,includeSensitivityAnalysis:!0,outputFormat:"executive_dashboard"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP scenario analysis error:",t),this.getFallbackScenarioAnalysis(e)}}async processRealTimeDataMCP(e){try{return(await R.post(`${this.mcpServerUrl}/ai/real-time-analysis`,{dataStream:e,analysisType:"working_capital_monitoring",alertThresholds:{cashRunway:30,dsoIncrease:10,workingCapitalDecrease:15},generateAlerts:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP real-time analysis error:",t),null}}async integrateMultiAPIDataMCP(e){try{return(await R.post(`${this.mcpServerUrl}/integration/multi-api-sync`,{sources:e,syncType:"comprehensive",dataValidation:!0,conflictResolution:"ai_mediated",outputFormat:"normalized"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP multi-API integration error:",t),null}}async detectFinancialPatternsMCP(e){try{return(await R.post(`${this.mcpServerUrl}/ai/pattern-recognition`,{data:e,patternTypes:["seasonal_trends","anomaly_detection","correlation_analysis","predictive_indicators"],confidenceThreshold:.8,includeVisualization:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP pattern recognition error:",t),null}}async generateBoardPresentationMCP(e){try{return(await R.post(`${this.mcpServerUrl}/ai/board-presentation`,{data:e,presentationType:"working_capital_intelligence",audience:"board_of_directors",includeExecutiveSummary:!0,includeActionItems:!0,includeFinancialProjections:!0,format:"structured_content"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP board presentation error:",t),this.getFallbackPresentation(e)}}async assessFinancialRisksMCP(e){try{return(await R.post(`${this.mcpServerUrl}/ai/risk-assessment`,{financialData:e,riskTypes:["liquidity_risk","operational_risk","market_risk","credit_risk"],assessmentDepth:"comprehensive",includeMitigationStrategies:!0,timeHorizon:"12_months"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(t){return console.error("MCP risk assessment error:",t),this.getFallbackRiskAssessment(e)}}getCachedResponse(e){const t=this.responseCache.get(e);return t&&Date.now()-t.timestamp<this.cacheExpiry?t.data:null}cacheResponse(e,t){this.responseCache.set(e,{data:t,timestamp:Date.now()})}getFallbackAnalysis(e){return{summary:"Basic analysis - MCP server unavailable",recommendations:["Connect to MCP server for enhanced analysis"],confidence:"low",source:"fallback"}}getFallbackBenchmarks(e){return{workingCapital:{dso:{average:35,bestInClass:25},dpo:{average:35,bestInClass:45},inventoryTurns:{average:8,bestInClass:12}},source:"fallback",confidence:"low"}}getFallbackForecast(e){return{forecast:[],confidence:"low",source:"fallback",message:"Connect to MCP server for advanced forecasting"}}getFallbackInsights(e){return{insights:["MCP server required for AI-powered insights"],recommendations:["Ensure MCP server connection"],confidence:"low"}}getFallbackScenarioAnalysis(e){return{results:[],message:"MCP server required for scenario analysis",confidence:"low"}}getFallbackPresentation(e){return{slides:[],message:"MCP server required for presentation generation",confidence:"low"}}getFallbackRiskAssessment(e){return{risks:[],message:"MCP server required for comprehensive risk assessment",confidence:"low"}}async checkMCPHealth(){try{const e=await R.get(`${this.mcpServerUrl}/health`);return this.mcpConnected=e.status===200,{connected:this.mcpConnected,status:e.data,timestamp:new Date().toISOString()}}catch(e){return this.mcpConnected=!1,{connected:!1,error:e.message,timestamp:new Date().toISOString()}}}async getAvailableAIModels(){try{return(await R.get(`${this.mcpServerUrl}/ai/models`,{headers:{Authorization:`Bearer ${this.apiKey}`}})).data}catch(e){return console.error("Error fetching AI models:",e),[]}}async streamRealTimeInsights(e){try{const t=await R.get(`${this.mcpServerUrl}/ai/stream/insights`,{headers:{Authorization:`Bearer ${this.apiKey}`},responseType:"stream"});return t.data.on("data",a=>{try{const i=JSON.parse(a.toString());e(i)}catch(i){console.error("Error parsing streamed insight:",i)}}),t.data}catch(t){return console.error("Error streaming insights:",t),null}}}const P={SUPER_ADMIN:"super_admin",SYSTEM_ADMIN:"system_admin",USER_ADMIN:"user_admin",MANAGER:"manager",OPERATOR:"operator",VIEWER:"viewer",USER:"user"},p={SYSTEM_CONFIG:"system:config",API_KEYS_MANAGE:"system:api_keys",SYSTEM_LOGS:"system:logs",SYSTEM_MONITORING:"system:monitoring",SYSTEM_BACKUP:"system:backup",SYSTEM_SECURITY:"system:security",SYSTEM_INTEGRATIONS:"system:integrations",USERS_VIEW:"users:view",USERS_CREATE:"users:create",USERS_EDIT:"users:edit",USERS_DELETE:"users:delete",USERS_INVITE:"users:invite",USERS_APPROVE:"users:approve",USERS_ROLES:"users:roles",DATA_IMPORT:"data:import",DATA_EXPORT:"data:export",REPORTS_VIEW:"reports:view",REPORTS_CREATE:"reports:create",ANALYTICS_VIEW:"analytics:view",ANALYTICS_ADVANCED:"analytics:advanced",DASHBOARD_VIEW:"dashboard:view",DASHBOARD_EDIT:"dashboard:edit",DASHBOARD_ADMIN:"dashboard:admin",PRODUCTION_VIEW:"production:view",PRODUCTION_MANAGE:"production:manage",INVENTORY_VIEW:"inventory:view",INVENTORY_MANAGE:"inventory:manage",QUALITY_VIEW:"quality:view",QUALITY_MANAGE:"quality:manage"},je={[P.SUPER_ADMIN]:[...Object.values(p)],[P.SYSTEM_ADMIN]:[p.SYSTEM_CONFIG,p.API_KEYS_MANAGE,p.SYSTEM_LOGS,p.SYSTEM_MONITORING,p.SYSTEM_BACKUP,p.SYSTEM_SECURITY,p.SYSTEM_INTEGRATIONS,p.DASHBOARD_VIEW,p.REPORTS_VIEW,p.ANALYTICS_VIEW],[P.USER_ADMIN]:[p.USERS_VIEW,p.USERS_CREATE,p.USERS_EDIT,p.USERS_DELETE,p.USERS_INVITE,p.USERS_APPROVE,p.USERS_ROLES,p.DASHBOARD_VIEW,p.REPORTS_VIEW,p.ANALYTICS_VIEW],[P.MANAGER]:[p.DATA_IMPORT,p.DATA_EXPORT,p.REPORTS_VIEW,p.REPORTS_CREATE,p.ANALYTICS_VIEW,p.ANALYTICS_ADVANCED,p.DASHBOARD_VIEW,p.DASHBOARD_EDIT,p.PRODUCTION_VIEW,p.PRODUCTION_MANAGE,p.INVENTORY_VIEW,p.INVENTORY_MANAGE,p.QUALITY_VIEW,p.QUALITY_MANAGE,p.USERS_VIEW],[P.OPERATOR]:[p.PRODUCTION_VIEW,p.INVENTORY_VIEW,p.QUALITY_VIEW,p.DASHBOARD_VIEW,p.REPORTS_VIEW,p.ANALYTICS_VIEW],[P.VIEWER]:[p.DASHBOARD_VIEW,p.REPORTS_VIEW,p.ANALYTICS_VIEW,p.PRODUCTION_VIEW,p.INVENTORY_VIEW,p.QUALITY_VIEW],[P.USER]:[p.DASHBOARD_VIEW]};function _t(s,e){return!s||!e?!1:(je[s]||[]).includes(e)}function It(s){return[P.SUPER_ADMIN,P.SYSTEM_ADMIN,P.USER_ADMIN].includes(s)}function Et(s){switch(s){case P.SUPER_ADMIN:return"full";case P.SYSTEM_ADMIN:return"system";case P.USER_ADMIN:return"users";default:return"none"}}class Ve{constructor(){this.currentShift=null,this.activeStations=new Map,this.workOrders=new Map,this.operatorActions=[],this.alerts=[],this.dashboardConfig={refreshInterval:15e3,maxAlerts:10,quickActions:!0},this.isConnected=!1}async initialize(){try{return y("Initializing shop floor dashboard service"),await this.loadCurrentShift(),await this.loadActiveWorkOrders(),await this.connectToShopFloorSystems(),await this.startMobileMonitoring(),this.isConnected=!0,y("Shop floor dashboard service initialized successfully"),{success:!0,message:"Shop floor systems connected"}}catch(e){throw C("Failed to initialize shop floor service",e),new Error(`Shop floor integration failed: ${e.message}`)}}async getMobileDashboardOverview(){try{return{timestamp:new Date().toISOString(),shift:await this.getCurrentShiftInfo(),production:await this.getProductionSummary(),workOrders:await this.getActiveWorkOrdersSummary(),alerts:await this.getCriticalAlerts(),quickStats:await this.getQuickStats(),operatorActions:await this.getRecentOperatorActions(),stationStatus:await this.getStationStatusSummary()}}catch(e){throw C("Failed to get mobile dashboard overview",e),e}}async getCurrentShiftInfo(){try{return{id:`SHIFT_${new Date().toISOString().slice(0,10)}_${this.getCurrentShiftNumber()}`,number:this.getCurrentShiftNumber(),startTime:this.getShiftStartTime(),endTime:this.getShiftEndTime(),supervisor:await this.getShiftSupervisor(),operators:await this.getShiftOperators(),status:"active",duration:this.getShiftDuration(),timeRemaining:this.getTimeRemaining()}}catch(e){return C("Failed to get current shift info",e),null}}async getProductionSummary(){try{const e={totalProduced:await this.getTotalProduced(),target:await this.getShiftTarget(),completionRate:0,efficiency:await this.calculateShiftEfficiency(),qualityRate:await this.getShiftQualityRate(),activeLines:await this.getActiveProductionLines(),topProducts:await this.getTopProductsThisShift()};return e.target>0&&(e.completionRate=e.totalProduced/e.target*100),e}catch(e){return C("Failed to get production summary",e),null}}async getActiveWorkOrdersSummary(){try{return[{id:"WO-2025-090801",product:"GABA Red 500mg",quantity:5e3,completed:3750,priority:"high",dueTime:new Date(Date.now()+72e5).toISOString(),station:"Line A",operator:"John Smith",status:"in_progress"},{id:"WO-2025-090802",product:"Whey Protein Vanilla",quantity:2e3,completed:500,priority:"medium",dueTime:new Date(Date.now()+216e5).toISOString(),station:"Line B",operator:"Sarah Johnson",status:"in_progress"},{id:"WO-2025-090803",product:"Omega-3 Liquid",quantity:1500,completed:0,priority:"low",dueTime:new Date(Date.now()+288e5).toISOString(),station:"Line C",operator:"Mike Davis",status:"pending"}].map(t=>({...t,completionRate:t.completed/t.quantity*100,timeLeft:this.formatTimeRemaining(new Date(t.dueTime)-new Date),isOverdue:new Date(t.dueTime)<new Date}))}catch(e){return C("Failed to get work orders summary",e),[]}}async getCriticalAlerts(){try{return[{id:"ALT-001",type:"quality",severity:"high",message:"Quality check required on Line A",station:"Line A",timestamp:new Date(Date.now()-3e5).toISOString(),acknowledged:!1,action:"quality_check"},{id:"ALT-002",type:"maintenance",severity:"medium",message:"Scheduled maintenance due in 30 minutes",station:"Line B",timestamp:new Date(Date.now()-6e5).toISOString(),acknowledged:!1,action:"schedule_maintenance"},{id:"ALT-003",type:"inventory",severity:"medium",message:"Raw material running low - Capsule shells",station:"Warehouse",timestamp:new Date(Date.now()-9e5).toISOString(),acknowledged:!0,action:"reorder_material"}].map(t=>({...t,timeAgo:this.formatTimeAgo(new Date-new Date(t.timestamp))}))}catch(e){return C("Failed to get critical alerts",e),[]}}async recordOperatorAction(e){try{y("Recording operator action",e);const t={id:`ACTION_${Date.now()}_${crypto.randomUUID().substr(2,9)}`,timestamp:new Date().toISOString(),operator:e.operator||"Unknown",type:e.type,description:e.description,station:e.station,workOrder:e.workOrder,data:e.data||{},success:!0};switch(e.type){case"start_production":await this.handleStartProduction(t);break;case"complete_work_order":await this.handleCompleteWorkOrder(t);break;case"quality_check":await this.handleQualityCheck(t);break;case"material_request":await this.handleMaterialRequest(t);break;case"acknowledge_alert":await this.handleAcknowledgeAlert(t);break;default:j("Unknown operator action type",e)}return this.operatorActions.unshift(t),this.operatorActions.length>100&&(this.operatorActions=this.operatorActions.slice(0,100)),y(`Operator action recorded successfully: ${e.type}`),t}catch(t){throw C("Failed to record operator action",t),t}}async getQuickStats(){try{return{hourlyRate:await this.getHourlyProductionRate(),efficiency:await this.getCurrentEfficiency(),qualityRate:await this.getCurrentQualityRate(),oeeScore:await this.getCurrentOEE(),downtime:await this.getTotalDowntimeToday(),defectRate:await this.getCurrentDefectRate()}}catch(e){return C("Failed to get quick stats",e),{}}}async getStationStatusSummary(){try{return[{id:"LINE_A",name:"Production Line A",status:"running",operator:"John Smith",currentProduct:"GABA Red 500mg",efficiency:94.5,lastUpdate:new Date().toISOString()},{id:"LINE_B",name:"Production Line B",status:"idle",operator:"Sarah Johnson",currentProduct:"Whey Protein Vanilla",efficiency:0,lastUpdate:new Date(Date.now()-6e5).toISOString()},{id:"LINE_C",name:"Production Line C",status:"maintenance",operator:"Mike Davis",currentProduct:null,efficiency:0,lastUpdate:new Date(Date.now()-18e5).toISOString()},{id:"QC_STATION",name:"Quality Control",status:"active",operator:"Lisa Chen",currentProduct:"Various Testing",efficiency:87.2,lastUpdate:new Date(Date.now()-3e5).toISOString()}]}catch(e){return C("Failed to get station status summary",e),[]}}async loadCurrentShift(){y("Loading current shift information"),this.currentShift=this.getCurrentShiftNumber()}async loadActiveWorkOrders(){y("Loading active work orders")}async connectToShopFloorSystems(){y("Connecting to shop floor systems"),await this.delay(500),y("Shop floor system connections established")}async startMobileMonitoring(){y("Starting mobile-optimized monitoring"),setInterval(()=>this.updateMobileData(),this.dashboardConfig.refreshInterval),setInterval(()=>this.cleanupOldData(),36e5)}getCurrentShiftNumber(){const e=new Date().getHours();return e>=6&&e<14?1:e>=14&&e<22?2:3}getShiftStartTime(){const e=new Date().getHours(),t=new Date;return t.setMinutes(0,0,0),e>=6&&e<14?t.setHours(6):e>=14&&e<22?t.setHours(14):t.setHours(22),t.toISOString()}getShiftEndTime(){const e=new Date(this.getShiftStartTime());return e.setHours(e.getHours()+8),e.toISOString()}getShiftDuration(){const e=new Date(this.getShiftStartTime());return Math.floor((new Date-e)/36e5)}getTimeRemaining(){const e=new Date(this.getShiftEndTime()),a=Math.max(0,e-new Date);return Math.floor(a/36e5)}formatTimeRemaining(e){const t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4);return`${t}h ${a}m`}formatTimeAgo(e){const t=Math.floor(e/6e4);return t<60?`${t}m ago`:`${Math.floor(t/60)}h ago`}delay(e){return new Promise(t=>setTimeout(t,e))}async handleStartProduction(e){y("Production started",e)}async handleCompleteWorkOrder(e){y("Work order completed",e)}async handleQualityCheck(e){y("Quality check performed",e)}async handleMaterialRequest(e){y("Material requested",e)}async handleAcknowledgeAlert(e){y("Alert acknowledged",e)}async getShiftSupervisor(){return"David Wilson"}async getShiftOperators(){return["John Smith","Sarah Johnson","Mike Davis","Lisa Chen"]}async getTotalProduced(){return 3750}async getShiftTarget(){return 5e3}async calculateShiftEfficiency(){return 92.5}async getShiftQualityRate(){return 98.1}async getActiveProductionLines(){return 2}async getTopProductsThisShift(){return["GABA Red 500mg","Whey Protein Vanilla"]}async getHourlyProductionRate(){return 625}async getCurrentEfficiency(){return 94.2}async getCurrentQualityRate(){return 97.8}async getCurrentOEE(){return 89.3}async getTotalDowntimeToday(){return 45}async getCurrentDefectRate(){return 1.2}async getRecentOperatorActions(){return this.operatorActions.slice(0,5)}async updateMobileData(){}async cleanupOldData(){}}const Rt=new Ve;export{st as A,ct as B,yt as C,Re as D,ft as E,nt as F,at as L,At as M,p as P,P as R,tt as _,et as a,E as b,Xe as c,ut as d,dt as e,mt as f,Ze as g,ht as h,pt as i,St as j,wt as k,gt as l,C as m,y as n,Dt as o,vt as p,ot as q,Ct as r,bt as s,_t as t,lt as u,It as v,Et as w,rt as x,it as y,Rt as z};
