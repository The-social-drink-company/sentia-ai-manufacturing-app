import{c5 as t}from"./vendor-CfxROi5-.js";var h={};class m{constructor(){this.mcpServerUrl=h.MCP_SERVER_URL||"https://mcp-server-tkyu.onrender.com",this.apiKey=h.MCP_API_KEY,this.initializeMCPConnection(),this.responseCache=new Map,this.cacheExpiry=1800*1e3}async initializeMCPConnection(){try{const e=await t.get(`${this.mcpServerUrl}/health`);console.log("MCP Server connected:",e.data),this.mcpConnected=!0}catch(e){console.warn("MCP Server connection failed:",e.message),this.mcpConnected=!1}}async analyzeWorkingCapitalWithMCP(e){const r=`wc-analysis-${JSON.stringify(e).slice(0,100)}`,a=this.getCachedResponse(r);if(a)return a;try{const n=(await t.post(`${this.mcpServerUrl}/ai/working-capital-analysis`,{data:e,analysisType:"comprehensive",includeForecasting:!0,includeBenchmarking:!0,includeOptimization:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data;return this.cacheResponse(r,n),n}catch(s){return console.error("MCP working capital analysis error:",s),this.getFallbackAnalysis(e)}}async getIndustryBenchmarksViaMCP(e){const{industry:r,revenue:a,employees:s,region:n,dataSource:i}=e,o=`benchmarks-${r}-${a}-${s}-${n}`,c=this.getCachedResponse(o);if(c)return c;try{const p=(await t.post(`${this.mcpServerUrl}/ai/industry-benchmarks`,{industry:r,revenue:a,employees:s,region:n,dataSource:i||"comprehensive",includeCompetitiveAnalysis:!0,includeOptimizationRecommendations:!0,outputFormat:"executive_summary"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data;return this.cacheResponse(o,p),p}catch(l){return console.error("MCP benchmarking error:",l),this.getFallbackBenchmarks(e)}}async generateCashFlowForecastMCP(e){const{historicalData:r,timeHorizon:a,scenarios:s,includeSeasonality:n}=e;try{return(await t.post(`${this.mcpServerUrl}/ai/cash-flow-forecast`,{historicalData:r,timeHorizon:a,scenarios:s,includeSeasonality:n,modelType:"ensemble",confidenceIntervals:!0,riskAssessment:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(i){return console.error("MCP cash flow forecast error:",i),this.getFallbackForecast(e)}}async generateExecutiveInsightsMCP(e){try{return(await t.post(`${this.mcpServerUrl}/ai/executive-insights`,{financialData:e.financialMetrics,workingCapitalData:e.workingCapital,benchmarkData:e.benchmarks,insightType:"board_ready",audience:"c_suite",includeActionItems:!0,includeRiskAssessment:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP executive insights error:",r),this.getFallbackInsights(e)}}async runScenarioAnalysisMCP(e){try{return(await t.post(`${this.mcpServerUrl}/ai/scenario-analysis`,{scenarios:e,analysisDepth:"comprehensive",includeRiskModeling:!0,includeSensitivityAnalysis:!0,outputFormat:"executive_dashboard"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP scenario analysis error:",r),this.getFallbackScenarioAnalysis(e)}}async processRealTimeDataMCP(e){try{return(await t.post(`${this.mcpServerUrl}/ai/real-time-analysis`,{dataStream:e,analysisType:"working_capital_monitoring",alertThresholds:{cashRunway:30,dsoIncrease:10,workingCapitalDecrease:15},generateAlerts:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP real-time analysis error:",r),null}}async integrateMultiAPIDataMCP(e){try{return(await t.post(`${this.mcpServerUrl}/integration/multi-api-sync`,{sources:e,syncType:"comprehensive",dataValidation:!0,conflictResolution:"ai_mediated",outputFormat:"normalized"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP multi-API integration error:",r),null}}async detectFinancialPatternsMCP(e){try{return(await t.post(`${this.mcpServerUrl}/ai/pattern-recognition`,{data:e,patternTypes:["seasonal_trends","anomaly_detection","correlation_analysis","predictive_indicators"],confidenceThreshold:.8,includeVisualization:!0},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP pattern recognition error:",r),null}}async generateBoardPresentationMCP(e){try{return(await t.post(`${this.mcpServerUrl}/ai/board-presentation`,{data:e,presentationType:"working_capital_intelligence",audience:"board_of_directors",includeExecutiveSummary:!0,includeActionItems:!0,includeFinancialProjections:!0,format:"structured_content"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP board presentation error:",r),this.getFallbackPresentation(e)}}async assessFinancialRisksMCP(e){try{return(await t.post(`${this.mcpServerUrl}/ai/risk-assessment`,{financialData:e,riskTypes:["liquidity_risk","operational_risk","market_risk","credit_risk"],assessmentDepth:"comprehensive",includeMitigationStrategies:!0,timeHorizon:"12_months"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})).data}catch(r){return console.error("MCP risk assessment error:",r),this.getFallbackRiskAssessment(e)}}getCachedResponse(e){const r=this.responseCache.get(e);return r&&Date.now()-r.timestamp<this.cacheExpiry?r.data:null}cacheResponse(e,r){this.responseCache.set(e,{data:r,timestamp:Date.now()})}getFallbackAnalysis(e){return{summary:"Basic analysis - MCP server unavailable",recommendations:["Connect to MCP server for enhanced analysis"],confidence:"low",source:"fallback"}}getFallbackBenchmarks(e){return{workingCapital:{dso:{average:35,bestInClass:25},dpo:{average:35,bestInClass:45},inventoryTurns:{average:8,bestInClass:12}},source:"fallback",confidence:"low"}}getFallbackForecast(e){return{forecast:[],confidence:"low",source:"fallback",message:"Connect to MCP server for advanced forecasting"}}getFallbackInsights(e){return{insights:["MCP server required for AI-powered insights"],recommendations:["Ensure MCP server connection"],confidence:"low"}}getFallbackScenarioAnalysis(e){return{results:[],message:"MCP server required for scenario analysis",confidence:"low"}}getFallbackPresentation(e){return{slides:[],message:"MCP server required for presentation generation",confidence:"low"}}getFallbackRiskAssessment(e){return{risks:[],message:"MCP server required for comprehensive risk assessment",confidence:"low"}}async checkMCPHealth(){try{const e=await t.get(`${this.mcpServerUrl}/health`);return this.mcpConnected=e.status===200,{connected:this.mcpConnected,status:e.data,timestamp:new Date().toISOString()}}catch(e){return this.mcpConnected=!1,{connected:!1,error:e.message,timestamp:new Date().toISOString()}}}async getAvailableAIModels(){try{return(await t.get(`${this.mcpServerUrl}/ai/models`,{headers:{Authorization:`Bearer ${this.apiKey}`}})).data}catch(e){return console.error("Error fetching AI models:",e),[]}}async streamRealTimeInsights(e){try{const r=await t.get(`${this.mcpServerUrl}/ai/stream/insights`,{headers:{Authorization:`Bearer ${this.apiKey}`},responseType:"stream"});return r.data.on("data",a=>{try{const s=JSON.parse(a.toString());e(s)}catch(s){console.error("Error parsing streamed insight:",s)}}),r.data}catch(r){return console.error("Error streaming insights:",r),null}}}export{m as M};
