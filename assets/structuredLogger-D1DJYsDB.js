class f{constructor(e={}){this.level=e.level||"info",this.service=e.service||"sentia-manufacturing",this.version=e.version||"1.0.0",this.environment=e.environment||"development",this.enableConsole=e.enableConsole!==!1,this.enableStorage=e.enableStorage!==!1,this.maxStoredLogs=e.maxStoredLogs||1e3,this.levels={error:0,warn:1,info:2,debug:3,trace:4},this.logBuffer=[],this.metrics={logsGenerated:0,errorCount:0,warnCount:0,infoCount:0,debugCount:0}}log(e,t,r={},s=null){if(this.levels[e]>this.levels[this.level])return;const n={timestamp:new Date().toISOString(),level:e.toUpperCase(),service:this.service,version:this.version,environment:this.environment,message:t,context:this.sanitizeContext(r),...s&&{error:{message:s.message,stack:s.stack,name:s.name}},...typeof window<"u"&&{userAgent:window.navigator?.userAgent,url:window.location?.href}};return this.updateMetrics(e),this.enableStorage&&this.storeLog(n),this.enableConsole&&this.outputToConsole(n),this.sendToExternalService(n),n}error(e,t={},r=null){return this.log("error",e,t,r)}warn(e,t={}){return this.log("warn",e,t)}info(e,t={}){return this.log("info",e,t)}debug(e,t={}){return this.log("debug",e,t)}trace(e,t={}){return this.log("trace",e,t)}sanitizeContext(e){if(!e||typeof e!="object")return e;const t={...e},r=["password","token","apiKey","secret","authorization","credit_card","ssn","social_security","auth","bearer"];for(const s of Object.keys(t)){const i=s.toLowerCase();r.some(n=>i.includes(n))&&(t[s]="[REDACTED]")}return t}storeLog(e){this.logBuffer.push(e),this.logBuffer.length>this.maxStoredLogs&&this.logBuffer.shift()}outputToConsole(e){const t=this.formatConsoleMessage(e);switch(e.level){case"ERROR":break;case"WARN":break;case"INFO":break;case"DEBUG":console.debug(t);break;case"TRACE":console.trace(t);break}}formatConsoleMessage(e){const{timestamp:t,level:r,message:s,context:i,error:n}=e;let o=`[${new Date(t).toLocaleTimeString()}] ${r}: ${s}`;return i&&Object.keys(i).length>0&&(o+=`
Context: ${JSON.stringify(i,null,2)}`),n&&(o+=`
Error: ${n.message}`,(this.level==="debug"||this.level==="trace")&&(o+=`
Stack: ${n.stack}`)),o}async sendToExternalService(e){}updateMetrics(e){switch(this.metrics.logsGenerated++,e){case"error":this.metrics.errorCount++;break;case"warn":this.metrics.warnCount++;break;case"info":this.metrics.infoCount++;break;case"debug":this.metrics.debugCount++;break}}time(e){const t=performance.now();return{end:(r=`Timer ${e} _completed`,_s={}) => {const i=performance.now(),n=Math.round(i-t);return this.info(r,{...s,duration:`${n}ms`,label:e}),n}}}logRequest(e,t,r={}){return this.info("API Request",{method:e.toUpperCase(),url:t,...r,type:"request"})}logResponse(e,t,r,s,i={}){const n=r>=400?"error":r>=300?"warn":"info";return this.log(n,"API Response",{method:e.toUpperCase(),url:t,status:r,responseTime:`${s}ms`,...i,type:"response"})}logUserAction(e,t={}){return this.info("User Action",{action:e,...t,type:"user_action",userId:t.userId||"anonymous"})}logBusinessEvent(e,t={}){return this.info("Business Event",{event:e,...t,type:"business_event"})}logError(e,t={}){return this.error("Application Error",{...t,componentStack:t.componentStack,errorBoundary:!0},e)}searchLogs(e,t={}){const{level:r,startDate:s,endDate:i,limit:n=100}=t;let a=[...this.logBuffer];if(r&&(a=a.filter(o=>o.level.toLowerCase()===r.toLowerCase())),s&&(a=a.filter(o=>new Date(o.timestamp)>=new Date(s))),i&&(a=a.filter(o=>new Date(o.timestamp)<=new Date(i))),e){const o=e.toLowerCase();a=a.filter(c=>c.message.toLowerCase().includes(o)||JSON.stringify(c.context).toLowerCase().includes(o))}return a.sort((o,c)=>new Date(c.timestamp)-new Date(o.timestamp)),a.slice(0,n)}getMetrics(){return{...this.metrics,bufferSize:this.logBuffer.length,maxBufferSize:this.maxStoredLogs,currentLevel:this.level,environment:this.environment,service:this.service}}exportLogs(e="json"){switch(e){case"csv":return this.exportAsCSV();case"json":default:return JSON.stringify(this.logBuffer,null,2)}}exportAsCSV(){if(this.logBuffer.length===0)return"";const e=["timestamp","level","message","context","error"],t=this.logBuffer.map(r=>[r.timestamp,r.level,r.message,JSON.stringify(r.context||{}),r.error?r.error.message:""]);return[e,...t].map(r=>r.map(s=>`"${s}"`).join(",")).join(`
`)}clearLogs(){const e=this.logBuffer.length;return this.logBuffer=[],e}setLevel(e){return this.levels.hasOwnProperty(e)?(this.level=e,!0):!1}}const u=new f({service:"sentia-manufacturing",environment:typeof window<"u"?"browser":"server"}),h=(l,e,t)=>u.error(l,e,t),g=(l,e)=>u.warn(l,e),m=(l,e)=>u.info(l,e);export{h as a,g as b,m as l};
