import{ab as r,aG as I,b2 as _,ar as K,b4 as G,aY as H,b5 as O,b6 as b,b7 as D,b8 as B,r as w,b9 as Y,ba as U,bb as A,bc as q,bd as V,be as J,bf as $,bg as Q,bh as X,aJ as Z}from"./vendor-CUZU9yWq.js";import{e as g,C as k,a as C,b as M,c as P,d as N,f as y}from"./index-BMC-S8Ir.js";import{i as W,j as ee,k as te,l as ae,D as se,m as re,O as oe,n as ne,o as ie,p as le,q as ce,r as de,s as ue,t as ge,u as he}from"./radix-B2sbv38h.js";import{p as R,a as xe}from"./DashboardEnterprise-CSbskUfr.js";import{s as me}from"./stockLevelsApi-DQtHFnUn.js";import"./data-layer-Dk4PQe5w.js";import"./router-De_D0Hn1.js";function be({...e}){return r.jsx(W,{"data-slot":"dialog",...e})}function ve({...e}){return r.jsx(re,{"data-slot":"dialog-portal",...e})}function pe({className:e,...a}){return r.jsx(oe,{"data-slot":"dialog-overlay",className:g("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...a})}function ye({className:e,children:a,...t}){return r.jsxs(ve,{"data-slot":"dialog-portal",children:[r.jsx(pe,{}),r.jsxs(ee,{"data-slot":"dialog-content",className:g("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t,children:[a,r.jsxs(te,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[r.jsx(I,{}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function fe({className:e,...a}){return r.jsx("div",{"data-slot":"dialog-header",className:g("flex flex-col gap-2 text-center sm:text-left",e),...a})}function Se({className:e,...a}){return r.jsx(ae,{"data-slot":"dialog-title",className:g("text-lg leading-none font-semibold",e),...a})}function je({className:e,...a}){return r.jsx(se,{"data-slot":"dialog-description",className:g("text-muted-foreground text-sm",e),...a})}function we({className:e,...a}){return r.jsx(ne,{"data-slot":"checkbox",className:g("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...a,children:r.jsx(ie,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:r.jsx(_,{className:"size-3.5"})})})}function Fe({className:e,...a}){return r.jsx(le,{"data-slot":"label",className:g("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}function ke({className:e,orientation:a="horizontal",decorative:t=!0,...s}){return r.jsx(ce,{"data-slot":"separator-root",decorative:t,orientation:a,className:g("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...s})}const E=K("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Ce({className:e,classNames:a,showOutsideDays:t=!0,...s}){return r.jsx(G,{showOutsideDays:t,className:g("p-3",e),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:g(E({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:g("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",s.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:g(E({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({className:i,...n})=>r.jsx(O,{className:g("size-4",i),...n}),IconRight:({className:i,...n})=>r.jsx(H,{className:g("size-4",i),...n})},...s})}function Me({...e}){return r.jsx(de,{"data-slot":"popover",...e})}function Pe({...e}){return r.jsx(ue,{"data-slot":"popover-trigger",...e})}function Ne({className:e,align:a="center",sideOffset:t=4,...s}){return r.jsx(ge,{children:r.jsx(he,{"data-slot":"popover-content",align:a,sideOffset:t,className:g("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...s})})}const T=[{label:"Global working capital",value:"$9.2M",helper:"Across all subsidiaries"},{label:"Cash coverage",value:"214 days",helper:"Including credit facilities"},{label:"Intercompany exposure",value:"$1.1M",helper:"Pending settlements"},{label:"FX sensitivity",value:"$380K",helper:"±1% USD/EUR/JPY"}],L=[{region:"UK",revenue:42e5,ebitda:98e4},{region:"US",revenue:385e4,ebitda:82e4},{region:"EU",revenue:615e4,ebitda:114e4}],ze=async(e,a)=>{const t={metadata:{title:"Sentia Manufacturing Dashboard Report",generatedAt:new Date().toISOString(),reportPeriod:{from:a.from,to:a.to,formatted:`${b(a.from,"MMMM d, yyyy")} - ${b(a.to,"MMMM d, yyyy")}`},sections:e},sections:{}};try{if(e.capitalKpis&&(t.sections.capitalKpis={title:"Capital Position",description:"Key metrics reviewed in the weekly treasury meeting",data:T,summary:$e(T)}),e.performanceKpis){const s=await R.getKPISummary();t.sections.performanceKpis={title:"Performance Metrics",description:"Key business performance indicators tracked for operational excellence",data:s.success?[{label:"Annual revenue",value:s.data.annualRevenue.value,helper:s.data.annualRevenue.helper},{label:"Units sold",value:s.data.unitsSold.value,helper:s.data.unitsSold.helper},{label:"Gross margin",value:s.data.grossMargin.value,helper:s.data.grossMargin.helper}]:[],summary:Re(s.data)}}if(e.plAnalysis){const s=await R.getPLAnalysis(),i=await R.getPLSummary("year");t.sections.plAnalysis={title:"P&L Analysis",description:"Monthly profit and loss trends",data:s.success?s.data:[],summary:Ie(s.success?s.data:[],i.success?i.data:null),chartData:s.success?s.data:[]}}if(e.regionalContribution&&(t.sections.regionalContribution={title:"Regional Performance",description:"Revenue and EBITDA by region",data:L,summary:Ae(L)}),e.stockLevels)try{const s=await me.getStockLevels();t.sections.stockLevels={title:"Current Stock Levels",description:"Inventory status and stock levels",data:s.success?s.data:[],summary:Ee(s.data)}}catch(s){console.error("Error fetching stock levels:",s),t.sections.stockLevels={title:"Current Stock Levels",description:"Inventory status and stock levels",data:[],summary:{status:"Data unavailable",message:"Stock levels could not be retrieved"}}}if(e.productSales){const s=await xe.getProductSalesData();t.sections.productSales={title:"Product Sales Performance",description:"Revenue by product line",data:s.success?s.data:[],summary:Te(s.data)}}t.executiveSummary=Le(t.sections,a)}catch(s){throw console.error("Error generating report:",s),new Error(`Failed to generate report: ${s.message}`)}return t},$e=e=>{const a=e.find(s=>s.label.includes("working capital")),t=e.find(s=>s.label.includes("Cash coverage"));return{workingCapital:(a==null?void 0:a.value)||"N/A",cashCoverage:(t==null?void 0:t.value)||"N/A",status:"Strong liquidity position maintained",keyInsight:"Global working capital remains healthy with adequate cash coverage"}},Re=e=>{var a,t,s;return e?{revenue:((a=e.annualRevenue)==null?void 0:a.value)||"N/A",units:((t=e.unitsSold)==null?void 0:t.value)||"N/A",margin:((s=e.grossMargin)==null?void 0:s.value)||"N/A",status:"Performance targets on track",keyInsight:"Strong revenue growth with healthy margin maintenance"}:{status:"Data unavailable"}},Ae=e=>{const a=e.reduce((n,o)=>n+o.revenue,0),t=e.reduce((n,o)=>n+o.ebitda,0),s=t/a*100,i=e.reduce((n,o)=>n.revenue>o.revenue?n:o);return{totalRevenue:`$${(a/1e6).toFixed(1)}M`,totalEbitda:`$${(t/1e6).toFixed(1)}M`,avgEbitdaMargin:`${s.toFixed(1)}%`,topRegion:i.region,status:"Balanced regional performance",keyInsight:`${i.region} leads revenue generation with strong EBITDA margins`}},Ee=e=>{if(!e||!Array.isArray(e))return{status:"Data unavailable",message:"Stock level data not accessible"};const a=e.filter(s=>s.status==="Low"||s.level<20),t=e.filter(s=>s.status==="Optimal"||s.level>=20&&s.level<=80);return{totalItems:e.length,lowStockCount:a.length,optimalStockCount:t.length,status:a.length>0?"Attention required":"Stock levels healthy",keyInsight:a.length>0?`${a.length} items require restocking attention`:"All inventory levels within optimal ranges"}},Te=e=>{if(!e||!Array.isArray(e))return{status:"Data unavailable",message:"Product sales data not accessible"};const a=e.reduce((s,i)=>s+(i.sales||i.revenue||0),0),t=e.reduce((s,i)=>(s.sales||s.revenue||0)>(i.sales||i.revenue||0)?s:i);return{totalSales:`$${(a/1e6).toFixed(1)}M`,topProduct:t.name||t.product||"N/A",productCount:e.length,status:"Product performance tracked",keyInsight:`${t.name||t.product} leads product sales performance`}},Le=(e,a)=>{const t=[];let s="Operational";return e.capitalKpis&&t.push("Strong capital position maintained with healthy working capital levels"),e.performanceKpis&&t.push("Key performance indicators showing positive trends across revenue and margin metrics"),e.plAnalysis&&t.push("P&L analysis reveals consistent profitability trends with seasonal variations"),e.regionalContribution&&t.push("Regional performance balanced across all markets with EU leading revenue contribution"),e.stockLevels&&t.push("Inventory management requires attention for optimal stock level maintenance"),e.productSales&&t.push("Product sales performance tracking enables informed strategic decisions"),{status:s,reportPeriod:b(a.from,"MMMM yyyy"),keyInsights:t,recommendation:"Continue monitoring key metrics while focusing on inventory optimization and regional growth opportunities",dataQuality:"High - All critical systems operational and providing real-time data"}},Ie=(e,a)=>{if(!e||!Array.isArray(e)||e.length===0)return{status:"Data unavailable",message:"P&L analysis data not accessible"};const t=e.reduce((l,d)=>l+(d.revenue||0),0),s=e.reduce((l,d)=>l+(d.grossProfit||0),0),i=e.reduce((l,d)=>l+(d.ebitda||0),0),n=t>0?(s/t*100).toFixed(1):"0",o=t>0?(i/t*100).toFixed(1):"0",c=e.reduce((l,d)=>(l.revenue||0)>(d.revenue||0)?l:d);return{totalRevenue:`$${(t/1e3).toFixed(0)}K`,totalGrossProfit:`$${(s/1e3).toFixed(0)}K`,totalEbitda:`$${(i/1e3).toFixed(0)}K`,avgGrossMargin:`${n}%`,avgEbitdaMargin:`${o}%`,bestMonth:c.month||"N/A",status:"P&L trends analyzed",keyInsight:`${c.month} showed strongest performance with $${c.revenue}K revenue`}},_e=async e=>{try{const a=new D("p","mm","a4"),t=a.internal.pageSize.getWidth(),s=a.internal.pageSize.getHeight(),i=20,n=t-i*2;let o=i;S(a,t,i),o+=30,a.setFontSize(24),a.setFont(void 0,"bold"),a.text("Manufacturing Dashboard Report",i,o),o+=15,a.setFontSize(12),a.setFont(void 0,"normal"),a.setTextColor(100,100,100),a.text(`Generated: ${b(new Date,"MMMM d, yyyy 'at' h:mm a")}`,i,o),o+=8,a.text(`Report Period: ${e.metadata.reportPeriod.formatted}`,i,o),o+=20,e.executiveSummary&&(o=Ke(a,e.executiveSummary,i,o,n,s));for(const[,d]of Object.entries(e.sections))o+80>s-40&&(a.addPage(),S(a,t,i),o=i+30),o=Ge(a,d,i,o,n,s),o+=15;Ue(a,t,s,i);const l=`Sentia_Manufacturing_Report_${b(new Date,"yyyy-MM-dd_HH-mm")}.pdf`;return a.save(l),{success:!0,filename:l}}catch(a){throw console.error("Error generating PDF:",a),new Error(`Failed to generate PDF: ${a.message}`)}},S=(e,a,t)=>{e.setFillColor(59,130,246),e.roundedRect(t,t,30,15,2,2,"F"),e.setFontSize(14),e.setFont(void 0,"bold"),e.setTextColor(255,255,255),e.text("S",t+12,t+10),e.setFontSize(16),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text("Sentia Manufacturing",t+35,t+8),e.setFontSize(12),e.setFont(void 0,"normal"),e.setTextColor(100,100,100),e.text("Enterprise Manufacturing Intelligence",t+35,t+16),e.setDrawColor(200,200,200),e.line(t,t+25,a-t,t+25)},Ke=(e,a,t,s,i,n)=>{let o=s;return e.setFontSize(18),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text("Executive Summary",t,o),o+=12,e.setFontSize(12),e.setFont(void 0,"bold"),e.text("Status:",t,o),e.setFont(void 0,"normal"),e.text(a.status,t+20,o),o+=10,e.setFont(void 0,"bold"),e.text("Period:",t,o),e.setFont(void 0,"normal"),e.text(a.reportPeriod,t+20,o),o+=15,a.keyInsights&&a.keyInsights.length>0&&(e.setFont(void 0,"bold"),e.text("Key Insights:",t,o),o+=8,e.setFont(void 0,"normal"),a.keyInsights.forEach(c=>{e.splitTextToSize(`• ${c}`,i-10).forEach(d=>{o>n-30&&(e.addPage(),S(e,e.internal.pageSize.getWidth(),t),o=t+40),e.text(d,t+5,o),o+=6}),o+=2})),a.recommendation&&(o+=5,e.setFont(void 0,"bold"),e.text("Recommendation:",t,o),o+=8,e.setFont(void 0,"normal"),e.splitTextToSize(a.recommendation,i).forEach(l=>{o>n-30&&(e.addPage(),S(e,e.internal.pageSize.getWidth(),t),o=t+40),e.text(l,t,o),o+=6})),o+20},Ge=(e,a,t,s,i,n)=>{let o=s;return e.setFontSize(16),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text(a.title,t,o),o+=10,a.description&&(e.setFontSize(11),e.setFont(void 0,"normal"),e.setTextColor(100,100,100),e.splitTextToSize(a.description,i).forEach(l=>{e.text(l,t,o),o+=6}),o+=10),a.data&&Array.isArray(a.data)&&(o>n-120&&(e.addPage(),S(e,e.internal.pageSize.getWidth(),t),o=t+30,e.setFontSize(16),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text(a.title,t,o),o+=15),a.title==="Capital Position"||a.title==="Performance Metrics"?o=He(e,a.data,t,o,i):a.title==="Regional Performance"?o=Oe(e,a.data,t,o,i):a.title==="P&L Analysis"?o=De(e,a.data,t,o,i):o=Be(e,a.data,t,o,i)),a.summary&&typeof a.summary=="object"&&(o>n-60&&(e.addPage(),S(e,e.internal.pageSize.getWidth(),t),o=t+30),o+=10,o=Ye(e,a.summary,t,o,i)),o},He=(e,a,t,s,i)=>{let n=s;const o=12,c=15,l=i*.4,d=i*.25,h=i*.35;return e.setFillColor(245,245,245),e.rect(t,n,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Metric",t+5,n+10),e.text("Value",t+l+5,n+10),e.text("Description",t+l+d+5,n+10),n+=c,e.setFont(void 0,"normal"),a.forEach((x,v)=>{const f=e.splitTextToSize(x.label,l-10),F=e.splitTextToSize(x.helper||"",h-10),p=Math.max(o,Math.max(f.length,F.length)*6+6),z=e.internal.pageSize.getHeight();n+p>z-30&&(e.addPage(),S(e,e.internal.pageSize.getWidth(),t),n=t+30,e.setFillColor(245,245,245),e.rect(t,n,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Metric",t+5,n+10),e.text("Value",t+l+5,n+10),e.text("Description",t+l+d+5,n+10),n+=c,e.setFont(void 0,"normal")),v%2===0&&(e.setFillColor(250,250,250),e.rect(t,n,i,p,"F")),e.text(f,t+5,n+8),e.setFont(void 0,"bold"),e.text(x.value,t+l+5,n+8),e.setFont(void 0,"normal"),e.text(F,t+l+d+5,n+8),n+=p}),n},Oe=(e,a,t,s,i)=>{let n=s;const o=12,c=15,l=i*.33,d=i*.33;return e.setFillColor(245,245,245),e.rect(t,n,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Region",t+5,n+10),e.text("Revenue",t+l+5,n+10),e.text("EBITDA",t+l+d+5,n+10),n+=c,e.setFont(void 0,"normal"),a.forEach((h,x)=>{x%2===0&&(e.setFillColor(250,250,250),e.rect(t,n,i,o,"F")),e.text(h.region,t+5,n+8),e.text(`$${(h.revenue/1e6).toFixed(1)}M`,t+l+5,n+8),e.text(`$${(h.ebitda/1e6).toFixed(1)}M`,t+l+d+5,n+8),n+=o}),n},De=(e,a,t,s,i)=>{let n=s;const o=10,c=12,l=i*.25,d=i*.25,h=i*.25,x=a.slice(-6);return e.setFillColor(245,245,245),e.rect(t,n,i,c,"F"),e.setFontSize(10),e.setFont(void 0,"bold"),e.text("Month",t+5,n+8),e.text("Revenue",t+l+5,n+8),e.text("Gross Profit",t+l+d+5,n+8),e.text("EBITDA",t+l+d+h+5,n+8),n+=c,e.setFont(void 0,"normal"),x.forEach((v,f)=>{f%2===0&&(e.setFillColor(250,250,250),e.rect(t,n,i,o,"F")),e.text(v.month,t+5,n+7),e.text(`$${v.revenue}K`,t+l+5,n+7),e.text(`$${v.grossProfit}K`,t+l+d+5,n+7),e.text(`$${v.ebitda}K`,t+l+d+h+5,n+7),n+=o}),n},Be=(e,a,t,s,i)=>{let n=s;return e.setFontSize(11),e.setFont(void 0,"normal"),a.forEach(o=>{const c=typeof o=="object"?JSON.stringify(o):String(o);e.splitTextToSize(`• ${c}`,i).forEach(d=>{e.text(d,t+5,n),n+=6}),n+=2}),n},Ye=(e,a,t,s,i)=>{if(!a||typeof a!="object")return s;let n=s,o=0;e.setFontSize(10);let c=[];if(a.status&&c.push(`Status: ${a.status}`),a.keyInsight){const l=e.splitTextToSize(a.keyInsight,i-10);c=c.concat(l)}return a.totalRevenue&&c.push(`Total Revenue: ${a.totalRevenue}`),a.avgGrossMargin&&c.push(`Average Gross Margin: ${a.avgGrossMargin}`),a.bestMonth&&c.push(`Best performing month: ${a.bestMonth}`),a.topRegion&&c.push(`Top performing region: ${a.topRegion}`),c.length===0?s:(o=c.length*5+15,e.setFillColor(249,250,251),e.setDrawColor(200,200,200),e.roundedRect(t,n,i,o,2,2,"FD"),n+=8,e.setFontSize(10),e.setFont(void 0,"bold"),e.text("Summary:",t+5,n),n+=6,e.setFont(void 0,"normal"),c.forEach(l=>{e.text(l,t+5,n),n+=5}),s+o+5)},Ue=(e,a,t,s)=>{const i=t-15;e.setDrawColor(200,200,200),e.line(s,i-5,a-s,i-5),e.setFontSize(9),e.setTextColor(100,100,100),e.text("Sentia Manufacturing Dashboard Report",s,i);const n=e.internal.getCurrentPageInfo().pageNumber;e.text(`Page ${n}`,a-s-20,i),e.text(`Generated: ${b(new Date,"yyyy-MM-dd HH:mm")}`,a-s-70,i+5)},qe=({open:e,onClose:a})=>{const t=B(new Date),[s,i]=w.useState({from:U(t),to:Y(t)}),[n,o]=w.useState(!1),[c,l]=w.useState(!1),[d,h]=w.useState({capitalKpis:!0,performanceKpis:!0,plAnalysis:!0,regionalContribution:!0,stockLevels:!1,productSales:!1}),x=[{id:"capitalKpis",label:"Capital Position",description:"Working capital, cash coverage, intercompany exposure",recommended:!0},{id:"performanceKpis",label:"Performance Metrics",description:"Revenue, units sold, gross margin",recommended:!0},{id:"plAnalysis",label:"P&L Analysis",description:"Monthly profit and loss trends chart",recommended:!0},{id:"regionalContribution",label:"Regional Performance",description:"Revenue and EBITDA by region",recommended:!0},{id:"stockLevels",label:"Stock Levels",description:"Current inventory status and levels",recommended:!1},{id:"productSales",label:"Product Sales",description:"Sales performance by product line",recommended:!1}],v=(u,m)=>{h(j=>({...j,[u]:m}))},f=(u=!1)=>{if(u){const m={};x.forEach(j=>{m[j.id]=j.recommended}),h(m)}else{const m={};x.forEach(j=>{m[j.id]=!0}),h(m)}},F=()=>{const u={};x.forEach(m=>{u[m.id]=!1}),h(u)},p=Object.values(d).filter(Boolean).length,z=async()=>{if(p===0){$.error("Please select at least one section for your report");return}l(!0);try{const u=await ze(d,s);await _e(u,s),$.success("Report generated successfully!"),a()}catch(u){console.error("Error generating report:",u),$.error("Failed to generate report. Please try again.")}finally{l(!1)}};return r.jsx(be,{open:e,onOpenChange:a,children:r.jsxs(ye,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 shadow-xl",children:[r.jsxs(fe,{children:[r.jsxs(Se,{className:"flex items-center gap-2",children:[r.jsx(A,{className:"h-5 w-5"}),"Generate Manufacturing Report"]}),r.jsx(je,{children:"Create a customized report with your selected dashboard data and date range"})]}),r.jsxs("div",{className:"grid gap-6 py-4",children:[r.jsxs(k,{children:[r.jsxs(C,{children:[r.jsxs(M,{className:"flex items-center gap-2 text-lg",children:[r.jsx(q,{className:"h-4 w-4"}),"Report Period"]}),r.jsx(P,{children:"Select the date range for your report (defaults to last month)"})]}),r.jsx(N,{children:r.jsxs(Me,{open:n,onOpenChange:o,children:[r.jsx(Pe,{asChild:!0,children:r.jsxs(y,{variant:"outline",className:g("w-full justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[r.jsx(V,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?r.jsxs(r.Fragment,{children:[b(s.from,"LLL dd, y")," -"," ",b(s.to,"LLL dd, y")]}):b(s.from,"LLL dd, y"):r.jsx("span",{children:"Pick a date range"})]})}),r.jsx(Ne,{className:"w-auto p-0",align:"start",children:r.jsx(Ce,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:i,numberOfMonths:2})})]})})]}),r.jsxs(k,{children:[r.jsxs(C,{children:[r.jsxs(M,{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(J,{className:"h-4 w-4"}),"Report Sections (",p," selected)"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(y,{variant:"outline",size:"sm",onClick:()=>f(!0),children:"Recommended"}),r.jsx(y,{variant:"outline",size:"sm",onClick:()=>f(!1),children:"Select All"}),r.jsx(y,{variant:"outline",size:"sm",onClick:F,children:"Clear All"})]})]}),r.jsx(P,{children:"Choose which sections to include in your report"})]}),r.jsx(N,{children:r.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:x.map(u=>r.jsx("div",{className:g("rounded-lg border p-4 transition-colors",d[u.id]?"border-blue-200 bg-blue-50":"border-gray-200 hover:border-gray-300",u.recommended&&"ring-1 ring-orange-200"),children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(we,{id:u.id,checked:d[u.id],onCheckedChange:m=>v(u.id,m),className:"mt-1"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs(Fe,{htmlFor:u.id,className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[u.label,u.recommended&&r.jsx("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full",children:"Recommended"})]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:u.description})]})]})},u.id))})})]}),p>0&&r.jsxs(k,{children:[r.jsxs(C,{children:[r.jsx(M,{className:"text-lg",children:"Report Preview"}),r.jsx(P,{children:"Your report will include the following sections"})]}),r.jsx(N,{children:r.jsxs("div",{className:"text-sm space-y-2",children:[r.jsxs("p",{className:"font-medium",children:["Report Period: ",(s==null?void 0:s.from)&&b(s.from,"MMMM d, yyyy")," - ",(s==null?void 0:s.to)&&b(s.to,"MMMM d, yyyy")]}),r.jsx("p",{className:"font-medium",children:"Included Sections:"}),r.jsx("ul",{className:"list-disc list-inside space-y-1 ml-4",children:x.filter(u=>d[u.id]).map(u=>r.jsxs("li",{className:"text-muted-foreground",children:[u.label," - ",u.description]},u.id))})]})})]})]}),r.jsx(ke,{}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(y,{variant:"outline",onClick:a,children:"Cancel"}),r.jsx(y,{onClick:z,disabled:p===0||c,className:"bg-blue-600 hover:bg-blue-700",children:c?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(A,{className:"w-4 h-4 mr-2"}),"Generate PDF Report"]})})]})]})})},tt=()=>{const[e,a]=w.useState(!1),t=()=>{a(!0)};return r.jsxs(r.Fragment,{children:[r.jsxs(k,{className:"mt-8",children:[r.jsxs(C,{children:[r.jsxs(M,{className:"flex items-center gap-2",children:[r.jsx(Q,{className:"h-5 w-5"}),"Quick Actions"]}),r.jsx(P,{children:"Generate reports and perform common dashboard operations"})]}),r.jsxs(N,{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[r.jsxs(y,{onClick:t,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white min-w-[160px]",size:"lg",children:[r.jsx(X,{className:"h-4 w-4"}),"Generate Reports"]}),r.jsxs(y,{variant:"outline",className:"flex items-center gap-2 min-w-[160px]",size:"lg",disabled:!0,children:[r.jsx(Z,{className:"h-4 w-4"}),"Export Data"]})]}),r.jsx("p",{className:"text-sm text-muted-foreground mt-4 text-center",children:"Create customizable reports with your dashboard data and export as PDF"})]})]}),r.jsx(qe,{open:e,onClose:()=>a(!1)})]})};export{tt as default};
