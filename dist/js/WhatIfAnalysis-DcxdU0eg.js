import{r as e,j as a,aC as s,aD as t,aE as i,aF as n,ar as r,aG as l,ap as o,aH as c,aI as d,aJ as m,aK as u}from"./chunk-gD0WZlZe.js";import{D as h}from"./chunk-E_h9yjlz.js";import{C as x}from"./chunk-Bcr4iqHm.js";import{R as p,k as g,l as y,X as v,Y as f,m as j,n as b,o as w,q as k}from"./chunk-CGOCBQ1v.js";import"./chunk-tZo8O77D.js";import"./chunk-BY8qDDXp.js";import"./chunk-D_LFaUfL.js";import"./chunk-DuMuM8ZY.js";import"./chunk-B0LCvgW6.js";import"./chunk-BXzNuMxH.js";import"./chunk-Dozjk7Op.js";const C=()=>{const[u]=e.useState(()=>new h),[C]=e.useState(()=>new x),[F,G]=e.useState({rawMaterials:{availability:85,deliveryTime:14,costVariation:0,bufferStock:20},manufacturing:{capacity:80,efficiency:92,overtime:0,downtime:5},inventory:{finishedGoods:30,rawMaterials:21,workInProcess:7,safetyStock:15},sales:{ukGrowth:8,usGrowth:12,euGrowth:5,seasonality:15,newProducts:0},finance:{interestRate:4.5,paymentTerms:30,collectionPeriod:45,payablesPeriod:60,cashReserve:10}}),[I]=e.useState({uk:{revenue:125e5,growth:8,margin:22,risk:"Low"},us:{revenue:182e5,growth:12,margin:25,risk:"Medium"},eu:{revenue:98e5,growth:5,margin:18,risk:"Low"}}),V=e.useMemo(()=>{const{rawMaterials:e,manufacturing:a,inventory:s,sales:t,finance:i}=F;try{const n=u.getCurrentContext(),r={targetDSO:i.collectionPeriod,targetDPO:i.payablesPeriod,targetDIO:(s.finishedGoods+s.rawMaterials+s.workInProcess)/3,creditTerms:{net15:.1,net30:i.collectionPeriod<=30?.6:.4,net45:i.collectionPeriod>30?.4:.2,net60:i.collectionPeriod>45?.3:.1}},l=new x(r).calculateCashConversionCycle({annualRevenue:I.uk.revenue+I.us.revenue+I.eu.revenue,annualCOGS:.65*(I.uk.revenue+I.us.revenue+I.eu.revenue)}),o=u.seasonalPatterns.getBusinessSeasonality(n.currentMonth,n.currentQuarter),c=I.uk.revenue*(1+t.ukGrowth/100)*o+I.us.revenue*(1+t.usGrowth/100)*o+I.eu.revenue*(1+t.euGrowth/100)*o,d=a.capacity/100,m=a.efficiency/100,h=(100-a.downtime)/100,p=Math.min(1,d*m*h),g=c*p,y=l.balanceSheetItems.receivables+l.balanceSheetItems.inventory-l.balanceSheetItems.payables,v=(100-e.availability)/100,f=(v+Math.max(0,(e.deliveryTime-7)/30))/2,j=y*(i.interestRate/100),b=t.seasonality/100,w=([10,11,12].includes(n.currentMonth),y*(1+b)),k=y*(1-b/2),C=p>.95?.8:p<.7?.6:.3,M=Math.min(100,100*(40*f+30*C+i.interestRate/12*30));return{projectedRevenue:Math.round(g),workingCapital:Math.round(y),seasonalPeak:Math.round(w),seasonalTrough:Math.round(k),interestCost:Math.round(j),inventoryValue:Math.round(l.balanceSheetItems.inventory),receivablesValue:Math.round(l.balanceSheetItems.receivables),payablesValue:Math.round(l.balanceSheetItems.payables),actualCapacity:Math.round(100*p),rawMaterialRisk:Math.round(100*f),overallRisk:Math.round(M),cashConversionCycle:l.cashConversionCycle,cccComponents:l.components,seasonalMultiplier:Math.round(100*o)/100,businessContext:n,recommendations:P(F,{workingCapital:y,actualCapacity:p,supplychainRisk:f,cccResults:l,context:n})}}catch(n){return $(F,I)}},[F,I,u,C]),D=e.useMemo(()=>{const e=[],a=V.workingCapital;for(let s=0;s<12;s++){const t=1+F.sales.seasonality/100*Math.sin(s*Math.PI*2/12+Math.PI/2);e.push({month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s],workingCapital:Math.round(a*t),cashFlow:Math.round(V.projectedRevenue/12*t-V.interestCost/12*t),inventory:Math.round(V.inventoryValue*t),receivables:Math.round(V.receivablesValue*t)})}return e},[V,F]),T=e.useCallback((e,a,s)=>{G(t=>({...t,[e]:{...t[e],[a]:s}}))},[]);return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[a.jsx(s,{className:"w-8 h-8 mr-3 text-blue-600"}),"What-If Analysis"]}),a.jsx("p",{className:"mt-2 text-gray-600",children:"Interactive working capital optimization for UK, US, and EU markets"})]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Working Capital"}),a.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["$",(V.workingCapital/1e6).toFixed(1),"M"]})]})})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[a.jsx(M,{title:"Projected Revenue",value:`$${(V.projectedRevenue/1e6).toFixed(1)}M`,change:"vs current year",trend:"up",icon:a.jsx(t,{className:"w-6 h-6"}),color:"green"}),a.jsx(M,{title:"Seasonal Peak WC",value:`$${(V.seasonalPeak/1e6).toFixed(1)}M`,change:`+${F.sales.seasonality}% seasonal`,trend:"up",icon:a.jsx(i,{className:"w-6 h-6"}),color:"orange"}),a.jsx(M,{title:"Interest Cost",value:`$${(V.interestCost/1e3).toFixed(0)}K`,change:`@ ${F.finance.interestRate}% rate`,trend:"neutral",icon:a.jsx(n,{className:"w-6 h-6"}),color:"blue"}),a.jsx(M,{title:"Capacity Utilization",value:`${V.actualCapacity}%`,change:"effective capacity",trend:V.actualCapacity>95?"up":"neutral",icon:a.jsx(r,{className:"w-6 h-6"}),color:V.actualCapacity>95?"red":"blue"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs(N,{title:"Raw Materials & Supply Chain",icon:a.jsx(l,{className:"w-5 h-5"}),children:[a.jsx(S,{label:"Material Availability",value:F.rawMaterials.availability,onChange:e=>T("rawMaterials","availability",e),min:50,max:100,suffix:"%",description:"Supplier reliability and material availability"}),a.jsx(S,{label:"Delivery Lead Time",value:F.rawMaterials.deliveryTime,onChange:e=>T("rawMaterials","deliveryTime",e),min:7,max:60,suffix:" days",description:"Average delivery time from suppliers"}),a.jsx(S,{label:"Cost Variation",value:F.rawMaterials.costVariation,onChange:e=>T("rawMaterials","costVariation",e),min:-20,max:30,suffix:"%",description:"Expected change in raw material costs"}),a.jsx(S,{label:"Buffer Stock Level",value:F.rawMaterials.bufferStock,onChange:e=>T("rawMaterials","bufferStock",e),min:0,max:50,suffix:"%",description:"Safety stock as % of normal inventory"})]}),a.jsxs(N,{title:"Manufacturing Operations",icon:a.jsx(o,{className:"w-5 h-5"}),children:[a.jsx(S,{label:"Capacity Utilization",value:F.manufacturing.capacity,onChange:e=>T("manufacturing","capacity",e),min:50,max:100,suffix:"%",description:"Percentage of maximum production capacity"}),a.jsx(S,{label:"Manufacturing Efficiency",value:F.manufacturing.efficiency,onChange:e=>T("manufacturing","efficiency",e),min:70,max:100,suffix:"%",description:"Overall equipment effectiveness (OEE)"}),a.jsx(S,{label:"Overtime Hours",value:F.manufacturing.overtime,onChange:e=>T("manufacturing","overtime",e),min:0,max:40,suffix:"%",description:"Overtime as % of regular hours"})]}),a.jsxs(N,{title:"Inventory Management",icon:a.jsx(l,{className:"w-5 h-5"}),children:[a.jsx(S,{label:"Finished Goods Inventory",value:F.inventory.finishedGoods,onChange:e=>T("inventory","finishedGoods",e),min:7,max:90,suffix:" days",description:"Days of finished goods inventory"}),a.jsx(S,{label:"Raw Materials Inventory",value:F.inventory.rawMaterials,onChange:e=>T("inventory","rawMaterials",e),min:7,max:60,suffix:" days",description:"Days of raw materials inventory"}),a.jsx(S,{label:"Safety Stock Level",value:F.inventory.safetyStock,onChange:e=>T("inventory","safetyStock",e),min:5,max:40,suffix:"%",description:"Safety stock as % of normal inventory"})]}),a.jsxs(N,{title:"Sales Projections by Market",icon:a.jsx(i,{className:"w-5 h-5"}),children:[a.jsx(S,{label:"UK Market Growth",value:F.sales.ukGrowth,onChange:e=>T("sales","ukGrowth",e),min:-10,max:25,suffix:"%",description:"Expected growth in UK market"}),a.jsx(S,{label:"US Market Growth",value:F.sales.usGrowth,onChange:e=>T("sales","usGrowth",e),min:-10,max:30,suffix:"%",description:"Expected growth in US market"}),a.jsx(S,{label:"EU Market Growth",value:F.sales.euGrowth,onChange:e=>T("sales","euGrowth",e),min:-15,max:20,suffix:"%",description:"Expected growth in EU market"}),a.jsx(S,{label:"Seasonal Variation",value:F.sales.seasonality,onChange:e=>T("sales","seasonality",e),min:0,max:50,suffix:"%",description:"Peak season vs. normal sales"})]}),a.jsxs(N,{title:"Financial Parameters",icon:a.jsx(t,{className:"w-5 h-5"}),children:[a.jsx(S,{label:"Borrowing Interest Rate",value:F.finance.interestRate,onChange:e=>T("finance","interestRate",e),min:1,max:12,suffix:"%",step:.1,description:"Cost of borrowing working capital"}),a.jsx(S,{label:"Customer Payment Terms",value:F.finance.collectionPeriod,onChange:e=>T("finance","collectionPeriod",e),min:15,max:90,suffix:" days",description:"Average customer payment period"}),a.jsx(S,{label:"Supplier Payment Terms",value:F.finance.payablesPeriod,onChange:e=>T("finance","payablesPeriod",e),min:15,max:120,suffix:" days",description:"Payment terms with suppliers"})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[a.jsx(c,{className:"w-5 h-5 mr-2 text-blue-600"}),"Working Capital Components"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[a.jsx("span",{className:"text-sm font-medium text-green-900",children:"Inventory"}),a.jsxs("span",{className:"text-lg font-bold text-green-900",children:["$",(V.inventoryValue/1e6).toFixed(1),"M"]})]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg",children:[a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Receivables"}),a.jsxs("span",{className:"text-lg font-bold text-blue-900",children:["$",(V.receivablesValue/1e6).toFixed(1),"M"]})]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg",children:[a.jsx("span",{className:"text-sm font-medium text-red-900",children:"Payables"}),a.jsxs("span",{className:"text-lg font-bold text-red-900",children:["-$",(V.payablesValue/1e6).toFixed(1),"M"]})]}),a.jsx("div",{className:"border-t pt-3",children:a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Net Working Capital"}),a.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["$",(V.workingCapital/1e6).toFixed(1),"M"]})]})})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[a.jsx(d,{className:"w-5 h-5 mr-2 text-orange-600"}),"Risk Assessment"]}),a.jsx(R,{label:"Overall Risk",level:V.overallRisk}),a.jsx(R,{label:"Supply Chain Risk",level:V.rawMaterialRisk}),a.jsx(R,{label:"Capacity Risk",level:V.actualCapacity>95?85:25})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[a.jsx(m,{className:"w-5 h-5 mr-2 text-green-600"}),"Recommendations"]}),a.jsx("div",{className:"space-y-3",children:V.recommendations.map((e,s)=>a.jsxs("div",{className:"p-3 rounded-lg text-sm "+("high"===e.priority?"bg-red-50 border border-red-200":"medium"===e.priority?"bg-yellow-50 border border-yellow-200":"bg-blue-50 border border-blue-200"),children:[a.jsx("div",{className:"font-medium mb-1",children:e.title}),a.jsx("div",{className:"text-gray-600",children:e.description})]},s))})]})]})]}),a.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Seasonal Working Capital Requirements"}),a.jsx(p,{width:"100%",height:300,children:a.jsxs(g,{data:D,children:[a.jsx(y,{strokeDasharray:"3 3"}),a.jsx(v,{dataKey:"month"}),a.jsx(f,{tickFormatter:e=>`$${(e/1e6).toFixed(1)}M`}),a.jsx(j,{formatter:e=>[`$${(e/1e6).toFixed(1)}M`,"Working Capital"]}),a.jsx(b,{type:"monotone",dataKey:"workingCapital",stroke:"#3B82F6",fill:"#93C5FD",strokeWidth:2})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Monthly Cash Flow Projection"}),a.jsx(p,{width:"100%",height:300,children:a.jsxs(w,{data:D,children:[a.jsx(y,{strokeDasharray:"3 3"}),a.jsx(v,{dataKey:"month"}),a.jsx(f,{tickFormatter:e=>`$${(e/1e6).toFixed(1)}M`}),a.jsx(j,{formatter:e=>[`$${(e/1e6).toFixed(1)}M`]}),a.jsx(k,{type:"monotone",dataKey:"cashFlow",stroke:"#10B981",strokeWidth:2,dot:{fill:"#10B981",strokeWidth:2,r:4}})]})})]})]})]})})},M=({title:e,value:s,change:t,trend:n,icon:r,color:l})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),a.jsx("div",{className:`p-2 rounded-lg ${{green:"bg-green-50 text-green-600",red:"bg-red-50 text-red-600",blue:"bg-blue-50 text-blue-600",orange:"bg-orange-50 text-orange-600"}[l]}`,children:r})]}),a.jsx("div",{className:"flex items-end justify-between",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s}),a.jsxs("div",{className:"flex items-center mt-1",children:["up"===n&&a.jsx(i,{className:"w-4 h-4 text-green-500"}),"down"===n&&a.jsx(u,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{className:"text-sm text-gray-500 ml-1",children:t})]})]})})]}),N=({title:e,icon:s,children:t})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-gray-900",children:[a.jsx("span",{className:"text-blue-600 mr-2",children:s}),e]}),a.jsx("div",{className:"space-y-4",children:t})]}),S=({label:e,value:s,onChange:t,min:i,max:n,suffix:r="",step:l=1,description:o})=>a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:e}),a.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[s,r]})]}),a.jsx("input",{type:"range",min:i,max:n,step:l,value:s,onChange:e=>t(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),a.jsx("p",{className:"text-xs text-gray-500",children:o})]}),R=({label:e,level:s})=>{return a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-700 mb-1",children:[a.jsx("span",{children:e}),a.jsx("span",{children:(t=s,t<=30?"Low":t<=60?"Medium":"High")})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full ${(e=>e<=30?"bg-green-500":e<=60?"bg-yellow-500":"bg-red-500")(s)}`,style:{width:`${s}%`}})})]});var t},P=(e,a)=>{const{workingCapital:s,actualCapacity:t,cccResults:i,context:n}=a,r=[];return i&&i.cashConversionCycle>(i.benchmarks?.targetCCC||45)+10&&r.push({type:"cash-conversion",priority:"high",message:`CCC of ${i.cashConversionCycle.toFixed(1)} days exceeds target`,impact:`Potential cash release: £${Math.round(4e7*(i.cashConversionCycle-45)/365).toLocaleString()}`}),n&&[9,10].includes(n.currentMonth)&&r.push({type:"seasonal",priority:"medium",message:"Q4 peak season approaching. Ensure adequate credit facilities.",impact:`Additional WC needed: £${Math.round(.2*s).toLocaleString()}`}),t>95&&n&&[10,11,12].includes(n.currentMonth)&&r.push({type:"capacity",priority:"high",message:"Peak season capacity constraint detected.",impact:"Revenue at risk during peak demand period"}),r},$=(e,a)=>{const{rawMaterials:s,manufacturing:t,sales:i,finance:n}=e,r=(a.uk.revenue+a.us.revenue+a.eu.revenue)*(1+i.ukGrowth/200),l=Math.min(100,t.capacity*t.efficiency/100),o=.25*r;return{projectedRevenue:Math.round(r),workingCapital:Math.round(o),seasonalPeak:Math.round(1.2*o),seasonalTrough:Math.round(.8*o),interestCost:Math.round(o*n.interestRate/100),inventoryValue:Math.round(.4*o),receivablesValue:Math.round(.35*o),payablesValue:Math.round(.25*o),actualCapacity:Math.round(l),rawMaterialRisk:Math.round(100-s.availability),overallRisk:50,cashConversionCycle:45,cccComponents:{dso:30,dio:35,dpo:20},seasonalMultiplier:1,businessContext:{currentDate:(new Date).toISOString().split("T")[0]},recommendations:[{type:"fallback",priority:"medium",message:"Using simplified calculations. Full calendar analysis unavailable.",impact:"Limited scenario accuracy"}]}};export{C as default};
