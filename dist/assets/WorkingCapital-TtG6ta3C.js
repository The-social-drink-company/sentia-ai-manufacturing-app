import{j as e}from"./query-CJR12TOn.js";import{a as s}from"./vendor-BPOA5ME_.js";import{a}from"./axios-3c2ZL6GZ.js";import{n as i,o as t,f as n,b as c,g as r,h as l}from"./index-e-Rauy7p.js";import{F as d}from"./ClockIcon-BNTGqfUF.js";import{F as o}from"./ExclamationTriangleIcon-ztEnirSg.js";function h({title:e,titleId:a,...i},t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},i),e?s.createElement("title",{id:a},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const m=s.forwardRef(h);function x(){const[t,n]=s.useState(null),[c,r]=s.useState(!1),[l,d]=s.useState(null),[o,h]=s.useState(12),m=async()=>{try{r(!0),d(null);const e={Authorization:`Bearer ${await(async()=>null)()}`},s=await a.get(`/api/working-capital/kpis/trends?months=${o}`,{headers:e});n(s.data.data)}catch(e){i("KPI fetch error",e,{component:"KPIDashboard",timeframe:o}),d(e.response?.data?.error||e.message)}finally{r(!1)}};s.useEffect(()=>{m()},[o]);const x=(e,s)=>{const a={ccc:{excellent:45,good:55,threshold:65},dso:{excellent:30,good:35,threshold:45},dpo:{excellent:30,good:25,threshold:20},dio:{excellent:40,good:45,threshold:55},inv_turnover:{excellent:8,good:6,threshold:4},wc_turnover:{excellent:6.5,good:5,threshold:3.5},facility_utilization:{excellent:.3,good:.6,threshold:.8}}[e];return a&&null!=s?["ccc","dso","dio","facility_utilization"].includes(e)?s<=a.excellent?"excellent":s<=a.good?"good":s<=a.threshold?"warning":"critical":["dpo","inv_turnover","wc_turnover"].includes(e)?s>=a.excellent?"excellent":s>=a.good?"good":s>=a.threshold?"warning":"critical":"unknown":"unknown"},j=(e,s)=>null==s?"N/A":"facility_utilization"===e?`${(100*s).toFixed(1)}%`:["inv_turnover","wc_turnover"].includes(e)?`${s.toFixed(1)}x`:`${s.toFixed(1)} days`,u=t?.trends&&0!==t.trends.length?t.trends[t.trends.length-1]:null;return e.jsxs("div",{className:"sentia-kpi-container",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"KPI Analysis"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-form-grid",children:[e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Time Period"}),e.jsxs("select",{className:"sentia-select",value:o,onChange:e=>h(parseInt(e.target.value)),children:[e.jsx("option",{value:3,children:"Last 3 Months"}),e.jsx("option",{value:6,children:"Last 6 Months"}),e.jsx("option",{value:12,children:"Last 12 Months"}),e.jsx("option",{value:24,children:"Last 24 Months"})]})]}),e.jsx("div",{className:"sentia-form-group",children:e.jsx("button",{className:"sentia-btn sentia-btn-primary",onClick:m,disabled:c,children:c?"Loading...":"Refresh KPIs"})})]})})]}),l&&e.jsx("div",{className:"sentia-error",children:e.jsxs("div",{className:"sentia-error-content",children:[e.jsx("h4",{children:"KPI Loading Error"}),e.jsx("p",{children:l}),e.jsx("button",{onClick:m,className:"sentia-btn sentia-btn-secondary",children:"Retry"})]})}),c&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-loading",children:[e.jsx("div",{className:"sentia-spinner"}),e.jsx("p",{children:"Loading KPI trends..."})]})})}),u&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sentia-grid sentia-grid-4",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"Cash Conversion Cycle"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("ccc",u.ccc)}`,children:x("ccc",u.ccc)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("ccc",u.ccc)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: <55 days"})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"Days Sales Outstanding"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("dso",u.dso)}`,children:x("dso",u.dso)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("dso",u.dso)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: <35 days"})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"Days Payable Outstanding"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("dpo",u.dpo)}`,children:x("dpo",u.dpo)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("dpo",u.dpo)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: >25 days"})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"Days Inventory Outstanding"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("dio",u.dio)}`,children:x("dio",u.dio)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("dio",u.dio)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: <45 days"})]})})]})]}),e.jsxs("div",{className:"sentia-grid sentia-grid-3",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"Inventory Turnover"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("inv_turnover",u.inv_turnover)}`,children:x("inv_turnover",u.inv_turnover)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("inv_turnover",u.inv_turnover)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: >8x annually"})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"WC Turnover"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("wc_turnover",u.wc_turnover)}`,children:x("wc_turnover",u.wc_turnover)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("wc_turnover",u.wc_turnover)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: >6.5x annually"})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h4",{className:"sentia-card-title",children:"Credit Utilization"}),e.jsx("div",{className:`sentia-kpi-status sentia-status-${x("facility_utilization",u.facility_utilization)}`,children:x("facility_utilization",u.facility_utilization)})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsx("span",{className:"sentia-metric-value",children:j("facility_utilization",u.facility_utilization)}),e.jsx("span",{className:"sentia-metric-label",children:"Target: <60%"})]})})]})]}),t.trends.length>1&&e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"KPI Trends"}),e.jsxs("div",{className:"sentia-card-badge",children:[t.trends.length," data points"]})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsx("div",{className:"sentia-table-container",children:e.jsxs("table",{className:"sentia-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"CCC"}),e.jsx("th",{children:"DSO"}),e.jsx("th",{children:"DPO"}),e.jsx("th",{children:"DIO"}),e.jsx("th",{children:"Inv Turnover"}),e.jsx("th",{children:"WC Turnover"}),e.jsx("th",{children:"Credit Util"})]})}),e.jsx("tbody",{children:t.trends.slice(-10).reverse().map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(s.createdAt).toLocaleDateString("en-GB")}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("ccc",s.ccc)}`,children:j("ccc",s.ccc)}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("dso",s.dso)}`,children:j("dso",s.dso)}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("dpo",s.dpo)}`,children:j("dpo",s.dpo)}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("dio",s.dio)}`,children:j("dio",s.dio)}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("inv_turnover",s.inv_turnover)}`,children:j("inv_turnover",s.inv_turnover)}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("wc_turnover",s.wc_turnover)}`,children:j("wc_turnover",s.wc_turnover)}),e.jsx("td",{className:`sentia-kpi-cell sentia-${x("facility_utilization",s.facility_utilization)}`,children:j("facility_utilization",s.facility_utilization)})]},a))})]})})})]})]}),!t&&!c&&!l&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No KPI data available"}),e.jsx("small",{children:"Historical KPI data will appear here once working capital projections are generated"})]})})})]})}function j(){const[t,n]=s.useState(null),[c,r]=s.useState(!1),[l,d]=s.useState(null),[o,h]=s.useState({horizonMonths:12,currency:"GBP",scenarios:["baseline"]}),m=async()=>{try{r(!0),d(null);const e={Authorization:`Bearer ${await(async()=>null)()}`},s=await a.post("/api/working-capital/projections",{...o,startMonth:new Date},{headers:e});n(s.data.data)}catch(e){i("Projection error",e,{component:"CashFlowProjections"}),d(e.response?.data?.error||e.message)}finally{r(!1)}};s.useEffect(()=>{m()},[]);const x=(e,s)=>{h(a=>({...a,[e]:s}))};return e.jsxs("div",{className:"sentia-projections-container",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Projection Parameters"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-form-grid",children:[e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Horizon (Months)"}),e.jsxs("select",{className:"sentia-select",value:o.horizonMonths,onChange:e=>x("horizonMonths",parseInt(e.target.value)),children:[e.jsx("option",{value:3,children:"3 Months"}),e.jsx("option",{value:6,children:"6 Months"}),e.jsx("option",{value:12,children:"12 Months"}),e.jsx("option",{value:24,children:"24 Months"})]})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Currency"}),e.jsxs("select",{className:"sentia-select",value:o.currency,onChange:e=>x("currency",e.target.value),children:[e.jsx("option",{value:"GBP",children:"GBP (Â£)"}),e.jsx("option",{value:"EUR",children:"EUR (â‚¬)"}),e.jsx("option",{value:"USD",children:"USD ($)"})]})]}),e.jsx("div",{className:"sentia-form-group",children:e.jsx("button",{className:"sentia-btn sentia-btn-primary",onClick:m,disabled:c,children:c?"Generating...":"Generate Projection"})})]})})]}),l&&e.jsx("div",{className:"sentia-error",children:e.jsxs("div",{className:"sentia-error-content",children:[e.jsx("h4",{children:"Projection Error"}),e.jsx("p",{children:l}),e.jsx("button",{onClick:m,className:"sentia-btn sentia-btn-secondary",children:"Retry"})]})}),c&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-loading",children:[e.jsx("div",{className:"sentia-spinner"}),e.jsx("p",{children:"Generating cash flow projections..."})]})})}),t&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sentia-grid sentia-grid-3",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h4",{className:"sentia-card-title",children:"Total Cash In"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsxs("span",{className:"sentia-metric-value",children:["Â£",t.scenarios.baseline.summary.totalCashIn.toLocaleString()]}),e.jsxs("span",{className:"sentia-metric-label",children:["Over ",o.horizonMonths," months"]})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h4",{className:"sentia-card-title",children:"Total Cash Out"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsxs("span",{className:"sentia-metric-value",children:["Â£",t.scenarios.baseline.summary.totalCashOut.toLocaleString()]}),e.jsxs("span",{className:"sentia-metric-label",children:["Over ",o.horizonMonths," months"]})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h4",{className:"sentia-card-title",children:"Net Cash Flow"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-metric",children:[e.jsxs("span",{className:"sentia-metric-value "+(t.scenarios.baseline.summary.netCashFlow>=0?"sentia-positive":"sentia-negative"),children:["Â£",t.scenarios.baseline.summary.netCashFlow.toLocaleString()]}),e.jsxs("span",{className:"sentia-metric-label",children:["Net over ",o.horizonMonths," months"]})]})})]})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Monthly Cash Flow Projections"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsx("div",{className:"sentia-table-container",children:e.jsxs("table",{className:"sentia-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Month"}),e.jsx("th",{children:"Opening Cash"}),e.jsx("th",{children:"Cash In"}),e.jsx("th",{children:"Cash Out"}),e.jsx("th",{children:"Net Change"}),e.jsx("th",{children:"Ending Cash"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.scenarios.baseline.projections.map((s,a)=>{const i=new Date(s.month).toLocaleDateString("en-GB",{month:"short",year:"numeric"}),t=s.ending_cash<5e4;return e.jsxs("tr",{children:[e.jsx("td",{children:i}),e.jsxs("td",{children:["Â£",s.openingCash?s.openingCash.toLocaleString():"0"]}),e.jsxs("td",{className:"sentia-positive",children:["Â£",s.cash_in.toLocaleString()]}),e.jsxs("td",{className:"sentia-negative",children:["Â£",s.cash_out.toLocaleString()]}),e.jsxs("td",{className:s.net_change>=0?"sentia-positive":"sentia-negative",children:["Â£",s.net_change.toLocaleString()]}),e.jsxs("td",{className:t?"sentia-negative":"sentia-positive",children:["Â£",s.ending_cash.toLocaleString()]}),e.jsxs("td",{children:[t&&e.jsx("span",{className:"sentia-status sentia-status-error",children:"Low Cash"}),!t&&s.net_change>=0&&e.jsx("span",{className:"sentia-status sentia-status-success",children:"Healthy"}),!t&&s.net_change<0&&e.jsx("span",{className:"sentia-status sentia-status-warning",children:"Declining"})]})]},s.id)})})]})})})]}),t.scenarios.baseline.summary.breachMonths>0&&e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Risk Analysis"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsx("div",{className:"sentia-alert sentia-alert-warning",children:e.jsxs("div",{className:"sentia-alert-content",children:[e.jsxs("div",{className:"sentia-alert-message",children:["WARNING: Cash falls below minimum buffer in ",t.scenarios.baseline.summary.breachMonths," months"]}),e.jsxs("div",{className:"sentia-alert-details",children:["Minimum cash level: Â£",t.scenarios.baseline.summary.minCash.toLocaleString()]})]})})})]})]}),!t&&!c&&!l&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No projection data available"}),e.jsx("small",{children:'Click "Generate Projection" to create cash flow projections'})]})})})]})}function u(){const[t,n]=s.useState(null),[c,r]=s.useState(!1),[l,d]=s.useState(null),[o,h]=s.useState({horizonMonths:12,currency:"GBP"}),[m,x]=s.useState([{name:"Optimistic",description:"Growth acceleration scenario",parameters:{demandAdjustment:.15,priceAdjustment:.05,arTermsAdjustment:-.1}},{name:"Pessimistic",description:"Economic downturn scenario",parameters:{demandAdjustment:-.2,cogsAdjustment:.1,arTermsAdjustment:.15}}]),j=async()=>{try{r(!0),d(null);const e={Authorization:`Bearer ${await(async()=>null)()}`},s=await a.post("/api/working-capital/scenarios",{baselineParams:{...o,startMonth:new Date},overrides:m},{headers:e});n(s.data.data)}catch(e){i("Scenario analysis error",e,{component:"ScenarioAnalysis"}),d(e.response?.data?.error||e.message)}finally{r(!1)}},u=(e,s,a)=>{const i=[...m];if(s.includes(".")){const[t,n]=s.split(".");i[e][t][n]=parseFloat(a)||0}else i[e][s]=a;x(i)};return e.jsxs("div",{className:"sentia-scenario-container",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Scenario Configuration"})}),e.jsxs("div",{className:"sentia-card-content",children:[e.jsxs("div",{className:"sentia-form-section",children:[e.jsx("h4",{children:"Baseline Parameters"}),e.jsxs("div",{className:"sentia-form-grid",children:[e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Horizon (Months)"}),e.jsxs("select",{className:"sentia-select",value:o.horizonMonths,onChange:e=>h({...o,horizonMonths:parseInt(e.target.value)}),children:[e.jsx("option",{value:6,children:"6 Months"}),e.jsx("option",{value:12,children:"12 Months"}),e.jsx("option",{value:24,children:"24 Months"})]})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Currency"}),e.jsxs("select",{className:"sentia-select",value:o.currency,onChange:e=>h({...o,currency:e.target.value}),children:[e.jsx("option",{value:"GBP",children:"GBP (Â£)"}),e.jsx("option",{value:"EUR",children:"EUR (â‚¬)"}),e.jsx("option",{value:"USD",children:"USD ($)"})]})]})]})]}),e.jsxs("div",{className:"sentia-form-section",children:[e.jsxs("div",{className:"sentia-section-header",children:[e.jsx("h4",{children:"Scenarios"}),e.jsx("button",{className:"sentia-btn sentia-btn-ghost",onClick:()=>{x([...m,{name:`Custom ${m.length+1}`,description:"Custom scenario",parameters:{demandAdjustment:0,priceAdjustment:0,cogsAdjustment:0,arTermsAdjustment:0}}])},children:"Add Custom Scenario"})]}),m.map((s,a)=>e.jsxs("div",{className:"sentia-scenario-form",children:[e.jsxs("div",{className:"sentia-scenario-header",children:[e.jsx("input",{type:"text",className:"sentia-input",value:s.name,onChange:e=>u(a,"name",e.target.value),placeholder:"Scenario name"}),e.jsx("button",{className:"sentia-btn sentia-btn-ghost sentia-btn-sm",onClick:()=>(e=>{x(m.filter((s,a)=>a!==e))})(a),children:"Remove"})]}),e.jsx("input",{type:"text",className:"sentia-input",value:s.description,onChange:e=>u(a,"description",e.target.value),placeholder:"Scenario description"}),e.jsxs("div",{className:"sentia-scenario-params",children:[e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Demand Change (%)"}),e.jsx("input",{type:"number",className:"sentia-input",value:(100*s.parameters.demandAdjustment).toFixed(1),onChange:e=>u(a,"parameters.demandAdjustment",e.target.value/100),step:"0.1",placeholder:"0.0"})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Price Change (%)"}),e.jsx("input",{type:"number",className:"sentia-input",value:(100*s.parameters.priceAdjustment).toFixed(1),onChange:e=>u(a,"parameters.priceAdjustment",e.target.value/100),step:"0.1",placeholder:"0.0"})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"COGS Change (%)"}),e.jsx("input",{type:"number",className:"sentia-input",value:(100*(s.parameters.cogsAdjustment||0)).toFixed(1),onChange:e=>u(a,"parameters.cogsAdjustment",e.target.value/100),step:"0.1",placeholder:"0.0"})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Collection Terms (%)"}),e.jsx("input",{type:"number",className:"sentia-input",value:(100*(s.parameters.arTermsAdjustment||0)).toFixed(1),onChange:e=>u(a,"parameters.arTermsAdjustment",e.target.value/100),step:"0.1",placeholder:"0.0"})]})]})]},a))]}),e.jsx("div",{className:"sentia-form-actions",children:e.jsx("button",{className:"sentia-btn sentia-btn-primary",onClick:j,disabled:c||0===m.length,children:c?"Analyzing...":"Run Scenario Analysis"})})]})]}),l&&e.jsx("div",{className:"sentia-error",children:e.jsxs("div",{className:"sentia-error-content",children:[e.jsx("h4",{children:"Scenario Analysis Error"}),e.jsx("p",{children:l}),e.jsx("button",{onClick:j,className:"sentia-btn sentia-btn-secondary",children:"Retry"})]})}),c&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-loading",children:[e.jsx("div",{className:"sentia-spinner"}),e.jsx("p",{children:"Running scenario analysis..."})]})})}),t&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Scenario Comparison"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsx("div",{className:"sentia-table-container",children:e.jsxs("table",{className:"sentia-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Scenario"}),e.jsx("th",{children:"Net Cash Flow"}),e.jsx("th",{children:"Variance"}),e.jsx("th",{children:"Min Cash"}),e.jsx("th",{children:"Risk Score"}),e.jsx("th",{children:"CCC"}),e.jsx("th",{children:"CCC Change"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"sentia-baseline-row",children:[e.jsx("td",{children:e.jsx("strong",{children:"Baseline"})}),e.jsxs("td",{children:["Â£",t.baseline?.scenarios?.baseline?.summary?.netCashFlow?.toLocaleString()||"N/A"]}),e.jsx("td",{children:"-"}),e.jsxs("td",{children:["Â£",t.baseline?.scenarios?.baseline?.summary?.minCash?.toLocaleString()||"N/A"]}),e.jsx("td",{children:t.baseline?.summary?.riskScore||"N/A"}),e.jsxs("td",{children:[t.baseline?.summary?.ccc?.toFixed(1)||"N/A"," days"]}),e.jsx("td",{children:"-"})]}),t.scenarios?.map((s,a)=>{const i=t.baseline?.scenarios?.baseline?.summary?.netCashFlow||0,n=s.results?.scenarios?.baseline?.summary?.netCashFlow||0,c=(l=n,(r=i)&&l?((l-r)/r*100).toFixed(1)+"%":"N/A");var r,l;const d=t.baseline?.summary?.ccc&&s.results?.summary?.ccc?(s.results.summary.ccc-t.baseline.summary.ccc).toFixed(1):"N/A";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("strong",{children:s.name}),e.jsx("br",{}),e.jsx("small",{children:s.description})]}),e.jsxs("td",{className:n>=i?"sentia-positive":"sentia-negative",children:["Â£",n.toLocaleString()]}),e.jsx("td",{className:c.startsWith("+")?"sentia-positive":"sentia-negative",children:c}),e.jsxs("td",{children:["Â£",s.results?.scenarios?.baseline?.summary?.minCash?.toLocaleString()||"N/A"]}),e.jsx("td",{children:s.results?.summary?.riskScore||"N/A"}),e.jsxs("td",{children:[s.results?.summary?.ccc?.toFixed(1)||"N/A"," days"]}),e.jsx("td",{className:parseFloat(d)<=0?"sentia-positive":"sentia-negative",children:"N/A"!==d?(parseFloat(d)>=0?"+"+d:d)+" days":"N/A"})]},a)})]})]})})})]}),t.comparison?.recommendations&&t.comparison.recommendations.length>0&&e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Scenario Recommendations"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsx("div",{className:"sentia-recommendations",children:t.comparison.recommendations.map((s,a)=>e.jsx("div",{className:`sentia-alert sentia-alert-${s.type}`,children:e.jsxs("div",{className:"sentia-alert-content",children:[e.jsxs("div",{className:"sentia-alert-header",children:[e.jsx("strong",{children:s.scenario})," - ",s.metric]}),e.jsx("div",{className:"sentia-alert-message",children:s.description}),e.jsxs("div",{className:"sentia-alert-impact",children:["Impact: Â£",s.impact?.toLocaleString()||"N/A"]})]})},a))})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsx("div",{className:"sentia-card-header",children:e.jsx("h3",{className:"sentia-card-title",children:"Risk Analysis Summary"})}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-grid sentia-grid-3",children:[e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Best Case"}),e.jsx("div",{className:"sentia-metric-value sentia-positive",children:t.scenarios&&t.scenarios.length>0?Math.max(...t.scenarios.map(e=>e.results?.scenarios?.baseline?.summary?.netCashFlow||0)).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Worst Case"}),e.jsx("div",{className:"sentia-metric-value sentia-negative",children:t.scenarios&&t.scenarios.length>0?Math.min(...t.scenarios.map(e=>e.results?.scenarios?.baseline?.summary?.netCashFlow||0)).toLocaleString():"N/A"})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Risk Range"}),e.jsx("div",{className:"sentia-metric-value",children:t.scenarios&&t.scenarios.length>0?(Math.max(...t.scenarios.map(e=>e.results?.scenarios?.baseline?.summary?.netCashFlow||0))-Math.min(...t.scenarios.map(e=>e.results?.scenarios?.baseline?.summary?.netCashFlow||0))).toLocaleString():"N/A"})]})]})})]})]}),!t&&!c&&!l&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No scenario analysis results"}),e.jsx("small",{children:'Configure scenarios above and click "Run Scenario Analysis" to compare different business scenarios'})]})})})]})}function v({hasManagementAccess:n=!1}){const c=async()=>null,[r,l]=s.useState([]),[d,o]=s.useState([]),[h,m]=s.useState(!1),[x,j]=s.useState(null),[u,v]=s.useState("ar"),[p,g]=s.useState(null);s.useEffect(()=>{y()},[]);const y=async()=>{try{m(!0),j(null);const e={Authorization:`Bearer ${await c()}`},[s,i]=await Promise.all([a.get("/api/working-capital/policies/ar",{headers:e}),a.get("/api/working-capital/policies/ap",{headers:e})]);l(s.data.data||[]),o(i.data.data||[])}catch(e){i("Policy fetch error",e,{component:"PolicyManagement"}),j(e.response?.data?.error||e.message)}finally{m(!1)}},b=e=>{try{return JSON.parse(e).map(e=>`${e.days} days (${(100*e.pct).toFixed(0)}%)`).join(", ")}catch{return"Invalid terms format"}},f=e=>(100*e).toFixed(2)+"%";return e.jsxs("div",{className:"sentia-policy-container",children:[e.jsx("div",{className:"sentia-tabs",children:e.jsxs("div",{className:"sentia-tab-list",children:[e.jsxs("button",{className:"sentia-tab "+("ar"===u?"sentia-tab-active":""),onClick:()=>v("ar"),children:[e.jsx("span",{className:"sentia-tab-icon",children:"ðŸ“¥"}),e.jsx("span",{className:"sentia-tab-label",children:"AR Policies"})]}),e.jsxs("button",{className:"sentia-tab "+("ap"===u?"sentia-tab-active":""),onClick:()=>v("ap"),children:[e.jsx("span",{className:"sentia-tab-icon",children:"ðŸ“¤"}),e.jsx("span",{className:"sentia-tab-label",children:"AP Policies"})]})]})}),x&&e.jsx("div",{className:"sentia-error",children:e.jsxs("div",{className:"sentia-error-content",children:[e.jsx("h4",{children:"Policy Management Error"}),e.jsx("p",{children:x}),e.jsx("button",{onClick:y,className:"sentia-btn sentia-btn-secondary",children:"Retry"})]})}),h&&!p&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-loading",children:[e.jsx("div",{className:"sentia-spinner"}),e.jsx("p",{children:"Loading policies..."})]})})}),"ar"===u&&!h&&e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"Accounts Receivable Policies"}),e.jsx("div",{className:"sentia-card-badge",children:r.length})]}),e.jsx("div",{className:"sentia-card-content",children:r.length>0?e.jsx("div",{className:"sentia-table-container",children:e.jsxs("table",{className:"sentia-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sales Channel"}),e.jsx("th",{children:"Channel Type"}),e.jsx("th",{children:"Market"}),e.jsx("th",{children:"Payment Terms"}),e.jsx("th",{children:"Bad Debt %"}),e.jsx("th",{children:"Fees %"}),e.jsx("th",{children:"Active From"}),n&&e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.sales_channel?.name||"N/A"}),e.jsx("td",{children:e.jsx("span",{className:"sentia-badge",children:s.sales_channel?.channelType||"Unknown"})}),e.jsx("td",{children:s.sales_channel?.marketCode||"N/A"}),e.jsx("td",{children:b(s.terms)}),e.jsx("td",{children:f(s.bad_debt_pct)}),e.jsx("td",{children:f(s.fees_pct)}),e.jsx("td",{children:new Date(s.active_from).toLocaleDateString("en-GB")}),n&&e.jsx("td",{children:e.jsx("button",{className:"sentia-btn sentia-btn-ghost sentia-btn-sm",onClick:()=>g({...s,type:"ar"}),children:"Edit"})})]},s.id||a))})]})}):e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No AR policies configured"}),e.jsx("small",{children:"AR policies define payment terms and collection parameters for sales channels"})]})})]}),"ap"===u&&!h&&e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"Accounts Payable Policies"}),e.jsx("div",{className:"sentia-card-badge",children:d.length})]}),e.jsx("div",{className:"sentia-card-content",children:d.length>0?e.jsx("div",{className:"sentia-table-container",children:e.jsxs("table",{className:"sentia-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Supplier ID"}),e.jsx("th",{children:"Term Days"}),e.jsx("th",{children:"Early Pay Discount"}),e.jsx("th",{children:"Early Pay Days"}),e.jsx("th",{children:"Strategy"}),e.jsx("th",{children:"Active From"}),n&&e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.supplier_id||"N/A"}),e.jsxs("td",{children:[s.term_days," days"]}),e.jsx("td",{children:f(s.early_pay_discount_pct||0)}),e.jsxs("td",{children:[s.early_pay_days||"N/A"," days"]}),e.jsx("td",{children:e.jsx("span",{className:"sentia-badge",children:s.strategy||"Standard"})}),e.jsx("td",{children:new Date(s.active_from).toLocaleDateString("en-GB")}),n&&e.jsx("td",{children:e.jsx("button",{className:"sentia-btn sentia-btn-ghost sentia-btn-sm",onClick:()=>g({...s,type:"ap"}),children:"Edit"})})]},s.id||a))})]})}):e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No AP policies configured"}),e.jsx("small",{children:"AP policies define payment terms and discount strategies for suppliers"})]})})]}),p&&n&&e.jsx(N,{policy:p,onSave:"ar"===p.type?async e=>{try{m(!0);const s={Authorization:`Bearer ${await c()}`};await a.post("/api/working-capital/policies/ar",e,{headers:s});await y(),g(null),t("AR Policy updated successfully",{component:"PolicyManagement",policy:e})}catch(s){i("AR Policy update error",s,{component:"PolicyManagement",policy:e}),j(s.response?.data?.error||s.message)}finally{m(!1)}}:null,onCancel:()=>g(null),loading:h}),!n&&e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsx("div",{className:"sentia-alert sentia-alert-info",children:e.jsx("div",{className:"sentia-alert-content",children:e.jsx("div",{className:"sentia-alert-message",children:"You have read-only access to policy information. Contact your financial manager to modify policies."})})})})}),e.jsx("div",{className:"sentia-dashboard-actions",children:e.jsxs("button",{onClick:y,className:"sentia-btn sentia-btn-ghost",disabled:h,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M1 4v6h6M23 20v-6h-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Refresh Policies"]})})]})}function N({policy:a,onSave:i,onCancel:t,loading:n}){const[c,r]=s.useState({channel_id:a.channel_id||"",terms:a.terms?JSON.parse(a.terms):[{days:30,pct:1}],bad_debt_pct:a.bad_debt_pct||.025,fees_pct:a.fees_pct||.029,description:a.description||""}),l=e=>{e.preventDefault(),i&&i(c)},d=(e,s,a)=>{const i=[...c.terms];i[e][s]="days"===s?parseInt(a):parseFloat(a),r({...c,terms:i})};return e.jsx("div",{className:"sentia-modal-overlay",children:e.jsxs("div",{className:"sentia-modal",children:[e.jsxs("div",{className:"sentia-modal-header",children:[e.jsx("h3",{children:"Edit AR Policy"}),e.jsx("button",{className:"sentia-modal-close",onClick:t,children:"Ã—"})]}),e.jsxs("form",{onSubmit:l,className:"sentia-modal-content",children:[e.jsxs("div",{className:"sentia-form-section",children:[e.jsx("h4",{children:"Payment Terms"}),c.terms.map((s,a)=>e.jsxs("div",{className:"sentia-term-row",children:[e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Days"}),e.jsx("input",{type:"number",className:"sentia-input",value:s.days,onChange:e=>d(a,"days",e.target.value),min:"0",required:!0})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Percentage"}),e.jsx("input",{type:"number",className:"sentia-input",value:s.pct,onChange:e=>d(a,"pct",e.target.value),min:"0",max:"1",step:"0.01",required:!0})]}),c.terms.length>1&&e.jsx("button",{type:"button",className:"sentia-btn sentia-btn-ghost sentia-btn-sm",onClick:()=>(e=>{if(c.terms.length>1){const s=c.terms.filter((s,a)=>a!==e);r({...c,terms:s})}})(a),children:"Remove"})]},a)),e.jsx("button",{type:"button",className:"sentia-btn sentia-btn-ghost",onClick:()=>{r({...c,terms:[...c.terms,{days:30,pct:0}]})},children:"Add Term"})]}),e.jsxs("div",{className:"sentia-form-grid",children:[e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Bad Debt Rate (%)"}),e.jsx("input",{type:"number",className:"sentia-input",value:(100*c.bad_debt_pct).toFixed(2),onChange:e=>r({...c,bad_debt_pct:parseFloat(e.target.value)/100}),min:"0",max:"100",step:"0.01",required:!0})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Fees Rate (%)"}),e.jsx("input",{type:"number",className:"sentia-input",value:(100*c.fees_pct).toFixed(2),onChange:e=>r({...c,fees_pct:parseFloat(e.target.value)/100}),min:"0",max:"100",step:"0.01",required:!0})]})]}),e.jsxs("div",{className:"sentia-form-group",children:[e.jsx("label",{className:"sentia-label",children:"Description"}),e.jsx("textarea",{className:"sentia-input",value:c.description,onChange:e=>r({...c,description:e.target.value}),rows:"3",placeholder:"Policy description or notes"})]})]}),e.jsxs("div",{className:"sentia-modal-actions",children:[e.jsx("button",{type:"button",className:"sentia-btn sentia-btn-ghost",onClick:t,children:"Cancel"}),e.jsx("button",{type:"submit",className:"sentia-btn sentia-btn-primary",onClick:l,disabled:n,children:n?"Saving...":"Save Policy"})]})]})})}function p({dashboardData:t}){const[n,c]=s.useState(t),[r,l]=s.useState(!1),[d,o]=s.useState(null),[h,m]=s.useState(!1),x=async()=>{try{m(!0),o(null);const e={Authorization:`Bearer ${await(async()=>null)()}`},s=await a.get("/api/working-capital/diagnostics",{headers:e});c(s.data.data)}catch(e){i("Diagnostics refresh error",e,{component:"SystemDiagnostics"}),o(e.response?.data?.error||e.message)}finally{m(!1)}},j=e=>e>=80?"sentia-excellent":e>=60?"sentia-good":e>=40?"sentia-warning":"sentia-critical",u=e=>"healthy"===e||"excellent"===e||"optimal"===e?"sentia-status-success":"good"===e||"acceptable"===e?"sentia-status-warning":"sentia-status-error";return n||r?e.jsxs("div",{className:"sentia-diagnostics-container",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"System Health Overview"}),e.jsxs("div",{className:`sentia-card-badge ${j(n?.overallHealthScore||0)}`,children:[n?.overallHealthScore||0,"/100"]})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-health-grid",children:[e.jsxs("div",{className:"sentia-health-item",children:[e.jsx("div",{className:"sentia-health-icon",children:"ðŸ’¾"}),e.jsxs("div",{className:"sentia-health-content",children:[e.jsx("div",{className:"sentia-health-label",children:"Database"}),e.jsx("div",{className:`sentia-status ${u(n?.systemHealth?.overallStatus)}`,children:n?.systemHealth?.overallStatus||"unknown"}),e.jsx("div",{className:"sentia-health-detail",children:n?.systemHealth?.database?.message||"No status available"})]})]}),e.jsxs("div",{className:"sentia-health-item",children:[e.jsx("div",{className:"sentia-health-icon",children:"ðŸ§®"}),e.jsxs("div",{className:"sentia-health-content",children:[e.jsx("div",{className:"sentia-health-label",children:"Calculations"}),e.jsx("div",{className:`sentia-status ${u(n?.systemHealth?.calculations?.status)}`,children:n?.systemHealth?.calculations?.status||"unknown"}),e.jsx("div",{className:"sentia-health-detail",children:n?.systemHealth?.calculations?.message||"No status available"})]})]})]})})]}),e.jsxs("div",{className:"sentia-grid sentia-grid-2",children:[e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"Data Quality"}),e.jsxs("div",{className:`sentia-card-badge ${j(n?.dataQuality?.overallScore||0)}`,children:[n?.dataQuality?.overallScore||0,"/100"]})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-data-quality-grid",children:[e.jsxs("div",{className:"sentia-quality-item",children:[e.jsx("div",{className:"sentia-quality-label",children:"Product Coverage"}),e.jsx("div",{className:`sentia-status ${u(n?.dataQuality?.productCoverage?.status)}`,children:n?.dataQuality?.productCoverage?.status||"unknown"}),e.jsxs("div",{className:"sentia-quality-detail",children:[n?.dataQuality?.productCoverage?.count||0," products"]})]}),e.jsxs("div",{className:"sentia-quality-item",children:[e.jsx("div",{className:"sentia-quality-label",children:"Sales Data"}),e.jsx("div",{className:`sentia-status ${u(n?.dataQuality?.salesDataFreshness?.status)}`,children:n?.dataQuality?.salesDataFreshness?.status||"unknown"}),e.jsxs("div",{className:"sentia-quality-detail",children:[n?.dataQuality?.salesDataFreshness?.recentSalesCount||0," recent sales"]})]}),e.jsxs("div",{className:"sentia-quality-item",children:[e.jsx("div",{className:"sentia-quality-label",children:"Forecasts"}),e.jsx("div",{className:`sentia-status ${u(n?.dataQuality?.forecastCoverage?.status)}`,children:n?.dataQuality?.forecastCoverage?.status||"unknown"}),e.jsxs("div",{className:"sentia-quality-detail",children:[n?.dataQuality?.forecastCoverage?.count||0," forecasts"]})]}),e.jsxs("div",{className:"sentia-quality-item",children:[e.jsx("div",{className:"sentia-quality-label",children:"Inventory Data"}),e.jsx("div",{className:`sentia-status ${u(n?.dataQuality?.inventoryDataFreshness?.status)}`,children:n?.dataQuality?.inventoryDataFreshness?.status||"unknown"}),e.jsxs("div",{className:"sentia-quality-detail",children:[n?.dataQuality?.inventoryDataFreshness?.recentInventoryCount||0," recent records"]})]})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"Model Accuracy"}),e.jsx("div",{className:`sentia-card-badge ${u(n?.modelAccuracy?.overallAccuracy)}`,children:n?.modelAccuracy?.overallAccuracy||"unknown"})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-accuracy-grid",children:[e.jsxs("div",{className:"sentia-accuracy-item",children:[e.jsx("div",{className:"sentia-accuracy-label",children:"Forecast Accuracy"}),e.jsxs("div",{className:"sentia-accuracy-value",children:[n?.modelAccuracy?.forecastAccuracy?.mape||0,"% MAPE"]}),e.jsx("div",{className:`sentia-status ${u(n?.modelAccuracy?.forecastAccuracy?.status)}`,children:n?.modelAccuracy?.forecastAccuracy?.status||"unknown"})]}),e.jsxs("div",{className:"sentia-accuracy-item",children:[e.jsx("div",{className:"sentia-accuracy-label",children:"Cash Flow Accuracy"}),e.jsxs("div",{className:"sentia-accuracy-value",children:[n?.modelAccuracy?.cashFlowAccuracy?.variance||0,"% variance"]}),e.jsx("div",{className:`sentia-status ${u(n?.modelAccuracy?.cashFlowAccuracy?.status)}`,children:n?.modelAccuracy?.cashFlowAccuracy?.status||"unknown"})]}),e.jsxs("div",{className:"sentia-accuracy-detail",children:["Last validation: ",n?.modelAccuracy?.lastValidation?new Date(n.modelAccuracy.lastValidation).toLocaleDateString("en-GB"):"Never"]})]})})]})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"Performance Metrics"}),e.jsx("div",{className:`sentia-card-badge ${u(n?.performanceMetrics?.status)}`,children:n?.performanceMetrics?.status||"unknown"})]}),e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-grid sentia-grid-4",children:[e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Avg Calculation Time"}),e.jsxs("div",{className:"sentia-metric-value",children:[n?.performanceMetrics?.averageCalculationTime||0,"s"]})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Cache Hit Rate"}),e.jsxs("div",{className:"sentia-metric-value",children:[(100*(n?.performanceMetrics?.cacheHitRate||0)).toFixed(1),"%"]})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Memory Usage"}),e.jsxs("div",{className:"sentia-metric-value",children:[n?.performanceMetrics?.memoryUsage||0,"MB"]})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsx("div",{className:"sentia-metric-label",children:"Concurrent Users"}),e.jsx("div",{className:"sentia-metric-value",children:n?.performanceMetrics?.concurrentUsers||0})]})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"System Alerts"}),e.jsx("div",{className:"sentia-card-badge",children:n?.alerts?.length||0})]}),e.jsx("div",{className:"sentia-card-content",children:n?.alerts&&n.alerts.length>0?e.jsx("div",{className:"sentia-alerts-list",children:n.alerts.map((s,a)=>e.jsx("div",{className:`sentia-alert sentia-alert-${s.level}`,children:e.jsxs("div",{className:"sentia-alert-content",children:[e.jsxs("div",{className:"sentia-alert-header",children:[e.jsx("span",{className:"sentia-alert-type",children:s.type}),e.jsx("span",{className:"sentia-alert-timestamp",children:new Date(s.timestamp).toLocaleString("en-GB")})]}),e.jsx("div",{className:"sentia-alert-message",children:s.message})]})},a))}):e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No active alerts"}),e.jsx("small",{children:"System is running normally with no issues detected"})]})})]}),e.jsxs("div",{className:"sentia-card",children:[e.jsxs("div",{className:"sentia-card-header",children:[e.jsx("h3",{className:"sentia-card-title",children:"System Recommendations"}),e.jsx("div",{className:"sentia-card-badge",children:n?.recommendations?.length||0})]}),e.jsx("div",{className:"sentia-card-content",children:n?.recommendations&&n.recommendations.length>0?e.jsx("div",{className:"sentia-recommendations-list",children:n.recommendations.map((s,a)=>e.jsx("div",{className:`sentia-recommendation sentia-priority-${s.priority}`,children:e.jsxs("div",{className:"sentia-recommendation-content",children:[e.jsxs("div",{className:"sentia-recommendation-header",children:[e.jsx("span",{className:"sentia-recommendation-title",children:s.title}),e.jsxs("div",{className:"sentia-recommendation-badges",children:[e.jsx("span",{className:`sentia-badge sentia-priority-${s.priority}`,children:s.priority}),e.jsxs("span",{className:"sentia-badge sentia-effort-{rec.estimatedEffort}",children:[s.estimatedEffort," effort"]})]})]}),e.jsx("div",{className:"sentia-recommendation-description",children:s.description}),e.jsxs("div",{className:"sentia-recommendation-category",children:["Category: ",s.category]})]})},a))}):e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No system recommendations"}),e.jsx("small",{children:"System is optimally configured with no immediate actions required"})]})})]}),d&&e.jsx("div",{className:"sentia-error",children:e.jsxs("div",{className:"sentia-error-content",children:[e.jsx("h4",{children:"Diagnostics Error"}),e.jsx("p",{children:d}),e.jsx("button",{onClick:x,className:"sentia-btn sentia-btn-secondary",children:"Retry"})]})}),e.jsx("div",{className:"sentia-dashboard-actions",children:e.jsxs("button",{onClick:x,className:"sentia-btn sentia-btn-primary",disabled:h,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M1 4v6h6M23 20v-6h-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),h?"Refreshing...":"Refresh Diagnostics"]})})]}):e.jsx("div",{className:"sentia-card",children:e.jsx("div",{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-empty-state",children:[e.jsx("p",{children:"No diagnostics data available"}),e.jsx("button",{onClick:x,className:"sentia-btn sentia-btn-primary",children:"Load Diagnostics"})]})})})}const g=()=>{const[a,i]=s.useState("overview");s.useState(!1);const[t,h]=s.useState({current:2456e3,projected:289e4,trend:"+17.7%",lastUpdated:(new Date).toLocaleString(),components:{inventory:189e4,receivables:78e4,payables:-214e3},alerts:[{type:"warning",message:"Inventory levels 15% above optimal range"},{type:"info",message:"Receivables collection improved by 3 days"}]}),N=[{id:"overview",label:"Overview",icon:r},{id:"projections",label:"Cash Flow",icon:c},{id:"scenarios",label:"What-If Analysis",icon:m},{id:"policies",label:"Policies",icon:l},{id:"diagnostics",label:"Diagnostics",icon:o}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Working Capital Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Comprehensive financial analysis and optimization tools"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Last updated"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(d,{className:"w-4 h-4 mr-1"}),t.lastUpdated]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx(n,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Current Working Capital"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Â£",(t.current/1e6).toFixed(2),"M"]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(c,{className:"w-4 h-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:t.trend})]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(c,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Projected (30 days)"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Â£",(t.projected/1e6).toFixed(2),"M"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["+Â£",((t.projected-t.current)/1e3).toFixed(0),"K improvement"]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx(r,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Optimization Potential"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"18.5%"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["Â£",(.185*t.current/1e3).toFixed(0),"K available"]})]})]})})]}),t.alerts.length>0&&e.jsx("div",{className:"space-y-3",children:t.alerts.map((s,a)=>e.jsx("div",{className:"p-4 rounded-lg border-l-4 "+("warning"===s.type?"bg-yellow-50 border-yellow-400 dark:bg-yellow-900/20 dark:border-yellow-600":"bg-blue-50 border-blue-400 dark:bg-blue-900/20 dark:border-blue-600"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{className:"w-5 h-5 mr-3 "+("warning"===s.type?"text-yellow-600":"text-blue-600")}),e.jsx("p",{className:"text-sm "+("warning"===s.type?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"),children:s.message})]})},a))}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:N.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>i(s.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 "+(a===s.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),s.label]},s.id)})})}),e.jsxs("div",{className:"mt-6",children:["overview"===a&&e.jsx(x,{data:t}),"projections"===a&&e.jsx(j,{}),"scenarios"===a&&e.jsx(u,{}),"policies"===a&&e.jsx(v,{}),"diagnostics"===a&&e.jsx(p,{})]})]})},y=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{m as F,g as W,y as a};
