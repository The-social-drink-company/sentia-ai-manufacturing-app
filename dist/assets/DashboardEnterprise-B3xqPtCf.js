const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RegionalContributionChart-Cns9MYEb.js","assets/vendor-C1LNgw1J.js","assets/charts-1s3mMhcR.js","assets/PLAnalysisChart-DBCIGQA7.js","assets/ProductSalesChart-Cso4rRVU.js","assets/StockLevelsWidget-BST3FaSb.js","assets/index-DjYN98sh.js","assets/data-layer-rESbPKUZ.js","assets/radix-CSh4aNe1.js","assets/router-BEPb3H3e.js","assets/index-CpYoe3Ja.css","assets/stockLevelsApi-CwrlrV-D.js","assets/QuickActions-BKkxv0o_.js"])))=>i.map(i=>d[i]);
import{r as o,ab as e,b1 as v}from"./vendor-C1LNgw1J.js";import{B as I,C as m,a as p,b as g,c as x,d as f}from"./index-DjYN98sh.js";class C{constructor(){this.baseURL="/api",this.defaultHeaders={"Content-Type":"application/json",Accept:"application/json"}}async request(t,s={}){const i=`${this.baseURL}${t}`,l={headers:{...this.defaultHeaders,...s.headers},...s};try{const r=await fetch(i,l);if(!r.ok)throw new Error(`API Error: ${r.status} ${r.statusText}`);const a=r.headers.get("content-type");return a&&a.includes("application/json")?await r.json():await r.text()}catch(r){throw console.error(`[APIClient] Request failed for ${t}:`,r),r}}async get(t,s={}){const i=new URL(`${this.baseURL}${t}`,window.location.origin);return Object.keys(s).forEach(l=>{s[l]!==void 0&&s[l]!==null&&i.searchParams.append(l,s[l])}),this.request(i.pathname+i.search,{method:"GET"})}async post(t,s={}){return this.request(t,{method:"POST",body:JSON.stringify(s)})}async put(t,s={}){return this.request(t,{method:"PUT",body:JSON.stringify(s)})}async delete(t){return this.request(t,{method:"DELETE"})}async health(){return this.get("/health")}async status(){return this.get("/status")}}const j=new C,y=()=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((t,s)=>{const i=1200+Math.sin(s*.5)*200+Math.random()*100,l=1+Math.sin(s*.5)*.15,r=Math.round(i*l),a=Math.round(r*(.55+Math.random()*.15)),n=Math.round(r*(.18+Math.random()*.08)),P=Number((a/r*100).toFixed(1));return{month:t,revenue:r,grossProfit:a,ebitda:n,grossMarginPercent:P}}),S={async getPLAnalysis(c={}){try{return(await j.get("/api/financial/pl-analysis",{params:c})).data}catch(t){return console.error("Failed to fetch P&L analysis data:",t),console.log("Using mock P&L data as fallback"),{success:!0,data:y(),timestamp:new Date().toISOString()}}},async getPLSummary(c="year"){try{return(await j.get("/api/financial/pl-summary",{params:{period:c}})).data}catch(t){console.error("Failed to fetch P&L summary:",t);const s=y(),i=s.reduce((a,n)=>a+n.revenue,0),l=s.reduce((a,n)=>a+n.grossProfit,0),r=s.reduce((a,n)=>a+n.ebitda,0);return{success:!0,data:{totalRevenue:i,totalGrossProfit:l,totalEbitda:r,avgGrossMargin:Number((l/i*100).toFixed(1)),avgEbitdaMargin:Number((r/i*100).toFixed(1)),period:c},timestamp:new Date().toISOString()}}},async getKPISummary(){try{return(await j.get("/api/financial/kpi-summary")).data}catch(c){console.error("Failed to fetch KPI summary:",c);const t=y(),s=t.reduce((a,n)=>a+n.revenue,0),i=t.reduce((a,n)=>a+n.grossProfit,0),l=Number((i/s*100).toFixed(1)),r=Math.round(s/25);return{success:!0,data:{annualRevenue:{value:`$${(s/1e3).toFixed(1)}M`,raw:s,helper:"Year to date"},unitsSold:{value:`${(r/1e3).toFixed(0)}K`,raw:r,helper:"Current quarter"},grossMargin:{value:`${l}%`,raw:l,helper:"Average margin"}},timestamp:new Date().toISOString()}}},getMockData(){return{success:!0,data:y(),timestamp:new Date().toISOString()}}},b=()=>[{product:"GABA Red",revenue:48e5,units:192e3,growthRate:12.5,marketShare:34.2},{product:"GABA Black",revenue:62e5,units:248e3,growthRate:18.3,marketShare:44.1},{product:"GABA Gold",revenue:32e5,units:128e3,growthRate:8.7,marketShare:21.7}],L={async getProductSalesData(c="year"){try{return(await j.get("/api/sales/product-performance",{params:{period:c}})).data}catch(t){return console.error("Failed to fetch product sales data:",t),console.log("Using mock product sales data as fallback"),{success:!0,data:b(),timestamp:new Date().toISOString(),period:c}}},async getProductSalesSummary(c="year"){try{return(await j.get("/api/sales/product-summary",{params:{period:c}})).data}catch(t){console.error("Failed to fetch product sales summary:",t);const s=b(),i=s.reduce((a,n)=>a+n.revenue,0),l=s.reduce((a,n)=>a+n.units,0),r=s.reduce((a,n)=>a+n.growthRate,0)/s.length;return{success:!0,data:{totalRevenue:i,totalUnits:l,avgGrowthRate:Number(r.toFixed(1)),productCount:s.length,topPerformer:s.reduce((a,n)=>n.revenue>a.revenue?n:a),period:c},timestamp:new Date().toISOString()}}},async getTopProducts(c=5){try{return(await j.get("/api/sales/top-products",{params:{limit:c}})).data}catch(t){return console.error("Failed to fetch top products:",t),{success:!0,data:b().sort((l,r)=>r.revenue-l.revenue).slice(0,c),timestamp:new Date().toISOString()}}},getMockData(){return{success:!0,data:b(),timestamp:new Date().toISOString()}}},O=[{region:"UK",revenue:42e5,ebitda:98e4},{region:"US",revenue:385e4,ebitda:82e4},{region:"EU",revenue:615e4,ebitda:114e4}],F=[{label:"Global working capital",value:"$9.2M",helper:"Across all subsidiaries"},{label:"Cash coverage",value:"214 days",helper:"Including credit facilities"},{label:"Intercompany exposure",value:"$1.1M",helper:"Pending settlements"},{label:"FX sensitivity",value:"$380K",helper:"Â±1% USD/EUR/JPY"}],A=[{label:"Annual revenue",value:"$14.2M",helper:"Year to date"},{label:"Units sold",value:"568K",helper:"Current quarter"},{label:"Gross margin",value:"62.3%",helper:"Average margin"}],K=o.lazy(()=>v(()=>import("./RegionalContributionChart-Cns9MYEb.js"),__vite__mapDeps([0,1,2]))),U=o.lazy(()=>v(()=>import("./PLAnalysisChart-DBCIGQA7.js"),__vite__mapDeps([3,1,2]))),T=o.lazy(()=>v(()=>import("./ProductSalesChart-Cso4rRVU.js"),__vite__mapDeps([4,1,2]))),$=o.lazy(()=>v(()=>import("./StockLevelsWidget-BST3FaSb.js"),__vite__mapDeps([5,1,6,7,8,9,10,11]))),G=o.lazy(()=>v(()=>import("./QuickActions-BKkxv0o_.js"),__vite__mapDeps([12,1,6,7,8,9,10,11]))),q=()=>{const[c,t]=o.useState([]),[s,i]=o.useState(!0),[l,r]=o.useState(null),[a,n]=o.useState(A),[P,w]=o.useState(!0),[B,N]=o.useState(null),[R,D]=o.useState([]),[_,E]=o.useState(!0),[M,k]=o.useState(null);return o.useEffect(()=>{(async()=>{try{i(!0),r(null);const d=await S.getPLAnalysis();if(d.success)t(d.data);else throw new Error("Failed to fetch P&L data")}catch(d){console.error("Error fetching P&L data:",d),r(d.message);const h=S.getMockData();t(h.data)}finally{i(!1)}})()},[]),o.useEffect(()=>{(async()=>{try{w(!0),N(null);const d=await S.getKPISummary();if(d.success&&d.data){const h=d.data;n([{label:"Annual revenue",value:h.annualRevenue.value,helper:h.annualRevenue.helper},{label:"Units sold",value:h.unitsSold.value,helper:h.unitsSold.helper},{label:"Gross margin",value:h.grossMargin.value,helper:h.grossMargin.helper}])}else throw new Error("Failed to fetch KPI data")}catch(d){console.error("Error fetching KPI data:",d),N(d.message),n(A)}finally{w(!1)}})()},[]),o.useEffect(()=>{(async()=>{try{E(!0),k(null);const d=await L.getProductSalesData();if(d.success)D(d.data);else throw new Error("Failed to fetch product sales data")}catch(d){console.error("Error fetching product sales data:",d),k(d.message);const h=L.getMockData();D(h.data)}finally{E(!1)}})()},[]),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold tracking-tight",children:"Enterprise dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Consolidated liquidity and performance outlook across all regions."})]}),e.jsx(I,{variant:"outline",children:"Global view"})]}),e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Capital position"}),e.jsx(x,{children:"Key metrics reviewed in the weekly treasury meeting."})]}),e.jsx(f,{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:F.map(u=>e.jsxs("div",{className:"rounded-lg border border-border bg-muted/30 p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:u.label}),e.jsx("p",{className:"text-lg font-semibold text-foreground",children:u.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.helper})]},u.label))})]}),e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Performance metrics"}),e.jsx(x,{children:"Key business performance indicators tracked for operational excellence."})]}),e.jsx(f,{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:a.map(u=>e.jsxs("div",{className:"rounded-lg border border-border bg-muted/30 p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:u.label}),e.jsx("p",{className:"text-lg font-semibold text-foreground",children:u.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u.helper})]},u.label))})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Product Sales Performance"}),e.jsx(x,{children:"Revenue by product line"})]}),e.jsx(f,{className:"h-64",children:_?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):M?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-destructive mb-2",children:"Error loading data"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Using sample data"})]})}):e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading chart..."}),children:e.jsx(T,{data:R})})})]}),e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"P&L Analysis"}),e.jsx(x,{children:"Monthly profit and loss trends"})]}),e.jsx(f,{className:"h-64",children:s?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):l?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-destructive mb-2",children:"Error loading data"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Using sample data"})]})}):e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading chart..."}),children:e.jsx(U,{data:c})})})]}),e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Regional Contribution"}),e.jsx(x,{children:"Revenue and EBITDA by region"})]}),e.jsx(f,{className:"h-64",children:e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading chart..."}),children:e.jsx(K,{data:O})})})]})]}),e.jsx(o.Suspense,{fallback:e.jsxs(m,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Current Stock Levels"}),e.jsx(x,{children:"Loading inventory data..."})]}),e.jsx(f,{className:"h-64",children:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"})})})]}),children:e.jsx($,{})}),e.jsx(o.Suspense,{fallback:e.jsxs(m,{className:"mt-8",children:[e.jsxs(p,{children:[e.jsx(g,{children:"Quick Actions"}),e.jsx(x,{children:"Loading quick actions..."})]}),e.jsx(f,{className:"h-32",children:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"})})})]}),children:e.jsx(G,{})})]})},V=Object.freeze(Object.defineProperty({__proto__:null,default:q},Symbol.toStringTag,{value:"Module"}));export{V as D,L as a,j as b,S as p};
