import{j as e,c as s}from"./query-ChsViXKH.js";import{a as t}from"./vendor-CoorQe56.js";const a=({className:s="",children:t,...a})=>e.jsx("div",{className:`bg-white rounded-lg border border-gray-200 shadow-sm ${s}`,...a,children:t}),r=({className:s="",children:t,...a})=>e.jsx("div",{className:`px-6 py-4 border-b border-gray-200 ${s}`,...a,children:t}),n=({className:s="",children:t,...a})=>e.jsx("h3",{className:`text-lg font-semibold text-gray-900 ${s}`,...a,children:t}),d=({className:s="",children:t,...a})=>e.jsx("div",{className:`px-6 py-4 ${s}`,...a,children:t}),c=({config:c={}})=>{const{data:i,isLoading:l,error:o}=s({queryKey:["ai-forecasting-data"],queryFn:async()=>{const e=await fetch("/api/ai/forecasting");if(!e.ok)throw new Error("Failed to fetch AI forecasting data");return e.json()},refetchInterval:6e4,staleTime:5e4}),[m,x]=t.useState("ensemble"),[h,u]=t.useState("30d"),[v,j]=t.useState({demand:{current:0,predicted:0,confidence:0,trend:"stable"},inventory:{current:0,predicted:0,confidence:0,trend:"stable"},production:{current:0,predicted:0,confidence:0,trend:"stable"},revenue:{current:0,predicted:0,confidence:0,trend:"stable"}});t.useEffect(()=>{i&&j({demand:i.demand?.[m]?.[h]||v.demand,inventory:i.inventory?.[m]?.[h]||v.inventory,production:i.production?.[m]?.[h]||v.production,revenue:i.revenue?.[m]?.[h]||v.revenue})},[i,m,h]);const N=[{id:"ensemble",name:"4-Model Ensemble",color:"bg-purple-500"},{id:"arima",name:"ARIMA",color:"bg-blue-500"},{id:"lstm",name:"LSTM Neural Net",color:"bg-green-500"},{id:"prophet",name:"Prophet",color:"bg-yellow-500"},{id:"random_forest",name:"Random Forest",color:"bg-red-500"}],p=e=>{switch(e){case"up":return"↗️";case"down":return"↘️";default:return"➡️"}},g=e=>e>=85?"text-green-600":e>=70?"text-yellow-600":"text-red-600";return l?e.jsxs(a,{className:"sentia-card h-full",children:[e.jsx(r,{className:"sentia-card-header",children:e.jsx(n,{className:"sentia-widget-title",children:"AI Forecasting"})}),e.jsx(d,{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-loading-state",children:[e.jsx("div",{className:"sentia-spinner"}),e.jsx("p",{children:"Running AI models..."})]})})]}):o?e.jsxs(a,{className:"sentia-card h-full border-red-200",children:[e.jsx(r,{className:"sentia-card-header",children:e.jsx(n,{className:"sentia-widget-title text-red-600",children:"AI Forecasting"})}),e.jsx(d,{className:"sentia-card-content",children:e.jsxs("div",{className:"sentia-error-state",children:[e.jsxs("p",{className:"text-red-500",children:["Error: ",o.message]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Check AI service status"})]})})]}):e.jsxs(a,{className:"sentia-card h-full",children:[e.jsxs(r,{className:"sentia-card-header",children:[e.jsx(n,{className:"sentia-widget-title",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full animate-pulse"}),"AI Predictive Analytics"]})}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("select",{value:m,onChange:e=>x(e.target.value),className:"text-xs px-2 py-1 border rounded",children:N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))}),e.jsxs("select",{value:h,onChange:e=>u(e.target.value),className:"text-xs px-2 py-1 border rounded",children:[e.jsx("option",{value:"7d",children:"7 Days"}),e.jsx("option",{value:"30d",children:"30 Days"}),e.jsx("option",{value:"90d",children:"90 Days"})]})]})]}),e.jsxs(d,{className:"sentia-card-content",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"sentia-metric-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Demand Forecast"}),e.jsx("div",{className:"text-lg",children:p(v.demand.trend)})]}),e.jsx("div",{className:"sentia-metric-value text-blue-600",children:v.demand.predicted.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",v.demand.current.toLocaleString()]}),e.jsxs("div",{className:`text-xs ${g(v.demand.confidence)}`,children:[v.demand.confidence,"% confidence"]})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Inventory Needs"}),e.jsx("div",{className:"text-lg",children:p(v.inventory.trend)})]}),e.jsx("div",{className:"sentia-metric-value text-green-600",children:v.inventory.predicted.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",v.inventory.current.toLocaleString()]}),e.jsxs("div",{className:`text-xs ${g(v.inventory.confidence)}`,children:[v.inventory.confidence,"% confidence"]})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Production Plan"}),e.jsx("div",{className:"text-lg",children:p(v.production.trend)})]}),e.jsx("div",{className:"sentia-metric-value text-purple-600",children:v.production.predicted.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Current: ",v.production.current.toLocaleString()]}),e.jsxs("div",{className:`text-xs ${g(v.production.confidence)}`,children:[v.production.confidence,"% confidence"]})]}),e.jsxs("div",{className:"sentia-metric-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Revenue Forecast"}),e.jsx("div",{className:"text-lg",children:p(v.revenue.trend)})]}),e.jsxs("div",{className:"sentia-metric-value text-emerald-600",children:["$",v.revenue.predicted.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Current: $",v.revenue.current.toLocaleString()]}),e.jsxs("div",{className:`text-xs ${g(v.revenue.confidence)}`,children:[v.revenue.confidence,"% confidence"]})]})]}),i?.insights&&i.insights.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-purple-800 mb-2",children:"🤖 AI Insights"}),e.jsx("div",{className:"space-y-1",children:i.insights.slice(0,3).map((s,t)=>e.jsx("div",{className:"text-sm text-purple-700",children:s.message},t))})]}),i?.modelPerformance&&e.jsx("div",{className:"mt-4 grid grid-cols-5 gap-1",children:N.map(s=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-2 h-2 ${s.color} rounded-full mx-auto mb-1`}),e.jsxs("div",{className:"text-xs text-gray-600",children:[(i.modelPerformance[s.id]?.accuracy||0).toFixed(1),"%"]})]},s.id))}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500 sentia-data-timestamp",children:["Last updated: ",i?.lastUpdated?new Date(i.lastUpdated).toLocaleTimeString():"Never"]})]})]})};export{c as default};
