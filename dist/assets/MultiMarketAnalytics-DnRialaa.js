import{r as o,j as e,b6 as V,b7 as W,b8 as _,b9 as $,ba as Q,bb as J,bc as Y,bd as H,be as X,bf as q,bg as Z,bh as ee,bi as se,bj as te,bk as ae}from"./react-vendor-CbFVVgBZ.js";import{C as l}from"./card-BnzAuvGC.js";import{B as b,a as x}from"./badge-CdOBaKFn.js";import{c as N}from"./LoadingSpinner-CegXJRNj.js";import{h as w,r as ie,s as re,t as ne,T as k,o as le,j as O,X as R,Y as C,B as D,q as oe,m as S}from"./charts-Dbk9-C0f.js";import"./vendor-BHPHB5s9.js";import"./clerk-3Oyg3_c8.js";import"./utils-Pe79r9Ua.js";function ce({className:h,defaultValue:c,value:j,min:d=0,max:g=100,...u}){const n=o.useMemo(()=>Array.isArray(j)?j:Array.isArray(c)?c:[d,g],[j,c,d,g]);return e.jsxs(V,{"data-slot":"slider",defaultValue:c,value:j,min:d,max:g,className:N("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",h),...u,children:[e.jsx(W,{"data-slot":"slider-track",className:N("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(_,{"data-slot":"slider-range",className:N("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:n.length},(U,i)=>e.jsx($,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},i))]})}const fe=({data:h,onRefresh:c,onAnalyze:j,loading:d=!1})=>{const[g,u]=o.useState("Q4-2024");o.useState("absolute"),o.useState("revenue");const[n,U]=o.useState([75]);o.useState(!0);const[i,f]=o.useState(null),[A,p]=o.useState(!1);o.useEffect(()=>{(async()=>{if(h){f(h);return}p(!0);try{const[s,v,m]=await Promise.all([fetch("/api/optimization/health"),fetch("/api/forecasting/accuracy/trends?days=90"),fetch("/api/optimization/working-capital/multi-region",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({horizonMonths:12,regions:["UK","EU","USA"],scenarios:["baseline","optimistic","pessimistic"]})})]),y=s.ok?await s.json():null,G=v.ok?await v.json():null,a=m.ok?await m.json():null,B={marketOverview:{totalRevenue:a?.consolidatedProjection?.totalRevenueProjected||354e4,totalWorkingCapital:a?.consolidatedProjection?.totalWorkingCapital||284e4,totalInventoryValue:168e4,crossMarketOptimizationPotential:a?.optimizationOpportunities?.totalSavingsPotential||52e4},markets:{UK:{name:"United Kingdom",currency:"GBP",revenue:a?.regions?.UK?.projectedRevenue||12e5,revenueGrowth:a?.regions?.UK?.growthRate||.08,workingCapital:a?.regions?.UK?.workingCapital||95e4,workingCapitalEfficiency:a?.regions?.UK?.efficiency||.79,inventoryTurnover:a?.regions?.UK?.inventoryTurnover||8.2,leadTimeAvg:21,leadTimeVariability:.15,demandVolatility:.12,products:{SENSIO_RED:{demand:650,stock:1250,forecast:680},SENSIO_BLACK:{demand:520,stock:980,forecast:540},SENSIO_GOLD:{demand:180,stock:450,forecast:195}},seasonality:[.95,.88,1.02,1.08,1.12,1.05,.92,.87,.96,1.15,1.25,1.18],riskFactors:[{factor:"Brexit Impact",severity:"medium",trend:"improving"},{factor:"Supply Chain",severity:"low",trend:"stable"}]},EU:{name:"European Union",currency:"EUR",revenue:a?.regions?.EU?.projectedRevenue||89e4,revenueGrowth:a?.regions?.EU?.growthRate||.15,workingCapital:a?.regions?.EU?.workingCapital||72e4,workingCapitalEfficiency:a?.regions?.EU?.efficiency||.81,inventoryTurnover:a?.regions?.EU?.inventoryTurnover||7.8,leadTimeAvg:28,leadTimeVariability:.22,demandVolatility:.18,products:{SENSIO_RED:{demand:480,stock:890,forecast:520},SENSIO_BLACK:{demand:390,stock:720,forecast:425},SENSIO_GOLD:{demand:140,stock:320,forecast:160}},seasonality:[.92,.85,.98,1.05,1.15,1.08,.95,.89,.94,1.12,1.22,1.16],riskFactors:[{factor:"Regulatory Changes",severity:"medium",trend:"stable"},{factor:"Currency Fluctuation",severity:"high",trend:"worsening"}]},US:{name:"United States",currency:"USD",revenue:a?.regions?.USA?.projectedRevenue||145e4,revenueGrowth:a?.regions?.USA?.growthRate||.22,workingCapital:a?.regions?.USA?.workingCapital||117e4,workingCapitalEfficiency:a?.regions?.USA?.efficiency||.81,inventoryTurnover:a?.regions?.USA?.inventoryTurnover||6.5,leadTimeAvg:42,leadTimeVariability:.35,demandVolatility:.25,products:{SENSIO_RED:{demand:780,stock:1450,forecast:890},SENSIO_BLACK:{demand:620,stock:1200,forecast:720},SENSIO_GOLD:{demand:220,stock:580,forecast:280}},seasonality:[.88,.82,.94,1.02,1.18,1.12,.98,.91,.89,1.08,1.28,1.22],riskFactors:[{factor:"Lead Time Variability",severity:"high",trend:"stable"},{factor:"Market Competition",severity:"medium",trend:"worsening"},{factor:"Logistics Costs",severity:"high",trend:"worsening"}]}},crossMarketInsights:a?.crossMarketInsights||{optimalInventoryDistribution:{UK:.32,EU:.28,US:.4},arbitrageOpportunities:[],consolidatedForecast:{nextQuarter:{totalDemand:8450,confidenceLevel:G?.trends?.overall?.confidence||.86,scenarios:{optimistic:9250,baseline:8450,pessimistic:7680}}}},serviceHealth:y};f(B)}catch{f(I())}finally{p(!1)}})()},[h]);const I=()=>({marketOverview:{totalRevenue:354e4,totalWorkingCapital:284e4,totalInventoryValue:168e4,crossMarketOptimizationPotential:52e4},markets:{UK:{name:"United Kingdom",currency:"GBP",revenue:12e5,revenueGrowth:.08,workingCapital:95e4,workingCapitalEfficiency:.79,inventoryTurnover:8.2,leadTimeAvg:21,leadTimeVariability:.15,demandVolatility:.12,products:{SENSIO_RED:{demand:650,stock:1250,forecast:680}},seasonality:[.95,.88,1.02,1.08,1.12,1.05,.92,.87,.96,1.15,1.25,1.18],riskFactors:[]}},crossMarketInsights:{optimalInventoryDistribution:{UK:.32,EU:.28,US:.4},arbitrageOpportunities:[],consolidatedForecast:{nextQuarter:{totalDemand:8450,confidenceLevel:.86,scenarios:{}}}}}),K=async()=>{p(!0),await loadAnalyticsData(),c&&c()};if(!i)return e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading analytics data..."});const M=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6"],r=(t,s="GBP")=>`${s==="EUR"?"€":s==="USD"?"$":"£"}${(t/1e3).toFixed(0)}k`,E=t=>t>.15?"text-green-600":t>.05?"text-blue-600":t>0?"text-yellow-600":"text-red-600",P=t=>t>0?te:ae,z=t=>{const s={low:"text-green-600 bg-green-50",medium:"text-yellow-600 bg-yellow-50",high:"text-red-600 bg-red-50"};return s[t]||s.medium},T=Object.entries(i.markets).map(([t,s])=>({name:t,value:s.revenue,color:M[Object.keys(i.markets).indexOf(t)]})),L=i.markets.UK.seasonality.map((t,s)=>({month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s],UK:i.markets.UK.seasonality[s],EU:i.markets.EU.seasonality[s],US:i.markets.US.seasonality[s]})),F=Object.entries(i.markets).map(([t,s])=>({market:t,revenue:s.revenue/1e3,workingCapital:s.workingCapital/1e3,turnover:s.inventoryTurnover,leadTime:s.leadTimeAvg,efficiency:s.workingCapitalEfficiency*100}));return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Multi-Market Analytics"}),e.jsx("p",{className:"text-gray-500",children:"Comprehensive Cross-Market Performance Analysis"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("select",{value:g,onChange:t=>u(t.target.value),className:"px-3 py-2 border rounded-md bg-white",children:[e.jsx("option",{value:"Q4-2024",children:"Q4 2024"}),e.jsx("option",{value:"Q3-2024",children:"Q3 2024"}),e.jsx("option",{value:"YTD-2024",children:"YTD 2024"}),e.jsx("option",{value:"12M",children:"Last 12 Months"})]}),e.jsxs(b,{onClick:K,disabled:d||A,variant:"outline",size:"sm",children:[e.jsx(Q,{className:`w-4 h-4 mr-2 ${d||A?"animate-spin":""}`}),"Refresh"]}),e.jsxs(b,{variant:"default",size:"sm",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r(i.marketOverview.totalRevenue)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Across all markets"})]}),e.jsx(Y,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Working Capital"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r(i.marketOverview.totalWorkingCapital)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Optimization potential"})]}),e.jsx(H,{className:"h-8 w-8 text-green-600"})]})}),e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inventory Value"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r(i.marketOverview.totalInventoryValue)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total across markets"})]}),e.jsx(X,{className:"h-8 w-8 text-purple-600"})]})}),e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Optimization Potential"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r(i.marketOverview.crossMarketOptimizationPotential)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cross-market savings"})]}),e.jsx(q,{className:"h-8 w-8 text-yellow-600"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:Object.entries(i.markets).map(([t,s])=>{const v=P(s.revenueGrowth);return e.jsxs(l,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsx(x,{variant:"outline",children:s.currency})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(v,{className:`w-4 h-4 ${E(s.revenueGrowth)}`}),e.jsxs("span",{className:`text-sm font-semibold ${E(s.revenueGrowth)}`,children:[(s.revenueGrowth*100).toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Revenue:"}),e.jsx("span",{className:"font-semibold",children:r(s.revenue,s.currency)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Working Capital:"}),e.jsx("span",{className:"font-semibold",children:r(s.workingCapital,s.currency)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Inventory Turnover:"}),e.jsxs("span",{className:"font-semibold",children:[s.inventoryTurnover,"x"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Avg Lead Time:"}),e.jsxs("span",{className:"font-semibold",children:[s.leadTimeAvg," days"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"WC Efficiency:"}),e.jsxs(x,{variant:s.workingCapitalEfficiency>.8?"default":"secondary",children:[(s.workingCapitalEfficiency*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Risk Factors:"}),e.jsx("div",{className:"space-y-1",children:s.riskFactors.map((m,y)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[m.factor,":"]}),e.jsx(x,{className:z(m.severity),size:"sm",children:m.severity})]},y))})]})]},t)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),"Revenue Distribution"]}),e.jsx("div",{className:"h-64",children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(ie,{children:[e.jsx(re,{data:T,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:t,percent:s})=>`${t} ${(s*100).toFixed(0)}%`,children:T.map((t,s)=>e.jsx(ne,{fill:t.color},`cell-${s}`))}),e.jsx(k,{formatter:t=>r(t)})]})})})]}),e.jsxs(l,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Performance Metrics"]}),e.jsx("div",{className:"h-64",children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(le,{data:F,children:[e.jsx(O,{strokeDasharray:"3 3"}),e.jsx(R,{dataKey:"market"}),e.jsx(C,{yAxisId:"left"}),e.jsx(C,{yAxisId:"right",orientation:"right"}),e.jsx(k,{}),e.jsx(D,{yAxisId:"left",dataKey:"revenue",fill:"#2563eb",name:"Revenue (k)"}),e.jsx(D,{yAxisId:"right",dataKey:"turnover",fill:"#10b981",name:"Turnover"})]})})})]})]}),e.jsxs(l,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Seasonal Pattern Analysis"}),e.jsx("div",{className:"h-64",children:e.jsx(w,{width:"100%",height:"100%",children:e.jsxs(oe,{data:L,children:[e.jsx(O,{strokeDasharray:"3 3"}),e.jsx(R,{dataKey:"month"}),e.jsx(C,{domain:[.7,1.4],tickFormatter:t=>`${(t*100).toFixed(0)}%`}),e.jsx(k,{formatter:t=>`${(t*100).toFixed(1)}%`}),e.jsx(S,{type:"monotone",dataKey:"UK",stroke:"#2563eb",strokeWidth:2}),e.jsx(S,{type:"monotone",dataKey:"EU",stroke:"#10b981",strokeWidth:2}),e.jsx(S,{type:"monotone",dataKey:"US",stroke:"#f59e0b",strokeWidth:2})]})})}),e.jsxs("div",{className:"flex justify-center space-x-6 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-600 rounded mr-2"}),e.jsx("span",{className:"text-sm",children:"UK"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-green-600 rounded mr-2"}),e.jsx("span",{className:"text-sm",children:"EU"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-600 rounded mr-2"}),e.jsx("span",{className:"text-sm",children:"US"})]})]})]}),e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(se,{className:"w-5 h-5 mr-2"}),"Cross-Market Optimization Opportunities"]}),e.jsxs(x,{variant:"outline",className:"text-green-600",children:["Potential Savings: ",r(i.marketOverview.crossMarketOptimizationPotential)]})]}),e.jsx("div",{className:"space-y-4",children:i.crossMarketInsights.arbitrageOpportunities.map((t,s)=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(x,{variant:"outline",children:t.product.replace(""," ")}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Transfer from ",e.jsx("strong",{children:t.from})," to ",e.jsx("strong",{children:t.to})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Potential Saving:"}),e.jsx("p",{className:"font-semibold text-green-600",children:r(t.potentialSaving)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Transfer Cost:"}),e.jsx("p",{className:"font-semibold text-red-600",children:r(t.transferCost)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Net Benefit:"}),e.jsx("p",{className:"font-semibold text-blue-600",children:r(t.netBenefit)})]})]})]}),e.jsx(b,{variant:"outline",size:"sm",children:"Analyze"})]})},s))})]}),e.jsxs(l,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Risk Tolerance Analysis"}),e.jsxs(x,{variant:"outline",children:["Current: ",n[0],"%"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:["Service Level Target: ",n[0],"%"]}),e.jsx(ce,{value:n,onValueChange:U,max:99,min:80,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Conservative (80%)"}),e.jsx("span",{children:"Aggressive (99%)"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Working Capital Impact"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:n[0]>95?"+£180k":n[0]>90?"+£90k":"£0k"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Stockout Risk"}),e.jsxs("p",{className:"text-lg font-semibold text-red-600",children:[(100-n[0]).toFixed(0),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Expected Savings"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:n[0]<90?"£420k":n[0]<95?"£280k":"£150k"})]})]})]})]})]})};export{fe as default};
