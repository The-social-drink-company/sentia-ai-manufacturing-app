import{a as e,ao as s,bm as t,j as a,aT as r,t as l,ad as i,W as d,bh as n,bn as c,bo as o,an as x,bp as m,z as h}from"./chunk-CZvSV-v7.js";import"./index-Ns7yFE9m.js";import"./chunk-rwMzC66e.js";import"./chunk-BHfUfMK7.js";import"./chunk-C3DITRU1.js";import"./chunk-BC7Dcwdl.js";import"./chunk-CSoZPqtx.js";import"./chunk-GD9X1rNN.js";import"./chunk-Dozjk7Op.js";const u=()=>{const[u]=e.useState("all"),[g,j]=e.useState("24h"),[p]=e.useState(3e4),{data:b,isLoading:y,refetch:N}=s({queryKey:["production-data",u,g],queryFn:async()=>{const e=await fetch(`/api/production/live?line=${u}&range=${g}`);if(!e.ok)throw new Error("Production API unavailable - no mock data allowed");return e.json()},refetchInterval:p}),f=t({mutationFn:async e=>(await fetch("/api/production/jobs/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json(),onSuccess:()=>N()}),w=t({mutationFn:async e=>(await fetch(`/api/production/jobs/${e}/pause`,{method:"POST"})).json(),onSuccess:()=>N()});e.useEffect(()=>{const e=setInterval(()=>{N()},p);return()=>clearInterval(e)},[p,N]);const v={labels:b?.hourlyProduction?.map(e=>e.hour)||[],datasets:[{label:"Target Production",data:b?.hourlyProduction?.map(e=>e.target)||[],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"Actual Production",data:b?.hourlyProduction?.map(e=>e.actual)||[],borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4}]},k=e=>{switch(e){case"running":return a.jsx(o,{className:"w-5 h-5 text-green-500"});case"paused":return a.jsx(c,{className:"w-5 h-5 text-yellow-500"});case"maintenance":return a.jsx(h,{className:"w-5 h-5 text-red-500"});default:return a.jsx(m,{className:"w-5 h-5 text-gray-500"})}};return y?a.jsx("div",{className:"max-w-7xl mx-auto p-6 flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(r,{className:"w-6 h-6 animate-spin text-blue-500"}),a.jsx("span",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading production data..."})]})}):a.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Production Tracking"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Real-time monitoring of production lines, schedules, and performance"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("select",{value:g,onChange:e=>j(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600",children:[a.jsx("option",{value:"1h",children:"Last Hour"}),a.jsx("option",{value:"24h",children:"Last 24 Hours"}),a.jsx("option",{value:"7d",children:"Last Week"})]}),a.jsxs("button",{onClick:()=>N(),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(r,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Active Jobs"}),a.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:b?.metrics?.activeJobs||0}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["of ",b?.metrics?.totalJobs||0," total"]})]}),a.jsx(l,{className:"w-8 h-8 text-blue-500"})]})}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Capacity"}),a.jsxs("p",{className:"text-3xl font-bold text-green-600 mt-2",children:[b?.metrics?.capacity||0,"%"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Utilization rate"})]}),a.jsx(l,{className:"w-8 h-8 text-green-500"})]})}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Efficiency"}),a.jsxs("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:[b?.metrics?.efficiency||0,"%"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Overall equipment"})]}),a.jsx(i,{className:"w-8 h-8 text-purple-500"})]})}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Output Today"}),a.jsx("p",{className:"text-3xl font-bold text-orange-600 mt-2",children:b?.metrics?.outputToday||0}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["of ",b?.metrics?.outputTarget||0," target"]})]}),a.jsx(d,{className:"w-8 h-8 text-orange-500"})]})})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Production Lines"})}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:b?.lines?.map(e=>a.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),k(e.status)]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Efficiency:"}),a.jsxs("span",{className:"font-medium",children:[e.efficiency,"%"]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Output:"}),a.jsxs("span",{className:"font-medium",children:[e.output," units"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.efficiency}%`}})})]})]},e.id))})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Active Jobs"}),a.jsxs("button",{className:"flex items-center px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:[a.jsx(n,{className:"w-4 h-4 mr-1"}),"New Job"]})]}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"space-y-4",children:b?.activeJobs?.map(e=>a.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.id}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.product," - ",e.line]})]}),a.jsx("div",{className:"flex space-x-2",children:"running"===e.status?a.jsx("button",{onClick:()=>w.mutate(e.id),className:"p-1 text-yellow-600 hover:bg-yellow-50 rounded",children:a.jsx(c,{className:"w-5 h-5"})}):a.jsx("button",{onClick:()=>f.mutate(e),className:"p-1 text-green-600 hover:bg-green-50 rounded",children:a.jsx(o,{className:"w-5 h-5"})})})]}),a.jsxs("div",{className:"mb-2",children:[a.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[a.jsx("span",{children:"Progress"}),a.jsxs("span",{children:[e.progress,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"h-2 rounded-full "+("running"===e.status?"bg-green-600":"paused"===e.status?"bg-yellow-600":"bg-gray-400"),style:{width:`${e.progress}%`}})})]}),a.jsxs("div",{className:"text-xs text-gray-500 flex justify-between",children:[a.jsxs("span",{children:["Started: ",new Date(e.startTime).toLocaleTimeString()]}),a.jsxs("span",{children:["ETA: ",new Date(e.estimatedEnd).toLocaleTimeString()]})]})]},e.id))})})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:a.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Hourly Production"})}),a.jsx("div",{className:"p-6",children:a.jsx("div",{style:{height:"300px"},children:a.jsx(x,{data:v,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Units"}},x:{title:{display:!0,text:"Time"}}}}})})})]})]})]})};export{u as default};
