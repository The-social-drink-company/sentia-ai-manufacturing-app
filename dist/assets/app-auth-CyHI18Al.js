import{r as h,u as N,d as x,e,L,S as R,C as B}from"./1-react-core-C8GbWHu9.js";const j=h.createContext(null),U={isLoaded:!0,isSignedIn:!1,userId:"guest_user",sessionId:"guest_session",user:{id:"guest_user",firstName:"Guest",lastName:"User",fullName:"Guest User",emailAddresses:[{emailAddress:"guest@sentia.local"}],publicMetadata:{role:"viewer"}},signOut:()=>Promise.resolve(),getToken:()=>Promise.resolve(null),mode:"fallback"};function y(){const t=h.useContext(j);if(t)return t;try{const s=N(),n=x();if(s?.isLoaded)return{...s,user:n?.user,mode:"clerk-direct"}}catch{}return U}function w(){const t=y(),s=t.user?.publicMetadata?.role||"viewer",n=C(s);return{role:s,permissions:n,hasPermission:a=>n.includes(a),isAdmin:s==="admin",isManager:s==="manager"||s==="admin",isAuthenticated:t.isSignedIn}}function C(t){const s={admin:["*"],manager:["read","write","update","delete","manage_team"],operator:["read","write","update"],viewer:["read"]};return s[t]||s.viewer}const I=()=>{const t=y(),s=w();return h.useMemo(()=>{const{user:a,isLoaded:c,isSignedIn:o,mode:i}=t;if(!c)return{isLoading:!0,isAuthenticated:!1,user:null,role:"viewer",permissions:["read"],features:{},hasRole:()=>!1,hasPermission:()=>!1,hasFeature:()=>!1,isRoleAtLeast:()=>!1,getUserDisplayName:()=>"Loading...",getUserInitials:()=>"...",canAccess:()=>!1};const u=s?.role||a?.publicMetadata?.role||a?.organizationMemberships?.[0]?.role||"viewer",f=s?.permissions||a?.publicMetadata?.permissions||S(u),A=a?.publicMetadata?.features||k(u),l=a?.fullName||a?.firstName||(i==="fallback"?"Guest User":"User"),g=a?.emailAddresses?.[0]?.emailAddress||(i==="fallback"?"guest@sentia.local":"user@sentia.local"),b={admin:4,manager:3,operator:2,viewer:1},p=r=>u===r,D=r=>u==="admin"?!0:f.includes(r);return{isLoading:!1,isAuthenticated:o||i==="fallback",authMode:i,user:a||{id:"guest",email:g,name:l},role:u,permissions:f,features:A,hasRole:p,hasPermission:D,hasFeature:r=>u==="admin"?!0:A[r]===!0,isRoleAtLeast:r=>(b[u]||0)>=(b[r]||0),getUserDisplayName:()=>l,getUserInitials:()=>{const r=l.split(" ");return r.length>=2?r[0][0].toUpperCase()+r[r.length-1][0].toUpperCase():l.substring(0,2).toUpperCase()},canAccess:r=>({dashboard:["read"],analytics:["read"],forecasting:["read","write"],inventory:["read","write"],production:["read","write"],quality:["read","write"],financial:["read","financial"],admin:["admin"],settings:["read","settings"]}[r]||["read"]).some(v=>D(v)),isSignedIn:o||!1,userEmail:g,userName:l}},[t,s])};function S(t){const s={admin:["read","write","delete","admin","financial","settings","manage_users","manage_system"],manager:["read","write","delete","financial","settings","manage_team"],operator:["read","write","update"],viewer:["read"]};return s[t]||s.viewer}function k(t){const s={admin:{aiAnalytics:!0,advancedReporting:!0,customDashboards:!0,apiAccess:!0,bulkOperations:!0,auditLogs:!0},manager:{aiAnalytics:!0,advancedReporting:!0,customDashboards:!0,apiAccess:!1,bulkOperations:!0,auditLogs:!1},operator:{aiAnalytics:!1,advancedReporting:!1,customDashboards:!0,apiAccess:!1,bulkOperations:!1,auditLogs:!1},viewer:{aiAnalytics:!1,advancedReporting:!1,customDashboards:!1,apiAccess:!1,bulkOperations:!1,auditLogs:!1}};return s[t]||s.viewer}function z({children:t,requireAdmin:s=!1,requiredRole:n=null,requiredPermission:a=null,requiredRoleAtLeast:c=null,requiredFeature:o=null,fallback:i=null}){const{isLoaded:u,isSignedIn:f}=N(),{isLoading:A,isAuthenticated:l,hasRole:g,hasPermission:b,isRoleAtLeast:p,hasFeature:D,role:m}=I();return!u||A?e.jsxDEV("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV(L,{className:"mx-auto h-8 w-8 animate-spin text-blue-600"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:32,columnNumber:11},this),e.jsxDEV("p",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:"Checking authentication..."},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:33,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:31,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:30,columnNumber:7},this):!f||!l?e.jsxDEV("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxDEV("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV(R,{className:"mx-auto h-12 w-12 text-red-500 mb-4"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:47,columnNumber:13},this),e.jsxDEV("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Authentication Required"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:48,columnNumber:13},this),e.jsxDEV("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"You need to sign in to access this page."},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:51,columnNumber:13},this),e.jsxDEV("button",{onClick:()=>window.location.href="/",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Go to Sign In"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:54,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:46,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:45,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:44,columnNumber:7},this):s&&m!=="admin"&&m!=="master_admin"?e.jsxDEV(d,{reason:"Admin access required",userRole:m,requiredRole:"admin or master_admin",fallback:i},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:68,columnNumber:12},this):n&&!g(n)?e.jsxDEV(d,{reason:"Specific role required",userRole:m,requiredRole:n,fallback:i},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:78,columnNumber:12},this):c&&!p(c)?e.jsxDEV(d,{reason:"Insufficient role level",userRole:m,requiredRole:`${c} or higher`,fallback:i},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:88,columnNumber:12},this):a&&!b(a)?e.jsxDEV(d,{reason:"Missing required permission",userRole:m,requiredPermission:a,fallback:i},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:98,columnNumber:12},this):o&&!D(o)?e.jsxDEV(d,{reason:"Feature not available",userRole:m,requiredFeature:o,fallback:i},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:108,columnNumber:12},this):e.jsxDEV(e.Fragment,{children:t},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:117,columnNumber:10},this)}function d({reason:t,userRole:s,requiredRole:n,requiredPermission:a,requiredFeature:c,fallback:o}){return o||e.jsxDEV("div",{className:"flex items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxDEV("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV(B,{className:"mx-auto h-12 w-12 text-amber-500 mb-4"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:138,columnNumber:11},this),e.jsxDEV("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Access Denied"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:139,columnNumber:11},this),e.jsxDEV("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:t},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:142,columnNumber:11},this),e.jsxDEV("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6 text-left",children:e.jsxDEV("div",{className:"text-sm space-y-2",children:[e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Your Role:"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:150,columnNumber:17},this),e.jsxDEV("span",{className:"text-gray-900 dark:text-white capitalize",children:s||"Unknown"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:151,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:149,columnNumber:15},this),n&&e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Required Role:"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:156,columnNumber:19},this),e.jsxDEV("span",{className:"text-gray-900 dark:text-white capitalize",children:n},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:157,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:155,columnNumber:17},this),a&&e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Required Permission:"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:163,columnNumber:19},this),e.jsxDEV("span",{className:"text-gray-900 dark:text-white font-mono text-xs",children:a},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:164,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:162,columnNumber:17},this),c&&e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Required Feature:"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:170,columnNumber:19},this),e.jsxDEV("span",{className:"text-gray-900 dark:text-white",children:c},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:171,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:169,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:148,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:147,columnNumber:11},this),e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("button",{onClick:()=>window.location.href="/dashboard",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Go to Dashboard"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:178,columnNumber:13},this),e.jsxDEV("button",{onClick:()=>window.history.back(),className:"w-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-800 dark:text-white font-medium py-2 px-4 rounded-md transition-colors",children:"Go Back"},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:185,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:177,columnNumber:11},this),e.jsxDEV("p",{className:"mt-6 text-xs text-gray-500 dark:text-gray-400",children:"If you believe this is an error, please contact your administrator."},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:193,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:137,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:136,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/DanielKenny/OneDrive - GABA LABS Research Ltd/Documents/AI logistics system/main-repo/sentia-manufacturing-dashboard/src/components/auth/ProtectedRoute.jsx",lineNumber:135,columnNumber:5},this)}const P=h.createContext(null),E={id:"fallback_user",emailAddresses:[{emailAddress:"demo@sentia.com"}],firstName:"Demo",lastName:"User",fullName:"Demo User",imageUrl:null,publicMetadata:{role:"manager",permissions:["read","write","export"],features:{advancedAnalytics:!0,apiAccess:!0}},createdAt:new Date().toISOString()},O={isLoaded:!0,isSignedIn:!0,userId:"fallback_user",sessionId:"fallback_session",user:E,signOut:()=>{localStorage.removeItem("sentia_auth_state"),window.location.reload()},getToken:async()=>"fallback_token",mode:"fallback"},G=()=>{const t=h.useContext(P);if(!t)throw new Error("useBulletproofAuth must be used within BulletproofClerkProvider");return t},H=()=>{const t=G();if(t?.isFallbackMode)return t;try{const s=N(),n=x();if(s?.isLoaded&&n?.user)return{...s,user:n.user,isFallbackMode:!1};if(!s?.isLoaded)return{isLoaded:!1,isSignedIn:!1,user:null,isLoading:!0,isFallbackMode:!1}}catch(s){console.warn("Clerk auth hooks not available, using fallback:",s.message)}return t||O};export{z as P,y as a,I as b,H as u};
