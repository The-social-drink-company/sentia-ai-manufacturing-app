import{r as e,j as t}from"./react-core-DkFbty9o.js";import{u as s,a}from"./ManufacturingIntelligence-mS35nsIY.js";import{u as r}from"./GlobalComplianceSystem-DSmKNDgd.js";import{a4 as i,a5 as n,a6 as l,e as c,b as d,s as o,a7 as m,a8 as x}from"./ui-components-J4-_vVnI.js";import"./vendor-CHbOot_X.js";import"./charts-DxLx1lqX.js";import"./vendor-utils-BvmCeSbq.js";import"./index-C8migC5L.js";import"./router-C0m1gglZ.js";import"./auth-M1VfQxmO.js";import"./forms-CtqjxpzJ.js";import"./animation-CTJwy-Vh.js";const u=({className:u="",enableAR:p=!0,enableVR:g=!1,autoSync:h=!0,...y})=>{const{performAIAnalysis:b,isLoading:j}=s(),{dataStreams:v,subscribe:N,STREAM_TYPES:f}=a(),{resolvedTheme:w}=r(),[k,S]=e.useState([]),[$,A]=e.useState(null),[D,_]=e.useState({}),[T,z]=e.useState(null),[R,I]=e.useState(null),[C,E]=e.useState("idle"),[M,U]=e.useState("overview"),[V,q]=e.useState(!1),P=e.useRef(null),L=[{id:"dt-production-line-a",name:"Production Line A - Digital Twin",type:"production_line",physicalAssetId:"prod-line-a",modelUrl:"/models/production-line-a.gltf",realTimeData:!0,sensors:45,actuators:12,lastSync:Date.now()-5e3,accuracy:98.5,status:"synchronized",capabilities:["simulation","prediction","optimization","ar_overlay"]},{id:"dt-cnc-machine-01",name:"CNC Machine #1 - Digital Twin",type:"cnc_machine",physicalAssetId:"cnc-001",modelUrl:"/models/cnc-machine.gltf",realTimeData:!0,sensors:18,actuators:6,lastSync:Date.now()-3e3,accuracy:96.8,status:"synchronized",capabilities:["simulation","maintenance_prediction","performance_optimization"]},{id:"dt-warehouse-01",name:"Main Warehouse - Digital Twin",type:"warehouse",physicalAssetId:"warehouse-main",modelUrl:"/models/warehouse.gltf",realTimeData:!0,sensors:120,actuators:30,lastSync:Date.now()-8e3,accuracy:94.2,status:"updating",capabilities:["inventory_tracking","route_optimization","space_utilization"]},{id:"dt-assembly-robot-01",name:"Assembly Robot Arm #1 - Digital Twin",type:"robot",physicalAssetId:"robot-001",modelUrl:"/models/robot-arm.gltf",realTimeData:!0,sensors:24,actuators:8,lastSync:Date.now()-2e3,accuracy:99.1,status:"synchronized",capabilities:["motion_planning","collision_detection","path_optimization","vr_control"]}],O=[{id:"scenario-01",name:"Peak Production Load",description:"Simulate maximum production capacity",type:"stress_test",parameters:{productionRate:150,duration:480,shiftPattern:"3-shift"}},{id:"scenario-02",name:"Equipment Failure Impact",description:"Analyze impact of critical equipment failure",type:"failure_analysis",parameters:{failedEquipment:"cnc-001",downtime:240,alternativeRouting:!0}},{id:"scenario-03",name:"Energy Optimization",description:"Optimize energy consumption patterns",type:"optimization",parameters:{targetReduction:15,constraints:["quality","throughput"],timeframe:"monthly"}},{id:"scenario-04",name:"New Product Introduction",description:"Simulate introduction of new product line",type:"npi",parameters:{productComplexity:"high",volumeRampUp:"gradual",learningCurve:.85}}];e.useEffect(()=>{S(L),h&&F()},[h]),e.useEffect(()=>{const e=k.map(e=>N(f.EQUIPMENT_STATUS,t=>{t.equipmentId===e.physicalAssetId&&B(e.id,t)}));return()=>{e.forEach(e=>e())}},[k,N,f]);const F=()=>{E("syncing");const e=setInterval(()=>{S(e=>e.map(e=>({...e,lastSync:Date.now(),accuracy:Math.min(100,e.accuracy+1),status:Math.random()>.1?"synchronized":"updating"})))},5e3);return()=>clearInterval(e)},B=(e,t)=>{_(s=>({...s,[e]:{...s[e],...t,timestamp:Date.now()}}))},G=e=>{const t="synchronized"===e.status?100:80,s=e.accuracy,a=e.sensors/50*100;return Math.round((t+s+a)/3)},H=e=>{switch(e){case"synchronized":return"text-green-600 bg-green-100 dark:bg-green-900/30";case"updating":return"text-blue-600 bg-blue-100 dark:bg-blue-900/30";case"disconnected":return"text-red-600 bg-red-100 dark:bg-red-900/30";case"maintenance":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/30"}},Q=`\n    rounded-lg border shadow-sm\n    ${"dark"===w?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}\n  `,W="dark"===w?"text-gray-100":"text-gray-900",Y="dark"===w?"text-gray-300":"text-gray-600",J="dark"===w?"text-gray-400":"text-gray-500";return t.jsxs("div",{className:`space-y-6 ${u}`,...y,children:[t.jsx("div",{className:Q,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(i,{className:"w-6 h-6 mr-3 text-purple-600"}),t.jsx("h2",{className:`text-xl font-semibold ${W}`,children:"Digital Twin & AR/VR Integration"}),t.jsx("span",{className:"ml-3 px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full dark:bg-purple-900/30 dark:text-purple-400",children:"INNOVATION LAB"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[p&&t.jsxs("button",{onClick:async()=>{if(p&&navigator.xr)try{if(await navigator.xr.isSessionSupported("immersive-ar")){const e=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test","dom-overlay"],domOverlay:{root:document.body}});z(e)}}catch(e){}},className:`\n                    px-3 py-2 rounded-lg font-medium transition-colors flex items-center\n                    ${T?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-purple-600 text-white hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600"}\n                  `,children:[t.jsx(n,{className:"w-4 h-4 mr-2"}),T?"AR Active":"Start AR"]}),g&&t.jsxs("button",{onClick:async()=>{if(g&&navigator.xr)try{if(await navigator.xr.isSessionSupported("immersive-vr")){const e=await navigator.xr.requestSession("immersive-vr");I(e)}}catch(e){}},className:`\n                    px-3 py-2 rounded-lg font-medium transition-colors flex items-center\n                    ${R?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-indigo-600 text-white hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600"}\n                  `,children:[t.jsx(l,{className:"w-4 h-4 mr-2"}),R?"VR Active":"Start VR"]})]})]}),t.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:["overview","3d-view","simulations","analytics","control"].map(e=>t.jsx("button",{onClick:()=>U(e),className:`\n                  px-4 py-2 rounded-md text-sm font-medium transition-colors\n                  ${M===e?"bg-white shadow text-purple-600 dark:bg-gray-800 dark:text-purple-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}\n                `,children:"3d-view"===e?"3D View":e.charAt(0).toUpperCase()+e.slice(1)},e))})]})}),"overview"===M&&t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6",children:k.map(e=>t.jsx("div",{className:Q,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{className:`\n                      w-10 h-10 rounded-lg flex items-center justify-center\n                      ${"production_line"===e.type?"bg-blue-100 dark:bg-blue-900/30":"cnc_machine"===e.type?"bg-green-100 dark:bg-green-900/30":"warehouse"===e.type?"bg-orange-100 dark:bg-orange-900/30":"bg-purple-100 dark:bg-purple-900/30"}\n                    `,children:t.jsx(c,{className:`\n                        w-6 h-6\n                        ${"production_line"===e.type?"text-blue-600":"cnc_machine"===e.type?"text-green-600":"warehouse"===e.type?"text-orange-600":"text-purple-600"}\n                      `})})}),t.jsx("div",{className:`\n                    px-2 py-1 rounded-full text-xs font-medium\n                    ${H(e.status)}\n                  `,children:e.status})]}),t.jsx("h3",{className:`font-semibold mb-2 ${W}`,children:e.name}),t.jsxs("div",{className:"space-y-2 mb-4",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:Y,children:"Health Score"}),t.jsxs("span",{className:"font-medium "+(G(e)>=90?"text-green-600":G(e)>=70?"text-yellow-600":"text-red-600"),children:[G(e),"%"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:Y,children:"Accuracy"}),t.jsxs("span",{className:`font-medium ${W}`,children:[e.accuracy.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:Y,children:"Sensors"}),t.jsx("span",{className:`font-medium ${W}`,children:e.sensors})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-slate-700",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(d,{className:`\n                      w-4 h-4 mr-1\n                      ${e.realTimeData?"text-green-500":"text-gray-400"}\n                    `}),t.jsx("span",{className:`text-xs ${J}`,children:e.realTimeData?"Live":"Offline"})]}),t.jsx("button",{onClick:()=>A(e),className:"text-sm text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300",children:"View Details"})]})]})},e.id))}),"3d-view"===M&&t.jsx("div",{className:Q,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:`text-lg font-semibold ${W}`,children:"3D Digital Twin Visualization"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg dark:text-gray-300 dark:hover:bg-gray-700",children:t.jsx(o,{className:"w-5 h-5"})}),t.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg dark:text-gray-300 dark:hover:bg-gray-700",children:t.jsx(n,{className:"w-5 h-5"})})]})]}),t.jsx("div",{ref:P,className:`\n                w-full h-96 rounded-lg flex items-center justify-center\n                ${"dark"===w?"bg-slate-900":"bg-gray-100"}\n              `,children:V?t.jsx("canvas",{className:"w-full h-full"}):t.jsxs("div",{className:"text-center",children:[t.jsx(i,{className:"w-16 h-16 mx-auto mb-4 text-purple-600"}),t.jsx("p",{className:`text-lg font-medium ${W}`,children:"3D Visualization"}),t.jsx("p",{className:`text-sm ${Y}`,children:"Three.js integration would render here"})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:"98.5%"}),t.jsx("div",{className:`text-sm ${J}`,children:"Model Accuracy"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-green-600",children:"45"}),t.jsx("div",{className:`text-sm ${J}`,children:"Active Sensors"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-purple-600",children:"12"}),t.jsx("div",{className:`text-sm ${J}`,children:"Actuators"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-orange-600",children:"5ms"}),t.jsx("div",{className:`text-sm ${J}`,children:"Latency"})]})]})]})}),"simulations"===M&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx("div",{className:Q,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${W}`,children:"Available Scenarios"}),t.jsx("div",{className:"space-y-3",children:O.map(e=>t.jsxs("div",{className:`\n                    p-4 rounded-lg border cursor-pointer hover:shadow-md transition-shadow\n                    ${"dark"===w?"bg-slate-700 border-slate-600 hover:border-purple-500":"bg-gray-50 border-gray-200 hover:border-purple-300"}\n                  `,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:`font-medium ${W}`,children:e.name}),t.jsx(m,{className:"w-5 h-5 text-purple-600"})]}),t.jsx("p",{className:`text-sm mb-3 ${Y}`,children:e.description}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:`\n                        px-2 py-1 rounded text-xs font-medium\n                        ${"stress_test"===e.type?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"optimization"===e.type?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"failure_analysis"===e.type?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}\n                      `,children:e.type.replace("_"," ").toUpperCase()}),t.jsx("button",{onClick:()=>$&&(async(e,t)=>{const s=k.find(t=>t.id===e),a=O.find(e=>e.id===t);if(s&&a)try{const r=await b("digitalTwinSimulation",{twin:s,scenario:a,currentData:D[e]||{}});return _(s=>({...s,[e]:{...s[e],simulations:{...s[e]?.simulations,[t]:{result:r,timestamp:Date.now(),status:"completed"}}}})),r}catch(r){return null}})($.id,e.id),className:"text-sm text-purple-600 hover:text-purple-700 dark:text-purple-400",children:"Run Simulation"})]})]},e.id))})]})}),t.jsx("div",{className:Q,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${W}`,children:"Simulation Results"}),t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"text-center py-8",children:[t.jsx(x,{className:"w-12 h-12 mx-auto mb-3 text-purple-400"}),t.jsx("p",{className:Y,children:"Run a simulation to see results"}),t.jsx("p",{className:`text-sm ${J}`,children:"AI-powered analysis and predictions"})]})})]})})]})]})};export{u as DigitalTwinSystem,u as default};
