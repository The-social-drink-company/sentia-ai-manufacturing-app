import{r as e,j as t}from"./react-core-DkFbty9o.js";import{A as a,m as n}from"./animation-CTJwy-Vh.js";import{a8 as o,$ as i,a as r,q as s,r as c,u as l}from"./ui-components-J4-_vVnI.js";import{l as d,e as u,j as m}from"./index-C8migC5L.js";function p({notification:a,onClose:d}){const{id:u,type:m,title:p,message:h,duration:g=5e3,action:y}=a,f={success:{bg:"from-green-500 to-emerald-500",icon:c,accent:"border-green-200",glow:"shadow-green-500/25"},error:{bg:"from-red-500 to-rose-500",icon:s,accent:"border-red-200",glow:"shadow-red-500/25"},warning:{bg:"from-yellow-500 to-amber-500",icon:r,accent:"border-yellow-200",glow:"shadow-yellow-500/25"},info:{bg:"from-blue-500 to-indigo-500",icon:i,accent:"border-blue-200",glow:"shadow-blue-500/25"},magic:{bg:"from-purple-500 to-pink-500",icon:o,accent:"border-purple-200",glow:"shadow-purple-500/25"}},w=f[m]||f.info,b=w.icon;return e.useEffect(()=>{if(g>0){const e=setTimeout(()=>d(u),g);return()=>clearTimeout(e)}},[u,g,d]),t.jsxs(n.div,{initial:{opacity:0,y:-50,scale:.9,x:400},animate:{opacity:1,y:0,scale:1,x:0},exit:{opacity:0,x:400,scale:.8,transition:{duration:.3,ease:"easeIn"}},transition:{type:"spring",stiffness:300,damping:30,opacity:{duration:.2}},className:`\n        relative overflow-hidden min-w-80 max-w-md mb-3\n        bg-white/95 backdrop-blur-xl rounded-2xl \n        border border-white/50 ${w.accent}\n        shadow-2xl ${w.glow}\n        transform-gpu\n      `,whileHover:{y:-2,scale:1.02,transition:{duration:.2}},layout:!0,children:[t.jsx(n.div,{className:`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${w.bg}`,initial:{scaleX:0},animate:{scaleX:1},transition:{duration:.5,delay:.1}}),g>0&&t.jsx(n.div,{className:`absolute top-0 left-0 h-1 bg-gradient-to-r ${w.bg} opacity-60`,initial:{width:"100%"},animate:{width:"0%"},transition:{duration:g/1e3,ease:"linear"}}),t.jsxs("div",{className:"p-4 flex items-start space-x-3",children:[t.jsx(n.div,{className:`flex-shrink-0 w-8 h-8 rounded-xl bg-gradient-to-r ${w.bg} flex items-center justify-center`,initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:400,damping:15,delay:.2},whileHover:{scale:1.1,rotate:"success"===m?10:0},children:t.jsx(b,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx(n.h4,{className:"text-sm font-semibold text-gray-900 truncate",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},children:p}),h&&t.jsx(n.p,{className:"mt-1 text-sm text-gray-600 leading-relaxed",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4},children:h}),y&&t.jsx(n.button,{className:`mt-3 text-xs font-medium px-3 py-1.5 rounded-lg bg-gradient-to-r ${w.bg} text-white hover:opacity-90 transition-opacity`,onClick:y.onClick,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},whileHover:{scale:1.05},whileTap:{scale:.95},children:y.label})]}),t.jsx(n.button,{className:"flex-shrink-0 w-6 h-6 rounded-lg hover:bg-gray-100 flex items-center justify-center group transition-colors",onClick:()=>d(u),initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.6},whileHover:{scale:1.1,backgroundColor:"rgba(0,0,0,0.1)"},whileTap:{scale:.9},children:t.jsx(l,{className:"w-4 h-4 text-gray-400 group-hover:text-gray-600"})})]}),"magic"===m&&t.jsx(t.Fragment,{children:[...Array(3)].map((e,a)=>t.jsx(n.div,{className:"absolute w-1 h-1 bg-purple-400 rounded-full",style:{top:20+25*a+"%",right:10+15*a+"%"},animate:{scale:[0,1.5,0],opacity:[0,1,0],rotate:[0,180,360]},transition:{duration:2,delay:.3*a,repeat:1/0,ease:"easeInOut"}},a))}),t.jsx(n.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent pointer-events-none",initial:{x:"-100%"},animate:{x:"100%"},transition:{duration:1.5,ease:"easeInOut",repeat:"magic"===m?1/0:0,repeatDelay:3}})]})}function h(){const[n,o]=e.useState([]),i=e.useCallback(e=>{const t=Date.now()+0;o(a=>[...a,{...e,id:t}])},[]),r=e.useCallback(e=>{o(t=>t.filter(t=>t.id!==e))},[]);return e.useEffect(()=>{const e=e=>{i(e.detail)};return window.addEventListener("sentia-notify",e),()=>{window.removeEventListener("sentia-notify",e)}},[i]),e.useEffect(()=>{const e=setInterval(()=>{const e=[{type:"success",title:"Production Update",message:"Batch #SEN-2025-089 completed mixing successfully"},{type:"info",title:"New Orders",message:"5 new orders received from Amazon UK"},{type:"warning",title:"Inventory Alert",message:"Low stock warning: Gin & Tonic bottles running low"}];if(Math.random()<.1){const t=e[Math.floor(Math.random()*e.length)];i(t)}},3e4);return()=>clearInterval(e)},[i]),0===n.length?null:t.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-3 max-w-md pointer-events-auto",children:t.jsx(a,{mode:"popLayout",children:n.map(e=>t.jsx(p,{notification:e,onClose:r},e.id))})})}const g=e=>{const t=new CustomEvent("sentia-notify",{detail:e});window.dispatchEvent(t)},y=()=>({showSuccess:e.useCallback((e,t,a)=>{g({type:"success",title:e,message:t,duration:a})},[]),showError:e.useCallback((e,t,a)=>{g({type:"error",title:e,message:t,duration:a})},[]),showWarning:e.useCallback((e,t,a)=>{g({type:"warning",title:e,message:t,duration:a})},[]),showInfo:e.useCallback((e,t,a)=>{g({type:"info",title:e,message:t,duration:a})},[]),showMagic:e.useCallback((e,t,a)=>{g({type:"magic",title:e,message:t,duration:a})},[])}),f=({children:e})=>t.jsxs("div",{children:[e,t.jsx(h,{})]}),w=()=>{const[t,a]=e.useState(!1),[n,o]=e.useState("disconnected"),[i,r]=e.useState(null),[s,c]=e.useState([]),[l,p]=e.useState(null),h="http://localhost:9000",g="sentia-mcp-secret",y=e.useCallback(async()=>{try{const e=await fetch(`${h}/health`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json();return r(t),o("connected"),a(!0),p(null),d("MCP server health check successful",{health:t}),t}throw new Error(`Health check failed: ${e.status}`)}catch(e){return u("MCP server health check failed",e),o("disconnected"),a(!1),p(e.message),null}},[h]),f=e.useCallback(async()=>{try{const e=await fetch(`${h}/mcp/tools`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}});if(e.ok){const t=await e.json();return c(t.tools||[]),d("MCP tools retrieved successfully",{toolCount:t.tools?.length||0}),t.tools||[]}throw new Error(`Failed to get tools: ${e.status}`)}catch(e){return u("Failed to get MCP tools",e),c([]),[]}},[h,g]),w=e.useCallback(async(e,t={})=>{try{d("Executing MCP tool",{toolName:e,parameters:t});const a=await fetch(`${h}/mcp/execute`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({tool:e,parameters:t})});if(a.ok){const t=await a.json();return d("MCP tool executed successfully",{toolName:e,result:t}),t}{const e=await a.json();throw new Error(e.error||`Tool execution failed: ${a.status}`)}}catch(a){throw u("MCP tool execution failed",{toolName:e,error:a.message}),a}},[h,g]),b=e.useCallback(async(e={})=>{const t={horizon:30,confidence:.95,seasonality:!0,...e};try{return await w("demand_forecast",t)}catch(a){return m("Demand forecast failed, using fallback",a),{forecast:{predictions:Array.from({length:30},(e,t)=>({date:new Date(Date.now()+24*t*60*60*1e3).toISOString().split("T")[0],value:1e3+500*Math.random(),confidence:.85+.1*Math.random()})),accuracy:.87,trend:"increasing"},insights:[{type:"trend",message:"Demand showing upward trend with 87% confidence",impact:"positive"}]}}},[w]),x=e.useCallback(async(e={})=>{const t={timeHorizon:7,resourceConstraints:!0,qualityTargets:!0,...e};try{return await w("production_optimization",t)}catch(a){return m("Production optimization failed, using fallback",a),{optimization:{efficiency:.94,recommendations:[{action:"Increase Line 2 capacity",impact:"+12% throughput",cost:5e3},{action:"Optimize shift scheduling",impact:"+8% efficiency",cost:0}]},metrics:{currentEfficiency:.87,projectedEfficiency:.94,costSavings:15e3}}}},[w]),v=e.useCallback(async(e={})=>{const t={predictionHorizon:24,includeRiskFactors:!0,...e};try{return await w("quality_prediction",t)}catch(a){return m("Quality prediction failed, using fallback",a),{predictions:[{time:(new Date).toISOString(),qualityScore:.92,riskLevel:"low",factors:["temperature","humidity","operator_experience"]}],riskFactors:[{factor:"Temperature variance",risk:.15,recommendation:"Maintain ±2°C control"},{factor:"Operator fatigue",risk:.08,recommendation:"Implement rotation schedule"}]}}},[w]),k=e.useCallback(async(e={})=>{const t={optimizationPeriod:30,includeCarryingCosts:!0,demandUncertainty:!0,...e};try{return await w("inventory_optimization",t)}catch(a){return m("Inventory optimization failed, using fallback",a),{optimization:{currentInventoryValue:18e5,optimalInventoryValue:165e4,savings:15e4,recommendations:[{sku:"SKU-001",currentStock:1e3,optimalStock:750,reason:"High carrying cost"},{sku:"SKU-002",currentStock:500,optimalStock:800,reason:"Demand increase predicted"}]},metrics:{turnoverImprovement:.12,carryingCostReduction:.18,stockoutRiskReduction:.25}}}},[w]),C=e.useCallback(e=>{if(!t)return m("Cannot subscribe to real-time data: MCP server not connected"),null;try{const t=new EventSource(`${h}/mcp/stream`);return t.onmessage=t=>{try{const a=JSON.parse(t.data);e(a)}catch(a){u("Failed to parse real-time data",a)}},t.onerror=e=>{u("Real-time data stream error",e),t.close()},t}catch(a){return u("Failed to establish real-time data stream",a),null}},[t,h]);e.useEffect(()=>{(async()=>{d("Initializing MCP server connection"),await y()&&await f();setInterval(y,3e4)})()},[y,f]);const j=e.useCallback(()=>{switch(n){case"connected":return{status:"connected",color:"green",message:"MCP Server Connected",icon:"✓"};case"connecting":return{status:"connecting",color:"yellow",message:"Connecting to MCP Server...",icon:"⟳"};default:return{status:"disconnected",color:"red",message:l||"MCP Server Disconnected",icon:"✗"}}},[n,l]);return{isConnected:t,connectionStatus:n,serverHealth:i,error:l,availableTools:s,checkServerHealth:y,getAvailableTools:f,executeTool:w,runDemandForecast:b,optimizeProduction:x,predictQuality:v,optimizeInventory:k,subscribeToRealTimeData:C,getConnectionStatusInfo:j}};export{h as N,f as a,y as b,w as u};
