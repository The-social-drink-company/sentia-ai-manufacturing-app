import{r as e,al as a,bk as s,j as t,aQ as r,b6 as i,bt as n,aa as d,a8 as l,bu as c,b1 as o,t as m,ak as h,bv as x}from"./chunk-gD0WZlZe.js";import"./index-DoInKTaY.js";import{D as u}from"./chunk-E_h9yjlz.js";import"./chunk-tZo8O77D.js";import"./chunk-BY8qDDXp.js";import"./chunk-CGOCBQ1v.js";import"./chunk-D_LFaUfL.js";import"./chunk-DuMuM8ZY.js";import"./chunk-B0LCvgW6.js";import"./chunk-BXzNuMxH.js";import"./chunk-Dozjk7Op.js";const p=()=>{const[h,x]=e.useState("30"),[p,w]=e.useState(["all"]),[k,A]=e.useState("demand"),[D]=e.useState(()=>new u),{data:M,refetch:P}=a({queryKey:["demand-forecast",h,p,k],queryFn:async()=>{try{const e=await fetch(`/api/forecasting/demand?period=${h}&products=${p.join(",")}&type=${k}`,{headers:{Authorization:`Bearer ${session?.accessToken||""}`}});if(e.ok)return e.json()}catch(i){}const e=parseInt(h),a=D.generateDateRange(new Date,e,!0),s={"gaba-red-500":850,"gaba-clear-500":620,"gaba-red-250":450,"gaba-clear-250":280,all:2200},t=[];let r=0;return a.forEach((e,a)=>{const i=D.seasonalPatterns.getBusinessSeasonality(e.month,e.quarter),n=[.8,.85,1.1,1.15,1,.9,.7][e.dayOfWeek],d=p[0],l=Math.round((s[d]||s.all)*i*n*(1+.2*(Math.random()-.5)));r+=l,t.push({date:e.dateString,predicted:l,historical:a<7?l*(.9+.2*Math.random()):null,seasonalFactor:i,dayOfWeekFactor:n,isBusinessDay:e.isBusinessDay})}),{totalDemand:r,confidence:Math.max(80,Math.min(95,87+10*(Math.random()-.5))),peakDay:`Day ${Math.floor(Math.random()*e)+1}`,accuracy:Math.max(85,Math.min(95,89+8*(Math.random()-.5))),forecastData:t,productBreakdown:S(selectedProduct,r),seasonalPatterns:C(),riskFactors:B(),insights:F(r,e)}},refetchInterval:6e4}),S=(e,a)=>{if("all"===e)return[{name:"GABA Red 500ml",category:"Premium",forecast:Math.round(.4*a)},{name:"GABA Clear 500ml",category:"Premium",forecast:Math.round(.3*a)},{name:"GABA Red 250ml",category:"Standard",forecast:Math.round(.2*a)},{name:"GABA Clear 250ml",category:"Standard",forecast:Math.round(.1*a)}];{const s=R.find(a=>a.id===e);return[{name:s?.name||"Selected Product",category:"Product",forecast:a}]}},C=()=>[{period:"Q1",intensity:85+Math.round(10*Math.random())},{period:"Q2",intensity:90+Math.round(10*Math.random())},{period:"Q3",intensity:75+Math.round(10*Math.random())},{period:"Q4",intensity:95+Math.round(10*Math.random())}],B=()=>[{factor:"Supply Chain Reliability",level:Math.random()>.7?"medium":"low",description:"Current supply chain status and potential disruptions"},{factor:"Market Demand Volatility",level:Math.random()>.8?"high":"medium",description:"Market demand patterns and economic indicators"}],F=(e,a)=>[{title:"Production Capacity Planning",priority:e/a>2500?"High":"Medium",description:`Forecast shows ${Math.round(e/a)} daily demand average`,impact:"+12% revenue potential"},{title:"Inventory Optimization",priority:"Medium",description:"Adjust safety stock levels based on seasonal patterns",impact:"6% cost reduction"}],G=s({mutationFn:async()=>(await fetch("/api/forecasting/run-model",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await(user?.getToken())}`},body:JSON.stringify({modelType:"demand_forecast",parameters:{horizon:parseInt(h),products:p,seasonality:!0,confidence:.95}})})).json(),onSuccess:()=>{P()}}),$=M||N,R=[{id:"all",name:"All Products"},{id:"gaba-red-500",name:"GABA Red 500ml"},{id:"gaba-clear-500",name:"GABA Clear 500ml"},{id:"gaba-red-250",name:"GABA Red 250ml"},{id:"gaba-clear-250",name:"GABA Clear 250ml"}];return t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Demand Forecasting"}),t.jsx("p",{className:"mt-2 text-gray-600",children:"AI-powered demand predictions and market analysis"})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("button",{onClick:()=>G.mutate(),disabled:G.isLoading,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[G.isLoading?t.jsx(r,{className:"w-4 h-4 mr-2 animate-spin"}):t.jsx(i,{className:"w-4 h-4 mr-2"}),"Generate Forecast"]}),t.jsxs("button",{className:"flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:[t.jsx(n,{className:"w-4 h-4 mr-2"}),"Export Data"]})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forecast Period (Days)"}),t.jsxs("select",{value:h,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"7",children:"7 Days"}),t.jsx("option",{value:"14",children:"14 Days"}),t.jsx("option",{value:"30",children:"30 Days"}),t.jsx("option",{value:"60",children:"60 Days"}),t.jsx("option",{value:"90",children:"90 Days"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Products"}),t.jsx("select",{value:p[0],onChange:e=>w([e.target.value]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:R.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Analysis Type"}),t.jsxs("select",{value:k,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"demand",children:"Demand Forecast"}),t.jsx("option",{value:"seasonal",children:"Seasonal Analysis"}),t.jsx("option",{value:"trend",children:"Trend Analysis"}),t.jsx("option",{value:"scenario",children:"Scenario Planning"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Status"}),t.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[t.jsx(d,{className:"w-5 h-5 text-green-500"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Model Ready"})]})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[t.jsx(g,{title:"Predicted Demand",value:$.totalDemand?.toLocaleString()||"0",change:"+12.5%",trend:"up",icon:t.jsx(l,{className:"w-6 h-6"})}),t.jsx(g,{title:"Confidence Level",value:`${$.confidence||87}%`,change:"+2.1%",trend:"up",icon:t.jsx(c,{className:"w-6 h-6"})}),t.jsx(g,{title:"Peak Demand Day",value:$.peakDay||"Day 15",change:"Fri",trend:"stable",icon:t.jsx(o,{className:"w-6 h-6"})}),t.jsx(g,{title:"Model Accuracy",value:`${$.accuracy||89}%`,change:"+1.3%",trend:"up",icon:t.jsx(m,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[t.jsx(y,{data:$.forecastData}),t.jsx(j,{data:$.productBreakdown})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx(b,{patterns:$.seasonalPatterns}),t.jsx(f,{risks:$.riskFactors}),t.jsx(v,{insights:$.insights})]})]})})},g=({title:e,value:a,change:s,trend:r,icon:i})=>{const n="up"===r||"down"===r?l:o,d="up"===r?"text-green-500":"down"===r?"text-red-500":"text-gray-500";return t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),t.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600",children:i})]}),t.jsx("div",{className:"flex items-end justify-between",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:a}),t.jsxs("div",{className:"flex items-center mt-1",children:[t.jsx(n,{className:`w-4 h-4 ${d}`}),t.jsx("span",{className:`text-sm ml-1 ${d}`,children:s}),t.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"vs last period"})]})]})})]})},y=({data:e})=>{const a={labels:e?.map(e=>e.date)||[],datasets:[{label:"Predicted Demand",data:e?.map(e=>e.predicted)||[],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Historical Demand",data:e?.map(e=>e.historical)||[],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!1,tension:.4}]};return t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Demand Forecast"}),t.jsx("div",{className:"h-64",children:t.jsx(h,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Demand Forecast vs Historical Data"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Units"}}}}})})]})},j=({data:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Product Breakdown"}),t.jsx("div",{className:"space-y-4",children:(e||w).map((e,a)=>t.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 rounded-full "+(0===a?"bg-blue-500":1===a?"bg-green-500":2===a?"bg-yellow-500":"bg-purple-500")}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.name}),t.jsx("div",{className:"text-sm text-gray-500",children:e.category})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.forecast.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-500",children:"units"})]})]},a))})]}),b=({patterns:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Seasonal Patterns"}),t.jsx("div",{className:"space-y-3",children:(e||k).map((e,a)=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-600",children:e.period}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.intensity}%`}})}),t.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e.intensity,"%"]})]})]},a))})]}),f=({risks:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Risk Factors"}),t.jsx("div",{className:"space-y-3",children:(e||A).map((e,a)=>t.jsxs("div",{className:"p-3 rounded-lg border-l-4 "+("high"===e.level?"border-red-400 bg-red-50":"medium"===e.level?"border-yellow-400 bg-yellow-50":"border-blue-400 bg-blue-50"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"font-medium text-gray-900",children:e.factor}),t.jsx(x,{className:"w-4 h-4 "+("high"===e.level?"text-red-600":"medium"===e.level?"text-yellow-600":"text-blue-600")})]}),t.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},a))})]}),v=({insights:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Actionable Insights"}),t.jsx("div",{className:"space-y-4",children:(e||D).map((e,a)=>t.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),t.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:e.priority})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),t.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Expected Impact: ",e.impact]})]},a))})]}),N={totalDemand:25420,confidence:87.3,peakDay:"Day 15",accuracy:89.2,forecastData:[{date:"Jan 1",predicted:850,historical:820},{date:"Jan 2",predicted:920,historical:890},{date:"Jan 3",predicted:780,historical:750},{date:"Jan 4",predicted:1050,historical:1020},{date:"Jan 5",predicted:1150,historical:null}]},w=[{name:"GABA Red 500ml",category:"Premium",forecast:12500},{name:"GABA Clear 500ml",category:"Premium",forecast:8900},{name:"GABA Red 250ml",category:"Standard",forecast:2800},{name:"GABA Clear 250ml",category:"Standard",forecast:1220}],k=[{period:"Q1",intensity:85},{period:"Q2",intensity:92},{period:"Q3",intensity:78},{period:"Q4",intensity:96}],A=[{factor:"Supply Chain Disruption",level:"medium",description:"Potential delays from primary supplier"},{factor:"Market Volatility",level:"low",description:"Economic indicators show stable demand"}],D=[{title:"Increase Production Capacity",priority:"High",description:"Demand forecast shows 25% increase in Q2",impact:"+15% revenue potential"},{title:"Optimize Inventory Levels",priority:"Medium",description:"Adjust safety stock for seasonal variations",impact:"8% cost reduction"}];export{p as default};
