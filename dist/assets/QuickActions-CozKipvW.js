import{ab as r,aG as K,b3 as G,ar as H,b5 as O,aZ as D,b6 as B,b7 as y,b8 as U,b9 as Y,r as C,ba as q,bb as J,bc as E,bd as V,be as Q,bf as X,bg as $,bh as Z,bi as W,aJ as ee}from"./vendor-C1LNgw1J.js";import{e as x,C as M,a as P,b as N,c as z,d as R,f as j}from"./index-N-0KO8U4.js";import{i as te,j as se,k as ae,l as oe,D as re,m as ne,O as ie,n as le,o as ce,p as de,q as ue,r as he,s as ge,t as xe,u as me}from"./radix-CSh4aNe1.js";import{p as A,a as be}from"./DashboardEnterprise-4TRamfKp.js";import{s as ve}from"./stockLevelsApi-y4gfd6ZA.js";import"./data-layer-rESbPKUZ.js";import"./router-BEPb3H3e.js";function ye({...e}){return r.jsx(te,{"data-slot":"dialog",...e})}function pe({...e}){return r.jsx(ne,{"data-slot":"dialog-portal",...e})}function fe({className:e,...s}){return r.jsx(ie,{"data-slot":"dialog-overlay",className:x("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...s})}function Se({className:e,children:s,...t}){return r.jsxs(pe,{"data-slot":"dialog-portal",children:[r.jsx(fe,{}),r.jsxs(se,{"data-slot":"dialog-content",className:x("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t,children:[s,r.jsxs(ae,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[r.jsx(K,{}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function we({className:e,...s}){return r.jsx("div",{"data-slot":"dialog-header",className:x("flex flex-col gap-2 text-center sm:text-left",e),...s})}function je({className:e,...s}){return r.jsx(oe,{"data-slot":"dialog-title",className:x("text-lg leading-none font-semibold",e),...s})}function Fe({className:e,...s}){return r.jsx(re,{"data-slot":"dialog-description",className:x("text-muted-foreground text-sm",e),...s})}function ke({className:e,...s}){return r.jsx(le,{"data-slot":"checkbox",className:x("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:r.jsx(ce,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:r.jsx(G,{className:"size-3.5"})})})}function Ce({className:e,...s}){return r.jsx(de,{"data-slot":"label",className:x("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...s})}function Me({className:e,orientation:s="horizontal",decorative:t=!0,...a}){return r.jsx(ue,{"data-slot":"separator-root",decorative:t,orientation:s,className:x("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...a})}const T=H("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Pe({className:e,classNames:s,showOutsideDays:t=!0,...a}){return r.jsx(O,{showOutsideDays:t,className:x("p-3",e),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:x(T({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:x("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",a.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:x(T({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({className:i,...o})=>r.jsx(B,{className:x("size-4",i),...o}),IconRight:({className:i,...o})=>r.jsx(D,{className:x("size-4",i),...o})},...a})}function Ne({...e}){return r.jsx(he,{"data-slot":"popover",...e})}function ze({...e}){return r.jsx(ge,{"data-slot":"popover-trigger",...e})}function Re({className:e,align:s="center",sideOffset:t=4,...a}){return r.jsx(xe,{children:r.jsx(me,{"data-slot":"popover-content",align:s,sideOffset:t,className:x("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...a})})}const L=[{label:"Global working capital",value:"$9.2M",helper:"Across all subsidiaries"},{label:"Cash coverage",value:"214 days",helper:"Including credit facilities"},{label:"Intercompany exposure",value:"$1.1M",helper:"Pending settlements"},{label:"FX sensitivity",value:"$380K",helper:"±1% USD/EUR/JPY"}],I=[{region:"UK",revenue:42e5,ebitda:98e4},{region:"US",revenue:385e4,ebitda:82e4},{region:"EU",revenue:615e4,ebitda:114e4}],$e=async(e,s)=>{const t={metadata:{title:"Sentia Manufacturing Dashboard Report",generatedAt:new Date().toISOString(),reportPeriod:{from:s.from,to:s.to,formatted:`${y(s.from,"MMMM d, yyyy")} - ${y(s.to,"MMMM d, yyyy")}`},sections:e},sections:{}};try{if(e.capitalKpis&&(t.sections.capitalKpis={title:"Capital Position",description:"Key metrics reviewed in the weekly treasury meeting",data:L,summary:Ae(L)}),e.performanceKpis){const a=await A.getKPISummary();t.sections.performanceKpis={title:"Performance Metrics",description:"Key business performance indicators tracked for operational excellence",data:a.success?[{label:"Annual revenue",value:a.data.annualRevenue.value,helper:a.data.annualRevenue.helper},{label:"Units sold",value:a.data.unitsSold.value,helper:a.data.unitsSold.helper},{label:"Gross margin",value:a.data.grossMargin.value,helper:a.data.grossMargin.helper}]:[],summary:Ee(a.data)}}if(e.plAnalysis){const a=await A.getPLAnalysis(),i=await A.getPLSummary("year");t.sections.plAnalysis={title:"P&L Analysis",description:"Monthly profit and loss trends",data:a.success?a.data:[],summary:Ke(a.success?a.data:[],i.success?i.data:null),chartData:a.success?a.data:[]}}if(e.regionalContribution&&(t.sections.regionalContribution={title:"Regional Performance",description:"Revenue and EBITDA by region",data:I,summary:Te(I)}),e.stockLevels)try{const a=await ve.getStockLevels();t.sections.stockLevels={title:"Current Stock Levels",description:"Inventory status and stock levels",data:a.success?a.data:[],summary:Le(a.data)}}catch(a){console.error("Error fetching stock levels:",a),t.sections.stockLevels={title:"Current Stock Levels",description:"Inventory status and stock levels",data:[],summary:{status:"Data unavailable",message:"Stock levels could not be retrieved"}}}if(e.productSales){const a=await be.getProductSalesData();t.sections.productSales={title:"Product Sales Performance",description:"Revenue by product line",data:a.success?a.data:[],summary:Ie(a.data)}}t.executiveSummary=_e(t.sections,s)}catch(a){throw console.error("Error generating report:",a),new Error(`Failed to generate report: ${a.message}`)}return t},Ae=e=>{const s=e.find(a=>a.label.includes("working capital")),t=e.find(a=>a.label.includes("Cash coverage"));return{workingCapital:(s==null?void 0:s.value)||"N/A",cashCoverage:(t==null?void 0:t.value)||"N/A",status:"Strong liquidity position maintained",keyInsight:"Global working capital remains healthy with adequate cash coverage"}},Ee=e=>{var s,t,a;return e?{revenue:((s=e.annualRevenue)==null?void 0:s.value)||"N/A",units:((t=e.unitsSold)==null?void 0:t.value)||"N/A",margin:((a=e.grossMargin)==null?void 0:a.value)||"N/A",status:"Performance targets on track",keyInsight:"Strong revenue growth with healthy margin maintenance"}:{status:"Data unavailable"}},Te=e=>{const s=e.reduce((o,n)=>o+n.revenue,0),t=e.reduce((o,n)=>o+n.ebitda,0),a=t/s*100,i=e.reduce((o,n)=>o.revenue>n.revenue?o:n);return{totalRevenue:`$${(s/1e6).toFixed(1)}M`,totalEbitda:`$${(t/1e6).toFixed(1)}M`,avgEbitdaMargin:`${a.toFixed(1)}%`,topRegion:i.region,status:"Balanced regional performance",keyInsight:`${i.region} leads revenue generation with strong EBITDA margins`}},Le=e=>{if(!e||!Array.isArray(e))return{status:"Data unavailable",message:"Stock level data not accessible"};const s=e.filter(a=>a.status==="Low"||a.level<20),t=e.filter(a=>a.status==="Optimal"||a.level>=20&&a.level<=80);return{totalItems:e.length,lowStockCount:s.length,optimalStockCount:t.length,status:s.length>0?"Attention required":"Stock levels healthy",keyInsight:s.length>0?`${s.length} items require restocking attention`:"All inventory levels within optimal ranges"}},Ie=e=>{if(!e||!Array.isArray(e))return{status:"Data unavailable",message:"Product sales data not accessible"};const s=e.reduce((a,i)=>a+(i.sales||i.revenue||0),0),t=e.reduce((a,i)=>(a.sales||a.revenue||0)>(i.sales||i.revenue||0)?a:i);return{totalSales:`$${(s/1e6).toFixed(1)}M`,topProduct:t.name||t.product||"N/A",productCount:e.length,status:"Product performance tracked",keyInsight:`${t.name||t.product} leads product sales performance`}},_e=(e,s)=>{const t=[];let a="Operational";return e.capitalKpis&&t.push("Strong capital position maintained with healthy working capital levels"),e.performanceKpis&&t.push("Key performance indicators showing positive trends across revenue and margin metrics"),e.plAnalysis&&t.push("P&L analysis reveals consistent profitability trends with seasonal variations"),e.regionalContribution&&t.push("Regional performance balanced across all markets with EU leading revenue contribution"),e.stockLevels&&t.push("Inventory management requires attention for optimal stock level maintenance"),e.productSales&&t.push("Product sales performance tracking enables informed strategic decisions"),{status:a,reportPeriod:y(s.from,"MMMM yyyy"),keyInsights:t,recommendation:"Continue monitoring key metrics while focusing on inventory optimization and regional growth opportunities",dataQuality:"High - All critical systems operational and providing real-time data"}},Ke=(e,s)=>{if(!e||!Array.isArray(e)||e.length===0)return{status:"Data unavailable",message:"P&L analysis data not accessible"};const t=e.reduce((l,d)=>l+(d.revenue||0),0),a=e.reduce((l,d)=>l+(d.grossProfit||0),0),i=e.reduce((l,d)=>l+(d.ebitda||0),0),o=t>0?(a/t*100).toFixed(1):"0",n=t>0?(i/t*100).toFixed(1):"0",c=e.reduce((l,d)=>(l.revenue||0)>(d.revenue||0)?l:d);return{totalRevenue:`$${(t/1e3).toFixed(0)}K`,totalGrossProfit:`$${(a/1e3).toFixed(0)}K`,totalEbitda:`$${(i/1e3).toFixed(0)}K`,avgGrossMargin:`${o}%`,avgEbitdaMargin:`${n}%`,bestMonth:c.month||"N/A",status:"P&L trends analyzed",keyInsight:`${c.month} showed strongest performance with $${c.revenue}K revenue`}},Ge=async e=>{try{const s=new U("p","mm","a4"),t=s.internal.pageSize.getWidth(),a=s.internal.pageSize.getHeight(),i=20,o=t-i*2;let n=i;F(s,t,i),n+=30,s.setFontSize(24),s.setFont(void 0,"bold"),s.text("Manufacturing Dashboard Report",i,n),n+=15,s.setFontSize(12),s.setFont(void 0,"normal"),s.setTextColor(100,100,100),s.text(`Generated: ${y(new Date,"MMMM d, yyyy 'at' h:mm a")}`,i,n),n+=8,s.text(`Report Period: ${e.metadata.reportPeriod.formatted}`,i,n),n+=20,e.executiveSummary&&(n=He(s,e.executiveSummary,i,n,o,a));for(const[,d]of Object.entries(e.sections))n+80>a-40&&(s.addPage(),F(s,t,i),n=i+30),n=Oe(s,d,i,n,o,a),n+=15;Ve(s,t,a,i);const l=`Sentia_Manufacturing_Report_${y(new Date,"yyyy-MM-dd_HH-mm")}.pdf`;return s.save(l),{success:!0,filename:l}}catch(s){throw console.error("Error generating PDF:",s),new Error(`Failed to generate PDF: ${s.message}`)}},F=(e,s,t)=>{e.setFillColor(59,130,246),e.roundedRect(t,t,30,15,2,2,"F"),e.setFontSize(14),e.setFont(void 0,"bold"),e.setTextColor(255,255,255),e.text("S",t+12,t+10),e.setFontSize(16),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text("Sentia Manufacturing",t+35,t+8),e.setFontSize(12),e.setFont(void 0,"normal"),e.setTextColor(100,100,100),e.text("Enterprise Manufacturing Intelligence",t+35,t+16),e.setDrawColor(200,200,200),e.line(t,t+25,s-t,t+25)},He=(e,s,t,a,i,o)=>{let n=a;return e.setFontSize(18),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text("Executive Summary",t,n),n+=12,e.setFontSize(12),e.setFont(void 0,"bold"),e.text("Status:",t,n),e.setFont(void 0,"normal"),e.text(s.status,t+20,n),n+=10,e.setFont(void 0,"bold"),e.text("Period:",t,n),e.setFont(void 0,"normal"),e.text(s.reportPeriod,t+20,n),n+=15,s.keyInsights&&s.keyInsights.length>0&&(e.setFont(void 0,"bold"),e.text("Key Insights:",t,n),n+=8,e.setFont(void 0,"normal"),s.keyInsights.forEach(c=>{e.splitTextToSize(`• ${c}`,i-10).forEach(d=>{n>o-30&&(e.addPage(),F(e,e.internal.pageSize.getWidth(),t),n=t+40),e.text(d,t+5,n),n+=6}),n+=2})),s.recommendation&&(n+=5,e.setFont(void 0,"bold"),e.text("Recommendation:",t,n),n+=8,e.setFont(void 0,"normal"),e.splitTextToSize(s.recommendation,i).forEach(l=>{n>o-30&&(e.addPage(),F(e,e.internal.pageSize.getWidth(),t),n=t+40),e.text(l,t,n),n+=6})),n+20},Oe=(e,s,t,a,i,o)=>{let n=a;return e.setFontSize(16),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text(s.title,t,n),n+=10,s.description&&(e.setFontSize(11),e.setFont(void 0,"normal"),e.setTextColor(100,100,100),e.splitTextToSize(s.description,i).forEach(l=>{e.text(l,t,n),n+=6}),n+=10),s.data&&Array.isArray(s.data)&&(n>o-120&&(e.addPage(),F(e,e.internal.pageSize.getWidth(),t),n=t+30,e.setFontSize(16),e.setFont(void 0,"bold"),e.setTextColor(0,0,0),e.text(s.title,t,n),n+=15),s.title==="Capital Position"||s.title==="Performance Metrics"?n=De(e,s.data,t,n,i):s.title==="Regional Performance"?n=Be(e,s.data,t,n,i):s.title==="P&L Analysis"?n=Ue(e,s.data,t,n,i):s.title==="Product Sales Performance"?n=Ye(e,s.data,t,n,i):n=qe(e,s.data,t,n,i)),s.summary&&typeof s.summary=="object"&&(n>o-60&&(e.addPage(),F(e,e.internal.pageSize.getWidth(),t),n=t+30),n+=10,n=Je(e,s.summary,t,n,i)),n},De=(e,s,t,a,i)=>{let o=a;const n=12,c=15,l=i*.4,d=i*.25,g=i*.35;return e.setFillColor(245,245,245),e.rect(t,o,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Metric",t+5,o+10),e.text("Value",t+l+5,o+10),e.text("Description",t+l+d+5,o+10),o+=c,e.setFont(void 0,"normal"),s.forEach((h,p)=>{const S=e.splitTextToSize(h.label,l-10),f=e.splitTextToSize(h.helper||"",g-10),m=Math.max(n,Math.max(S.length,f.length)*6+6),v=e.internal.pageSize.getHeight();o+m>v-30&&(e.addPage(),F(e,e.internal.pageSize.getWidth(),t),o=t+30,e.setFillColor(245,245,245),e.rect(t,o,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Metric",t+5,o+10),e.text("Value",t+l+5,o+10),e.text("Description",t+l+d+5,o+10),o+=c,e.setFont(void 0,"normal")),p%2===0&&(e.setFillColor(250,250,250),e.rect(t,o,i,m,"F")),e.text(S,t+5,o+8),e.setFont(void 0,"bold"),e.text(h.value,t+l+5,o+8),e.setFont(void 0,"normal"),e.text(f,t+l+d+5,o+8),o+=m}),o},Be=(e,s,t,a,i)=>{let o=a;const n=12,c=15,l=i*.33,d=i*.33;return e.setFillColor(245,245,245),e.rect(t,o,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Region",t+5,o+10),e.text("Revenue",t+l+5,o+10),e.text("EBITDA",t+l+d+5,o+10),o+=c,e.setFont(void 0,"normal"),s.forEach((g,h)=>{h%2===0&&(e.setFillColor(250,250,250),e.rect(t,o,i,n,"F")),e.text(g.region,t+5,o+8),e.text(`$${(g.revenue/1e6).toFixed(1)}M`,t+l+5,o+8),e.text(`$${(g.ebitda/1e6).toFixed(1)}M`,t+l+d+5,o+8),o+=n}),o},Ue=(e,s,t,a,i)=>{let o=a;const n=10,c=12,l=i*.25,d=i*.25,g=i*.25,h=s.slice(-6);return e.setFillColor(245,245,245),e.rect(t,o,i,c,"F"),e.setFontSize(10),e.setFont(void 0,"bold"),e.text("Month",t+5,o+8),e.text("Revenue",t+l+5,o+8),e.text("Gross Profit",t+l+d+5,o+8),e.text("EBITDA",t+l+d+g+5,o+8),o+=c,e.setFont(void 0,"normal"),h.forEach((p,S)=>{S%2===0&&(e.setFillColor(250,250,250),e.rect(t,o,i,n,"F")),e.text(p.month,t+5,o+7),e.text(`$${p.revenue}K`,t+l+5,o+7),e.text(`$${p.grossProfit}K`,t+l+d+5,o+7),e.text(`$${p.ebitda}K`,t+l+d+g+5,o+7),o+=n}),o},Ye=(e,s,t,a,i)=>{let o=a;const n=12,c=15,l=i*.25,d=i*.25,g=i*.25;return e.setFillColor(245,245,245),e.rect(t,o,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Product",t+5,o+10),e.text("Revenue",t+l+5,o+10),e.text("Units Sold",t+l+d+5,o+10),e.text("Growth Rate",t+l+d+g+5,o+10),o+=c,e.setFont(void 0,"normal"),s.forEach((h,p)=>{const S=e.internal.pageSize.getHeight();o+n>S-30&&(e.addPage(),F(e,e.internal.pageSize.getWidth(),t),o=t+30,e.setFillColor(245,245,245),e.rect(t,o,i,c,"F"),e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Product",t+5,o+10),e.text("Revenue",t+l+5,o+10),e.text("Units Sold",t+l+d+5,o+10),e.text("Growth Rate",t+l+d+g+5,o+10),o+=c,e.setFont(void 0,"normal")),p%2===0&&(e.setFillColor(250,250,250),e.rect(t,o,i,n,"F"));let f,m,v,u;if(typeof h=="string")try{const k=JSON.parse(h);f=k.product||"N/A",m=k.revenue||0,v=k.units||0,u=k.growthRate||0}catch{f="Invalid Data",m=0,v=0,u=0}else typeof h=="object"?(f=h.product||h.name||"N/A",m=h.revenue||h.sales||0,v=h.units||h.unitsSold||0,u=h.growthRate||h.growth||0):(f=String(h),m=0,v=0,u=0);const b=m>=1e6?`$${(m/1e6).toFixed(1)}M`:`$${Math.round(m/1e3)}K`,w=v>=1e3?`${Math.round(v/1e3)}K`:`${v}`,_=`${Number(u).toFixed(1)}%`;e.text(f,t+5,o+8),e.text(b,t+l+5,o+8),e.text(w,t+l+d+5,o+8),e.text(_,t+l+d+g+5,o+8),o+=n}),o},qe=(e,s,t,a,i)=>{let o=a;return e.setFontSize(11),e.setFont(void 0,"normal"),s.forEach(n=>{const c=typeof n=="object"?JSON.stringify(n):String(n);e.splitTextToSize(`• ${c}`,i).forEach(d=>{e.text(d,t+5,o),o+=6}),o+=2}),o},Je=(e,s,t,a,i)=>{if(!s||typeof s!="object")return a;let o=a,n=0;e.setFontSize(10);let c=[];if(s.status&&c.push(`Status: ${s.status}`),s.keyInsight){const l=e.splitTextToSize(s.keyInsight,i-10);c=c.concat(l)}return s.totalRevenue&&c.push(`Total Revenue: ${s.totalRevenue}`),s.avgGrossMargin&&c.push(`Average Gross Margin: ${s.avgGrossMargin}`),s.bestMonth&&c.push(`Best performing month: ${s.bestMonth}`),s.topRegion&&c.push(`Top performing region: ${s.topRegion}`),c.length===0?a:(n=c.length*5+15,e.setFillColor(249,250,251),e.setDrawColor(200,200,200),e.roundedRect(t,o,i,n,2,2,"FD"),o+=8,e.setFontSize(10),e.setFont(void 0,"bold"),e.text("Summary:",t+5,o),o+=6,e.setFont(void 0,"normal"),c.forEach(l=>{e.text(l,t+5,o),o+=5}),a+n+5)},Ve=(e,s,t,a)=>{const i=t-15;e.setDrawColor(200,200,200),e.line(a,i-5,s-a,i-5),e.setFontSize(9),e.setTextColor(100,100,100),e.text("Sentia Manufacturing Dashboard Report",a,i);const o=e.internal.getCurrentPageInfo().pageNumber;e.text(`Page ${o}`,s-a-20,i),e.text(`Generated: ${y(new Date,"yyyy-MM-dd HH:mm")}`,s-a-70,i+5)},Qe=({open:e,onClose:s})=>{const t=Y(new Date),[a,i]=C.useState({from:J(t),to:q(t)}),[o,n]=C.useState(!1),[c,l]=C.useState(!1),[d,g]=C.useState({capitalKpis:!0,performanceKpis:!0,plAnalysis:!0,regionalContribution:!0,stockLevels:!1,productSales:!1}),h=[{id:"capitalKpis",label:"Capital Position",description:"Working capital, cash coverage, intercompany exposure",recommended:!0},{id:"performanceKpis",label:"Performance Metrics",description:"Revenue, units sold, gross margin",recommended:!0},{id:"plAnalysis",label:"P&L Analysis",description:"Monthly profit and loss trends chart",recommended:!0},{id:"regionalContribution",label:"Regional Performance",description:"Revenue and EBITDA by region",recommended:!0},{id:"stockLevels",label:"Stock Levels",description:"Current inventory status and levels",recommended:!1},{id:"productSales",label:"Product Sales",description:"Sales performance by product line",recommended:!1}],p=(u,b)=>{g(w=>({...w,[u]:b}))},S=(u=!1)=>{if(u){const b={};h.forEach(w=>{b[w.id]=w.recommended}),g(b)}else{const b={};h.forEach(w=>{b[w.id]=!0}),g(b)}},f=()=>{const u={};h.forEach(b=>{u[b.id]=!1}),g(u)},m=Object.values(d).filter(Boolean).length,v=async()=>{if(m===0){$.error("Please select at least one section for your report");return}l(!0);try{const u=await $e(d,a);await Ge(u,a),$.success("Report generated successfully!"),s()}catch(u){console.error("Error generating report:",u),$.error("Failed to generate report. Please try again.")}finally{l(!1)}};return r.jsx(ye,{open:e,onOpenChange:s,children:r.jsxs(Se,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 shadow-xl",children:[r.jsxs(we,{children:[r.jsxs(je,{className:"flex items-center gap-2",children:[r.jsx(E,{className:"h-5 w-5"}),"Generate Manufacturing Report"]}),r.jsx(Fe,{children:"Create a customized report with your selected dashboard data and date range"})]}),r.jsxs("div",{className:"grid gap-6 py-4",children:[r.jsxs(M,{children:[r.jsxs(P,{children:[r.jsxs(N,{className:"flex items-center gap-2 text-lg",children:[r.jsx(V,{className:"h-4 w-4"}),"Report Period"]}),r.jsx(z,{children:"Select the date range for your report (defaults to last month)"})]}),r.jsx(R,{children:r.jsxs(Ne,{open:o,onOpenChange:n,children:[r.jsx(ze,{asChild:!0,children:r.jsxs(j,{variant:"outline",className:x("w-full justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[r.jsx(Q,{className:"mr-2 h-4 w-4"}),a!=null&&a.from?a.to?r.jsxs(r.Fragment,{children:[y(a.from,"LLL dd, y")," -"," ",y(a.to,"LLL dd, y")]}):y(a.from,"LLL dd, y"):r.jsx("span",{children:"Pick a date range"})]})}),r.jsx(Re,{className:"w-auto p-0",align:"start",children:r.jsx(Pe,{initialFocus:!0,mode:"range",defaultMonth:a==null?void 0:a.from,selected:a,onSelect:i,numberOfMonths:2})})]})})]}),r.jsxs(M,{children:[r.jsxs(P,{children:[r.jsxs(N,{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(X,{className:"h-4 w-4"}),"Report Sections (",m," selected)"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(j,{variant:"outline",size:"sm",onClick:()=>S(!0),children:"Recommended"}),r.jsx(j,{variant:"outline",size:"sm",onClick:()=>S(!1),children:"Select All"}),r.jsx(j,{variant:"outline",size:"sm",onClick:f,children:"Clear All"})]})]}),r.jsx(z,{children:"Choose which sections to include in your report"})]}),r.jsx(R,{children:r.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:h.map(u=>r.jsx("div",{className:x("rounded-lg border p-4 transition-colors",d[u.id]?"border-blue-200 bg-blue-50":"border-gray-200 hover:border-gray-300",u.recommended&&"ring-1 ring-orange-200"),children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx(ke,{id:u.id,checked:d[u.id],onCheckedChange:b=>p(u.id,b),className:"mt-1"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs(Ce,{htmlFor:u.id,className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[u.label,u.recommended&&r.jsx("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full",children:"Recommended"})]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:u.description})]})]})},u.id))})})]}),m>0&&r.jsxs(M,{children:[r.jsxs(P,{children:[r.jsx(N,{className:"text-lg",children:"Report Preview"}),r.jsx(z,{children:"Your report will include the following sections"})]}),r.jsx(R,{children:r.jsxs("div",{className:"text-sm space-y-2",children:[r.jsxs("p",{className:"font-medium",children:["Report Period: ",(a==null?void 0:a.from)&&y(a.from,"MMMM d, yyyy")," - ",(a==null?void 0:a.to)&&y(a.to,"MMMM d, yyyy")]}),r.jsx("p",{className:"font-medium",children:"Included Sections:"}),r.jsx("ul",{className:"list-disc list-inside space-y-1 ml-4",children:h.filter(u=>d[u.id]).map(u=>r.jsxs("li",{className:"text-muted-foreground",children:[u.label," - ",u.description]},u.id))})]})})]})]}),r.jsx(Me,{}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(j,{variant:"outline",onClick:s,children:"Cancel"}),r.jsx(j,{onClick:v,disabled:m===0||c,className:"bg-blue-600 hover:bg-blue-700",children:c?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx(E,{className:"w-4 h-4 mr-2"}),"Generate PDF Report"]})})]})]})})},ot=()=>{const[e,s]=C.useState(!1),t=()=>{s(!0)};return r.jsxs(r.Fragment,{children:[r.jsxs(M,{className:"mt-8",children:[r.jsxs(P,{children:[r.jsxs(N,{className:"flex items-center gap-2",children:[r.jsx(Z,{className:"h-5 w-5"}),"Quick Actions"]}),r.jsx(z,{children:"Generate reports and perform common dashboard operations"})]}),r.jsxs(R,{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[r.jsxs(j,{onClick:t,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white min-w-[160px]",size:"lg",children:[r.jsx(W,{className:"h-4 w-4"}),"Generate Reports"]}),r.jsxs(j,{variant:"outline",className:"flex items-center gap-2 min-w-[160px]",size:"lg",disabled:!0,children:[r.jsx(ee,{className:"h-4 w-4"}),"Export Data"]})]}),r.jsx("p",{className:"text-sm text-muted-foreground mt-4 text-center",children:"Create customizable reports with your dashboard data and export as PDF"})]})]}),r.jsx(Qe,{open:e,onClose:()=>s(!1)})]})};export{ot as default};
