import{r as e,as as s,bo as a,j as t,$ as l,bb as r,bw as i,W as n,ah as d,bx as c,b6 as o,t as m,ar as x,by as h}from"./chunk-CXAPUP0Z.js";import"./index-DlLdO_QQ.js";import{D as g}from"./chunk-E_h9yjlz.js";import"./chunk-CwR8AQSU.js";import"./chunk--CRELh3m.js";import"./chunk-VeJKilaK.js";import"./chunk-DELSdgG9.js";import"./chunk-l5C0fGLm.js";import"./chunk-Kk1dlRB6.js";import"./chunk-DJCy_cXY.js";import"./chunk-Dozjk7Op.js";const u=()=>{const[x,h]=e.useState("30"),[u,f]=e.useState(["all"]),[w,k]=e.useState("demand"),[D]=e.useState(()=>new g),{data:A,refetch:P}=s({queryKey:["demand-forecast",x,u,w],queryFn:async()=>{try{const e=await fetch(`/api/forecasting/demand?period=${x}&products=${u.join(",")}&type=${w}`,{headers:{Authorization:`Bearer ${session?.accessToken||""}`}});if(e.ok)return e.json()}catch(s){}const e=parseInt(x);throw D.generateDateRange(new Date,e,!0).forEach((e,s)=>{throw D.seasonalPatterns.getBusinessSeasonality(e.month,e.quarter),new Error("Real API connection required - Demand forecasting must use actual historical sales data and ML models")}),new Error("Real API connection required - Demand forecasting must integrate with actual ERP/CRM systems and historical sales data")},refetchInterval:6e4}),S=a({mutationFn:async()=>(await fetch("/api/forecasting/run-model",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await(user?.getToken())}`},body:JSON.stringify({modelType:"demand_forecast",parameters:{horizon:parseInt(x),products:u,seasonality:!0,confidence:.95}})})).json(),onSuccess:()=>{P()}}),C=A||{};return t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Demand Forecasting"}),t.jsx("p",{className:"mt-2 text-gray-600",children:"AI-powered demand predictions and market analysis"})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("button",{onClick:()=>S.mutate(),disabled:S.isLoading,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[S.isLoading?t.jsx(l,{className:"w-4 h-4 mr-2 animate-spin"}):t.jsx(r,{className:"w-4 h-4 mr-2"}),"Generate Forecast"]}),t.jsxs("button",{className:"flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:[t.jsx(i,{className:"w-4 h-4 mr-2"}),"Export Data"]})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forecast Period (Days)"}),t.jsxs("select",{value:x,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"7",children:"7 Days"}),t.jsx("option",{value:"14",children:"14 Days"}),t.jsx("option",{value:"30",children:"30 Days"}),t.jsx("option",{value:"60",children:"60 Days"}),t.jsx("option",{value:"90",children:"90 Days"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Products"}),t.jsx("select",{value:u[0],onChange:e=>f([e.target.value]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[{id:"all",name:"All Products"},{id:"gaba-red-500",name:"GABA Red 500ml"},{id:"gaba-clear-500",name:"GABA Clear 500ml"},{id:"gaba-red-250",name:"GABA Red 250ml"},{id:"gaba-clear-250",name:"GABA Clear 250ml"}].map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Analysis Type"}),t.jsxs("select",{value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"demand",children:"Demand Forecast"}),t.jsx("option",{value:"seasonal",children:"Seasonal Analysis"}),t.jsx("option",{value:"trend",children:"Trend Analysis"}),t.jsx("option",{value:"scenario",children:"Scenario Planning"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Status"}),t.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[t.jsx(n,{className:"w-5 h-5 text-green-500"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Model Ready"})]})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[t.jsx(j,{title:"Predicted Demand",value:C.totalDemand?.toLocaleString()||"0",change:"+12.5%",trend:"up",icon:t.jsx(d,{className:"w-6 h-6"})}),t.jsx(j,{title:"Confidence Level",value:`${C.confidence||87}%`,change:"+2.1%",trend:"up",icon:t.jsx(c,{className:"w-6 h-6"})}),t.jsx(j,{title:"Peak Demand Day",value:C.peakDay||"Day 15",change:"Fri",trend:"stable",icon:t.jsx(o,{className:"w-6 h-6"})}),t.jsx(j,{title:"Model Accuracy",value:`${C.accuracy||89}%`,change:"+1.3%",trend:"up",icon:t.jsx(m,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[t.jsx(p,{data:C.forecastData}),t.jsx(b,{data:C.productBreakdown})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx(y,{patterns:C.seasonalPatterns}),t.jsx(v,{risks:C.riskFactors}),t.jsx(N,{insights:C.insights})]})]})})},j=({title:e,value:s,change:a,trend:l,icon:r})=>{const i="up"===l||"down"===l?d:o,n="up"===l?"text-green-500":"down"===l?"text-red-500":"text-gray-500";return t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),t.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600",children:r})]}),t.jsx("div",{className:"flex items-end justify-between",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s}),t.jsxs("div",{className:"flex items-center mt-1",children:[t.jsx(i,{className:`w-4 h-4 ${n}`}),t.jsx("span",{className:`text-sm ml-1 ${n}`,children:a}),t.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"vs last period"})]})]})})]})},p=({data:e})=>{const s={labels:e?.map(e=>e.date)||[],datasets:[{label:"Predicted Demand",data:e?.map(e=>e.predicted)||[],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Historical Demand",data:e?.map(e=>e.historical)||[],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!1,tension:.4}]};return t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Demand Forecast"}),t.jsx("div",{className:"h-64",children:t.jsx(x,{data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Demand Forecast vs Historical Data"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Units"}}}}})})]})},b=({data:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Product Breakdown"}),t.jsx("div",{className:"space-y-4",children:(e.productBreakdown||[]).map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-3 h-3 rounded-full "+(0===s?"bg-blue-500":1===s?"bg-green-500":2===s?"bg-yellow-500":"bg-purple-500")}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.name}),t.jsx("div",{className:"text-sm text-gray-500",children:e.category})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.forecast.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-500",children:"units"})]})]},s))})]}),y=({patterns:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Seasonal Patterns"}),t.jsx("div",{className:"space-y-3",children:(e||[]).map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-600",children:e.period}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.intensity}%`}})}),t.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e.intensity,"%"]})]})]},s))})]}),v=({risks:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Risk Factors"}),t.jsx("div",{className:"space-y-3",children:(e||[]).map((e,s)=>t.jsxs("div",{className:"p-3 rounded-lg border-l-4 "+("high"===e.level?"border-red-400 bg-red-50":"medium"===e.level?"border-yellow-400 bg-yellow-50":"border-blue-400 bg-blue-50"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"font-medium text-gray-900",children:e.factor}),t.jsx(h,{className:"w-4 h-4 "+("high"===e.level?"text-red-600":"medium"===e.level?"text-yellow-600":"text-blue-600")})]}),t.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},s))})]}),N=({insights:e})=>t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Actionable Insights"}),t.jsx("div",{className:"space-y-4",children:(e||[]).map((e,s)=>t.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),t.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:e.priority})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),t.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Expected Impact: ",e.impact]})]},s))})]});export{u as default};
