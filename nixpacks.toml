# Nixpacks configuration for Express.js app
providers = ["node"]

[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
# Clear any existing cache issues before install
cmds = ["rm -rf node_modules/.cache", "npm ci --legacy-peer-deps"]

[phases.build]
# Build React frontend
cmds = ["npm run build || echo 'Build failed but continuing for debugging'"]

[start]
# Start Express server with debugging
cmd = "echo 'Starting Express server...' && ls -la && node server.js"

[staticAssets]
# IMPORTANT: This disables Caddy static file server
# We're running an Express.js server, not a static site
enabled = false