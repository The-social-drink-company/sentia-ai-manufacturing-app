import{r as e,j as r,q as t,a8 as s,aA as a,ax as l,t as d,a9 as i,a$ as n,aa as c,b0 as x,F as o}from"./chunk-gD0WZlZe.js";import{E as m}from"./chunk-DnsBdAPo.js";import"./chunk-tZo8O77D.js";import"./chunk-BY8qDDXp.js";import"./chunk-CGOCBQ1v.js";import"./chunk-D_LFaUfL.js";import"./chunk-DuMuM8ZY.js";import"./chunk-B0LCvgW6.js";import"./chunk-BXzNuMxH.js";import"./chunk-Dozjk7Op.js";const g=()=>{const[g,h]=e.useState(null),[b,y]=e.useState(!0),[p,u]=e.useState(null),[j,N]=e.useState(12),[k,f]=e.useState(!1),[w]=e.useState(()=>new m),v=e.useCallback(async()=>{try{f(!0),u(null);const e=await w.calculateWorkingCapitalRequirements({period:j,currency:"GBP",includeForecasts:!0});h(e)}catch(e){u(e.message)}finally{y(!1),f(!1)}},[j,w]);e.useEffect(()=>{v()},[v]),e.useEffect(()=>{const e=setInterval(()=>{b||k||v()},3e5);return()=>clearInterval(e)},[b,k]);const C=(e,r=0)=>"undefined"!=typeof Intl&&Intl.NumberFormat?new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:r,maximumFractionDigits:r}).format(e):`£${e.toLocaleString()}`,A=(e,r=1)=>"undefined"!=typeof Intl&&Intl.NumberFormat?new Intl.NumberFormat("en-GB",{minimumFractionDigits:r,maximumFractionDigits:r}).format(e):e.toFixed(r),I=e=>{switch(e){case"low":return"text-green-600 bg-green-50 border-green-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"high":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:r.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center",children:[r.jsx(t,{className:"w-8 h-8 text-blue-600 mr-3"}),"True Working Capital Requirements"]}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Real-time analysis using live financial data - No mock data, only actual API calculations"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("select",{value:j,onChange:e=>N(parseInt(e.target.value)),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[r.jsx("option",{value:3,children:"3 Months"}),r.jsx("option",{value:6,children:"6 Months"}),r.jsx("option",{value:12,children:"12 Months"}),r.jsx("option",{value:24,children:"24 Months"})]}),r.jsxs("button",{onClick:v,disabled:b||k,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[r.jsx(s,{className:"w-4 h-4 mr-2 "+(k?"animate-spin":"")}),k?"Updating...":"Refresh Data"]})]})]}),g&&r.jsxs("div",{className:"flex items-center mt-4 text-sm text-gray-500 dark:text-gray-400",children:[r.jsx(a,{className:"w-4 h-4 mr-1"}),"Last updated: ",new Date(g.calculationDate).toLocaleString(),r.jsx("span",{className:"mx-2",children:"•"}),"Currency: ",g.currency,r.jsx("span",{className:"mx-2",children:"•"}),"Period: ",g.period," months"]})]}),p&&r.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(l,{className:"w-6 h-6 text-red-600 mr-3"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-100",children:"Working Capital Calculation Error"}),r.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1",children:p}),r.jsx("button",{onClick:v,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try Again"})]})]})}),b&&r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Calculating Working Capital Requirements"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Fetching real financial data from APIs and performing calculations..."})]})}),g&&!b&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Working Capital"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:C(g.workingCapital.total)}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:[A(g.workingCapital.percentage,1),"% of revenue"]})]}),r.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg",children:r.jsx(t,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:r.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Per Employee: ",C(g.workingCapital.perEmployee)]})})]}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Current Ratio"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:A(g.ratios.current,2)}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["Target: ≥",g.benchmarks.currentRatio.target]})]}),r.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:(()=>{const e=((e,r,t=!1)=>{const s=e/r;return t?s<=.8?{color:"green",icon:c,status:"excellent"}:s<=1?{color:"yellow",icon:x,status:"good"}:{color:"red",icon:o,status:"poor"}:s>=1.2?{color:"green",icon:c,status:"excellent"}:s>=.9?{color:"yellow",icon:x,status:"good"}:{color:"red",icon:o,status:"poor"}})(g.ratios.current,g.benchmarks.currentRatio.target),t=e.icon;return r.jsx(t,{className:`w-6 h-6 text-${e.color}-600 dark:text-${e.color}-400`})})()})]})}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Cash Conversion Cycle"}),r.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:[A(g.cashConversionCycle.total,1)," days"]}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["Target: ≤",g.benchmarks.cashConversionCycle.target," days"]})]}),r.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900 rounded-lg",children:r.jsx(a,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})})]})}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Performance Score"}),r.jsxs("p",{className:"text-2xl font-bold mt-2 "+(F=g.performanceScore,F>=80?"text-green-600":F>=60?"text-yellow-600":"text-red-600"),children:[g.performanceScore,"%"]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:"Overall efficiency"})]}),r.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-lg",children:r.jsx(d,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Current Assets"}),r.jsxs("div",{className:"space-y-4",children:[Object.entries(g.currentAssets).map(([e,t])=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:r.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize",children:e.replace(/([A-Z])/g," $1").trim()})}),r.jsx("div",{className:"text-right",children:r.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:C(t)})})]},e)),r.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-600",children:r.jsxs("div",{className:"flex items-center justify-between font-semibold",children:[r.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total Current Assets"}),r.jsx("span",{className:"text-gray-900 dark:text-white",children:C(Object.values(g.currentAssets).reduce((e,r)=>e+r,0))})]})})]})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Current Liabilities"}),r.jsxs("div",{className:"space-y-4",children:[Object.entries(g.currentLiabilities).map(([e,t])=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:r.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize",children:e.replace(/([A-Z])/g," $1").trim()})}),r.jsx("div",{className:"text-right",children:r.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:C(t)})})]},e)),r.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-600",children:r.jsxs("div",{className:"flex items-center justify-between font-semibold",children:[r.jsx("span",{className:"text-gray-900 dark:text-white",children:"Total Current Liabilities"}),r.jsx("span",{className:"text-gray-900 dark:text-white",children:C(Object.values(g.currentLiabilities).reduce((e,r)=>e+r,0))})]})})]})]})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Working Capital Requirements by Category"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(g.requirements).filter(([e])=>!["employeeCount","facilityCount"].includes(e)).map(([e,t])=>r.jsxs("div",{className:"p-4 rounded-lg border-2 "+("critical"===t.priority?"border-red-200 bg-red-50 dark:bg-red-900/20":"high"===t.priority?"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20":"border-blue-200 bg-blue-50 dark:bg-blue-900/20"),children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white capitalize",children:e}),r.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium "+("critical"===t.priority?"bg-red-100 text-red-800":"high"===t.priority?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),children:t.priority})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:t.description}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-500",children:"Amount:"}),r.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:C(t.amount)})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-500",children:"Days of Sales:"}),r.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:A(t.daysOfSales,1)})]})]})]},e))})]}),g.riskAssessment&&r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Risk Assessment"}),r.jsx("div",{className:`px-4 py-2 rounded-lg border ${I(g.riskAssessment.overall)}`,children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(i,{className:"w-4 h-4 mr-2"}),r.jsxs("span",{className:"font-semibold capitalize",children:[g.riskAssessment.overall," Risk"]})]})})]}),g.riskAssessment.risks.length>0&&r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.riskAssessment.risks.map((e,t)=>r.jsxs("div",{className:`p-4 rounded-lg border ${I(e.level)}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h4",{className:"font-semibold",children:e.category}),r.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-medium capitalize",children:e.level})]}),r.jsx("p",{className:"text-sm mb-2",children:e.description}),r.jsxs("p",{className:"text-xs font-medium",children:["Impact: ",e.impact]})]},t))})]}),g.recommendations&&g.recommendations.length>0&&r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Optimization Recommendations"}),r.jsx("div",{className:"space-y-4",children:g.recommendations.map((e,t)=>r.jsxs("div",{className:"p-4 rounded-lg border-l-4 "+("high"===e.priority?"border-red-500 bg-red-50 dark:bg-red-900/20":"medium"===e.priority?"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"border-blue-500 bg-blue-50 dark:bg-blue-900/20"),children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.category}),r.jsxs("span",{className:"ml-2 text-xs px-2 py-1 rounded-full font-medium "+("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),children:[e.priority," priority"]})]}),e.potentialImpact&&r.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 font-medium",children:["Impact: ",e.potentialImpact]})]}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:[r.jsx("strong",{children:"Issue:"})," ",e.issue]}),r.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-200",children:[r.jsx("strong",{children:"Recommendation:"})," ",e.recommendation]}),e.targetValue&&e.currentValue&&r.jsxs("div",{className:"flex items-center mt-2 text-xs text-gray-500 dark:text-gray-400",children:[r.jsxs("span",{children:["Current: ",A(e.currentValue,1)]}),r.jsx("span",{className:"mx-2",children:"→"}),r.jsxs("span",{children:["Target: ",A(e.targetValue,1)]})]})]},t))})]}),g.forecasts&&r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"12-Month Working Capital Forecast"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(n,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Based on real growth trends"})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[r.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Month"}),r.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Working Capital"}),r.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"A/R"}),r.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Inventory"}),r.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"A/P"}),r.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-white",children:"Cash Flow"})]})}),r.jsx("tbody",{children:g.forecasts.slice(0,12).map((e,t)=>r.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[r.jsx("td",{className:"py-3 px-4 text-sm text-gray-900 dark:text-white",children:new Date(e.date).toLocaleDateString("en-GB",{month:"short",year:"numeric"})}),r.jsx("td",{className:"py-3 px-4 text-sm text-right font-semibold text-gray-900 dark:text-white",children:C(e.workingCapital)}),r.jsx("td",{className:"py-3 px-4 text-sm text-right text-gray-600 dark:text-gray-300",children:C(e.accountsReceivable)}),r.jsx("td",{className:"py-3 px-4 text-sm text-right text-gray-600 dark:text-gray-300",children:C(e.inventory)}),r.jsx("td",{className:"py-3 px-4 text-sm text-right text-gray-600 dark:text-gray-300",children:C(e.accountsPayable)}),r.jsxs("td",{className:"py-3 px-4 text-sm text-right text-green-600 dark:text-green-400",children:["+",C(e.cashFlow)]})]},t))})]})})]})]})]})});var F};export{g as default};
