# Complete Render Environment Variables Configuration

## ‚úÖ DATABASE MIGRATION: Neon ‚Üí Render PostgreSQL

All three environments now use **Render PostgreSQL** databases instead of Neon:

| Environment | Database Name | Plan | Cost | Connection |
|-------------|--------------|------|------|------------|
| **Development** | sentia-db-development | Free | $0 | Auto via `fromDatabase` |
| **Testing** | sentia-db-testing | Free | $0 | Auto via `fromDatabase` |
| **Production** | sentia-db-production | Starter | $7/month | Auto via `fromDatabase` |

### Database Benefits with Render PostgreSQL:
- **Automatic Connection**: No manual DATABASE_URL needed
- **Integrated Backups**: Daily backups on Starter plan
- **SSL/TLS**: Automatic encryption
- **Connection Pooling**: Built-in optimization
- **Same Region**: Databases in same region as app (oregon)

## üîß COMPLETE ENVIRONMENT VARIABLES LIST

### Core Configuration (All Environments)
```yaml
NODE_ENV: [development|test|production]
PORT: 3000
CORS_ORIGINS: https://sentia-manufacturing-[environment].onrender.com
```

### Database (Render PostgreSQL - Automatic)
```yaml
DATABASE_URL: fromDatabase.sentia-db-[environment].connectionString
DEV_DATABASE_URL: fromDatabase.sentia-db-development.connectionString (dev only)
TEST_DATABASE_URL: fromDatabase.sentia-db-testing.connectionString (test only)
```

### Authentication (Clerk)
```yaml
VITE_CLERK_PUBLISHABLE_KEY: pk_test_Y2hhbXBpb24tYnVsbGRvZy05Mi5jbGVyay5hY2NvdW50cy5kZXYk
CLERK_SECRET_KEY: sk_test_EP6iF7prGbq73CscUPCOW8PAKol4pPaBG5iYdsDodq
CLERK_WEBHOOK_SECRET: whsec_REDACTED
```

### Session Management
```yaml
SESSION_SECRET: [auto-generated by Render]
JWT_SECRET: [auto-generated by Render]
```

### MCP Server Integration (‚úÖ LIVE)
```yaml
MCP_SERVER_URL: https://mcp-server-tkyu.onrender.com
MCP_WEBSOCKET_URL: wss://mcp-server-tkyu.onrender.com
MCP_JWT_SECRET: [auto-generated by Render]
MCP_ENABLE_WEBSOCKET: true
MCP_SERVER_HEALTH_CHECK_INTERVAL: 30000
```

### Xero Integration
```yaml
XERO_CLIENT_ID: 9C0CAB921C134476A249E48BBECB8C4B
XERO_CLIENT_SECRET: f0TJpJSRX_B9NI51sknz7TuKbbSfhO4dEhTM4m4fWBlph9F5
XERO_REDIRECT_URI: https://sentia-manufacturing-[environment].onrender.com/api/xero/callback
XERO_TENANT_ID: [set via dashboard when available]
```

### Shopify UK Store
```yaml
SHOPIFY_UK_API_KEY: 7a30cd84e7a106b852c8e0fb789de10e
SHOPIFY_UK_SECRET: 8b2d61745c506970c70d8c892f5f977e
SHOPIFY_UK_ACCESS_TOKEN: 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
SHOPIFY_UK_SHOP_URL: sentiaspirits.myshopify.com
```

### Shopify USA Store
```yaml
SHOPIFY_USA_API_KEY: 83b8903fd8b509ef8bf93d1dbcd6079c
SHOPIFY_USA_SECRET: d01260e58adb00198cddddd1bd9a9490
SHOPIFY_USA_ACCESS_TOKEN: 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
SHOPIFY_USA_SHOP_URL: us-sentiaspirits.myshopify.com
SHOPIFY_WEBHOOK_SECRET: [set via dashboard when available]
```

### Amazon SP-API
```yaml
AMAZON_SP_API_CLIENT_ID: [set via dashboard when available]
AMAZON_SP_API_CLIENT_SECRET: [set via dashboard when available]
AMAZON_SP_API_REFRESH_TOKEN: [set via dashboard when available]
AMAZON_UK_MARKETPLACE_ID: A1F83G8C2ARO7P
AMAZON_USA_MARKETPLACE_ID: ATVPDKIKX0DER
AMAZON_SELLER_ID: [set via dashboard when available]
```

### Unleashed ERP
```yaml
UNLEASHED_API_ID: d5313df6-db35-430c-a69e-ae27dffe0c5a
UNLEASHED_API_KEY: 2bJcHlDhIV04ScdqT60c3zlnG7hOER7aoPSh2IF2hWQluOi7ZaGkeu4SGeseYexAqOGfcRmyl9c6QYueJHyQ==
UNLEASHED_API_URL: https://api.unleashedsoftware.com
```

### AI Services
```yaml
OPENAI_API_KEY: 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
ANTHROPIC_API_KEY: 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
```

### Microsoft Graph API
```yaml
MICROSOFT_CLIENT_ID: c16d6fba-0e6b-45ea-a016-eb697ff7a7ae
MICROSOFT_CLIENT_SECRET: peI8Q~4QJG.ax3ekxtWrv.PXVENVQ3vw_Br1qayM
MICROSOFT_TENANT_ID: common
MICROSOFT_ADMIN_EMAIL: admin@app.sentiaspirits.com
MICROSOFT_DATA_EMAIL: data@app.sentiaspirits.com
```

### Auto-Sync Configuration
```yaml
AUTO_SYNC_ENABLED: true
XERO_SYNC_INTERVAL: "*/30 * * * *"
SHOPIFY_SYNC_INTERVAL: "*/15 * * * *"
AMAZON_SYNC_INTERVAL: "*/60 * * * *"
DATABASE_SYNC_INTERVAL: "0 */6 * * *"
```

### Optional Services
```yaml
REDIS_URL: [optional - set if using Redis]
SENTRY_DSN: [optional - for error tracking]
```

### Monitoring
```yaml
LOG_LEVEL: info
```

### Feature Flags by Environment

| Flag | Development | Testing | Production |
|------|------------|---------|------------|
| ENABLE_AUTONOMOUS_TESTING | true | true | false |
| AUTO_FIX_ENABLED | true | true | false |
| AUTO_DEPLOY_ENABLED | true | false | false |

### Application Settings
```yaml
VITE_API_BASE_URL: https://sentia-manufacturing-[environment].onrender.com/api
VITE_APP_TITLE: Sentia Manufacturing Dashboard
VITE_APP_VERSION: 1.0.0
```

## üìã DEPLOYMENT CHECKLIST

### For Each Environment (Development, Testing, Production):

1. **Create Service in Render**
   - [ ] Web service created with correct name
   - [ ] Linked to GitHub repo
   - [ ] Correct branch selected
   - [ ] Build command set
   - [ ] Start command set

2. **Database Setup**
   - [ ] PostgreSQL database created in Render
   - [ ] Database linked to service via `fromDatabase`
   - [ ] No manual DATABASE_URL needed

3. **Environment Variables**
   - [ ] All variables from list above added
   - [ ] Environment-specific URLs updated
   - [ ] Auto-generated values created (JWT_SECRET, SESSION_SECRET)

4. **Verification**
   - [ ] Health endpoint responding
   - [ ] Database connection working
   - [ ] MCP server connected
   - [ ] All APIs configured

## üöÄ QUICK VALIDATION

Run this to validate everything:
```powershell
.\validate-render-complete.ps1 -Environment all
```

## üí∞ TOTAL COST BREAKDOWN

| Service | Plan | Monthly Cost |
|---------|------|--------------|
| Development App | Free | $0 |
| Testing App | Starter | $7 |
| Production App | Standard | $25 |
| Development DB | Free | $0 |
| Testing DB | Free | $0 |
| Production DB | Starter | $7 |
| MCP Server | Standard | $25 |
| **TOTAL** | | **$64/month** |

## ‚ö†Ô∏è IMPORTANT NOTES

1. **Database Migration**: Data must be migrated from Neon to Render PostgreSQL
2. **Connection Strings**: Render automatically provides DATABASE_URL via `fromDatabase`
3. **Backups**: Production database (Starter plan) includes daily backups
4. **SSL**: All database connections use SSL automatically
5. **Region**: All services and databases must be in same region (oregon)

## ‚úÖ VALIDATION COMMANDS

```powershell
# Test all environments
.\validate-render-complete.ps1 -Environment all

# Test specific environment
.\validate-render-complete.ps1 -Environment production

# Test MCP integration
.\test-mcp-integration-e2e.ps1 -Environment production

# Monitor all services
.\monitor-render-services.ps1
```

## üîÑ MIGRATION FROM NEON

To migrate your data from Neon to Render PostgreSQL:

```powershell
# Export from Neon
.\database-migration-render.ps1 -Operation export `
  -SourceDB "postgresql://neondb_owner:npg_2wXVD9gdintm@ep-aged-dust-abpyip0r-pooler.eu-west-2.aws.neon.tech/neondb?sslmode=require"

# Import to Render (get connection string from Render dashboard)
.\database-migration-render.ps1 -Operation import `
  -TargetDB "[Render PostgreSQL External Connection String]" `
  -BackupFile "sentia-db-backup-[timestamp].sql"
```

---

**STATUS**: All environment variables configured for Render PostgreSQL. Ready for deployment!
