import{r as e,j as t,G as s,b1 as a,b2 as r,ac as n,b3 as i}from"./chunk-6UcRpCBY.js";import{u as o,a as l}from"./chunk-DTveDoil.js";import{f as d}from"./index-eUvznO12.js";import"./chunk-BSax3_JK.js";import"./chunk-CH-SdtzI.js";import"./chunk-C3SnPVx2.js";import"./chunk-BnxSvIiU.js";import"./chunk-TAvxFron.js";import"./chunk-B0LCvgW6.js";import"./chunk-CxHw_PPj.js";import"./chunk-Dozjk7Op.js";const c=({className:c="",autoExecute:m=!1,maxConcurrentWorkflows:u=5,...p})=>{o();const{subscribe:x,STREAM_TYPES:g}=l(),{resolvedTheme:h}=d(),[b,y]=e.useState([]),[f,j]=e.useState(new Map),[v,w]=e.useState([]);e.useState([]),e.useState([]),e.useState(null);const[N,k]=e.useState("active"),[S,E]=e.useState(!1),$={IDLE:{label:"Idle",color:"text-gray-500",bg:"bg-gray-100 dark:bg-gray-700"},RUNNING:{label:"Running",color:"text-blue-500",bg:"bg-blue-100 dark:bg-blue-900/30"},COMPLETED:{label:"Completed",color:"text-green-500",bg:"bg-green-100 dark:bg-green-900/30"},FAILED:{label:"Failed",color:"text-red-500",bg:"bg-red-100 dark:bg-red-900/30"},PAUSED:{label:"Paused",color:"text-yellow-500",bg:"bg-yellow-100 dark:bg-yellow-900/30"}},C=[{id:"quality-check",name:"Automated Quality Check",description:"Automated quality validation process for production batches",category:"quality",steps:[{id:"step-1",name:"Sample Collection",type:"trigger",duration:5},{id:"step-2",name:"Dimensional Analysis",type:"analysis",duration:10},{id:"step-3",name:"Surface Quality Check",type:"inspection",duration:8},{id:"step-4",name:"Generate QC Report",type:"documentation",duration:3},{id:"step-5",name:"Approval/Rejection",type:"decision",duration:2}],triggerConditions:["batch_completed","quality_schedule"],expectedDuration:28,successRate:96.8},{id:"maintenance-workflow",name:"Predictive Maintenance Workflow",description:"Automated maintenance workflow based on AI predictions",category:"maintenance",steps:[{id:"step-1",name:"Equipment Health Check",type:"monitoring",duration:2},{id:"step-2",name:"AI Risk Assessment",type:"analysis",duration:5},{id:"step-3",name:"Schedule Maintenance",type:"scheduling",duration:1},{id:"step-4",name:"Parts Ordering",type:"procurement",duration:15},{id:"step-5",name:"Maintenance Execution",type:"action",duration:120}],triggerConditions:["equipment_warning","schedule_based"],expectedDuration:143,successRate:94.2},{id:"production-optimization",name:"Production Line Optimization",description:"Optimize production parameters based on real-time data",category:"production",steps:[{id:"step-1",name:"Data Collection",type:"monitoring",duration:1},{id:"step-2",name:"Performance Analysis",type:"analysis",duration:3},{id:"step-3",name:"Parameter Optimization",type:"optimization",duration:2},{id:"step-4",name:"Implement Changes",type:"action",duration:5},{id:"step-5",name:"Monitor Results",type:"monitoring",duration:30}],triggerConditions:["efficiency_drop","scheduled_optimization"],expectedDuration:41,successRate:91.5},{id:"inventory-replenishment",name:"Smart Inventory Replenishment",description:"AI-driven inventory replenishment workflow",category:"inventory",steps:[{id:"step-1",name:"Inventory Level Check",type:"monitoring",duration:1},{id:"step-2",name:"Demand Forecasting",type:"analysis",duration:8},{id:"step-3",name:"Supplier Selection",type:"decision",duration:5},{id:"step-4",name:"Purchase Order Creation",type:"action",duration:2},{id:"step-5",name:"Order Confirmation",type:"verification",duration:10}],triggerConditions:["low_stock","reorder_point"],expectedDuration:26,successRate:98.1}];e.useEffect(()=>{(()=>{const e=C.map(e=>({...e,status:"IDLE",currentStep:null,startTime:null,endTime:null,executionCount:Math.floor(100*Math.random()),lastExecution:Date.now()-24*Math.random()*60*60*1e3,enabled:!0}));y(e)})()},[]),e.useEffect(()=>{const e=[x(g.PRODUCTION_METRICS,D),x(g.QUALITY_DATA,I),x(g.EQUIPMENT_STATUS,A),x(g.INVENTORY_LEVELS,M)];return()=>{e.forEach(e=>e())}},[x,g]);const D=e=>{e.batchCompleted&&m&&T("quality-check",{batchId:e.batchId}),e.efficiency<85&&m&&T("production-optimization",{reason:"efficiency_drop"})},I=e=>{e.defectRate>2&&m&&T("quality-check",{reason:"quality_issue"})},A=e=>{"high"===e.warningLevel&&m&&T("maintenance-workflow",{equipmentId:e.equipmentId})},M=e=>{e.stockLevel<e.reorderPoint&&m&&T("inventory-replenishment",{itemId:e.itemId})},T=(e,t={})=>{const s=b.find(t=>t.id===e);if(!s||!s.enabled)return;if(f.size>=u)return;const a=`exec-${Date.now()}-${crypto.randomUUID().substr(2,9)}`,r={id:a,workflowId:e,workflow:{...s},status:"RUNNING",currentStep:0,startTime:Date.now(),context:t,progress:0,logs:[]};j(e=>new Map(e.set(a,r))),L(r)},L=async e=>{const{steps:t}=e.workflow;try{for(let s=0;s<t.length;s++){const a=t[s];if(j(r=>{const n=new Map(r),i=n.get(e.id);return i&&(i.currentStep=s,i.progress=s/t.length*100,i.logs.push({timestamp:Date.now(),level:"info",message:`Starting step: ${a.name}`})),n}),await new Promise(e=>setTimeout(e,100*a.duration)),Math.random()<.05)throw new Error(`Step "${a.name}" failed during execution`);j(t=>{const s=new Map(t),r=s.get(e.id);return r&&r.logs.push({timestamp:Date.now(),level:"success",message:`Completed step: ${a.name}`}),s})}P(e.id,"COMPLETED")}catch(s){j(t=>{const a=new Map(t),r=a.get(e.id);return r&&r.logs.push({timestamp:Date.now(),level:"error",message:`Workflow failed: ${s.message}`}),a}),P(e.id,"FAILED")}},P=(e,t)=>{j(s=>{const a=new Map(s),r=a.get(e);if(r){const s={...r,status:t,endTime:Date.now(),progress:100};w(e=>[s,...e].slice(0,100)),y(e=>e.map(e=>e.id===r.workflowId?{...e,status:"IDLE",executionCount:e.executionCount+1,lastExecution:Date.now()}:e)),a.delete(e)}return a})},R=e=>{if(e<60)return`${e} min`;if(e<1440){return`${Math.floor(e/60)}h ${e%60}m`}return`${Math.floor(e/1440)}d ${Math.floor(e%1440/60)}h`},_=`\n    rounded-lg border shadow-sm\n    ${"dark"===h?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}\n  `,O="dark"===h?"text-gray-100":"text-gray-900",z="dark"===h?"text-gray-300":"text-gray-600",q="dark"===h?"text-gray-400":"text-gray-500";return t.jsxs("div",{className:`space-y-6 ${c}`,...p,children:[t.jsx("div",{className:_,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(s,{className:"w-6 h-6 mr-3 text-amber-600"}),t.jsx("h2",{className:`text-xl font-semibold ${O}`,children:"Workflow Automation & Optimization"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-bold text-amber-600",children:f.size}),t.jsx("div",{className:`text-sm ${q}`,children:"Active Workflows"})]}),t.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:"Create Workflow"})]})]}),t.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:["active","templates","history","analytics"].map(e=>t.jsx("button",{onClick:()=>k(e),className:`\n                  px-4 py-2 rounded-md text-sm font-medium transition-colors\n                  ${N===e?"bg-white shadow text-amber-600 dark:bg-gray-800 dark:text-amber-400":"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100"}\n                `,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})}),"active"===N&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx("div",{className:_,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${O}`,children:"Active Executions"}),f.size>0?t.jsx("div",{className:"space-y-4",children:Array.from(f.values()).map(e=>t.jsxs("div",{className:`\n                      p-4 rounded-lg border\n                      ${"dark"===h?"bg-slate-700 border-slate-600":"bg-gray-50 border-gray-200"}\n                    `,children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:`font-medium ${O}`,children:e.workflow.name}),t.jsxs("p",{className:`text-sm ${z}`,children:["Step ",e.currentStep+1," of ",e.workflow.steps.length]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>{return t=e.id,void j(e=>{const s=new Map(e),a=s.get(t);return a&&(a.status="PAUSED"),s});var t},className:"p-1 text-yellow-600 hover:bg-yellow-100 rounded dark:hover:bg-yellow-900/30",children:t.jsx(a,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{return t=e.id,void P(t,"STOPPED");var t},className:"p-1 text-red-600 hover:bg-red-100 rounded dark:hover:bg-red-900/30",children:t.jsx(r,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{className:z,children:"Progress"}),t.jsxs("span",{className:z,children:[Math.round(e.progress),"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${e.progress}%`}})})]}),t.jsxs("div",{className:"text-sm",children:[t.jsxs("p",{className:`${z} mb-1`,children:["Current: ",e.workflow.steps[e.currentStep]?.name]}),t.jsxs("p",{className:q,children:["Started: ",new Date(e.startTime).toLocaleTimeString()]})]})]},e.id))}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(n,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),t.jsx("p",{className:z,children:"No active workflows"}),t.jsx("p",{className:`text-sm ${q}`,children:"Start a workflow from the templates tab"})]})]})}),t.jsx("div",{className:_,children:t.jsxs("div",{className:"p-6",children:[t.jsx("h3",{className:`text-lg font-semibold mb-4 ${O}`,children:"Recent Activity"}),t.jsx("div",{className:"space-y-3",children:v.slice(0,8).map(e=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`\n                        w-2 h-2 rounded-full\n                        ${"COMPLETED"===e.status?"bg-green-500":"FAILED"===e.status?"bg-red-500":"bg-gray-500"}\n                      `}),t.jsxs("div",{children:[t.jsx("p",{className:`font-medium ${O}`,children:e.workflow.name}),t.jsx("p",{className:`text-sm ${q}`,children:new Date(e.endTime).toLocaleString()})]})]}),t.jsx("div",{className:`\n                      px-2 py-1 rounded-full text-xs font-medium\n                      ${$[e.status]?.bg} ${$[e.status]?.color}\n                    `,children:$[e.status]?.label})]},e.id))})]})})]}),"templates"===N&&t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:b.map(e=>{return t.jsx("div",{className:_,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("h3",{className:`text-lg font-semibold ${O}`,children:e.name}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s=e.category,{quality:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",maintenance:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",production:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400",inventory:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400"}[s]||"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"}`,children:e.category})]}),t.jsx("p",{className:`text-sm ${z}`,children:e.description})]}),t.jsx("button",{onClick:()=>{return t=e.id,void T(t,{trigger:"manual"});var t},disabled:f.size>=u,className:`\n                      p-2 rounded-lg transition-colors\n                      ${f.size>=u?"text-gray-400 cursor-not-allowed":"text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30"}\n                    `,children:t.jsx(i,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:e.executionCount}),t.jsx("div",{className:`text-sm ${q}`,children:"Executions"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-lg font-bold text-green-600",children:[e.successRate,"%"]}),t.jsx("div",{className:`text-sm ${q}`,children:"Success Rate"})]})]}),t.jsxs("div",{className:"border-t border-gray-200 dark:border-slate-700 pt-4",children:[t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:z,children:[e.steps.length," steps"]}),t.jsxs("span",{className:z,children:["~",R(e.expectedDuration)]})]}),e.lastExecution&&t.jsxs("div",{className:`text-xs mt-2 ${q}`,children:["Last run: ",new Date(e.lastExecution).toLocaleDateString()]})]})]})},e.id);var s})})]})};export{c as WorkflowAutomation,c as default};
