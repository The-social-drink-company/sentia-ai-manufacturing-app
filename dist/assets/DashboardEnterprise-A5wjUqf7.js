const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/RegionalContributionChart-CKyWU7iu.js","assets/vendor-9Il8YjTy.js","assets/charts-DCEQ2Gmr.js","assets/PLAnalysisChart-Dk0N0VK4.js"])))=>i.map(i=>d[i]);
import{B as b,C as u,a as h,b as m,c as p,d as x,_ as j}from"./index-BTxlbXHN.js";import{r as l,ab as e}from"./vendor-9Il8YjTy.js";import"./data-layer-5DSV7RNU.js";import"./radix-Cvpp8Uw1.js";import"./router-C61bPHzn.js";class v{constructor(){this.baseURL="/api",this.defaultHeaders={"Content-Type":"application/json",Accept:"application/json"}}async request(t,s={}){const n=`${this.baseURL}${t}`,o={headers:{...this.defaultHeaders,...s.headers},...s};try{const a=await fetch(n,o);if(!a.ok)throw new Error(`API Error: ${a.status} ${a.statusText}`);const r=a.headers.get("content-type");return r&&r.includes("application/json")?await a.json():await a.text()}catch(a){throw console.error(`[APIClient] Request failed for ${t}:`,a),a}}async get(t,s={}){const n=new URL(`${this.baseURL}${t}`,window.location.origin);return Object.keys(s).forEach(o=>{s[o]!==void 0&&s[o]!==null&&n.searchParams.append(o,s[o])}),this.request(n.pathname+n.search,{method:"GET"})}async post(t,s={}){return this.request(t,{method:"POST",body:JSON.stringify(s)})}async put(t,s={}){return this.request(t,{method:"PUT",body:JSON.stringify(s)})}async delete(t){return this.request(t,{method:"DELETE"})}async health(){return this.get("/health")}async status(){return this.get("/status")}}const f=new v,g=()=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((t,s)=>{const n=1200+Math.sin(s*.5)*200+Math.random()*100,o=1+Math.sin(s*.5)*.15,a=Math.round(n*o),r=Math.round(a*(.55+Math.random()*.15)),i=Math.round(a*(.18+Math.random()*.08)),d=Number((r/a*100).toFixed(1));return{month:t,revenue:a,grossProfit:r,ebitda:i,grossMarginPercent:d}}),y={async getPLAnalysis(c={}){try{return(await f.get("/api/financial/pl-analysis",{params:c})).data}catch(t){return console.error("Failed to fetch P&L analysis data:",t),console.log("Using mock P&L data as fallback"),{success:!0,data:g(),timestamp:new Date().toISOString()}}},async getPLSummary(c="year"){try{return(await f.get("/api/financial/pl-summary",{params:{period:c}})).data}catch(t){console.error("Failed to fetch P&L summary:",t);const s=g(),n=s.reduce((r,i)=>r+i.revenue,0),o=s.reduce((r,i)=>r+i.grossProfit,0),a=s.reduce((r,i)=>r+i.ebitda,0);return{success:!0,data:{totalRevenue:n,totalGrossProfit:o,totalEbitda:a,avgGrossMargin:Number((o/n*100).toFixed(1)),avgEbitdaMargin:Number((a/n*100).toFixed(1)),period:c},timestamp:new Date().toISOString()}}},getMockData(){return{success:!0,data:g(),timestamp:new Date().toISOString()}}},P=[{region:"APAC",revenue:32e5,ebitda:78e4},{region:"EMEA",revenue:276e4,ebitda:64e4},{region:"Americas",revenue:214e4,ebitda:52e4}],L=[{label:"Global working capital",value:"$9.2M",helper:"Across all subsidiaries"},{label:"Cash coverage",value:"214 days",helper:"Including credit facilities"},{label:"Intercompany exposure",value:"$1.1M",helper:"Pending settlements"},{label:"FX sensitivity",value:"$380K",helper:"Â±1% USD/EUR/JPY"}],E=l.lazy(()=>j(()=>import("./RegionalContributionChart-CKyWU7iu.js"),__vite__mapDeps([0,1,2]))),w=l.lazy(()=>j(()=>import("./PLAnalysisChart-Dk0N0VK4.js"),__vite__mapDeps([3,1,2]))),S=()=>{const[c,t]=l.useState([]),[s,n]=l.useState(!0),[o,a]=l.useState(null);return l.useEffect(()=>{(async()=>{try{n(!0),a(null);const i=await y.getPLAnalysis();if(i.success)t(i.data);else throw new Error("Failed to fetch P&L data")}catch(i){console.error("Error fetching P&L data:",i),a(i.message);const d=y.getMockData();t(d.data)}finally{n(!1)}})()},[]),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold tracking-tight",children:"Enterprise dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Consolidated liquidity and performance outlook across all regions."})]}),e.jsx(b,{variant:"outline",children:"Global view"})]}),e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(m,{children:"Capital position"}),e.jsx(p,{children:"Key metrics reviewed in the weekly treasury meeting."})]}),e.jsx(x,{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:L.map(r=>e.jsxs("div",{className:"rounded-lg border border-border bg-muted/30 p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:r.label}),e.jsx("p",{className:"text-lg font-semibold text-foreground",children:r.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.helper})]},r.label))})]}),e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(m,{children:"P&L Analysis"}),e.jsx(p,{children:"Monthly profit and loss analysis showing revenue, gross profit, EBITDA, and margin trends."})]}),e.jsx(x,{className:"h-80",children:s?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading P&L data..."})]})}):o?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-destructive mb-2",children:"Error loading P&L data"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Using sample data for demonstration"})]})}):e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading chart..."}),children:e.jsx(w,{data:c})})})]}),e.jsxs(u,{children:[e.jsxs(h,{children:[e.jsx(m,{children:"Regional contribution"}),e.jsx(p,{children:"Revenue and EBITDA by operating region for the current quarter."})]}),e.jsx(x,{className:"h-80",children:e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading chart..."}),children:e.jsx(E,{data:P})})})]})]})};export{S as default};
