import{r as d,j as e,o as x,x as b,J as v,H as C,aH as E,af as M,I as S,aK as A,y as D}from"./react-vendor-CbFVVgBZ.js";import"./vendor-BHPHB5s9.js";import"./charts-Dbk9-C0f.js";import"./utils-Pe79r9Ua.js";class P{constructor(){this.baseUrl="https://sentia-manufacturing-production.onrender.com/api",this.cache=new Map,this.cacheTimeout=300*1e3}async getKPIs(r="7d"){const a=`kpis-${r}`;if(this.isCacheValid(a))return this.cache.get(a).data;try{const s={oee:{value:78.5,target:85,trend:"up",change:2.3,components:{availability:92.1,performance:88.4,quality:96.2}},production:{totalOutput:15234,plannedOutput:16e3,efficiency:95.2,utilization:87.3},quality:{defectRate:2.3,firstPassYield:94.5,reworkRate:3.2,scrapRate:1.8},inventory:{turnoverRatio:12.5,stockoutRate:.8,carryingCost:125e3,daysOnHand:28},delivery:{onTimeDelivery:96.7,orderFulfillment:98.2,leadTime:4.2,cycleTime:2.8},cost:{unitCost:45.23,laborCost:28.5,materialCost:62.3,overheadCost:9.2}};return this.setCache(a,s),s}catch(s){throw console.error("Error fetching KPIs:",s),s}}async getProductionTrends(r="30d",a="daily"){const s=`trends-${r}-${a}`;if(this.isCacheValid(s))return this.cache.get(s).data;try{const i=this.generateTrendData(r,a),c={production:i.map(n=>({date:n.date,volume:n.production,efficiency:n.efficiency,quality:n.quality})),oee:i.map(n=>({date:n.date,overall:n.oee,availability:n.availability,performance:n.performance,quality:n.quality})),costs:i.map(n=>({date:n.date,total:n.totalCost,labor:n.laborCost,material:n.materialCost,overhead:n.overheadCost}))};return this.setCache(s,c),c}catch(i){throw console.error("Error fetching production trends:",i),i}}async detectAnomalies(r=["all"]){const a=`anomalies-${r.join("-")}`;if(this.isCacheValid(a))return this.cache.get(a).data;try{const s=[{id:"ANO-001",timestamp:new Date().toISOString(),metric:"Machine Efficiency",severity:"high",description:"Machine L2-04 efficiency dropped to 45% (normal: 85-90%)",impact:"Production delay of 2 hours expected",recommendation:"Immediate maintenance inspection required"},{id:"ANO-002",timestamp:new Date(Date.now()-72e5).toISOString(),metric:"Quality Defect Rate",severity:"medium",description:"Defect rate increased to 4.2% on Product Line A",impact:"Additional QC resources needed",recommendation:"Review recent process changes and material batch"},{id:"ANO-003",timestamp:new Date(Date.now()-144e5).toISOString(),metric:"Material Consumption",severity:"low",description:"Raw material usage 8% higher than forecast",impact:"Potential inventory shortage in 5 days",recommendation:"Adjust procurement schedule"}];return this.setCache(a,s),s}catch(s){throw console.error("Error detecting anomalies:",s),s}}async getPredictiveMaintenance(){const r="predictive-maintenance";if(this.isCacheValid(r))return this.cache.get(r).data;try{const a={alerts:[{machineId:"MCH-001",name:"CNC Machine A",predictedFailure:"2025-10-05",confidence:87,component:"Spindle Bearing",hoursToFailure:168,recommendation:"Schedule maintenance within 5 days"},{machineId:"MCH-005",name:"Assembly Robot 2",predictedFailure:"2025-10-12",confidence:72,component:"Servo Motor",hoursToFailure:336,recommendation:"Monitor closely, plan maintenance"}],maintenanceSchedule:[{date:"2025-09-28",machines:["MCH-002","MCH-007"],type:"Preventive",duration:4},{date:"2025-10-02",machines:["MCH-001"],type:"Predictive",duration:6}],healthScores:{"MCH-001":65,"MCH-002":88,"MCH-003":92,"MCH-004":76,"MCH-005":71}};return this.setCache(r,a),a}catch(a){throw console.error("Error fetching predictive maintenance:",a),a}}async getLinePerformance(r="all"){const a=`line-performance-${r}`;if(this.isCacheValid(a))return this.cache.get(a).data;try{const s=[{id:"LINE-01",name:"Assembly Line A",status:"running",oee:82.3,currentSpeed:120,targetSpeed:150,unitsProduced:4523,targetUnits:5e3,efficiency:90.5,downtime:12,qualityRate:98.2},{id:"LINE-02",name:"Packaging Line B",status:"running",oee:76.8,currentSpeed:200,targetSpeed:220,unitsProduced:8234,targetUnits:9e3,efficiency:91.5,downtime:8,qualityRate:97.5},{id:"LINE-03",name:"Processing Line C",status:"maintenance",oee:0,currentSpeed:0,targetSpeed:180,unitsProduced:0,targetUnits:0,efficiency:0,downtime:120,qualityRate:0}],i=r==="all"?s:s.filter(c=>c.id===r);return this.setCache(a,i),i}catch(s){throw console.error("Error fetching line performance:",s),s}}async getShiftAnalysis(r=new Date){const a=`shift-analysis-${r.toISOString().split("T")[0]}`;if(this.isCacheValid(a))return this.cache.get(a).data;try{const s={morning:{shift:"Morning (6AM - 2PM)",production:5234,efficiency:88.5,quality:97.2,downtime:25,incidents:1,oee:81.3},afternoon:{shift:"Afternoon (2PM - 10PM)",production:4892,efficiency:84.2,quality:96.8,downtime:35,incidents:2,oee:77.8},night:{shift:"Night (10PM - 6AM)",production:4123,efficiency:79.5,quality:95.5,downtime:45,incidents:0,oee:72.4},comparison:{bestShift:"morning",worstShift:"night",avgOEE:77.2,totalProduction:14249,totalDowntime:105}};return this.setCache(a,s),s}catch(s){throw console.error("Error fetching shift analysis:",s),s}}async getEnergyAnalytics(r="7d"){const a=`energy-${r}`;if(this.isCacheValid(a))return this.cache.get(a).data;try{const s={total:{consumption:45678,cost:12345,efficiency:82.3,trend:"down",change:-5.2},byLine:[{line:"LINE-01",consumption:15234,cost:4123},{line:"LINE-02",consumption:18456,cost:4987},{line:"LINE-03",consumption:11988,cost:3235}],byTime:this.generateEnergyData(r),recommendations:["Optimize Line 2 scheduling to avoid peak rates","Consider upgrading Line 1 motors to high-efficiency models","Implement automated shutdown during idle periods"]};return this.setCache(a,s),s}catch(s){throw console.error("Error fetching energy analytics:",s),s}}async getWasteAnalysis(r="30d"){const a=`waste-${r}`;if(this.isCacheValid(a))return this.cache.get(a).data;try{const s={summary:{totalWaste:2345,wasteRate:3.2,recycled:1876,recycleRate:80,costImpact:34567},byCategory:[{category:"Material Defects",amount:890,percentage:38},{category:"Process Waste",amount:567,percentage:24},{category:"Setup Scrap",amount:445,percentage:19},{category:"Overproduction",amount:234,percentage:10},{category:"Other",amount:209,percentage:9}],byProduct:[{product:"Product A",wasteRate:2.8,amount:678},{product:"Product B",wasteRate:3.5,amount:892},{product:"Product C",wasteRate:3.1,amount:775}],trends:this.generateWasteTrends(r)};return this.setCache(a,s),s}catch(s){throw console.error("Error fetching waste analysis:",s),s}}async getSupplyChainAnalytics(){const r="supply-chain";if(this.isCacheValid(r))return this.cache.get(r).data;try{const a={suppliers:{total:24,onTime:21,delayed:3,performance:87.5},inventory:{rawMaterials:456789,wip:123456,finished:234567,turnover:12.5},leadTimes:{average:4.2,min:2,max:8,trend:"improving"},risks:[{supplier:"Supplier A",risk:"Delivery delays",impact:"medium",mitigation:"Secondary supplier identified"},{supplier:"Supplier C",risk:"Quality issues",impact:"low",mitigation:"Enhanced QC implemented"}]};return this.setCache(r,a),a}catch(a){throw console.error("Error fetching supply chain analytics:",a),a}}async getWorkforceAnalytics(){const r="workforce";if(this.isCacheValid(r))return this.cache.get(r).data;try{const a={summary:{totalWorkers:156,present:148,absent:8,productivity:92.3},byDepartment:[{department:"Production",workers:89,productivity:94.2},{department:"Quality",workers:23,productivity:91.5},{department:"Maintenance",workers:18,productivity:88.7},{department:"Logistics",workers:26,productivity:90.1}],skills:{certified:134,trainingNeeded:22,crossTrained:67},safety:{daysWithoutIncident:45,nearMisses:3,safetyScore:94.5}};return this.setCache(r,a),a}catch(a){throw console.error("Error fetching workforce analytics:",a),a}}generateTrendData(r,a){const s=[],i=r==="7d"?7:r==="30d"?30:90;for(let c=0;c<i;c++){const n=new Date;n.setDate(n.getDate()-(i-c-1)),s.push({date:n.toISOString().split("T")[0],production:4500+Math.random()*1e3,efficiency:85+Math.random()*10,quality:95+Math.random()*4,oee:75+Math.random()*15,availability:90+Math.random()*8,performance:85+Math.random()*10,totalCost:45e3+Math.random()*1e4,laborCost:15e3+Math.random()*3e3,materialCost:25e3+Math.random()*5e3,overheadCost:5e3+Math.random()*2e3})}return s}generateEnergyData(r){const a=r==="7d"?7:r==="30d"?30:90,s=[];for(let i=0;i<a;i++){const c=new Date;c.setDate(c.getDate()-(a-i-1)),s.push({date:c.toISOString().split("T")[0],consumption:6e3+Math.random()*2e3,cost:1500+Math.random()*500,peakDemand:800+Math.random()*200})}return s}generateWasteTrends(r){const a=r==="7d"?7:r==="30d"?30:90,s=[];for(let i=0;i<a;i++){const c=new Date;c.setDate(c.getDate()-(a-i-1)),s.push({date:c.toISOString().split("T")[0],waste:70+Math.random()*30,recycled:50+Math.random()*25,rate:2.5+Math.random()*1.5})}return s}isCacheValid(r){const a=this.cache.get(r);return a?Date.now()-a.timestamp<this.cacheTimeout:!1}setCache(r,a){this.cache.set(r,{data:a,timestamp:Date.now()})}clearCache(){this.cache.clear()}}const p=new P,T=()=>{const[l,r]=d.useState(null),[a,s]=d.useState(!0),[i,c]=d.useState(null),[n,y]=d.useState(null),[g,f]=d.useState("7");d.useEffect(()=>{(async()=>{try{s(!0),await p.initialize(),await h(),c(null)}catch(o){c(`Failed to initialize analytics: ${o.message}`),console.error("Analytics initialization error:",o)}finally{s(!1)}})()},[]);const h=async()=>{try{const t=await p.getAnalyticsDashboard();r(t),y(new Date),c(null)}catch(t){c(`Failed to fetch analytics data: ${t.message}`),console.error("Analytics data error:",t)}};d.useEffect(()=>{const t=setInterval(h,3e4);return()=>clearInterval(t)},[]);const u=t=>t>=85?"text-green-600":t>=70?"text-yellow-600":"text-red-600",w=t=>t>=85?"bg-green-500":t>=70?"bg-yellow-500":"bg-red-500",j=t=>{switch(trend){case"improving":return e.jsx(D,{className:"h-5 w-5 text-green-500"});case"declining":return e.jsx(A,{className:"h-5 w-5 text-red-500"});default:return e.jsx("div",{className:"h-5 w-5 bg-gray-300 rounded-full"})}},m=t=>t==="favorable"?"text-green-600":"text-red-600";return a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Loading analytics..."})]})}):i?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-red-600 mb-4",children:[e.jsx(x,{className:"w-8 h-8"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Analytics Error"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:i}),e.jsx("button",{onClick:h,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Retry Loading"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-3",children:[e.jsx(b,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Manufacturing Analytics"})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Overall Equipment Effectiveness (OEE) and Variance Analysis"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",n?n.toLocaleTimeString():"--:--"]})]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[e.jsxs("select",{value:g,onChange:t=>f(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"1",children:"Last 24 Hours"}),e.jsx("option",{value:"7",children:"Last 7 Days"}),e.jsx("option",{value:"30",children:"Last 30 Days"})]}),e.jsx("button",{onClick:h,className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.jsx(v,{className:"h-5 w-5"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 uppercase tracking-wide",children:"Overall OEE"}),e.jsxs("p",{className:`text-3xl font-bold ${u(l?.summary?.overallOEE||0)}`,children:[l?.summary?.overallOEE||0,"%"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l?.summary?.classification||"Unknown"})]}),e.jsx("div",{className:"h-16 w-16 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("div",{className:`h-12 w-12 rounded-full flex items-center justify-center ${w(l?.summary?.overallOEE||0)}`,children:e.jsx("span",{className:"text-white font-bold",children:"OEE"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 uppercase tracking-wide",children:"Availability"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[l?.summary?.availability||0,"%"]})]}),e.jsx(C,{className:"h-12 w-12 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 uppercase tracking-wide",children:"Performance"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[l?.summary?.performance||0,"%"]})]}),e.jsx(E,{className:"h-12 w-12 text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 uppercase tracking-wide",children:"Quality"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[l?.summary?.quality||0,"%"]})]}),e.jsx(M,{className:"h-12 w-12 text-purple-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Station OEE Analysis"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Station"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"OEE"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Availability"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quality"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Classification"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?.stationOEE?.map(t=>{const o=l?.trends?.[t.stationId];return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.stationName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.stationId})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`text-lg font-bold ${u(t.oee)}`,children:[t.oee,"%"]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:[t.availability,"%"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:[t.performance,"%"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:[t.quality,"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.classification==="World Class"?"bg-green-100 text-green-800":t.classification==="Good"?"bg-yellow-100 text-yellow-800":t.classification==="Fair"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:t.classification})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[j(),e.jsxs("span",{className:"text-sm text-gray-600",children:[o?.oee?.change>0?"+":"",o?.oee?.change||0,"%"]})]})})]},t.stationId)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Variance Analysis"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l?.varianceAnalysis?.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:t.stationName}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Production Variance:"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`font-medium ${m(t.production.status)}`,children:[t.production.variance>0?"+":"",t.production.variance," units"]}),e.jsxs("span",{className:`text-sm ml-2 ${m(t.production.status)}`,children:["(",t.production.variancePercent,"%)"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Efficiency Variance:"}),e.jsxs("span",{className:`font-medium ${m(t.efficiency.status)}`,children:[t.efficiency.variance>0?"+":"",t.efficiency.variance,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Downtime Variance:"}),e.jsxs("span",{className:`font-medium ${m(t.downtime.status)}`,children:[t.downtime.variance>0?"+":"",t.downtime.variance," min"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Quality Variance:"}),e.jsxs("span",{className:`font-medium ${m(t.quality.status)}`,children:[t.quality.variance>0?"+":"",Math.round(t.quality.variance*10)/10,"%"]})]})]})]},t.stationId))})]}),l?.recommendations?.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Improvement Recommendations"}),e.jsx("div",{className:"space-y-4",children:l.recommendations.map((t,o)=>e.jsx("div",{className:`border-l-4 p-4 rounded-lg ${t.type==="critical"?"border-red-500 bg-red-50":t.type==="warning"?"border-yellow-500 bg-yellow-50":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[t.type==="critical"?e.jsx(x,{className:"h-6 w-6 text-red-500 mt-0.5"}):e.jsx(S,{className:"h-6 w-6 text-yellow-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.title}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.impact==="High"?"bg-red-100 text-red-800":t.impact==="Medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:[t.impact," Impact"]})]}),e.jsxs("p",{className:"text-gray-600 mb-2",children:[t.stationName,": ",t.description]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Recommended Actions:"}),e.jsx("ul",{className:"text-sm text-gray-600 list-disc list-inside space-y-1",children:t.actions.map((N,k)=>e.jsx("li",{children:N},actionIndex))})]})]})]})},o))})]})]})};export{T as default};
