import{c as e,b as s,j as a}from"./query-ChsViXKH.js";import{a as t}from"./vendor-CoorQe56.js";import{L as r}from"./index-DHg92Bk0.js";import{R as i,P as l,D as d}from"./refresh-cw-COockets.js";import{C as n,A as c}from"./check-circle-CSJjIkiF.js";import{T as o}from"./trending-up-Ds3lP0Ne.js";import{T as m}from"./target-DPt77ZEH.js";import{l as x}from"./index-OKp0riWf.js";import{B as h}from"./bar-chart-3-LHUe3x3R.js";import"./auth-DSi5b8Vw.js";const g=x("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),p=()=>{const[r,c]=t.useState("30"),[x,p]=t.useState(["all"]),[w,k]=t.useState("demand"),{data:A,refetch:D}=e({queryKey:["demand-forecast",r,x,w],queryFn:async()=>{const e=await fetch(`/api/forecasting/demand?period=${r}&products=${x.join(",")}&type=${w}`,{headers:{Authorization:`Bearer ${session?.accessToken||""}`}});return e.ok?e.json():N},refetchInterval:6e4}),C=s({mutationFn:async()=>(await fetch("/api/forecasting/run-model",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await(user?.getToken())}`},body:JSON.stringify({modelType:"demand_forecast",parameters:{horizon:parseInt(r),products:x,seasonality:!0,confidence:.95}})})).json(),onSuccess:()=>{D()}}),P=A||N;return a.jsx("div",{className:"min-h-screen bg-gray-50",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Demand Forecasting"}),a.jsx("p",{className:"mt-2 text-gray-600",children:"AI-powered demand predictions and market analysis"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:()=>C.mutate(),disabled:C.isLoading,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[C.isLoading?a.jsx(i,{className:"w-4 h-4 mr-2 animate-spin"}):a.jsx(l,{className:"w-4 h-4 mr-2"}),"Generate Forecast"]}),a.jsxs("button",{className:"flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:[a.jsx(d,{className:"w-4 h-4 mr-2"}),"Export Data"]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forecast Period (Days)"}),a.jsxs("select",{value:r,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"7",children:"7 Days"}),a.jsx("option",{value:"14",children:"14 Days"}),a.jsx("option",{value:"30",children:"30 Days"}),a.jsx("option",{value:"60",children:"60 Days"}),a.jsx("option",{value:"90",children:"90 Days"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Products"}),a.jsx("select",{value:x[0],onChange:e=>p([e.target.value]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[{id:"all",name:"All Products"},{id:"gaba-red-500",name:"GABA Red 500ml"},{id:"gaba-clear-500",name:"GABA Clear 500ml"},{id:"gaba-red-250",name:"GABA Red 250ml"},{id:"gaba-clear-250",name:"GABA Clear 250ml"}].map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Analysis Type"}),a.jsxs("select",{value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"demand",children:"Demand Forecast"}),a.jsx("option",{value:"seasonal",children:"Seasonal Analysis"}),a.jsx("option",{value:"trend",children:"Trend Analysis"}),a.jsx("option",{value:"scenario",children:"Scenario Planning"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Status"}),a.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[a.jsx(n,{className:"w-5 h-5 text-green-500"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Model Ready"})]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsx(u,{title:"Predicted Demand",value:P.totalDemand?.toLocaleString()||"0",change:"+12.5%",trend:"up",icon:a.jsx(o,{className:"w-6 h-6"})}),a.jsx(u,{title:"Confidence Level",value:`${P.confidence||87}%`,change:"+2.1%",trend:"up",icon:a.jsx(m,{className:"w-6 h-6"})}),a.jsx(u,{title:"Peak Demand Day",value:P.peakDay||"Day 15",change:"Fri",trend:"stable",icon:a.jsx(g,{className:"w-6 h-6"})}),a.jsx(u,{title:"Model Accuracy",value:`${P.accuracy||89}%`,change:"+1.3%",trend:"up",icon:a.jsx(h,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[a.jsx(j,{data:P.forecastData}),a.jsx(y,{data:P.productBreakdown})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsx(b,{patterns:P.seasonalPatterns}),a.jsx(f,{risks:P.riskFactors}),a.jsx(v,{insights:P.insights})]})]})})},u=({title:e,value:s,change:t,trend:r,icon:i})=>{const l="up"===r||"down"===r?o:g,d="up"===r?"text-green-500":"down"===r?"text-red-500":"text-gray-500";return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:e}),a.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600",children:i})]}),a.jsx("div",{className:"flex items-end justify-between",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s}),a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsx(l,{className:`w-4 h-4 ${d}`}),a.jsx("span",{className:`text-sm ml-1 ${d}`,children:t}),a.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"vs last period"})]})]})})]})},j=({data:e})=>{const s={labels:e?.map(e=>e.date)||[],datasets:[{label:"Predicted Demand",data:e?.map(e=>e.predicted)||[],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Historical Demand",data:e?.map(e=>e.historical)||[],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!1,tension:.4}]};return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Demand Forecast"}),a.jsx("div",{className:"h-64",children:a.jsx(r,{data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Demand Forecast vs Historical Data"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Units"}}}}})})]})},y=({data:e})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Product Breakdown"}),a.jsx("div",{className:"space-y-4",children:(e||w).map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-3 h-3 rounded-full "+(0===s?"bg-blue-500":1===s?"bg-green-500":2===s?"bg-yellow-500":"bg-purple-500")}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.name}),a.jsx("div",{className:"text-sm text-gray-500",children:e.category})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.forecast.toLocaleString()}),a.jsx("div",{className:"text-sm text-gray-500",children:"units"})]})]},s))})]}),b=({patterns:e})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Seasonal Patterns"}),a.jsx("div",{className:"space-y-3",children:(e||k).map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:e.period}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.intensity}%`}})}),a.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e.intensity,"%"]})]})]},s))})]}),f=({risks:e})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Risk Factors"}),a.jsx("div",{className:"space-y-3",children:(e||A).map((e,s)=>a.jsxs("div",{className:"p-3 rounded-lg border-l-4 "+("high"===e.level?"border-red-400 bg-red-50":"medium"===e.level?"border-yellow-400 bg-yellow-50":"border-blue-400 bg-blue-50"),children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium text-gray-900",children:e.factor}),a.jsx(c,{className:"w-4 h-4 "+("high"===e.level?"text-red-600":"medium"===e.level?"text-yellow-600":"text-blue-600")})]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},s))})]}),v=({insights:e})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Actionable Insights"}),a.jsx("div",{className:"space-y-4",children:(e||D).map((e,s)=>a.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:e.priority})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),a.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Expected Impact: ",e.impact]})]},s))})]}),N={totalDemand:25420,confidence:87.3,peakDay:"Day 15",accuracy:89.2,forecastData:[{date:"Jan 1",predicted:850,historical:820},{date:"Jan 2",predicted:920,historical:890},{date:"Jan 3",predicted:780,historical:750},{date:"Jan 4",predicted:1050,historical:1020},{date:"Jan 5",predicted:1150,historical:null}]},w=[{name:"GABA Red 500ml",category:"Premium",forecast:12500},{name:"GABA Clear 500ml",category:"Premium",forecast:8900},{name:"GABA Red 250ml",category:"Standard",forecast:2800},{name:"GABA Clear 250ml",category:"Standard",forecast:1220}],k=[{period:"Q1",intensity:85},{period:"Q2",intensity:92},{period:"Q3",intensity:78},{period:"Q4",intensity:96}],A=[{factor:"Supply Chain Disruption",level:"medium",description:"Potential delays from primary supplier"},{factor:"Market Volatility",level:"low",description:"Economic indicators show stable demand"}],D=[{title:"Increase Production Capacity",priority:"High",description:"Demand forecast shows 25% increase in Q2",impact:"+15% revenue potential"},{title:"Optimize Inventory Levels",priority:"Medium",description:"Adjust safety stock for seasonal variations",impact:"8% cost reduction"}];export{p as default};
